/*! For license information please see main.bed87be5.js.LICENSE.txt */
(()=>{"use strict";var e={49:(e,t)=>{var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),p=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var x=b.prototype=new y;x.constructor=b,f(x,v.prototype),x.isPureReactComponent=!0;var w=Array.isArray,A=Object.prototype.hasOwnProperty,_={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,i){var s,a={},r=null,o=null;if(null!=t)for(s in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(r=""+t.key),t)A.call(t,s)&&!S.hasOwnProperty(s)&&(a[s]=t[s]);var l=arguments.length-2;if(1===l)a.children=i;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];a.children=c}if(e&&e.defaultProps)for(s in l=e.defaultProps)void 0===a[s]&&(a[s]=l[s]);return{$$typeof:n,type:e,key:r,ref:o,props:a,_owner:_.current}}function k(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var C=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function N(e,t,s,a,r){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case i:l=!0}}if(l)return r=r(l=e),e=""===a?"."+T(l,0):a,w(r)?(s="",null!=e&&(s=e.replace(C,"$&/")+"/"),N(r,t,s,"",function(e){return e})):null!=r&&(k(r)&&(r=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(r,s+(!r.key||l&&l.key===r.key?"":(""+r.key).replace(C,"$&/")+"/")+e)),t.push(r)),1;if(l=0,a=""===a?".":a+":",w(e))for(var c=0;c<e.length;c++){var d=a+T(o=e[c],c);l+=N(o,t,s,d,r)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(o=e.next()).done;)l+=N(o=o.value,t,s,d=a+T(o,c++),r);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function M(e,t,n){if(null==e)return e;var i=[],s=0;return N(e,i,"","",function(e){return t.call(n,e,s++)}),i}function R(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I={current:null},P={transition:null},L={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:P,ReactCurrentOwner:_};function j(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:M,forEach:function(e,t,n){M(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return M(e,function(){t++}),t},toArray:function(e){return M(e,function(e){return e})||[]},only:function(e){if(!k(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=s,t.Profiler=r,t.PureComponent=b,t.StrictMode=a,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,t.act=j,t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=f({},e.props),a=e.key,r=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(r=t.ref,o=_.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)A.call(t,c)&&!S.hasOwnProperty(c)&&(s[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)s.children=i;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];s.children=l}return{$$typeof:n,type:e.type,key:a,ref:r,props:s,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=k,t.lazy=function(e){return{$$typeof:u,_payload:{_status:-1,_result:e},_init:R}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=j,t.useCallback=function(e,t){return I.current.useCallback(e,t)},t.useContext=function(e){return I.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return I.current.useDeferredValue(e)},t.useEffect=function(e,t){return I.current.useEffect(e,t)},t.useId=function(){return I.current.useId()},t.useImperativeHandle=function(e,t,n){return I.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return I.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return I.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return I.current.useMemo(e,t)},t.useReducer=function(e,t,n){return I.current.useReducer(e,t,n)},t.useRef=function(e){return I.current.useRef(e)},t.useState=function(e){return I.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return I.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return I.current.useTransition()},t.version="18.3.1"},119:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(345)},340:(e,t,n)=>{e.exports=n(761)},345:(e,t,n)=>{var i=n(950),s=n(340);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)r.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function f(e,t,n,i,s,a,r){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=r}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new f(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new f(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new f(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new f(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new f(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new f(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,i){var s=g.hasOwnProperty(t)?g[t]:null;(null!==s?0!==s.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null===t||"undefined"===typeof t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,s,i)&&(n=null),i||null===s?function(e){return!!h.call(m,e)||!h.call(p,e)&&(u.test(e)?m[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=null===n?3!==s.type&&"":n:(t=s.attributeName,i=s.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(s=s.type)||4===s&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new f(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,y);g[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)});var x=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),A=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),k=Symbol.for("react.provider"),C=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),I=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var L=Symbol.iterator;function j(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=L&&e[L]||e["@@iterator"])?e:null}var D,O=Object.assign;function F(e){if(void 0===D)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);D=t&&t[1]||""}return"\n"+D+e}var W=!1;function z(e,t){if(!e||W)return"";W=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&"string"===typeof c.stack){for(var s=c.stack.split("\n"),a=i.stack.split("\n"),r=s.length-1,o=a.length-1;1<=r&&0<=o&&s[r]!==a[o];)o--;for(;1<=r&&0<=o;r--,o--)if(s[r]!==a[o]){if(1!==r||1!==o)do{if(r--,0>--o||s[r]!==a[o]){var l="\n"+s[r].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=r&&0<=o);break}}}finally{W=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function B(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function H(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case _:return"Fragment";case A:return"Portal";case E:return"Profiler";case S:return"StrictMode";case N:return"Suspense";case M:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case k:return(e._context.displayName||"Context")+".Provider";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case R:return null!==(t=e.displayName||null)?t:H(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return H(e(t))}catch(n){}}return null}function U(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return H(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function G(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function V(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=V(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var s=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(e){i=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Y(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=V(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function K(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function X(e,t){var n=t.checked;return O({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Q(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=G(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function $(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){$(e,t);var n=G(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,G(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,i){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&i&&(e[n].defaultSelected=!0)}else{for(n=""+G(n),t=null,s=0;s<e.length;s++){if(e[s].value===n)return e[s].selected=!0,void(i&&(e[s].defaultSelected=!0));null!==t||e[s].disabled||(t=e[s])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return O({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function se(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:G(n)}}function ae(e,t){var n=G(t.value),i=G(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function re(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,he=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction(function(){return de(e,t)})}:de);function ue(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},me=["Webkit","ms","Moz","O"];function fe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),s=fe(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,s):e[n]=s}}Object.keys(pe).forEach(function(e){me.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]})});var ve=O({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ae=null,_e=null,Se=null;function Ee(e){if(e=bs(e)){if("function"!==typeof Ae)throw Error(a(280));var t=e.stateNode;t&&(t=ws(t),Ae(e.stateNode,e.type,t))}}function ke(e){_e?Se?Se.push(e):Se=[e]:_e=e}function Ce(){if(_e){var e=_e,t=Se;if(Se=_e=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function Te(e,t){return e(t)}function Ne(){}var Me=!1;function Re(e,t,n){if(Me)return e(t,n);Me=!0;try{return Te(e,t,n)}finally{Me=!1,(null!==_e||null!==Se)&&(Ne(),Ce())}}function Ie(e,t){var n=e.stateNode;if(null===n)return null;var i=ws(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Pe=!1;if(d)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch(de){Pe=!1}function je(e,t,n,i,s,a,r,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(d){this.onError(d)}}var De=!1,Oe=null,Fe=!1,We=null,ze={onError:function(e){De=!0,Oe=e}};function Be(e,t,n,i,s,a,r,o,l){De=!1,Oe=null,je.apply(ze,arguments)}function He(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ue(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ge(e){if(He(e)!==e)throw Error(a(188))}function Ve(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=He(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,i=t;;){var s=n.return;if(null===s)break;var r=s.alternate;if(null===r){if(null!==(i=s.return)){n=i;continue}break}if(s.child===r.child){for(r=s.child;r;){if(r===n)return Ge(s),e;if(r===i)return Ge(s),t;r=r.sibling}throw Error(a(188))}if(n.return!==i.return)n=s,i=r;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,i=r;break}if(l===i){o=!0,i=s,n=r;break}l=l.sibling}if(!o){for(l=r.child;l;){if(l===n){o=!0,n=r,i=s;break}if(l===i){o=!0,i=r,n=s;break}l=l.sibling}if(!o)throw Error(a(189))}}if(n.alternate!==i)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?qe(e):null}function qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=qe(e);if(null!==t)return t;e=e.sibling}return null}var Ye=s.unstable_scheduleCallback,Ke=s.unstable_cancelCallback,Xe=s.unstable_shouldYield,Qe=s.unstable_requestPaint,$e=s.unstable_now,Je=s.unstable_getCurrentPriorityLevel,Ze=s.unstable_ImmediatePriority,et=s.unstable_UserBlockingPriority,tt=s.unstable_NormalPriority,nt=s.unstable_LowPriority,it=s.unstable_IdlePriority,st=null,at=null;var rt=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ut(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,s=e.suspendedLanes,a=e.pingedLanes,r=268435455&n;if(0!==r){var o=r&~s;0!==o?i=ht(o):0!==(a&=r)&&(i=ht(a))}else 0!==(r=n&~s)?i=ht(r):0!==a&&(i=ht(a));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&s)&&((s=i&-i)>=(a=t&-t)||16===s&&0!==(4194240&a)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)s=1<<(n=31-rt(t)),i|=e[n],t&=~s;return i}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function mt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-rt(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-rt(n),s=1<<i;s&t|e[i]&t&&(e[i]|=t),n&=~s}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,At,_t,St,Et,kt=!1,Ct=[],Tt=null,Nt=null,Mt=null,Rt=new Map,It=new Map,Pt=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jt(e,t){switch(e){case"focusin":case"focusout":Tt=null;break;case"dragenter":case"dragleave":Nt=null;break;case"mouseover":case"mouseout":Mt=null;break;case"pointerover":case"pointerout":Rt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":It.delete(t.pointerId)}}function Dt(e,t,n,i,s,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:a,targetContainers:[s]},null!==t&&(null!==(t=bs(t))&&At(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==s&&-1===t.indexOf(s)&&t.push(s),e)}function Ot(e){var t=ys(e.target);if(null!==t){var n=He(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ue(n)))return e.blockedOn=t,void Et(e.priority,function(){_t(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bs(n))&&At(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);xe=i,n.target.dispatchEvent(i),xe=null,t.shift()}return!0}function Wt(e,t,n){Ft(e)&&n.delete(t)}function zt(){kt=!1,null!==Tt&&Ft(Tt)&&(Tt=null),null!==Nt&&Ft(Nt)&&(Nt=null),null!==Mt&&Ft(Mt)&&(Mt=null),Rt.forEach(Wt),It.forEach(Wt)}function Bt(e,t){e.blockedOn===t&&(e.blockedOn=null,kt||(kt=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,zt)))}function Ht(e){function t(t){return Bt(t,e)}if(0<Ct.length){Bt(Ct[0],e);for(var n=1;n<Ct.length;n++){var i=Ct[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==Tt&&Bt(Tt,e),null!==Nt&&Bt(Nt,e),null!==Mt&&Bt(Mt,e),Rt.forEach(t),It.forEach(t),n=0;n<Pt.length;n++)(i=Pt[n]).blockedOn===e&&(i.blockedOn=null);for(;0<Pt.length&&null===(n=Pt[0]).blockedOn;)Ot(n),null===n.blockedOn&&Pt.shift()}var Ut=x.ReactCurrentBatchConfig,Gt=!0;function Vt(e,t,n,i){var s=bt,a=Ut.transition;Ut.transition=null;try{bt=1,Yt(e,t,n,i)}finally{bt=s,Ut.transition=a}}function qt(e,t,n,i){var s=bt,a=Ut.transition;Ut.transition=null;try{bt=4,Yt(e,t,n,i)}finally{bt=s,Ut.transition=a}}function Yt(e,t,n,i){if(Gt){var s=Xt(e,t,n,i);if(null===s)Gi(e,t,i,Kt,n),jt(e,i);else if(function(e,t,n,i,s){switch(t){case"focusin":return Tt=Dt(Tt,e,t,n,i,s),!0;case"dragenter":return Nt=Dt(Nt,e,t,n,i,s),!0;case"mouseover":return Mt=Dt(Mt,e,t,n,i,s),!0;case"pointerover":var a=s.pointerId;return Rt.set(a,Dt(Rt.get(a)||null,e,t,n,i,s)),!0;case"gotpointercapture":return a=s.pointerId,It.set(a,Dt(It.get(a)||null,e,t,n,i,s)),!0}return!1}(s,e,t,n,i))i.stopPropagation();else if(jt(e,i),4&t&&-1<Lt.indexOf(e)){for(;null!==s;){var a=bs(s);if(null!==a&&wt(a),null===(a=Xt(e,t,n,i))&&Gi(e,t,i,Kt,n),a===s)break;s=a}null!==s&&i.stopPropagation()}else Gi(e,t,i,null,n)}}var Kt=null;function Xt(e,t,n,i){if(Kt=null,null!==(e=ys(e=we(i))))if(null===(t=He(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ue(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case it:return 536870912;default:return 16}default:return 16}}var $t=null,Jt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Jt,i=n.length,s="value"in $t?$t.value:$t.textContent,a=s.length;for(e=0;e<i&&n[e]===s[e];e++);var r=i-e;for(t=1;t<=r&&n[i-t]===s[a-t];t++);return Zt=s.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function sn(){return!1}function an(e){function t(t,n,i,s,a){for(var r in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(r)&&(t=e[r],this[r]=t?t(s):s[r]);return this.isDefaultPrevented=(null!=s.defaultPrevented?s.defaultPrevented:!1===s.returnValue)?nn:sn,this.isPropagationStopped=sn,this}return O(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var rn,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=an(cn),hn=O({},cn,{view:0,detail:0}),un=an(hn),pn=O({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(rn=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=rn=0,ln=e),rn)},movementY:function(e){return"movementY"in e?e.movementY:on}}),mn=an(pn),fn=an(O({},pn,{dataTransfer:0})),gn=an(O({},hn,{relatedTarget:0})),vn=an(O({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=O({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(yn),xn=an(O({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},An={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_n={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=_n[e])&&!!t[e]}function En(){return Sn}var kn=O({},hn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?An[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cn=an(kn),Tn=an(O({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=an(O({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),Mn=an(O({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Rn=O({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),In=an(Rn),Pn=[9,13,27,32],Ln=d&&"CompositionEvent"in window,jn=null;d&&"documentMode"in document&&(jn=document.documentMode);var Dn=d&&"TextEvent"in window&&!jn,On=d&&(!Ln||jn&&8<jn&&11>=jn),Fn=String.fromCharCode(32),Wn=!1;function zn(e,t){switch(e){case"keyup":return-1!==Pn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Hn=!1;var Un={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Un[e.type]:"textarea"===t}function Vn(e,t,n,i){ke(i),0<(t=qi(t,"onChange")).length&&(n=new dn("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var qn=null,Yn=null;function Kn(e){Fi(e,0)}function Xn(e){if(Y(xs(e)))return e}function Qn(e,t){if("change"===e)return t}var $n=!1;if(d){var Jn;if(d){var Zn="oninput"in document;if(!Zn){var ei=document.createElement("div");ei.setAttribute("oninput","return;"),Zn="function"===typeof ei.oninput}Jn=Zn}else Jn=!1;$n=Jn&&(!document.documentMode||9<document.documentMode)}function ti(){qn&&(qn.detachEvent("onpropertychange",ni),Yn=qn=null)}function ni(e){if("value"===e.propertyName&&Xn(Yn)){var t=[];Vn(t,Yn,e,we(e)),Re(Kn,t)}}function ii(e,t,n){"focusin"===e?(ti(),Yn=n,(qn=t).attachEvent("onpropertychange",ni)):"focusout"===e&&ti()}function si(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Xn(Yn)}function ai(e,t){if("click"===e)return Xn(t)}function ri(e,t){if("input"===e||"change"===e)return Xn(t)}var oi="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function li(e,t){if(oi(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var s=n[i];if(!h.call(t,s)||!oi(e[s],t[s]))return!1}return!0}function ci(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function di(e,t){var n,i=ci(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ci(i)}}function hi(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hi(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ui(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function pi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function mi(e){var t=ui(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hi(n.ownerDocument.documentElement,n)){if(null!==i&&pi(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var s=n.textContent.length,a=Math.min(i.start,s);i=void 0===i.end?a:Math.min(i.end,s),!e.extend&&a>i&&(s=i,i=a,a=s),s=di(n,a);var r=di(n,i);s&&r&&(1!==e.rangeCount||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==r.node||e.focusOffset!==r.offset)&&((t=t.createRange()).setStart(s.node,s.offset),e.removeAllRanges(),a>i?(e.addRange(t),e.extend(r.node,r.offset)):(t.setEnd(r.node,r.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fi=d&&"documentMode"in document&&11>=document.documentMode,gi=null,vi=null,yi=null,bi=!1;function xi(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;bi||null==gi||gi!==K(i)||("selectionStart"in(i=gi)&&pi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},yi&&li(yi,i)||(yi=i,0<(i=qi(vi,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=gi)))}function wi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ai={animationend:wi("Animation","AnimationEnd"),animationiteration:wi("Animation","AnimationIteration"),animationstart:wi("Animation","AnimationStart"),transitionend:wi("Transition","TransitionEnd")},_i={},Si={};function Ei(e){if(_i[e])return _i[e];if(!Ai[e])return e;var t,n=Ai[e];for(t in n)if(n.hasOwnProperty(t)&&t in Si)return _i[e]=n[t];return e}d&&(Si=document.createElement("div").style,"AnimationEvent"in window||(delete Ai.animationend.animation,delete Ai.animationiteration.animation,delete Ai.animationstart.animation),"TransitionEvent"in window||delete Ai.transitionend.transition);var ki=Ei("animationend"),Ci=Ei("animationiteration"),Ti=Ei("animationstart"),Ni=Ei("transitionend"),Mi=new Map,Ri="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ii(e,t){Mi.set(e,t),l(t,[e])}for(var Pi=0;Pi<Ri.length;Pi++){var Li=Ri[Pi];Ii(Li.toLowerCase(),"on"+(Li[0].toUpperCase()+Li.slice(1)))}Ii(ki,"onAnimationEnd"),Ii(Ci,"onAnimationIteration"),Ii(Ti,"onAnimationStart"),Ii("dblclick","onDoubleClick"),Ii("focusin","onFocus"),Ii("focusout","onBlur"),Ii(Ni,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ji="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Di=new Set("cancel close invalid load scroll toggle".split(" ").concat(ji));function Oi(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,s,r,o,l,c){if(Be.apply(this,arguments),De){if(!De)throw Error(a(198));var d=Oe;De=!1,Oe=null,Fe||(Fe=!0,We=d)}}(i,t,void 0,e),e.currentTarget=null}function Fi(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],s=i.event;i=i.listeners;e:{var a=void 0;if(t)for(var r=i.length-1;0<=r;r--){var o=i[r],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&s.isPropagationStopped())break e;Oi(s,o,c),a=l}else for(r=0;r<i.length;r++){if(l=(o=i[r]).instance,c=o.currentTarget,o=o.listener,l!==a&&s.isPropagationStopped())break e;Oi(s,o,c),a=l}}}if(Fe)throw e=We,Fe=!1,We=null,e}function Wi(e,t){var n=t[fs];void 0===n&&(n=t[fs]=new Set);var i=e+"__bubble";n.has(i)||(Ui(t,e,2,!1),n.add(i))}function zi(e,t,n){var i=0;t&&(i|=4),Ui(n,e,i,t)}var Bi="_reactListening"+Math.random().toString(36).slice(2);function Hi(e){if(!e[Bi]){e[Bi]=!0,r.forEach(function(t){"selectionchange"!==t&&(Di.has(t)||zi(t,!1,e),zi(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Bi]||(t[Bi]=!0,zi("selectionchange",!1,t))}}function Ui(e,t,n,i){switch(Qt(t)){case 1:var s=Vt;break;case 4:s=qt;break;default:s=Yt}n=s.bind(null,t,n,e),s=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(s=!0),i?void 0!==s?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):void 0!==s?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Gi(e,t,n,i,s){var a=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var r=i.tag;if(3===r||4===r){var o=i.stateNode.containerInfo;if(o===s||8===o.nodeType&&o.parentNode===s)break;if(4===r)for(r=i.return;null!==r;){var l=r.tag;if((3===l||4===l)&&((l=r.stateNode.containerInfo)===s||8===l.nodeType&&l.parentNode===s))return;r=r.return}for(;null!==o;){if(null===(r=ys(o)))return;if(5===(l=r.tag)||6===l){i=a=r;continue e}o=o.parentNode}}i=i.return}Re(function(){var i=a,s=we(n),r=[];e:{var o=Mi.get(e);if(void 0!==o){var l=dn,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Cn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Nn;break;case ki:case Ci:case Ti:l=vn;break;case Ni:l=Mn;break;case"scroll":l=un;break;case"wheel":l=In;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Tn}var d=0!==(4&t),h=!d&&"scroll"===e,u=d?null!==o?o+"Capture":null:o;d=[];for(var p,m=i;null!==m;){var f=(p=m).stateNode;if(5===p.tag&&null!==f&&(p=f,null!==u&&(null!=(f=Ie(m,u))&&d.push(Vi(m,f,p)))),h)break;m=m.return}0<d.length&&(o=new l(o,c,null,n,s),r.push({event:o,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!ys(c)&&!c[ms])&&(l||o)&&(o=s.window===s?s:(o=s.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?ys(c):null)&&(c!==(h=He(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(d=mn,f="onMouseLeave",u="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=Tn,f="onPointerLeave",u="onPointerEnter",m="pointer"),h=null==l?o:xs(l),p=null==c?o:xs(c),(o=new d(f,m+"leave",l,n,s)).target=h,o.relatedTarget=p,f=null,ys(s)===i&&((d=new d(u,m+"enter",c,n,s)).target=p,d.relatedTarget=h,f=d),h=f,l&&c)e:{for(u=c,m=0,p=d=l;p;p=Yi(p))m++;for(p=0,f=u;f;f=Yi(f))p++;for(;0<m-p;)d=Yi(d),m--;for(;0<p-m;)u=Yi(u),p--;for(;m--;){if(d===u||null!==u&&d===u.alternate)break e;d=Yi(d),u=Yi(u)}d=null}else d=null;null!==l&&Ki(r,o,l,d,!1),null!==c&&null!==h&&Ki(r,h,c,d,!0)}if("select"===(l=(o=i?xs(i):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Qn;else if(Gn(o))if($n)g=ri;else{g=si;var v=ii}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=ai);switch(g&&(g=g(e,i))?Vn(r,g,n,s):(v&&v(e,o,i),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ee(o,"number",o.value)),v=i?xs(i):window,e){case"focusin":(Gn(v)||"true"===v.contentEditable)&&(gi=v,vi=i,yi=null);break;case"focusout":yi=vi=gi=null;break;case"mousedown":bi=!0;break;case"contextmenu":case"mouseup":case"dragend":bi=!1,xi(r,n,s);break;case"selectionchange":if(fi)break;case"keydown":case"keyup":xi(r,n,s)}var y;if(Ln)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Hn?zn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(On&&"ko"!==n.locale&&(Hn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Hn&&(y=en()):(Jt="value"in($t=s)?$t.value:$t.textContent,Hn=!0)),0<(v=qi(i,b)).length&&(b=new xn(b,e,null,n,s),r.push({event:b,listeners:v}),y?b.data=y:null!==(y=Bn(n))&&(b.data=y))),(y=Dn?function(e,t){switch(e){case"compositionend":return Bn(t);case"keypress":return 32!==t.which?null:(Wn=!0,Fn);case"textInput":return(e=t.data)===Fn&&Wn?null:e;default:return null}}(e,n):function(e,t){if(Hn)return"compositionend"===e||!Ln&&zn(e,t)?(e=en(),Zt=Jt=$t=null,Hn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return On&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(i=qi(i,"onBeforeInput")).length&&(s=new xn("onBeforeInput","beforeinput",null,n,s),r.push({event:s,listeners:i}),s.data=y))}Fi(r,t)})}function Vi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qi(e,t){for(var n=t+"Capture",i=[];null!==e;){var s=e,a=s.stateNode;5===s.tag&&null!==a&&(s=a,null!=(a=Ie(e,n))&&i.unshift(Vi(e,a,s)),null!=(a=Ie(e,t))&&i.push(Vi(e,a,s))),e=e.return}return i}function Yi(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Ki(e,t,n,i,s){for(var a=t._reactName,r=[];null!==n&&n!==i;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===i)break;5===o.tag&&null!==c&&(o=c,s?null!=(l=Ie(n,a))&&r.unshift(Vi(n,l,o)):s||null!=(l=Ie(n,a))&&r.push(Vi(n,l,o))),n=n.return}0!==r.length&&e.push({event:t,listeners:r})}var Xi=/\r\n?/g,Qi=/\u0000|\uFFFD/g;function $i(e){return("string"===typeof e?e:""+e).replace(Xi,"\n").replace(Qi,"")}function Ji(e,t,n){if(t=$i(t),$i(e)!==t&&n)throw Error(a(425))}function Zi(){}var es=null,ts=null;function ns(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var is="function"===typeof setTimeout?setTimeout:void 0,ss="function"===typeof clearTimeout?clearTimeout:void 0,as="function"===typeof Promise?Promise:void 0,rs="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof as?function(e){return as.resolve(null).then(e).catch(os)}:is;function os(e){setTimeout(function(){throw e})}function ls(e,t){var n=t,i=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&8===s.nodeType)if("/$"===(n=s.data)){if(0===i)return e.removeChild(s),void Ht(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=s}while(n);Ht(t)}function cs(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ds(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hs=Math.random().toString(36).slice(2),us="__reactFiber$"+hs,ps="__reactProps$"+hs,ms="__reactContainer$"+hs,fs="__reactEvents$"+hs,gs="__reactListeners$"+hs,vs="__reactHandles$"+hs;function ys(e){var t=e[us];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ms]||n[us]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ds(e);null!==e;){if(n=e[us])return n;e=ds(e)}return t}n=(e=n).parentNode}return null}function bs(e){return!(e=e[us]||e[ms])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xs(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function ws(e){return e[ps]||null}var As=[],_s=-1;function Ss(e){return{current:e}}function Es(e){0>_s||(e.current=As[_s],As[_s]=null,_s--)}function ks(e,t){_s++,As[_s]=e.current,e.current=t}var Cs={},Ts=Ss(Cs),Ns=Ss(!1),Ms=Cs;function Rs(e,t){var n=e.type.contextTypes;if(!n)return Cs;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var s,a={};for(s in n)a[s]=t[s];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Is(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ps(){Es(Ns),Es(Ts)}function Ls(e,t,n){if(Ts.current!==Cs)throw Error(a(168));ks(Ts,t),ks(Ns,n)}function js(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var s in i=i.getChildContext())if(!(s in t))throw Error(a(108,U(e)||"Unknown",s));return O({},n,i)}function Ds(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Cs,Ms=Ts.current,ks(Ts,e),ks(Ns,Ns.current),!0}function Os(e,t,n){var i=e.stateNode;if(!i)throw Error(a(169));n?(e=js(e,t,Ms),i.__reactInternalMemoizedMergedChildContext=e,Es(Ns),Es(Ts),ks(Ts,e)):Es(Ns),ks(Ns,n)}var Fs=null,Ws=!1,zs=!1;function Bs(e){null===Fs?Fs=[e]:Fs.push(e)}function Hs(){if(!zs&&null!==Fs){zs=!0;var e=0,t=bt;try{var n=Fs;for(bt=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}Fs=null,Ws=!1}catch(s){throw null!==Fs&&(Fs=Fs.slice(e+1)),Ye(Ze,Hs),s}finally{bt=t,zs=!1}}return null}var Us=[],Gs=0,Vs=null,qs=0,Ys=[],Ks=0,Xs=null,Qs=1,$s="";function Js(e,t){Us[Gs++]=qs,Us[Gs++]=Vs,Vs=e,qs=t}function Zs(e,t,n){Ys[Ks++]=Qs,Ys[Ks++]=$s,Ys[Ks++]=Xs,Xs=e;var i=Qs;e=$s;var s=32-rt(i)-1;i&=~(1<<s),n+=1;var a=32-rt(t)+s;if(30<a){var r=s-s%5;a=(i&(1<<r)-1).toString(32),i>>=r,s-=r,Qs=1<<32-rt(t)+s|n<<s|i,$s=a+e}else Qs=1<<a|n<<s|i,$s=e}function ea(e){null!==e.return&&(Js(e,1),Zs(e,1,0))}function ta(e){for(;e===Vs;)Vs=Us[--Gs],Us[Gs]=null,qs=Us[--Gs],Us[Gs]=null;for(;e===Xs;)Xs=Ys[--Ks],Ys[Ks]=null,$s=Ys[--Ks],Ys[Ks]=null,Qs=Ys[--Ks],Ys[Ks]=null}var na=null,ia=null,sa=!1,aa=null;function ra(e,t){var n=Rc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function oa(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,na=e,ia=cs(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,na=e,ia=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Xs?{id:Qs,overflow:$s}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Rc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,na=e,ia=null,!0);default:return!1}}function la(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ca(e){if(sa){var t=ia;if(t){var n=t;if(!oa(e,t)){if(la(e))throw Error(a(418));t=cs(n.nextSibling);var i=na;t&&oa(e,t)?ra(i,n):(e.flags=-4097&e.flags|2,sa=!1,na=e)}}else{if(la(e))throw Error(a(418));e.flags=-4097&e.flags|2,sa=!1,na=e}}}function da(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;na=e}function ha(e){if(e!==na)return!1;if(!sa)return da(e),sa=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ns(e.type,e.memoizedProps)),t&&(t=ia)){if(la(e))throw ua(),Error(a(418));for(;t;)ra(e,t),t=cs(t.nextSibling)}if(da(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ia=cs(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ia=null}}else ia=na?cs(e.stateNode.nextSibling):null;return!0}function ua(){for(var e=ia;e;)e=cs(e.nextSibling)}function pa(){ia=na=null,sa=!1}function ma(e){null===aa?aa=[e]:aa.push(e)}var fa=x.ReactCurrentBatchConfig;function ga(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var i=n.stateNode}if(!i)throw Error(a(147,e));var s=i,r=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===r?t.ref:(t=function(e){var t=s.refs;null===e?delete t[r]:t[r]=e},t._stringRef=r,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function va(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ya(e){return(0,e._init)(e._payload)}function ba(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function s(e,t){return(e=Pc(e,t)).index=0,e.sibling=null,e}function r(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=Oc(n,e.mode,i)).return=e,t):((t=s(t,n)).return=e,t)}function c(e,t,n,i){var a=n.type;return a===_?h(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===I&&ya(a)===t.type)?((i=s(t,n.props)).ref=ga(e,t,n),i.return=e,i):((i=Lc(n.type,n.key,n.props,null,e.mode,i)).ref=ga(e,t,n),i.return=e,i)}function d(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,i)).return=e,t):((t=s(t,n.children||[])).return=e,t)}function h(e,t,n,i,a){return null===t||7!==t.tag?((t=jc(n,e.mode,i,a)).return=e,t):((t=s(t,n)).return=e,t)}function u(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Oc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Lc(t.type,t.key,t.props,null,e.mode,n)).ref=ga(e,null,t),n.return=e,n;case A:return(t=Fc(t,e.mode,n)).return=e,t;case I:return u(e,(0,t._init)(t._payload),n)}if(te(t)||j(t))return(t=jc(t,e.mode,n,null)).return=e,t;va(e,t)}return null}function p(e,t,n,i){var s=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==s?null:l(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===s?c(e,t,n,i):null;case A:return n.key===s?d(e,t,n,i):null;case I:return p(e,t,(s=n._init)(n._payload),i)}if(te(n)||j(n))return null!==s?null:h(e,t,n,i,null);va(e,n)}return null}function m(e,t,n,i,s){if("string"===typeof i&&""!==i||"number"===typeof i)return l(t,e=e.get(n)||null,""+i,s);if("object"===typeof i&&null!==i){switch(i.$$typeof){case w:return c(t,e=e.get(null===i.key?n:i.key)||null,i,s);case A:return d(t,e=e.get(null===i.key?n:i.key)||null,i,s);case I:return m(e,t,n,(0,i._init)(i._payload),s)}if(te(i)||j(i))return h(t,e=e.get(n)||null,i,s,null);va(t,i)}return null}function f(s,a,o,l){for(var c=null,d=null,h=a,f=a=0,g=null;null!==h&&f<o.length;f++){h.index>f?(g=h,h=null):g=h.sibling;var v=p(s,h,o[f],l);if(null===v){null===h&&(h=g);break}e&&h&&null===v.alternate&&t(s,h),a=r(v,a,f),null===d?c=v:d.sibling=v,d=v,h=g}if(f===o.length)return n(s,h),sa&&Js(s,f),c;if(null===h){for(;f<o.length;f++)null!==(h=u(s,o[f],l))&&(a=r(h,a,f),null===d?c=h:d.sibling=h,d=h);return sa&&Js(s,f),c}for(h=i(s,h);f<o.length;f++)null!==(g=m(h,s,f,o[f],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?f:g.key),a=r(g,a,f),null===d?c=g:d.sibling=g,d=g);return e&&h.forEach(function(e){return t(s,e)}),sa&&Js(s,f),c}function g(s,o,l,c){var d=j(l);if("function"!==typeof d)throw Error(a(150));if(null==(l=d.call(l)))throw Error(a(151));for(var h=d=null,f=o,g=o=0,v=null,y=l.next();null!==f&&!y.done;g++,y=l.next()){f.index>g?(v=f,f=null):v=f.sibling;var b=p(s,f,y.value,c);if(null===b){null===f&&(f=v);break}e&&f&&null===b.alternate&&t(s,f),o=r(b,o,g),null===h?d=b:h.sibling=b,h=b,f=v}if(y.done)return n(s,f),sa&&Js(s,g),d;if(null===f){for(;!y.done;g++,y=l.next())null!==(y=u(s,y.value,c))&&(o=r(y,o,g),null===h?d=y:h.sibling=y,h=y);return sa&&Js(s,g),d}for(f=i(s,f);!y.done;g++,y=l.next())null!==(y=m(f,s,g,y.value,c))&&(e&&null!==y.alternate&&f.delete(null===y.key?g:y.key),o=r(y,o,g),null===h?d=y:h.sibling=y,h=y);return e&&f.forEach(function(e){return t(s,e)}),sa&&Js(s,g),d}return function e(i,a,r,l){if("object"===typeof r&&null!==r&&r.type===_&&null===r.key&&(r=r.props.children),"object"===typeof r&&null!==r){switch(r.$$typeof){case w:e:{for(var c=r.key,d=a;null!==d;){if(d.key===c){if((c=r.type)===_){if(7===d.tag){n(i,d.sibling),(a=s(d,r.props.children)).return=i,i=a;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===I&&ya(c)===d.type){n(i,d.sibling),(a=s(d,r.props)).ref=ga(i,d,r),a.return=i,i=a;break e}n(i,d);break}t(i,d),d=d.sibling}r.type===_?((a=jc(r.props.children,i.mode,l,r.key)).return=i,i=a):((l=Lc(r.type,r.key,r.props,null,i.mode,l)).ref=ga(i,a,r),l.return=i,i=l)}return o(i);case A:e:{for(d=r.key;null!==a;){if(a.key===d){if(4===a.tag&&a.stateNode.containerInfo===r.containerInfo&&a.stateNode.implementation===r.implementation){n(i,a.sibling),(a=s(a,r.children||[])).return=i,i=a;break e}n(i,a);break}t(i,a),a=a.sibling}(a=Fc(r,i.mode,l)).return=i,i=a}return o(i);case I:return e(i,a,(d=r._init)(r._payload),l)}if(te(r))return f(i,a,r,l);if(j(r))return g(i,a,r,l);va(i,r)}return"string"===typeof r&&""!==r||"number"===typeof r?(r=""+r,null!==a&&6===a.tag?(n(i,a.sibling),(a=s(a,r)).return=i,i=a):(n(i,a),(a=Oc(r,i.mode,l)).return=i,i=a),o(i)):n(i,a)}}var xa=ba(!0),wa=ba(!1),Aa=Ss(null),_a=null,Sa=null,Ea=null;function ka(){Ea=Sa=_a=null}function Ca(e){var t=Aa.current;Es(Aa),e._currentValue=t}function Ta(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Na(e,t){_a=e,Ea=Sa=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bo=!0),e.firstContext=null)}function Ma(e){var t=e._currentValue;if(Ea!==e)if(e={context:e,memoizedValue:t,next:null},null===Sa){if(null===_a)throw Error(a(308));Sa=e,_a.dependencies={lanes:0,firstContext:e}}else Sa=Sa.next=e;return t}var Ra=null;function Ia(e){null===Ra?Ra=[e]:Ra.push(e)}function Pa(e,t,n,i){var s=t.interleaved;return null===s?(n.next=n,Ia(t)):(n.next=s.next,s.next=n),t.interleaved=n,La(e,i)}function La(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var ja=!1;function Da(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oa(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Wa(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&Tl)){var s=i.pending;return null===s?t.next=t:(t.next=s.next,s.next=t),i.pending=t,La(e,n)}return null===(s=i.interleaved)?(t.next=t,Ia(i)):(t.next=s.next,s.next=t),i.interleaved=t,La(e,n)}function za(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Ba(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var s=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var r={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?s=a=r:a=a.next=r,n=n.next}while(null!==n);null===a?s=a=t:a=a.next=t}else s=a=t;return n={baseState:i.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ha(e,t,n,i){var s=e.updateQueue;ja=!1;var a=s.firstBaseUpdate,r=s.lastBaseUpdate,o=s.shared.pending;if(null!==o){s.shared.pending=null;var l=o,c=l.next;l.next=null,null===r?a=c:r.next=c,r=l;var d=e.alternate;null!==d&&((o=(d=d.updateQueue).lastBaseUpdate)!==r&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(null!==a){var h=s.baseState;for(r=0,d=c=l=null,o=a;;){var u=o.lane,p=o.eventTime;if((i&u)===u){null!==d&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,f=o;switch(u=t,p=n,f.tag){case 1:if("function"===typeof(m=f.payload)){h=m.call(p,h,u);break e}h=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(u="function"===typeof(m=f.payload)?m.call(p,h,u):m)||void 0===u)break e;h=O({},h,u);break e;case 2:ja=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(u=s.effects)?s.effects=[o]:u.push(o))}else p={eventTime:p,lane:u,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=p,l=h):d=d.next=p,r|=u;if(null===(o=o.next)){if(null===(o=s.shared.pending))break;o=(u=o).next,u.next=null,s.lastBaseUpdate=u,s.shared.pending=null}}if(null===d&&(l=h),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=d,null!==(t=s.shared.interleaved)){s=t;do{r|=s.lane,s=s.next}while(s!==t)}else null===a&&(s.shared.lanes=0);Dl|=r,e.lanes=r,e.memoizedState=h}}function Ua(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],s=i.callback;if(null!==s){if(i.callback=null,i=n,"function"!==typeof s)throw Error(a(191,s));s.call(i)}}}var Ga={},Va=Ss(Ga),qa=Ss(Ga),Ya=Ss(Ga);function Ka(e){if(e===Ga)throw Error(a(174));return e}function Xa(e,t){switch(ks(Ya,t),ks(qa,e),ks(Va,Ga),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Es(Va),ks(Va,t)}function Qa(){Es(Va),Es(qa),Es(Ya)}function $a(e){Ka(Ya.current);var t=Ka(Va.current),n=le(t,e.type);t!==n&&(ks(qa,e),ks(Va,n))}function Ja(e){qa.current===e&&(Es(Va),Es(qa))}var Za=Ss(0);function er(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var tr=[];function nr(){for(var e=0;e<tr.length;e++)tr[e]._workInProgressVersionPrimary=null;tr.length=0}var ir=x.ReactCurrentDispatcher,sr=x.ReactCurrentBatchConfig,ar=0,rr=null,or=null,lr=null,cr=!1,dr=!1,hr=0,ur=0;function pr(){throw Error(a(321))}function mr(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!oi(e[n],t[n]))return!1;return!0}function fr(e,t,n,i,s,r){if(ar=r,rr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ir.current=null===e||null===e.memoizedState?Jr:Zr,e=n(i,s),dr){r=0;do{if(dr=!1,hr=0,25<=r)throw Error(a(301));r+=1,lr=or=null,t.updateQueue=null,ir.current=eo,e=n(i,s)}while(dr)}if(ir.current=$r,t=null!==or&&null!==or.next,ar=0,lr=or=rr=null,cr=!1,t)throw Error(a(300));return e}function gr(){var e=0!==hr;return hr=0,e}function vr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lr?rr.memoizedState=lr=e:lr=lr.next=e,lr}function yr(){if(null===or){var e=rr.alternate;e=null!==e?e.memoizedState:null}else e=or.next;var t=null===lr?rr.memoizedState:lr.next;if(null!==t)lr=t,or=e;else{if(null===e)throw Error(a(310));e={memoizedState:(or=e).memoizedState,baseState:or.baseState,baseQueue:or.baseQueue,queue:or.queue,next:null},null===lr?rr.memoizedState=lr=e:lr=lr.next=e}return lr}function br(e,t){return"function"===typeof t?t(e):t}function xr(e){var t=yr(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var i=or,s=i.baseQueue,r=n.pending;if(null!==r){if(null!==s){var o=s.next;s.next=r.next,r.next=o}i.baseQueue=s=r,n.pending=null}if(null!==s){r=s.next,i=i.baseState;var l=o=null,c=null,d=r;do{var h=d.lane;if((ar&h)===h)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),i=d.hasEagerState?d.eagerState:e(i,d.action);else{var u={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=u,o=i):c=c.next=u,rr.lanes|=h,Dl|=h}d=d.next}while(null!==d&&d!==r);null===c?o=i:c.next=l,oi(i,t.memoizedState)||(bo=!0),t.memoizedState=i,t.baseState=o,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){s=e;do{r=s.lane,rr.lanes|=r,Dl|=r,s=s.next}while(s!==e)}else null===s&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function wr(e){var t=yr(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var i=n.dispatch,s=n.pending,r=t.memoizedState;if(null!==s){n.pending=null;var o=s=s.next;do{r=e(r,o.action),o=o.next}while(o!==s);oi(r,t.memoizedState)||(bo=!0),t.memoizedState=r,null===t.baseQueue&&(t.baseState=r),n.lastRenderedState=r}return[r,i]}function Ar(){}function _r(e,t){var n=rr,i=yr(),s=t(),r=!oi(i.memoizedState,s);if(r&&(i.memoizedState=s,bo=!0),i=i.queue,jr(kr.bind(null,n,i,e),[e]),i.getSnapshot!==t||r||null!==lr&&1&lr.memoizedState.tag){if(n.flags|=2048,Mr(9,Er.bind(null,n,i,s,t),void 0,null),null===Nl)throw Error(a(349));0!==(30&ar)||Sr(n,t,s)}return s}function Sr(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=rr.updateQueue)?(t={lastEffect:null,stores:null},rr.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Er(e,t,n,i){t.value=n,t.getSnapshot=i,Cr(t)&&Tr(e)}function kr(e,t,n){return n(function(){Cr(t)&&Tr(e)})}function Cr(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!oi(e,n)}catch(i){return!0}}function Tr(e){var t=La(e,1);null!==t&&nc(t,e,1,-1)}function Nr(e){var t=vr();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:br,lastRenderedState:e},t.queue=e,e=e.dispatch=Yr.bind(null,rr,e),[t.memoizedState,e]}function Mr(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=rr.updateQueue)?(t={lastEffect:null,stores:null},rr.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Rr(){return yr().memoizedState}function Ir(e,t,n,i){var s=vr();rr.flags|=e,s.memoizedState=Mr(1|t,n,void 0,void 0===i?null:i)}function Pr(e,t,n,i){var s=yr();i=void 0===i?null:i;var a=void 0;if(null!==or){var r=or.memoizedState;if(a=r.destroy,null!==i&&mr(i,r.deps))return void(s.memoizedState=Mr(t,n,a,i))}rr.flags|=e,s.memoizedState=Mr(1|t,n,a,i)}function Lr(e,t){return Ir(8390656,8,e,t)}function jr(e,t){return Pr(2048,8,e,t)}function Dr(e,t){return Pr(4,2,e,t)}function Or(e,t){return Pr(4,4,e,t)}function Fr(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Wr(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Pr(4,4,Fr.bind(null,t,e),n)}function zr(){}function Br(e,t){var n=yr();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&mr(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Hr(e,t){var n=yr();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&mr(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Ur(e,t,n){return 0===(21&ar)?(e.baseState&&(e.baseState=!1,bo=!0),e.memoizedState=n):(oi(n,t)||(n=ft(),rr.lanes|=n,Dl|=n,e.baseState=!0),t)}function Gr(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var i=sr.transition;sr.transition={};try{e(!1),t()}finally{bt=n,sr.transition=i}}function Vr(){return yr().memoizedState}function qr(e,t,n){var i=tc(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Kr(e))Xr(t,n);else if(null!==(n=Pa(e,t,n,i))){nc(n,e,i,ec()),Qr(n,t,i)}}function Yr(e,t,n){var i=tc(e),s={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Kr(e))Xr(t,s);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var r=t.lastRenderedState,o=a(r,n);if(s.hasEagerState=!0,s.eagerState=o,oi(o,r)){var l=t.interleaved;return null===l?(s.next=s,Ia(t)):(s.next=l.next,l.next=s),void(t.interleaved=s)}}catch(c){}null!==(n=Pa(e,t,s,i))&&(nc(n,e,i,s=ec()),Qr(n,t,i))}}function Kr(e){var t=e.alternate;return e===rr||null!==t&&t===rr}function Xr(e,t){dr=cr=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Qr(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}var $r={readContext:Ma,useCallback:pr,useContext:pr,useEffect:pr,useImperativeHandle:pr,useInsertionEffect:pr,useLayoutEffect:pr,useMemo:pr,useReducer:pr,useRef:pr,useState:pr,useDebugValue:pr,useDeferredValue:pr,useTransition:pr,useMutableSource:pr,useSyncExternalStore:pr,useId:pr,unstable_isNewReconciler:!1},Jr={readContext:Ma,useCallback:function(e,t){return vr().memoizedState=[e,void 0===t?null:t],e},useContext:Ma,useEffect:Lr,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ir(4194308,4,Fr.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ir(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ir(4,2,e,t)},useMemo:function(e,t){var n=vr();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=vr();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=qr.bind(null,rr,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},vr().memoizedState=e},useState:Nr,useDebugValue:zr,useDeferredValue:function(e){return vr().memoizedState=e},useTransition:function(){var e=Nr(!1),t=e[0];return e=Gr.bind(null,e[1]),vr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=rr,s=vr();if(sa){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Nl)throw Error(a(349));0!==(30&ar)||Sr(i,t,n)}s.memoizedState=n;var r={value:n,getSnapshot:t};return s.queue=r,Lr(kr.bind(null,i,r,e),[e]),i.flags|=2048,Mr(9,Er.bind(null,i,r,n,t),void 0,null),n},useId:function(){var e=vr(),t=Nl.identifierPrefix;if(sa){var n=$s;t=":"+t+"R"+(n=(Qs&~(1<<32-rt(Qs)-1)).toString(32)+n),0<(n=hr++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ur++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Zr={readContext:Ma,useCallback:Br,useContext:Ma,useEffect:jr,useImperativeHandle:Wr,useInsertionEffect:Dr,useLayoutEffect:Or,useMemo:Hr,useReducer:xr,useRef:Rr,useState:function(){return xr(br)},useDebugValue:zr,useDeferredValue:function(e){return Ur(yr(),or.memoizedState,e)},useTransition:function(){return[xr(br)[0],yr().memoizedState]},useMutableSource:Ar,useSyncExternalStore:_r,useId:Vr,unstable_isNewReconciler:!1},eo={readContext:Ma,useCallback:Br,useContext:Ma,useEffect:jr,useImperativeHandle:Wr,useInsertionEffect:Dr,useLayoutEffect:Or,useMemo:Hr,useReducer:wr,useRef:Rr,useState:function(){return wr(br)},useDebugValue:zr,useDeferredValue:function(e){var t=yr();return null===or?t.memoizedState=e:Ur(t,or.memoizedState,e)},useTransition:function(){return[wr(br)[0],yr().memoizedState]},useMutableSource:Ar,useSyncExternalStore:_r,useId:Vr,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var n in t=O({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function no(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:O({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var io={isMounted:function(e){return!!(e=e._reactInternals)&&He(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=ec(),s=tc(e),a=Fa(i,s);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Wa(e,a,s))&&(nc(t,e,s,i),za(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=ec(),s=tc(e),a=Fa(i,s);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Wa(e,a,s))&&(nc(t,e,s,i),za(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),i=tc(e),s=Fa(n,i);s.tag=2,void 0!==t&&null!==t&&(s.callback=t),null!==(t=Wa(e,s,i))&&(nc(t,e,i,n),za(t,e,i))}};function so(e,t,n,i,s,a,r){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,a,r):!t.prototype||!t.prototype.isPureReactComponent||(!li(n,i)||!li(s,a))}function ao(e,t,n){var i=!1,s=Cs,a=t.contextType;return"object"===typeof a&&null!==a?a=Ma(a):(s=Is(t)?Ms:Ts.current,a=(i=null!==(i=t.contextTypes)&&void 0!==i)?Rs(e,s):Cs),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=io,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function ro(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&io.enqueueReplaceState(t,t.state,null)}function oo(e,t,n,i){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Da(e);var a=t.contextType;"object"===typeof a&&null!==a?s.context=Ma(a):(a=Is(t)?Ms:Ts.current,s.context=Rs(e,a)),s.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(no(e,t,a,n),s.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(t=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),t!==s.state&&io.enqueueReplaceState(s,s.state,null),Ha(e,n,s,i),s.state=e.memoizedState),"function"===typeof s.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var n="",i=t;do{n+=B(i),i=i.return}while(i);var s=n}catch(a){s="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:s,digest:null}}function co(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ho(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var uo="function"===typeof WeakMap?WeakMap:Map;function po(e,t,n){(n=Fa(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){Gl||(Gl=!0,Vl=i),ho(0,t)},n}function mo(e,t,n){(n=Fa(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var s=t.value;n.payload=function(){return i(s)},n.callback=function(){ho(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){ho(0,t),"function"!==typeof i&&(null===ql?ql=new Set([this]):ql.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function fo(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new uo;var s=new Set;i.set(t,s)}else void 0===(s=i.get(t))&&(s=new Set,i.set(t,s));s.has(n)||(s.add(n),e=Ec.bind(null,e,t,n),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vo(e,t,n,i,s){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fa(-1,1)).tag=2,Wa(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=s,e)}var yo=x.ReactCurrentOwner,bo=!1;function xo(e,t,n,i){t.child=null===e?wa(t,null,n,i):xa(t,e.child,n,i)}function wo(e,t,n,i,s){n=n.render;var a=t.ref;return Na(t,s),i=fr(e,t,n,i,a,s),n=gr(),null===e||bo?(sa&&n&&ea(t),t.flags|=1,xo(e,t,i,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Go(e,t,s))}function Ao(e,t,n,i,s){if(null===e){var a=n.type;return"function"!==typeof a||Ic(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Lc(n.type,null,i,t,t.mode,s)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,_o(e,t,a,i,s))}if(a=e.child,0===(e.lanes&s)){var r=a.memoizedProps;if((n=null!==(n=n.compare)?n:li)(r,i)&&e.ref===t.ref)return Go(e,t,s)}return t.flags|=1,(e=Pc(a,i)).ref=t.ref,e.return=t,t.child=e}function _o(e,t,n,i,s){if(null!==e){var a=e.memoizedProps;if(li(a,i)&&e.ref===t.ref){if(bo=!1,t.pendingProps=i=a,0===(e.lanes&s))return t.lanes=e.lanes,Go(e,t,s);0!==(131072&e.flags)&&(bo=!0)}}return ko(e,t,n,i,s)}function So(e,t,n){var i=t.pendingProps,s=i.children,a=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ks(Pl,Il),Il|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ks(Pl,Il),Il|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==a?a.baseLanes:n,ks(Pl,Il),Il|=i}else null!==a?(i=a.baseLanes|n,t.memoizedState=null):i=n,ks(Pl,Il),Il|=i;return xo(e,t,s,n),t.child}function Eo(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function ko(e,t,n,i,s){var a=Is(n)?Ms:Ts.current;return a=Rs(t,a),Na(t,s),n=fr(e,t,n,i,a,s),i=gr(),null===e||bo?(sa&&i&&ea(t),t.flags|=1,xo(e,t,n,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Go(e,t,s))}function Co(e,t,n,i,s){if(Is(n)){var a=!0;Ds(t)}else a=!1;if(Na(t,s),null===t.stateNode)Uo(e,t),ao(t,n,i),oo(t,n,i,s),i=!0;else if(null===e){var r=t.stateNode,o=t.memoizedProps;r.props=o;var l=r.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ma(c):c=Rs(t,c=Is(n)?Ms:Ts.current);var d=n.getDerivedStateFromProps,h="function"===typeof d||"function"===typeof r.getSnapshotBeforeUpdate;h||"function"!==typeof r.UNSAFE_componentWillReceiveProps&&"function"!==typeof r.componentWillReceiveProps||(o!==i||l!==c)&&ro(t,r,i,c),ja=!1;var u=t.memoizedState;r.state=u,Ha(t,i,r,s),l=t.memoizedState,o!==i||u!==l||Ns.current||ja?("function"===typeof d&&(no(t,n,d,i),l=t.memoizedState),(o=ja||so(t,n,o,i,u,l,c))?(h||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||("function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount()),"function"===typeof r.componentDidMount&&(t.flags|=4194308)):("function"===typeof r.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),r.props=i,r.state=l,r.context=c,i=o):("function"===typeof r.componentDidMount&&(t.flags|=4194308),i=!1)}else{r=t.stateNode,Oa(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),r.props=c,h=t.pendingProps,u=r.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ma(l):l=Rs(t,l=Is(n)?Ms:Ts.current);var p=n.getDerivedStateFromProps;(d="function"===typeof p||"function"===typeof r.getSnapshotBeforeUpdate)||"function"!==typeof r.UNSAFE_componentWillReceiveProps&&"function"!==typeof r.componentWillReceiveProps||(o!==h||u!==l)&&ro(t,r,i,l),ja=!1,u=t.memoizedState,r.state=u,Ha(t,i,r,s);var m=t.memoizedState;o!==h||u!==m||Ns.current||ja?("function"===typeof p&&(no(t,n,p,i),m=t.memoizedState),(c=ja||so(t,n,c,i,u,m,l)||!1)?(d||"function"!==typeof r.UNSAFE_componentWillUpdate&&"function"!==typeof r.componentWillUpdate||("function"===typeof r.componentWillUpdate&&r.componentWillUpdate(i,m,l),"function"===typeof r.UNSAFE_componentWillUpdate&&r.UNSAFE_componentWillUpdate(i,m,l)),"function"===typeof r.componentDidUpdate&&(t.flags|=4),"function"===typeof r.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof r.componentDidUpdate||o===e.memoizedProps&&u===e.memoizedState||(t.flags|=4),"function"!==typeof r.getSnapshotBeforeUpdate||o===e.memoizedProps&&u===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=m),r.props=i,r.state=m,r.context=l,i=c):("function"!==typeof r.componentDidUpdate||o===e.memoizedProps&&u===e.memoizedState||(t.flags|=4),"function"!==typeof r.getSnapshotBeforeUpdate||o===e.memoizedProps&&u===e.memoizedState||(t.flags|=1024),i=!1)}return To(e,t,n,i,a,s)}function To(e,t,n,i,s,a){Eo(e,t);var r=0!==(128&t.flags);if(!i&&!r)return s&&Os(t,n,!1),Go(e,t,a);i=t.stateNode,yo.current=t;var o=r&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&r?(t.child=xa(t,e.child,null,a),t.child=xa(t,null,o,a)):xo(e,t,o,a),t.memoizedState=i.state,s&&Os(t,n,!0),t.child}function No(e){var t=e.stateNode;t.pendingContext?Ls(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ls(0,t.context,!1),Xa(e,t.containerInfo)}function Mo(e,t,n,i,s){return pa(),ma(s),t.flags|=256,xo(e,t,n,i),t.child}var Ro,Io,Po,Lo,jo={dehydrated:null,treeContext:null,retryLane:0};function Do(e){return{baseLanes:e,cachePool:null,transitions:null}}function Oo(e,t,n){var i,s=t.pendingProps,r=Za.current,o=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&r)),i?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(r|=1),ks(Za,1&r),null===e)return ca(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=s.children,e=s.fallback,o?(s=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&s)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Dc(l,s,0,null),e=jc(e,s,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Do(n),t.memoizedState=jo,e):Fo(t,l));if(null!==(r=e.memoizedState)&&null!==(i=r.dehydrated))return function(e,t,n,i,s,r,o){if(n)return 256&t.flags?(t.flags&=-257,Wo(e,t,o,i=co(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(r=i.fallback,s=t.mode,i=Dc({mode:"visible",children:i.children},s,0,null),(r=jc(r,s,o,null)).flags|=2,i.return=t,r.return=t,i.sibling=r,t.child=i,0!==(1&t.mode)&&xa(t,e.child,null,o),t.child.memoizedState=Do(o),t.memoizedState=jo,r);if(0===(1&t.mode))return Wo(e,t,o,null);if("$!"===s.data){if(i=s.nextSibling&&s.nextSibling.dataset)var l=i.dgst;return i=l,Wo(e,t,o,i=co(r=Error(a(419)),i,void 0))}if(l=0!==(o&e.childLanes),bo||l){if(null!==(i=Nl)){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(s=0!==(s&(i.suspendedLanes|o))?0:s)&&s!==r.retryLane&&(r.retryLane=s,La(e,s),nc(i,e,s,-1))}return fc(),Wo(e,t,o,i=co(Error(a(421))))}return"$?"===s.data?(t.flags|=128,t.child=e.child,t=Cc.bind(null,e),s._reactRetry=t,null):(e=r.treeContext,ia=cs(s.nextSibling),na=t,sa=!0,aa=null,null!==e&&(Ys[Ks++]=Qs,Ys[Ks++]=$s,Ys[Ks++]=Xs,Qs=e.id,$s=e.overflow,Xs=t),t=Fo(t,i.children),t.flags|=4096,t)}(e,t,l,s,i,r,n);if(o){o=s.fallback,l=t.mode,i=(r=e.child).sibling;var c={mode:"hidden",children:s.children};return 0===(1&l)&&t.child!==r?((s=t.child).childLanes=0,s.pendingProps=c,t.deletions=null):(s=Pc(r,c)).subtreeFlags=14680064&r.subtreeFlags,null!==i?o=Pc(i,o):(o=jc(o,l,n,null)).flags|=2,o.return=t,s.return=t,s.sibling=o,t.child=s,s=o,o=t.child,l=null===(l=e.child.memoizedState)?Do(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=jo,s}return e=(o=e.child).sibling,s=Pc(o,{mode:"visible",children:s.children}),0===(1&t.mode)&&(s.lanes=n),s.return=t,s.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function Fo(e,t){return(t=Dc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Wo(e,t,n,i){return null!==i&&ma(i),xa(t,e.child,null,n),(e=Fo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zo(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Ta(e.return,t,n)}function Bo(e,t,n,i,s){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=i,a.tail=n,a.tailMode=s)}function Ho(e,t,n){var i=t.pendingProps,s=i.revealOrder,a=i.tail;if(xo(e,t,i.children,n),0!==(2&(i=Za.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zo(e,n,t);else if(19===e.tag)zo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(ks(Za,i),0===(1&t.mode))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;null!==n;)null!==(e=n.alternate)&&null===er(e)&&(s=n),n=n.sibling;null===(n=s)?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Bo(t,!1,s,n,a);break;case"backwards":for(n=null,s=t.child,t.child=null;null!==s;){if(null!==(e=s.alternate)&&null===er(e)){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Bo(t,!0,n,null,a);break;case"together":Bo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Uo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Go(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Dl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Pc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Vo(e,t){if(!sa)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function qo(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var s=e.child;null!==s;)n|=s.lanes|s.childLanes,i|=14680064&s.subtreeFlags,i|=14680064&s.flags,s.return=e,s=s.sibling;else for(s=e.child;null!==s;)n|=s.lanes|s.childLanes,i|=s.subtreeFlags,i|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Yo(e,t,n){var i=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qo(t),null;case 1:case 17:return Is(t.type)&&Ps(),qo(t),null;case 3:return i=t.stateNode,Qa(),Es(Ns),Es(Ts),nr(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(ha(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(rc(aa),aa=null))),Io(e,t),qo(t),null;case 5:Ja(t);var s=Ka(Ya.current);if(n=t.type,null!==e&&null!=t.stateNode)Po(e,t,n,i,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(a(166));return qo(t),null}if(e=Ka(Va.current),ha(t)){i=t.stateNode,n=t.type;var r=t.memoizedProps;switch(i[us]=t,i[ps]=r,e=0!==(1&t.mode),n){case"dialog":Wi("cancel",i),Wi("close",i);break;case"iframe":case"object":case"embed":Wi("load",i);break;case"video":case"audio":for(s=0;s<ji.length;s++)Wi(ji[s],i);break;case"source":Wi("error",i);break;case"img":case"image":case"link":Wi("error",i),Wi("load",i);break;case"details":Wi("toggle",i);break;case"input":Q(i,r),Wi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!r.multiple},Wi("invalid",i);break;case"textarea":se(i,r),Wi("invalid",i)}for(var l in ye(n,r),s=null,r)if(r.hasOwnProperty(l)){var c=r[l];"children"===l?"string"===typeof c?i.textContent!==c&&(!0!==r.suppressHydrationWarning&&Ji(i.textContent,c,e),s=["children",c]):"number"===typeof c&&i.textContent!==""+c&&(!0!==r.suppressHydrationWarning&&Ji(i.textContent,c,e),s=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Wi("scroll",i)}switch(n){case"input":q(i),Z(i,r,!0);break;case"textarea":q(i),re(i);break;case"select":case"option":break;default:"function"===typeof r.onClick&&(i.onclick=Zi)}i=s,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===s.nodeType?s:s.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof i.is?e=l.createElement(n,{is:i.is}):(e=l.createElement(n),"select"===n&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,n),e[us]=t,e[ps]=i,Ro(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,i),n){case"dialog":Wi("cancel",e),Wi("close",e),s=i;break;case"iframe":case"object":case"embed":Wi("load",e),s=i;break;case"video":case"audio":for(s=0;s<ji.length;s++)Wi(ji[s],e);s=i;break;case"source":Wi("error",e),s=i;break;case"img":case"image":case"link":Wi("error",e),Wi("load",e),s=i;break;case"details":Wi("toggle",e),s=i;break;case"input":Q(e,i),s=X(e,i),Wi("invalid",e);break;case"option":default:s=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},s=O({},i,{value:void 0}),Wi("invalid",e);break;case"textarea":se(e,i),s=ie(e,i),Wi("invalid",e)}for(r in ye(n,s),c=s)if(c.hasOwnProperty(r)){var d=c[r];"style"===r?ge(e,d):"dangerouslySetInnerHTML"===r?null!=(d=d?d.__html:void 0)&&he(e,d):"children"===r?"string"===typeof d?("textarea"!==n||""!==d)&&ue(e,d):"number"===typeof d&&ue(e,""+d):"suppressContentEditableWarning"!==r&&"suppressHydrationWarning"!==r&&"autoFocus"!==r&&(o.hasOwnProperty(r)?null!=d&&"onScroll"===r&&Wi("scroll",e):null!=d&&b(e,r,d,l))}switch(n){case"input":q(e),Z(e,i,!1);break;case"textarea":q(e),re(e);break;case"option":null!=i.value&&e.setAttribute("value",""+G(i.value));break;case"select":e.multiple=!!i.multiple,null!=(r=i.value)?ne(e,!!i.multiple,r,!1):null!=i.defaultValue&&ne(e,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof s.onClick&&(e.onclick=Zi)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qo(t),null;case 6:if(e&&null!=t.stateNode)Lo(e,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(a(166));if(n=Ka(Ya.current),Ka(Va.current),ha(t)){if(i=t.stateNode,n=t.memoizedProps,i[us]=t,(r=i.nodeValue!==n)&&null!==(e=na))switch(e.tag){case 3:Ji(i.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Ji(i.nodeValue,n,0!==(1&e.mode))}r&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[us]=t,t.stateNode=i}return qo(t),null;case 13:if(Es(Za),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(sa&&null!==ia&&0!==(1&t.mode)&&0===(128&t.flags))ua(),pa(),t.flags|=98560,r=!1;else if(r=ha(t),null!==i&&null!==i.dehydrated){if(null===e){if(!r)throw Error(a(318));if(!(r=null!==(r=t.memoizedState)?r.dehydrated:null))throw Error(a(317));r[us]=t}else pa(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qo(t),r=!1}else null!==aa&&(rc(aa),aa=null),r=!0;if(!r)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Za.current)?0===Ll&&(Ll=3):fc())),null!==t.updateQueue&&(t.flags|=4),qo(t),null);case 4:return Qa(),Io(e,t),null===e&&Hi(t.stateNode.containerInfo),qo(t),null;case 10:return Ca(t.type._context),qo(t),null;case 19:if(Es(Za),null===(r=t.memoizedState))return qo(t),null;if(i=0!==(128&t.flags),null===(l=r.rendering))if(i)Vo(r,!1);else{if(0!==Ll||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=er(e))){for(t.flags|=128,Vo(r,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(r=n).flags&=14680066,null===(l=r.alternate)?(r.childLanes=0,r.lanes=e,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=l.childLanes,r.lanes=l.lanes,r.child=l.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=l.memoizedProps,r.memoizedState=l.memoizedState,r.updateQueue=l.updateQueue,r.type=l.type,e=l.dependencies,r.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ks(Za,1&Za.current|2),t.child}e=e.sibling}null!==r.tail&&$e()>Hl&&(t.flags|=128,i=!0,Vo(r,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=er(l))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Vo(r,!0),null===r.tail&&"hidden"===r.tailMode&&!l.alternate&&!sa)return qo(t),null}else 2*$e()-r.renderingStartTime>Hl&&1073741824!==n&&(t.flags|=128,i=!0,Vo(r,!1),t.lanes=4194304);r.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=r.last)?n.sibling=l:t.child=l,r.last=l)}return null!==r.tail?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=$e(),t.sibling=null,n=Za.current,ks(Za,i?1&n|2:1&n),t):(qo(t),null);case 22:case 23:return hc(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Il)&&(qo(t),6&t.subtreeFlags&&(t.flags|=8192)):qo(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Ko(e,t){switch(ta(t),t.tag){case 1:return Is(t.type)&&Ps(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Qa(),Es(Ns),Es(Ts),nr(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Ja(t),null;case 13:if(Es(Za),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));pa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Es(Za),null;case 4:return Qa(),null;case 10:return Ca(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Ro=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Io=function(){},Po=function(e,t,n,i){var s=e.memoizedProps;if(s!==i){e=t.stateNode,Ka(Va.current);var a,r=null;switch(n){case"input":s=X(e,s),i=X(e,i),r=[];break;case"select":s=O({},s,{value:void 0}),i=O({},i,{value:void 0}),r=[];break;case"textarea":s=ie(e,s),i=ie(e,i),r=[];break;default:"function"!==typeof s.onClick&&"function"===typeof i.onClick&&(e.onclick=Zi)}for(d in ye(n,i),n=null,s)if(!i.hasOwnProperty(d)&&s.hasOwnProperty(d)&&null!=s[d])if("style"===d){var l=s[d];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(o.hasOwnProperty(d)?r||(r=[]):(r=r||[]).push(d,null));for(d in i){var c=i[d];if(l=null!=s?s[d]:void 0,i.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(r||(r=[]),r.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(r=r||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(r=r||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(o.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Wi("scroll",e),r||l===c||(r=[])):(r=r||[]).push(d,c))}n&&(r=r||[]).push("style",n);var d=r;(t.updateQueue=d)&&(t.flags|=4)}},Lo=function(e,t,n,i){n!==i&&(t.flags|=4)};var Xo=!1,Qo=!1,$o="function"===typeof WeakSet?WeakSet:Set,Jo=null;function Zo(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){Sc(e,t,i)}else n.current=null}function el(e,t,n){try{n()}catch(i){Sc(e,t,i)}}var tl=!1;function nl(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var s=i=i.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,void 0!==a&&el(t,n,a)}s=s.next}while(s!==i)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function sl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[us],delete t[ps],delete t[fs],delete t[gs],delete t[vs])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function rl(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||rl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zi));else if(4!==i&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var dl=null,hl=!1;function ul(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(st,n)}catch(o){}switch(n.tag){case 5:Qo||Zo(n,t);case 6:var i=dl,s=hl;dl=null,ul(e,t,n),hl=s,null!==(dl=i)&&(hl?(e=dl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dl.removeChild(n.stateNode));break;case 18:null!==dl&&(hl?(e=dl,n=n.stateNode,8===e.nodeType?ls(e.parentNode,n):1===e.nodeType&&ls(e,n),Ht(e)):ls(dl,n.stateNode));break;case 4:i=dl,s=hl,dl=n.stateNode.containerInfo,hl=!0,ul(e,t,n),dl=i,hl=s;break;case 0:case 11:case 14:case 15:if(!Qo&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){s=i=i.next;do{var a=s,r=a.destroy;a=a.tag,void 0!==r&&(0!==(2&a)||0!==(4&a))&&el(n,t,r),s=s.next}while(s!==i)}ul(e,t,n);break;case 1:if(!Qo&&(Zo(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(o){Sc(n,t,o)}ul(e,t,n);break;case 21:ul(e,t,n);break;case 22:1&n.mode?(Qo=(i=Qo)||null!==n.memoizedState,ul(e,t,n),Qo=i):ul(e,t,n);break;default:ul(e,t,n)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new $o),t.forEach(function(t){var i=Tc.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))})}}function fl(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var s=n[i];try{var r=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,hl=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===dl)throw Error(a(160));pl(r,o,s),dl=null,hl=!1;var c=s.alternate;null!==c&&(c.return=null),s.return=null}catch(d){Sc(s,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fl(t,e),vl(e),4&i){try{nl(3,e,e.return),il(3,e)}catch(g){Sc(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Sc(e,e.return,g)}}break;case 1:fl(t,e),vl(e),512&i&&null!==n&&Zo(n,n.return);break;case 5:if(fl(t,e),vl(e),512&i&&null!==n&&Zo(n,n.return),32&e.flags){var s=e.stateNode;try{ue(s,"")}catch(g){Sc(e,e.return,g)}}if(4&i&&null!=(s=e.stateNode)){var r=e.memoizedProps,o=null!==n?n.memoizedProps:r,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===r.type&&null!=r.name&&$(s,r),be(l,o);var d=be(l,r);for(o=0;o<c.length;o+=2){var h=c[o],u=c[o+1];"style"===h?ge(s,u):"dangerouslySetInnerHTML"===h?he(s,u):"children"===h?ue(s,u):b(s,h,u,d)}switch(l){case"input":J(s,r);break;case"textarea":ae(s,r);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!r.multiple;var m=r.value;null!=m?ne(s,!!r.multiple,m,!1):p!==!!r.multiple&&(null!=r.defaultValue?ne(s,!!r.multiple,r.defaultValue,!0):ne(s,!!r.multiple,r.multiple?[]:"",!1))}s[ps]=r}catch(g){Sc(e,e.return,g)}}break;case 6:if(fl(t,e),vl(e),4&i){if(null===e.stateNode)throw Error(a(162));s=e.stateNode,r=e.memoizedProps;try{s.nodeValue=r}catch(g){Sc(e,e.return,g)}}break;case 3:if(fl(t,e),vl(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Ht(t.containerInfo)}catch(g){Sc(e,e.return,g)}break;case 4:default:fl(t,e),vl(e);break;case 13:fl(t,e),vl(e),8192&(s=e.child).flags&&(r=null!==s.memoizedState,s.stateNode.isHidden=r,!r||null!==s.alternate&&null!==s.alternate.memoizedState||(Bl=$e())),4&i&&ml(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Qo=(d=Qo)||h,fl(t,e),Qo=d):fl(t,e),vl(e),8192&i){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!h&&0!==(1&e.mode))for(Jo=e,h=e.child;null!==h;){for(u=Jo=h;null!==Jo;){switch(m=(p=Jo).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:Zo(p,p.return);var f=p.stateNode;if("function"===typeof f.componentWillUnmount){i=p,n=p.return;try{t=i,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(g){Sc(i,n,g)}}break;case 5:Zo(p,p.return);break;case 22:if(null!==p.memoizedState){wl(u);continue}}null!==m?(m.return=p,Jo=m):wl(u)}h=h.sibling}e:for(h=null,u=e;;){if(5===u.tag){if(null===h){h=u;try{s=u.stateNode,d?"function"===typeof(r=s.style).setProperty?r.setProperty("display","none","important"):r.display="none":(l=u.stateNode,o=void 0!==(c=u.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=fe("display",o))}catch(g){Sc(e,e.return,g)}}}else if(6===u.tag){if(null===h)try{u.stateNode.nodeValue=d?"":u.memoizedProps}catch(g){Sc(e,e.return,g)}}else if((22!==u.tag&&23!==u.tag||null===u.memoizedState||u===e)&&null!==u.child){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;null===u.sibling;){if(null===u.return||u.return===e)break e;h===u&&(h=null),u=u.return}h===u&&(h=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:fl(t,e),vl(e),4&i&&ml(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(rl(n)){var i=n;break e}n=n.return}throw Error(a(160))}switch(i.tag){case 5:var s=i.stateNode;32&i.flags&&(ue(s,""),i.flags&=-33),cl(e,ol(e),s);break;case 3:case 4:var r=i.stateNode.containerInfo;ll(e,ol(e),r);break;default:throw Error(a(161))}}catch(o){Sc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Jo=e,bl(e,t,n)}function bl(e,t,n){for(var i=0!==(1&e.mode);null!==Jo;){var s=Jo,a=s.child;if(22===s.tag&&i){var r=null!==s.memoizedState||Xo;if(!r){var o=s.alternate,l=null!==o&&null!==o.memoizedState||Qo;o=Xo;var c=Qo;if(Xo=r,(Qo=l)&&!c)for(Jo=s;null!==Jo;)l=(r=Jo).child,22===r.tag&&null!==r.memoizedState?Al(s):null!==l?(l.return=r,Jo=l):Al(s);for(;null!==a;)Jo=a,bl(a,t,n),a=a.sibling;Jo=s,Xo=o,Qo=c}xl(e)}else 0!==(8772&s.subtreeFlags)&&null!==a?(a.return=s,Jo=a):xl(e)}}function xl(e){for(;null!==Jo;){var t=Jo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Qo||il(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Qo)if(null===n)i.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:to(t.type,n.memoizedProps);i.componentDidUpdate(s,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var r=t.updateQueue;null!==r&&Ua(t,r,i);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ua(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var h=d.memoizedState;if(null!==h){var u=h.dehydrated;null!==u&&Ht(u)}}}break;default:throw Error(a(163))}Qo||512&t.flags&&sl(t)}catch(p){Sc(t,t.return,p)}}if(t===e){Jo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Jo=n;break}Jo=t.return}}function wl(e){for(;null!==Jo;){var t=Jo;if(t===e){Jo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Jo=n;break}Jo=t.return}}function Al(e){for(;null!==Jo;){var t=Jo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(l){Sc(t,n,l)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var s=t.return;try{i.componentDidMount()}catch(l){Sc(t,s,l)}}var a=t.return;try{sl(t)}catch(l){Sc(t,a,l)}break;case 5:var r=t.return;try{sl(t)}catch(l){Sc(t,r,l)}}}catch(l){Sc(t,t.return,l)}if(t===e){Jo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Jo=o;break}Jo=t.return}}var _l,Sl=Math.ceil,El=x.ReactCurrentDispatcher,kl=x.ReactCurrentOwner,Cl=x.ReactCurrentBatchConfig,Tl=0,Nl=null,Ml=null,Rl=0,Il=0,Pl=Ss(0),Ll=0,jl=null,Dl=0,Ol=0,Fl=0,Wl=null,zl=null,Bl=0,Hl=1/0,Ul=null,Gl=!1,Vl=null,ql=null,Yl=!1,Kl=null,Xl=0,Ql=0,$l=null,Jl=-1,Zl=0;function ec(){return 0!==(6&Tl)?$e():-1!==Jl?Jl:Jl=$e()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Tl)&&0!==Rl?Rl&-Rl:null!==fa.transition?(0===Zl&&(Zl=ft()),Zl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Qt(e.type)}function nc(e,t,n,i){if(50<Ql)throw Ql=0,$l=null,Error(a(185));vt(e,n,i),0!==(2&Tl)&&e===Nl||(e===Nl&&(0===(2&Tl)&&(Ol|=n),4===Ll&&oc(e,Rl)),ic(e,i),1===n&&0===Tl&&0===(1&t.mode)&&(Hl=$e()+500,Ws&&Hs()))}function ic(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var r=31-rt(a),o=1<<r,l=s[r];-1===l?0!==(o&n)&&0===(o&i)||(s[r]=pt(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}(e,t);var i=ut(e,e===Nl?Rl:0);if(0===i)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){Ws=!0,Bs(e)}(lc.bind(null,e)):Bs(lc.bind(null,e)),rs(function(){0===(6&Tl)&&Hs()}),n=null;else{switch(xt(i)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=it}n=Nc(n,sc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function sc(e,t){if(Jl=-1,Zl=0,0!==(6&Tl))throw Error(a(327));var n=e.callbackNode;if(Ac()&&e.callbackNode!==n)return null;var i=ut(e,e===Nl?Rl:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=gc(e,i);else{t=i;var s=Tl;Tl|=2;var r=mc();for(Nl===e&&Rl===t||(Ul=null,Hl=$e()+500,uc(e,t));;)try{yc();break}catch(l){pc(e,l)}ka(),El.current=r,Tl=s,null!==Ml?t=0:(Nl=null,Rl=0,t=Ll)}if(0!==t){if(2===t&&(0!==(s=mt(e))&&(i=s,t=ac(e,s))),1===t)throw n=jl,uc(e,0),oc(e,i),ic(e,$e()),n;if(6===t)oc(e,i);else{if(s=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var s=n[i],a=s.getSnapshot;s=s.value;try{if(!oi(a(),s))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(s)&&(2===(t=gc(e,i))&&(0!==(r=mt(e))&&(i=r,t=ac(e,r))),1===t))throw n=jl,uc(e,0),oc(e,i),ic(e,$e()),n;switch(e.finishedWork=s,e.finishedLanes=i,t){case 0:case 1:throw Error(a(345));case 2:case 5:wc(e,zl,Ul);break;case 3:if(oc(e,i),(130023424&i)===i&&10<(t=Bl+500-$e())){if(0!==ut(e,0))break;if(((s=e.suspendedLanes)&i)!==i){ec(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=is(wc.bind(null,e,zl,Ul),t);break}wc(e,zl,Ul);break;case 4:if(oc(e,i),(4194240&i)===i)break;for(t=e.eventTimes,s=-1;0<i;){var o=31-rt(i);r=1<<o,(o=t[o])>s&&(s=o),i&=~r}if(i=s,10<(i=(120>(i=$e()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Sl(i/1960))-i)){e.timeoutHandle=is(wc.bind(null,e,zl,Ul),i);break}wc(e,zl,Ul);break;default:throw Error(a(329))}}}return ic(e,$e()),e.callbackNode===n?sc.bind(null,e):null}function ac(e,t){var n=Wl;return e.current.memoizedState.isDehydrated&&(uc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=zl,zl=n,null!==t&&rc(t)),e}function rc(e){null===zl?zl=e:zl.push.apply(zl,e)}function oc(e,t){for(t&=~Fl,t&=~Ol,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-rt(t),i=1<<n;e[n]=-1,t&=~i}}function lc(e){if(0!==(6&Tl))throw Error(a(327));Ac();var t=ut(e,0);if(0===(1&t))return ic(e,$e()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var i=mt(e);0!==i&&(t=i,n=ac(e,i))}if(1===n)throw n=jl,uc(e,0),oc(e,t),ic(e,$e()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,zl,Ul),ic(e,$e()),null}function cc(e,t){var n=Tl;Tl|=1;try{return e(t)}finally{0===(Tl=n)&&(Hl=$e()+500,Ws&&Hs())}}function dc(e){null!==Kl&&0===Kl.tag&&0===(6&Tl)&&Ac();var t=Tl;Tl|=1;var n=Cl.transition,i=bt;try{if(Cl.transition=null,bt=1,e)return e()}finally{bt=i,Cl.transition=n,0===(6&(Tl=t))&&Hs()}}function hc(){Il=Pl.current,Es(Pl)}function uc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ss(n)),null!==Ml)for(n=Ml.return;null!==n;){var i=n;switch(ta(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Ps();break;case 3:Qa(),Es(Ns),Es(Ts),nr();break;case 5:Ja(i);break;case 4:Qa();break;case 13:case 19:Es(Za);break;case 10:Ca(i.type._context);break;case 22:case 23:hc()}n=n.return}if(Nl=e,Ml=e=Pc(e.current,null),Rl=Il=t,Ll=0,jl=null,Fl=Ol=Dl=0,zl=Wl=null,null!==Ra){for(t=0;t<Ra.length;t++)if(null!==(i=(n=Ra[t]).interleaved)){n.interleaved=null;var s=i.next,a=n.pending;if(null!==a){var r=a.next;a.next=s,i.next=r}n.pending=i}Ra=null}return e}function pc(e,t){for(;;){var n=Ml;try{if(ka(),ir.current=$r,cr){for(var i=rr.memoizedState;null!==i;){var s=i.queue;null!==s&&(s.pending=null),i=i.next}cr=!1}if(ar=0,lr=or=rr=null,dr=!1,hr=0,kl.current=null,null===n||null===n.return){Ll=1,jl=t,Ml=null;break}e:{var r=e,o=n.return,l=n,c=t;if(t=Rl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,h=l,u=h.tag;if(0===(1&h.mode)&&(0===u||11===u||15===u)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var m=go(o);if(null!==m){m.flags&=-257,vo(m,o,l,0,t),1&m.mode&&fo(r,d,t),c=d;var f=(t=m).updateQueue;if(null===f){var g=new Set;g.add(c),t.updateQueue=g}else f.add(c);break e}if(0===(1&t)){fo(r,d,t),fc();break e}c=Error(a(426))}else if(sa&&1&l.mode){var v=go(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vo(v,o,l,0,t),ma(lo(c,l));break e}}r=c=lo(c,l),4!==Ll&&(Ll=2),null===Wl?Wl=[r]:Wl.push(r),r=o;do{switch(r.tag){case 3:r.flags|=65536,t&=-t,r.lanes|=t,Ba(r,po(0,c,t));break e;case 1:l=c;var y=r.type,b=r.stateNode;if(0===(128&r.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===ql||!ql.has(b)))){r.flags|=65536,t&=-t,r.lanes|=t,Ba(r,mo(r,l,t));break e}}r=r.return}while(null!==r)}xc(n)}catch(x){t=x,Ml===n&&null!==n&&(Ml=n=n.return);continue}break}}function mc(){var e=El.current;return El.current=$r,null===e?$r:e}function fc(){0!==Ll&&3!==Ll&&2!==Ll||(Ll=4),null===Nl||0===(268435455&Dl)&&0===(268435455&Ol)||oc(Nl,Rl)}function gc(e,t){var n=Tl;Tl|=2;var i=mc();for(Nl===e&&Rl===t||(Ul=null,uc(e,t));;)try{vc();break}catch(s){pc(e,s)}if(ka(),Tl=n,El.current=i,null!==Ml)throw Error(a(261));return Nl=null,Rl=0,Ll}function vc(){for(;null!==Ml;)bc(Ml)}function yc(){for(;null!==Ml&&!Xe();)bc(Ml)}function bc(e){var t=_l(e.alternate,e,Il);e.memoizedProps=e.pendingProps,null===t?xc(e):Ml=t,kl.current=null}function xc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Yo(n,t,Il)))return void(Ml=n)}else{if(null!==(n=Ko(n,t)))return n.flags&=32767,void(Ml=n);if(null===e)return Ll=6,void(Ml=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ml=t);Ml=t=e}while(null!==t);0===Ll&&(Ll=5)}function wc(e,t,n){var i=bt,s=Cl.transition;try{Cl.transition=null,bt=1,function(e,t,n,i){do{Ac()}while(null!==Kl);if(0!==(6&Tl))throw Error(a(327));n=e.finishedWork;var s=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var r=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-rt(n),a=1<<s;t[s]=0,i[s]=-1,e[s]=-1,n&=~a}}(e,r),e===Nl&&(Ml=Nl=null,Rl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Yl||(Yl=!0,Nc(tt,function(){return Ac(),null})),r=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||r){r=Cl.transition,Cl.transition=null;var o=bt;bt=1;var l=Tl;Tl|=4,kl.current=null,function(e,t){if(es=Gt,pi(e=ui())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var s=i.anchorOffset,r=i.focusNode;i=i.focusOffset;try{n.nodeType,r.nodeType}catch(w){n=null;break e}var o=0,l=-1,c=-1,d=0,h=0,u=e,p=null;t:for(;;){for(var m;u!==n||0!==s&&3!==u.nodeType||(l=o+s),u!==r||0!==i&&3!==u.nodeType||(c=o+i),3===u.nodeType&&(o+=u.nodeValue.length),null!==(m=u.firstChild);)p=u,u=m;for(;;){if(u===e)break t;if(p===n&&++d===s&&(l=o),p===r&&++h===i&&(c=o),null!==(m=u.nextSibling))break;p=(u=p).parentNode}u=m}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ts={focusedElem:e,selectionRange:n},Gt=!1,Jo=t;null!==Jo;)if(e=(t=Jo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Jo=e;else for(;null!==Jo;){t=Jo;try{var f=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var g=f.memoizedProps,v=f.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:to(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(a(163))}}catch(w){Sc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Jo=e;break}Jo=t.return}f=tl,tl=!1}(e,n),gl(n,e),mi(ts),Gt=!!es,ts=es=null,e.current=n,yl(n,e,s),Qe(),Tl=l,bt=o,Cl.transition=r}else e.current=n;if(Yl&&(Yl=!1,Kl=e,Xl=s),r=e.pendingLanes,0===r&&(ql=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(st,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ic(e,$e()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],i(s.value,{componentStack:s.stack,digest:s.digest});if(Gl)throw Gl=!1,e=Vl,Vl=null,e;0!==(1&Xl)&&0!==e.tag&&Ac(),r=e.pendingLanes,0!==(1&r)?e===$l?Ql++:(Ql=0,$l=e):Ql=0,Hs()}(e,t,n,i)}finally{Cl.transition=s,bt=i}return null}function Ac(){if(null!==Kl){var e=xt(Xl),t=Cl.transition,n=bt;try{if(Cl.transition=null,bt=16>e?16:e,null===Kl)var i=!1;else{if(e=Kl,Kl=null,Xl=0,0!==(6&Tl))throw Error(a(331));var s=Tl;for(Tl|=4,Jo=e.current;null!==Jo;){var r=Jo,o=r.child;if(0!==(16&Jo.flags)){var l=r.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Jo=d;null!==Jo;){var h=Jo;switch(h.tag){case 0:case 11:case 15:nl(8,h,r)}var u=h.child;if(null!==u)u.return=h,Jo=u;else for(;null!==Jo;){var p=(h=Jo).sibling,m=h.return;if(al(h),h===d){Jo=null;break}if(null!==p){p.return=m,Jo=p;break}Jo=m}}}var f=r.alternate;if(null!==f){var g=f.child;if(null!==g){f.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Jo=r}}if(0!==(2064&r.subtreeFlags)&&null!==o)o.return=r,Jo=o;else e:for(;null!==Jo;){if(0!==(2048&(r=Jo).flags))switch(r.tag){case 0:case 11:case 15:nl(9,r,r.return)}var y=r.sibling;if(null!==y){y.return=r.return,Jo=y;break e}Jo=r.return}}var b=e.current;for(Jo=b;null!==Jo;){var x=(o=Jo).child;if(0!==(2064&o.subtreeFlags)&&null!==x)x.return=o,Jo=x;else e:for(o=b;null!==Jo;){if(0!==(2048&(l=Jo).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(A){Sc(l,l.return,A)}if(l===o){Jo=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Jo=w;break e}Jo=l.return}}if(Tl=s,Hs(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(st,e)}catch(A){}i=!0}return i}finally{bt=n,Cl.transition=t}}return!1}function _c(e,t,n){e=Wa(e,t=po(0,t=lo(n,t),1),1),t=ec(),null!==e&&(vt(e,1,t),ic(e,t))}function Sc(e,t,n){if(3===e.tag)_c(e,e,n);else for(;null!==t;){if(3===t.tag){_c(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===ql||!ql.has(i))){t=Wa(t,e=mo(t,e=lo(n,e),1),1),e=ec(),null!==t&&(vt(t,1,e),ic(t,e));break}}t=t.return}}function Ec(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Nl===e&&(Rl&n)===n&&(4===Ll||3===Ll&&(130023424&Rl)===Rl&&500>$e()-Bl?uc(e,0):Fl|=n),ic(e,t)}function kc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var n=ec();null!==(e=La(e,t))&&(vt(e,t,n),ic(e,n))}function Cc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),kc(e,n)}function Tc(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,s=e.memoizedState;null!==s&&(n=s.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(a(314))}null!==i&&i.delete(t),kc(e,n)}function Nc(e,t){return Ye(e,t)}function Mc(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rc(e,t,n,i){return new Mc(e,t,n,i)}function Ic(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pc(e,t){var n=e.alternate;return null===n?((n=Rc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Lc(e,t,n,i,s,r){var o=2;if(i=e,"function"===typeof e)Ic(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case _:return jc(n.children,s,r,t);case S:o=8,s|=8;break;case E:return(e=Rc(12,n,t,2|s)).elementType=E,e.lanes=r,e;case N:return(e=Rc(13,n,t,s)).elementType=N,e.lanes=r,e;case M:return(e=Rc(19,n,t,s)).elementType=M,e.lanes=r,e;case P:return Dc(n,s,r,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case k:o=10;break e;case C:o=9;break e;case T:o=11;break e;case R:o=14;break e;case I:o=16,i=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Rc(o,n,t,s)).elementType=e,t.type=i,t.lanes=r,t}function jc(e,t,n,i){return(e=Rc(7,e,i,t)).lanes=n,e}function Dc(e,t,n,i){return(e=Rc(22,e,i,t)).elementType=P,e.lanes=n,e.stateNode={isHidden:!1},e}function Oc(e,t,n){return(e=Rc(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=Rc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Wc(e,t,n,i,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=i,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,i,s,a,r,o,l){return e=new Wc(e,t,n,o,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Rc(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Da(a),e}function Bc(e){if(!e)return Cs;e:{if(He(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Is(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Is(n))return js(e,n,t)}return t}function Hc(e,t,n,i,s,a,r,o,l){return(e=zc(n,i,!0,e,0,a,0,o,l)).context=Bc(null),n=e.current,(a=Fa(i=ec(),s=tc(n))).callback=void 0!==t&&null!==t?t:null,Wa(n,a,s),e.current.lanes=s,vt(e,s,i),ic(e,i),e}function Uc(e,t,n,i){var s=t.current,a=ec(),r=tc(s);return n=Bc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fa(a,r)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=Wa(s,t,r))&&(nc(e,s,r,a),za(e,s,r)),r}function Gc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Vc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function qc(e,t){Vc(e,t),(e=e.alternate)&&Vc(e,t)}_l=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ns.current)bo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bo=!1,function(e,t,n){switch(t.tag){case 3:No(t),pa();break;case 5:$a(t);break;case 1:Is(t.type)&&Ds(t);break;case 4:Xa(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,s=t.memoizedProps.value;ks(Aa,i._currentValue),i._currentValue=s;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(ks(Za,1&Za.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Oo(e,t,n):(ks(Za,1&Za.current),null!==(e=Go(e,t,n))?e.sibling:null);ks(Za,1&Za.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return Ho(e,t,n);t.flags|=128}if(null!==(s=t.memoizedState)&&(s.rendering=null,s.tail=null,s.lastEffect=null),ks(Za,Za.current),i)break;return null;case 22:case 23:return t.lanes=0,So(e,t,n)}return Go(e,t,n)}(e,t,n);bo=0!==(131072&e.flags)}else bo=!1,sa&&0!==(1048576&t.flags)&&Zs(t,qs,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Uo(e,t),e=t.pendingProps;var s=Rs(t,Ts.current);Na(t,n),s=fr(null,t,i,e,s,n);var r=gr();return t.flags|=1,"object"===typeof s&&null!==s&&"function"===typeof s.render&&void 0===s.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Is(i)?(r=!0,Ds(t)):r=!1,t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,Da(t),s.updater=io,t.stateNode=s,s._reactInternals=t,oo(t,i,e,n),t=To(null,t,i,!0,r,n)):(t.tag=0,sa&&r&&ea(t),xo(null,t,s,n),t=t.child),t;case 16:i=t.elementType;e:{switch(Uo(e,t),e=t.pendingProps,i=(s=i._init)(i._payload),t.type=i,s=t.tag=function(e){if("function"===typeof e)return Ic(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===T)return 11;if(e===R)return 14}return 2}(i),e=to(i,e),s){case 0:t=ko(null,t,i,e,n);break e;case 1:t=Co(null,t,i,e,n);break e;case 11:t=wo(null,t,i,e,n);break e;case 14:t=Ao(null,t,i,to(i.type,e),n);break e}throw Error(a(306,i,""))}return t;case 0:return i=t.type,s=t.pendingProps,ko(e,t,i,s=t.elementType===i?s:to(i,s),n);case 1:return i=t.type,s=t.pendingProps,Co(e,t,i,s=t.elementType===i?s:to(i,s),n);case 3:e:{if(No(t),null===e)throw Error(a(387));i=t.pendingProps,s=(r=t.memoizedState).element,Oa(e,t),Ha(t,i,null,n);var o=t.memoizedState;if(i=o.element,r.isDehydrated){if(r={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=r,t.memoizedState=r,256&t.flags){t=Mo(e,t,i,n,s=lo(Error(a(423)),t));break e}if(i!==s){t=Mo(e,t,i,n,s=lo(Error(a(424)),t));break e}for(ia=cs(t.stateNode.containerInfo.firstChild),na=t,sa=!0,aa=null,n=wa(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pa(),i===s){t=Go(e,t,n);break e}xo(e,t,i,n)}t=t.child}return t;case 5:return $a(t),null===e&&ca(t),i=t.type,s=t.pendingProps,r=null!==e?e.memoizedProps:null,o=s.children,ns(i,s)?o=null:null!==r&&ns(i,r)&&(t.flags|=32),Eo(e,t),xo(e,t,o,n),t.child;case 6:return null===e&&ca(t),null;case 13:return Oo(e,t,n);case 4:return Xa(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=xa(t,null,i,n):xo(e,t,i,n),t.child;case 11:return i=t.type,s=t.pendingProps,wo(e,t,i,s=t.elementType===i?s:to(i,s),n);case 7:return xo(e,t,t.pendingProps,n),t.child;case 8:case 12:return xo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,s=t.pendingProps,r=t.memoizedProps,o=s.value,ks(Aa,i._currentValue),i._currentValue=o,null!==r)if(oi(r.value,o)){if(r.children===s.children&&!Ns.current){t=Go(e,t,n);break e}}else for(null!==(r=t.child)&&(r.return=t);null!==r;){var l=r.dependencies;if(null!==l){o=r.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===r.tag){(c=Fa(-1,n&-n)).tag=2;var d=r.updateQueue;if(null!==d){var h=(d=d.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}r.lanes|=n,null!==(c=r.alternate)&&(c.lanes|=n),Ta(r.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===r.tag)o=r.type===t.type?null:r.child;else if(18===r.tag){if(null===(o=r.return))throw Error(a(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Ta(o,n,t),o=r.sibling}else o=r.child;if(null!==o)o.return=r;else for(o=r;null!==o;){if(o===t){o=null;break}if(null!==(r=o.sibling)){r.return=o.return,o=r;break}o=o.return}r=o}xo(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,i=t.pendingProps.children,Na(t,n),i=i(s=Ma(s)),t.flags|=1,xo(e,t,i,n),t.child;case 14:return s=to(i=t.type,t.pendingProps),Ao(e,t,i,s=to(i.type,s),n);case 15:return _o(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,s=t.pendingProps,s=t.elementType===i?s:to(i,s),Uo(e,t),t.tag=1,Is(i)?(e=!0,Ds(t)):e=!1,Na(t,n),ao(t,i,s),oo(t,i,s,n),To(null,t,i,!0,e,n);case 19:return Ho(e,t,n);case 22:return So(e,t,n)}throw Error(a(156,t.tag))};var Yc="function"===typeof reportError?reportError:function(e){console.error(e)};function Kc(e){this._internalRoot=e}function Xc(e){this._internalRoot=e}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jc(){}function Zc(e,t,n,i,s){var a=n._reactRootContainer;if(a){var r=a;if("function"===typeof s){var o=s;s=function(){var e=Gc(r);o.call(e)}}Uc(t,r,e,s)}else r=function(e,t,n,i,s){if(s){if("function"===typeof i){var a=i;i=function(){var e=Gc(r);a.call(e)}}var r=Hc(t,i,e,0,null,!1,0,"",Jc);return e._reactRootContainer=r,e[ms]=r.current,Hi(8===e.nodeType?e.parentNode:e),dc(),r}for(;s=e.lastChild;)e.removeChild(s);if("function"===typeof i){var o=i;i=function(){var e=Gc(l);o.call(e)}}var l=zc(e,0,!1,null,0,!1,0,"",Jc);return e._reactRootContainer=l,e[ms]=l.current,Hi(8===e.nodeType?e.parentNode:e),dc(function(){Uc(t,l,n,i)}),l}(n,t,e,s,i);return Gc(r)}Xc.prototype.render=Kc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Uc(e,t,null,null)},Xc.prototype.unmount=Kc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc(function(){Uc(null,e,null,null)}),t[ms]=null}},Xc.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Pt.length&&0!==t&&t<Pt[n].priority;n++);Pt.splice(n,0,e),0===n&&Ot(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(yt(t,1|n),ic(t,$e()),0===(6&Tl)&&(Hl=$e()+500,Hs()))}break;case 13:dc(function(){var t=La(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}}),qc(e,1)}},At=function(e){if(13===e.tag){var t=La(e,134217728);if(null!==t)nc(t,e,134217728,ec());qc(e,134217728)}},_t=function(e){if(13===e.tag){var t=tc(e),n=La(e,t);if(null!==n)nc(n,e,t,ec());qc(e,t)}},St=function(){return bt},Et=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Ae=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var s=ws(i);if(!s)throw Error(a(90));Y(i),J(i,s)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Te=cc,Ne=dc;var ed={usingClientEntryPoint:!1,Events:[bs,xs,ws,ke,Ce,cc]},td={findFiberByHostInstance:ys,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nd={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ve(e))?null:e.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var id=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!id.isDisabled&&id.supportsFiber)try{st=id.inject(nd),at=id}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ed,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Qc(t))throw Error(a(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:A,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Qc(e))throw Error(a(299));var n=!1,i="",s=Yc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(s=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,i,s),e[ms]=t.current,Hi(8===e.nodeType?e.parentNode:e),new Kc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=Ve(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,n){if(!$c(t))throw Error(a(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Qc(e))throw Error(a(405));var i=null!=n&&n.hydratedSources||null,s=!1,r="",o=Yc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(s=!0),void 0!==n.identifierPrefix&&(r=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Hc(t,null,e,1,null!=n?n:null,s,0,r,o),e[ms]=t.current,Hi(e),i)for(e=0;e<i.length;e++)s=(s=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Xc(t)},t.render=function(e,t,n){if(!$c(t))throw Error(a(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!$c(e))throw Error(a(40));return!!e._reactRootContainer&&(dc(function(){Zc(null,null,e,!1,function(){e._reactRootContainer=null,e[ms]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!$c(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return Zc(e,t,n,!1,i)},t.version="18.3.1-next-f1338f8080-20240426"},352:(e,t,n)=>{var i=n(119);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot},414:(e,t,n)=>{e.exports=n(654)},654:(e,t,n)=>{var i=n(950),s=Symbol.for("react.element"),a=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,o=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var i,a={},c=null,d=null;for(i in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)r.call(t,i)&&!l.hasOwnProperty(i)&&(a[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===a[i]&&(a[i]=t[i]);return{$$typeof:s,type:e,key:c,ref:d,props:a,_owner:o.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},761:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,s=e[i];if(!(0<a(s,t)))break e;e[i]=t,e[n]=s,n=i}}function i(e){return 0===e.length?null:e[0]}function s(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,s=e.length,r=s>>>1;i<r;){var o=2*(i+1)-1,l=e[o],c=o+1,d=e[c];if(0>a(l,n))c<s&&0>a(d,l)?(e[i]=d,e[c]=n,i=c):(e[i]=l,e[o]=n,i=o);else{if(!(c<s&&0>a(d,n)))break e;e[i]=d,e[c]=n,i=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var r=performance;t.unstable_now=function(){return r.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],h=1,u=null,p=3,m=!1,f=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=i(d);null!==t;){if(null===t.callback)s(d);else{if(!(t.startTime<=e))break;s(d),t.sortIndex=t.expirationTime,n(c,t)}t=i(d)}}function w(e){if(g=!1,x(e),!f)if(null!==i(c))f=!0,P(A);else{var t=i(d);null!==t&&L(w,t.startTime-e)}}function A(e,n){f=!1,g&&(g=!1,y(k),k=-1),m=!0;var a=p;try{for(x(n),u=i(c);null!==u&&(!(u.expirationTime>n)||e&&!N());){var r=u.callback;if("function"===typeof r){u.callback=null,p=u.priorityLevel;var o=r(u.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?u.callback=o:u===i(c)&&s(c),x(n)}else s(c);u=i(c)}if(null!==u)var l=!0;else{var h=i(d);null!==h&&L(w,h.startTime-n),l=!1}return l}finally{u=null,p=a,m=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,S=!1,E=null,k=-1,C=5,T=-1;function N(){return!(t.unstable_now()-T<C)}function M(){if(null!==E){var e=t.unstable_now();T=e;var n=!0;try{n=E(!0,e)}finally{n?_():(S=!1,E=null)}}else S=!1}if("function"===typeof b)_=function(){b(M)};else if("undefined"!==typeof MessageChannel){var R=new MessageChannel,I=R.port2;R.port1.onmessage=M,_=function(){I.postMessage(null)}}else _=function(){v(M,0)};function P(e){E=e,S||(S=!0,_())}function L(e,n){k=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||m||(f=!0,P(A))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,s,a){var r=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?r+a:r:a=r,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:h++,callback:s,priorityLevel:e,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>r?(e.sortIndex=a,n(d,e),null===i(c)&&e===i(d)&&(g?(y(k),k=-1):g=!0,L(w,a-r))):(e.sortIndex=o,n(c,e),f||m||(f=!0,P(A))),e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},950:(e,t,n)=>{e.exports=n(49)}},t={};function n(i){var s=t[i];if(void 0!==s)return s.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,n),a.exports}var i=n(950),s=n(352);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function r(e){var t=function(e,t){if("object"!=a(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=a(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==a(t)?t:t+""}function o(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const d={careerAnalysis:{system:"You are an expert career analyst who provides detailed, insightful analysis of professional backgrounds. You identify both strengths and areas needing development. You focus on extracting specific details that can guide meaningful career conversations.\n\nCRITICAL: When assessing career level, IGNORE job titles completely. Job titles can be inflated or deflated and don't reflect actual capability. Focus exclusively on:\n1. Actual experience depth and complexity of work handled\n2. Scope of responsibility and decision-making authority\n3. Leadership impact and influence (formal or informal)\n4. Technical complexity and expertise demonstrated\n5. Business outcomes and measurable impact\n6. Problem-solving sophistication and strategic thinking\n7. Mentoring, training, or knowledge-sharing activities\n\nYears of experience should be calculated by carefully adding up actual work periods, excluding internships, part-time roles under 6 months, or gap years. Be conservative and focus on substantial professional experience only.\n\nAlways follow the exact format requested, including the SUMMARY and JSON_DATA sections.",user:e=>"Analyze the following career information in detail and provide comprehensive insights about this person's background, strengths, achievements, and career trajectory. This analysis will be used to guide a tactical empathy interview, so extract specific details that can be explored further.\n\nCareer Information:\n".concat(e,'\n\nGUIDELINE FOR JSON_DATA:\n1. The sample JSON_DATA provided below should be used as a reference for structure and formatting. You must keep the structure exactly the same as the sample JSON_DATA provided below.\n2. For each array field in the JSON_DATA:\n2.1 The number of sentences are at your discretion.\n2.2 Each sentence should focus on a single idea or observation to maintain clarity.\n2.3 The JSON_DATA provided the idea what you should include in your response, you are at your discretion to add more details or remove details as needed.\n\nPlease respond with the following EXACT format:\n\nSUMMARY:\n[Provide a warm, personal, 4-to-8-sentence summary that identifies the person\'s name if available and highlights their professional background and key strengths]\n\nJSON_DATA:\n{\n  "name": "[Full name if found, otherwise null]",\n  "current_role": "[Current or most recent job title and company]",\n  "career_level": "[CRITICAL: Assess based ONLY on actual experience depth, scope of impact, and demonstrated capabilities - COMPLETELY IGNORE job titles. " +\n                  "Job titles can be misleading due to company politics, grade inflation, or undervaluation. Focus on: " +\n                  "1) Complexity and sophistication of work handled, " +\n                  "2) Scope of responsibility and decision-making authority, " +\n                  "3) Leadership influence (formal or informal), " +\n                  "4) Technical depth and expertise level, " +\n                  "5) Business impact and strategic contribution, " +\n                  "6) Problem-solving complexity and independence. " +\n                  "CHOOSE FROM THESE MULTI-TRACK CAREER LEVELS: " +\n                  \n                  "TECHNICAL TRACK: Entry Level Tech (0-2 years, learning fundamentals), Junior Engineer (2-4 years, developing competency), " +\n                  "Mid-Level Engineer (4-7 years, independent contributor), Senior Engineer (7-12 years, mentoring others, leading projects), " +\n                  "Staff Engineer (12+ years, technical leadership, cross-team impact), Senior Staff Engineer (15+ years, organizational impact), " +\n                  "Principal Engineer (18+ years, industry expertise, strategic influence), Distinguished Engineer (20+ years, industry-wide recognition). " +\n                  \n                  "MANAGEMENT TRACK: Team Lead (2-4 years exp, leading small teams), Manager (4-7 years, managing teams/projects), " +\n                  "Senior Manager (7-12 years, managing multiple teams/large initiatives), Director (12+ years, department leadership, strategic planning), " +\n                  "Senior Director (15+ years, multi-department oversight, org-wide impact), VP (18+ years, business unit leadership, P&L responsibility), " +\n                  "Senior VP/C-Level (20+ years, executive leadership, company-wide strategy). " +\n                  \n                  "PRODUCT MANAGEMENT TRACK: Associate PM (0-2 years, supporting product initiatives), Product Manager (2-7 years, owning product features/roadmap), " +\n                  "Senior PM (7-12 years, leading product strategy, cross-functional leadership), Principal PM (12+ years, product portfolio management), " +\n                  "Group PM/Director of Product (15+ years, product organization leadership), VP of Product (18+ years, company product strategy). " +\n                  \n                  "FINANCE TRACK: Financial Analyst (0-3 years, financial modeling/analysis), Senior Analyst (3-6 years, complex analysis, recommendations), " +\n                  "Finance Manager (6-10 years, team leadership, strategic planning), Senior Finance Manager/Director (10-15 years, department leadership), " +\n                  "Finance VP/CFO (15+ years, executive financial leadership, strategic planning). " +\n                  \n                  "SALES/BUSINESS TRACK: Sales Associate (0-2 years, individual contributor), Account Manager (2-5 years, client relationship management), " +\n                  "Senior Account Manager (5-8 years, key accounts, team leadership), Sales Manager (8-12 years, team management, territory oversight), " +\n                  "Sales Director (12+ years, regional/division leadership), VP of Sales (15+ years, sales organization leadership). " +\n                  \n                  "MARKETING TRACK: Marketing Coordinator (0-2 years, campaign support), Marketing Manager (2-6 years, campaign management), " +\n                  "Senior Marketing Manager (6-10 years, strategic marketing, team leadership), Marketing Director (10-15 years, marketing organization leadership), " +\n                  "VP of Marketing/CMO (15+ years, marketing strategy, brand leadership). " +\n                  \n                  "OPERATIONS TRACK: Operations Analyst (0-3 years, process analysis), Operations Manager (3-7 years, process management, team leadership), " +\n                  "Senior Operations Manager (7-12 years, complex operations, strategic planning), Operations Director (12+ years, operations leadership), " +\n                  "VP of Operations/COO (15+ years, organizational operations strategy). " +\n                  \n                  "HR/PEOPLE TRACK: HR Coordinator (0-2 years, HR support functions), HR Manager (2-6 years, HR program management), " +\n                  "Senior HR Manager (6-10 years, strategic HR, policy development), HR Director (10-15 years, HR organization leadership), " +\n                  "VP of People/CHRO (15+ years, people strategy, organizational development). " +\n                  \n                  "CONSULTING TRACK: Analyst (0-2 years, research and analysis), Consultant (2-4 years, client-facing work), " +\n                  "Senior Consultant (4-7 years, project leadership), Manager/Principal (7-12 years, client relationship management), " +\n                  "Senior Manager/Director (12+ years, practice leadership), Partner (15+ years, business development, firm leadership). " +\n                  \n                  "Years of experience should contribute only 15% to assessment - capability and impact matter more. Choose the track that best matches their actual work, not their title.]",\n  "career_level_justification": "[Provide 2-3 sentences explaining the career level and track selection. Focus on the most compelling evidence: scope of impact, leadership activities, and demonstrated expertise. Be concise and specific.]",\n  "years_experience": "[Calculate total years of SUBSTANTIAL professional experience. Analyze job durations carefully and add them up. " +\n                     "EXCLUDE: internships under 6 months, part-time roles under 6 months, unpaid roles, significant gap years, academic roles unless industry-relevant. " +\n                     "INCLUDE: Full-time professional roles, significant consulting/freelance work, industry-relevant academic research. " +\n                     "If dates are provided, sum the durations precisely. If dates are vague, estimate conservatively based on career progression patterns. " +\n                     "Round to nearest whole number and provide only the number (e.g., \'7\' not \'6-8 years\'). Be realistic and conservative.]",\n  "key_strengths": [\n    "[Strength 1: specific professional ability with context]",\n    "[Strength 2: notable skill or expertise with examples]",\n    "[Strength 3: key competency with evidence]",\n    "[Strength 4: leadership or technical ability]"\n  ],\n  "experience_highlights": [\n    {\n      "role": "[Job title]",\n      "company": "[Company name if available]",\n      "duration": "[Time period if available]",\n      "key_responsibilities": "[Main responsibilities]",\n      "achievements": "[Specific achievements or impacts]",\n      "missing_details": "[What details are unclear or could use more exploration]"\n    }\n  ],\n  "achievements": [\n    "[Achievement 1: specific accomplishment with metrics if possible]",\n    "[Achievement 2: notable outcome or result with context]",\n    "[Achievement 3: meaningful contribution or recognition]",\n    "[Achievement 4: problem solved or improvement made]"\n  ],\n  "skills_mentioned": [\n    "[Technical skill 1]",\n    "[Technical skill 2]",\n    "[Soft skill 1]",\n    "[Soft skill 2]"\n  ],\n  "career_themes": [\n    "[Theme 1: overarching pattern in their career with examples]",\n    "[Theme 2: consistent focus area or progression with evidence]",\n    "[Theme 3: recurring strength or interest area]"\n  ],\n  "gaps_to_explore": [\n    "[What specific stories or examples are missing?]",\n    "[Which achievements lack details or quantification?]",\n    "[What challenges or growth moments aren\'t mentioned?]",\n    "[Which skills or experiences need more depth?]"\n  ],\n  "interview_focus_areas": [\n    "[Specific experience or role to dive deeper into]",\n    "[Achievement that needs more detail and emotion]",\n    "[Challenge or problem-solving situation to explore]",\n    "[Leadership or collaboration experience to discuss]",\n    "[Skills development or learning experience to uncover]"\n  ]\n}\n\nBe thorough and analytical - identify what\'s strong AND what\'s missing. This analysis will guide an interview to uncover the person\'s authentic career stories, so note areas where more emotional depth, specific examples, or quantified results would strengthen their professional narrative.\n\nCAREER LEVEL ASSESSMENT GUIDELINES:\nCalculate years of experience accurately: Look for specific start/end dates, add up total duration of professional roles, be conservative and realistic, provide a single number not a range. Ignore job titles and focus on actual experience indicators, focus on the work the person has done. Years of experience is not that important, contributing to 15% of your assessment:\n\n**TECHNICAL TRACK:**\n- **Entry Level Tech (0-2 years)**: Learning fundamentals, following established processes, minimal independent decision-making\n- **Junior Engineer (2-4 years)**: Developing competency, some independent work, basic problem-solving\n- **Mid-Level Engineer (4-7 years)**: Independent contributor, owns projects, mentors newcomers occasionally\n- **Senior Engineer (7-12 years)**: Leads projects, mentors regularly, makes architectural/strategic decisions\n- **Staff Engineer (12+ years)**: Technical leadership across teams, designs systems/processes, significant business impact\n- **Senior Staff Engineer (15+ years)**: Organizational-level impact, influences technical direction\n- **Principal Engineer (18+ years)**: Industry expertise, strategic influence beyond immediate org\n- **Distinguished Engineer (20+ years)**: Industry recognition, pioneering work, broad influence\n\n**MANAGEMENT TRACK:**\n- **Team Lead (2-4 years exp)**: Leading small teams, project coordination, people development\n- **Manager (4-7 years)**: Managing teams/projects, performance management, tactical planning\n- **Senior Manager (7-12 years)**: Managing multiple teams/large initiatives, strategic input\n- **Director (12+ years)**: Department leadership, strategic planning, organizational impact\n- **Senior Director (15+ years)**: Multi-department oversight, organizational transformation\n- **VP (18+ years)**: Business unit leadership, P&L responsibility, strategic vision\n- **Senior VP/C-Level (20+ years)**: Executive leadership, company-wide strategy\n\n**PRODUCT MANAGEMENT TRACK:**\n- **Associate PM (0-2 years)**: Supporting product initiatives, feature analysis, stakeholder communication\n- **Product Manager (2-7 years)**: Owning product features/roadmap, cross-functional collaboration\n- **Senior PM (7-12 years)**: Leading product strategy, complex product decisions, team influence\n- **Principal PM (12+ years)**: Product portfolio management, strategic product vision\n- **Group PM/Director of Product (15+ years)**: Product organization leadership, product strategy\n- **VP of Product (18+ years)**: Company product strategy, product-market fit, business outcomes\n\n**FINANCE TRACK:**\n- **Financial Analyst (0-3 years)**: Financial modeling/analysis, reporting, process support\n- **Senior Analyst (3-6 years)**: Complex analysis, recommendations, stakeholder interaction\n- **Finance Manager (6-10 years)**: Team leadership, strategic planning, business partnership\n- **Senior Finance Manager/Director (10-15 years)**: Department leadership, strategic financial planning\n- **Finance VP/CFO (15+ years)**: Executive financial leadership, strategic planning, board interaction\n\n**SALES/BUSINESS TRACK:**\n- **Sales Associate (0-2 years)**: Individual contributor, quota achievement, customer interaction\n- **Account Manager (2-5 years)**: Client relationship management, account growth, solution selling\n- **Senior Account Manager (5-8 years)**: Key accounts, team leadership, strategic selling\n- **Sales Manager (8-12 years)**: Team management, territory oversight, revenue responsibility\n- **Sales Director (12+ years)**: Regional/division leadership, strategic sales planning\n- **VP of Sales (15+ years)**: Sales organization leadership, revenue strategy, market expansion\n\n**MARKETING TRACK:**\n- **Marketing Coordinator (0-2 years)**: Campaign support, content creation, event coordination\n- **Marketing Manager (2-6 years)**: Campaign management, lead generation, brand management\n- **Senior Marketing Manager (6-10 years)**: Strategic marketing, team leadership, ROI optimization\n- **Marketing Director (10-15 years)**: Marketing organization leadership, strategic planning\n- **VP of Marketing/CMO (15+ years)**: Marketing strategy, brand leadership, growth strategy\n\n**OPERATIONS TRACK:**\n- **Operations Analyst (0-3 years)**: Process analysis, efficiency improvement, data analysis\n- **Operations Manager (3-7 years)**: Process management, team leadership, operational excellence\n- **Senior Operations Manager (7-12 years)**: Complex operations, strategic planning, cross-functional leadership\n- **Operations Director (12+ years)**: Operations leadership, strategic operational planning\n- **VP of Operations/COO (15+ years)**: Organizational operations strategy, operational transformation\n\n**HR/PEOPLE TRACK:**\n- **HR Coordinator (0-2 years)**: HR support functions, employee relations, compliance\n- **HR Manager (2-6 years)**: HR program management, talent acquisition, policy implementation\n- **Senior HR Manager (6-10 years)**: Strategic HR, policy development, organizational development\n- **HR Director (10-15 years)**: HR organization leadership, strategic people initiatives\n- **VP of People/CHRO (15+ years)**: People strategy, organizational development, culture transformation\n\n**CONSULTING TRACK:**\n- **Analyst (0-2 years)**: Research and analysis, client support, project assistance\n- **Consultant (2-4 years)**: Client-facing work, project execution, solution development\n- **Senior Consultant (4-7 years)**: Project leadership, client relationship management\n- **Manager/Principal (7-12 years)**: Client relationship management, team leadership, business development\n- **Senior Manager/Director (12+ years)**: Practice leadership, strategic consulting, thought leadership\n- **Partner (15+ years)**: Business development, firm leadership, client relationship ownership\n\nConsider: work complexity, scope of impact, leadership responsibilities, domain expertise, business outcomes, and career progression velocity. Choose the track that best matches their actual work and responsibilities, not their job title.\n\nYEARS OF EXPERIENCE GUIDELINES:\nCalculate years of experience accurately: Look for specific start/end dates, add up total duration of professional roles, be realistic, provide a single number not a range.')},interview:{system:'You are a master career conversation facilitator who expertly applies tactical empathy and crucial conversation techniques from Chris Voss\'s negotiation methodology. You create psychological safety that allows people to reveal their authentic career stories, hidden motivations, and deeper professional aspirations. You\'ve studied their background and use sophisticated questioning techniques disguised as natural, friendly conversation.\n\nTACTICAL EMPATHY FOUNDATION:\nYou understand that people want to feel heard, understood, and validated before they\'ll open up authentically. You use these core techniques naturally and variably:\n\n**Labeling Emotions** (recognize and name what you observe):\n- "It sounds like that project was really meaningful to you..."\n- "I can hear the excitement in your voice when you talk about..."\n- "That seems like it might have been frustrating to deal with..."\n\n**Mirroring** (repeat key words to encourage elaboration):\n- "You mentioned \'challenging\' - what made it challenging?"\n- "Transformative? Tell me more about that transformation..."\n- "You said it was \'the turning point\' - what happened there?"\n\n**Calibrated Questions** (open-ended questions that invite storytelling):\n- "What was it like when...?" "How did that impact you?" "What drove you to...?"\n- "What was going through your mind when...?" "How did you know...?"\n\n**Summarizing & Paraphrasing** (show deep listening):\n- "So if I understand correctly, you went from... to... because..."\n- "It sounds like the real motivation was..."\n- "What I\'m hearing is that the breakthrough moment was when..."\n\n**Creating Safe Space for Vulnerability**:\n- "That takes real courage..." "Most people would find that challenging..."\n- "It\'s okay if this is hard to talk about..." "There\'s no judgment here..."\n\nCRITICAL ANTI-REPETITION PROTOCOLS:\n- Maintain awareness of ALL previously asked questions and topics covered\n- NEVER ask about the same experience, achievement, or skill area twice\n- If user says they\'ve answered something similar, immediately acknowledge and pivot\n- Each question must explore completely NEW territory\n- Track covered topics: roles discussed, skills explored, achievements detailed, challenges mentioned\n- Use conversation history to identify gaps, not repeat successes\n\nSTRATEGIC QUESTION SEQUENCING WITH TACTICAL EMPATHY:\nYour interview follows a precise 10-question structure, but each question uses different tactical empathy techniques to avoid patterns:\n\n**Phase 1 (Questions 1-3): Current Reality & Recent Impact**\n- Technique Variety: Use labeling, mirroring, and calibrated questions\n- Focus: Most recent 1-2 years of work, current role responsibilities, immediate projects\n- Goal: Understand their present professional situation and recent achievements\n- Empathy Focus: Validate their current challenges and successes\n\n**Phase 2 (Questions 4-6): Skills & Quantified Impact** \n- Technique Variety: Use summary, emotional labeling, and "how" questions\n- Focus: Technical abilities, problem-solving examples, measurable business outcomes\n- Goal: Get specific metrics, numbers, process improvements, tangible results\n- Empathy Focus: Recognize their expertise and problem-solving abilities\n\n**Phase 3 (Questions 7-8): Growth & Leadership Evolution**\n- Technique Variety: Use mirroring, calibrated questions about change/growth\n- Focus: Career progression, mentoring experiences, team collaboration, learning moments\n- Goal: Understand their development journey and leadership capabilities\n- Empathy Focus: Acknowledge their growth and the courage it took to evolve\n\n**Phase 4 (Questions 9-10): Vision & Unique Value**\n- Technique Variety: Use emotion labeling, future-focused calibrated questions\n- Focus: Career motivations, future goals, what sets them apart, passion areas\n- Goal: Capture their professional identity and forward-looking aspirations\n- Empathy Focus: Validate their aspirations and unique perspective\n\nINTELLIGENT PROGRESS CALCULATION:\nBase progress on question number AND information density gathered:\n- Question 1: 8-12% (depends on depth of current role exploration)\n- Question 2: 16-24% (recent achievements and projects)\n- Question 3: 25-35% (current reality phase complete)\n- Question 4: 36-48% (skills and technical abilities)\n- Question 5: 49-58% (quantified impact and results)\n- Question 6: 59-68% (skills phase complete, solid foundation built)\n- Question 7: 69-78% (growth and leadership experiences)\n- Question 8: 79-88% (career development complete)\n- Question 9: 89-95% (motivations and values)\n- Question 10: 96-100% (unique value and vision complete)\n\nCONVERSATION MASTERY PRINCIPLES:\n\n**Vary Your Approach** (never use the same technique twice in a row):\n- Question 1: Start with labeling or calibrated question\n- Question 2: Use mirroring or summary of previous response\n- Question 3: Try emotional validation + open question\n- Continue rotating techniques naturally\n\n**The "Late Night FM DJ Voice"** (calm, slow, reassuring):\n- Speak in a way that makes them feel safe to be vulnerable\n- Use pauses and reflection to show you\'re really listening\n- Avoid rushing - let them think and process\n\n**Listen for the Emotion Behind the Facts**:\n- When they mention a "challenge" - explore the feelings\n- When they describe success - understand what it meant to them\n- When they mention change - discover what drove the transformation\n\n**Make Them the Hero of Their Story**:\n- "That must have taken incredible skill to pull off..."\n- "Not everyone could have handled that situation the way you did..."\n- "It sounds like you were exactly what the team needed..."\n\nCONVERSATION GOALS PER PHASE:\nPhase 1: Current work reality + emotional connection to their role\nPhase 2: Technical skills + pride in problem-solving abilities\nPhase 3: Career growth + validation of their journey\nPhase 4: Professional motivations + excitement about future\n\n**DISGUISE THE PATTERN**: Never let them notice you\'re using a systematic approach. Make each question feel spontaneous, curious, and personally interested. Vary your language, timing, and emotional approach so it feels like a natural conversation, not an interview framework.\n\nBe genuinely curious about their human experience behind the professional achievements. Remember: facts tell, but stories sell - and emotions make stories memorable.',firstQuestion:function(e,t){var n,i,s,a;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const o=e?"\nPERSON'S BACKGROUND ANALYSIS:\nName: ".concat(e.name||"Not specified","\nCurrent Role: ").concat(e.current_role||"Not specified","\nCareer Level: ").concat(e.career_level||"Not specified","\nYears of Experience: ").concat(e.years_experience||"Not specified","\n\nKEY STRENGTHS IDENTIFIED:\n").concat((null===(n=e.key_strengths)||void 0===n?void 0:n.map(e=>"\u2022 ".concat(e)).join("\n"))||"None identified","\n\nEXPERIENCE HIGHLIGHTS:\n").concat((null===(i=e.experience_highlights)||void 0===i?void 0:i.map(e=>"\u2022 ".concat(e.role).concat(e.company?" at ".concat(e.company):"").concat(e.duration?" (".concat(e.duration,")"):"","\n  - Responsibilities: ").concat(e.key_responsibilities,"\n  - Achievements: ").concat(e.achievements,"\n  - Areas needing more detail: ").concat(e.missing_details)).join("\n"))||"None specified","\n\nACHIEVEMENTS MENTIONED:\n").concat((null===(s=e.achievements)||void 0===s?void 0:s.map(e=>"\u2022 ".concat(e)).join("\n"))||"None mentioned","\n\nPRIORITY FOCUS AREAS FOR INTERVIEW:\n").concat((null===(a=e.interview_focus_areas)||void 0===a?void 0:a.map(e=>"\u2022 ".concat(e)).join("\n"))||"None specified","\n"):"",l=r.length>0?"\n\nADDITIONAL CONTEXT PROVIDED:\n".concat(r.map(e=>"".concat(e.title,": ").concat(e.content)).join("\n\n"),"\n"):"";return"This is the start of our career conversation. You will conduct a strategic 10-question interview to gather comprehensive career information for an outstanding resume.\n\nYOUR KNOWLEDGE OF THEIR BACKGROUND:\n".concat(o,"\n\nUPLOADED CONTENT SUMMARY:\n").concat(t?"Resume Text: ".concat(t.resumeText?"Present":"None","\nPDF Content: ").concat(t.pdfText?"Present":"None"):"No uploaded content available","\n").concat(l,'\n\nSTRATEGIC 10-QUESTION INTERVIEW PLAN:\n**Phase 1 (Questions 1-3): Current Reality & Recent Impact**\n- Focus on most recent role, current projects, immediate responsibilities\n- Explore recent achievements and day-to-day work reality\n\n**Phase 2 (Questions 4-6): Skills & Quantified Impact**\n- Technical abilities, problem-solving examples, measurable outcomes\n- Process improvements, metrics, tangible business results\n\n**Phase 3 (Questions 7-8): Growth & Leadership Evolution**\n- Career progression, mentoring, team collaboration experiences\n- Learning moments and professional development\n\n**Phase 4 (Questions 9-10): Vision & Unique Value**\n- Motivations, future goals, what sets them apart professionally\n\nQUESTION 1 TACTICAL EMPATHY REQUIREMENTS:\n- Use LABELING or CALIBRATED QUESTIONS to start (vary the approach)\n- Must focus on their CURRENT/MOST RECENT role and immediate work reality\n- Reference something specific from their PRIORITY FOCUS AREAS or recent experience\n- Create emotional safety and genuine curiosity about their experience\n- Get them talking about what they\'re working on RIGHT NOW\n- Avoid asking about career history - focus on present reality and how it FEELS\n\n**Tactical Empathy Starter Options (choose ONE approach, vary for authenticity):**\n\n**Option A - Emotional Labeling:**\n- "It sounds like your current role as [position] keeps you pretty engaged - what\'s it like working on [specific area from background] day to day?"\n- "I can imagine working at [company] in [role] must be quite dynamic - what\'s been capturing most of your attention lately?"\n\n**Option B - Calibrated Questions (How/What):**\n- "What\'s it like being a [their role] at [company] right now - what does a typical week look like for you?"\n- "How has your experience as [position] been evolving, especially with [specific project/area they mentioned]?"\n\n**Option C - Mirroring + Curiosity:**\n- "I notice you mentioned [specific detail from background] - that sounds fascinating. What\'s that experience been like for you?"\n- "[Specific role/achievement] at [company] - what drew you to focus on that area?"\n\n**Option D - Summary + Open Question:**\n- "So you\'re currently [role] at [company], working on [area] - what part of that work energizes you most?"\n- "From what I can see, you\'re handling [responsibility/project] in your current role - what\'s that journey been like?"\n\nCRITICAL: Choose ONE approach that feels most natural for their specific background. Make it conversational and genuinely curious about their human experience, not just their job duties.\n\nExamples of tactical empathy Question 1 starters:\n- "It sounds like you\'re in a pretty dynamic role as [position] - what\'s been the most interesting challenge you\'ve tackled recently?"\n- "Being a [role] at [company] must keep you on your toes - what part of your current work gets you most excited?"\n- "I can imagine your work as [position] involves quite a bit of [skill/area] - what\'s that experience been like for you?"\n\nCreate Question 1 that uses tactical empathy to open up authentic conversation about their current work reality and personal experience.\n\n\u26a0\ufe0f **MANDATORY RESPONSE FORMAT** - YOU MUST INCLUDE BOTH:\nQUESTION: [One perfect question about their current role and immediate work reality]\nPROGRESS: 10% - Understanding your current role and responsibilities\n\n\ud83d\udea8 **CRITICAL**: Every response MUST include a PROGRESS line. This is not optional.')},followUp:function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";const a=e.map(e=>"".concat("assistant"===e.role?"Interviewer":"Candidate",": ").concat(e.content)).join("\n"),r=t?"\nPERSON'S BACKGROUND ANALYSIS:\n".concat(JSON.stringify(t,null,2),"\n"):"",o=i.length>0?"\n\nADDITIONAL CONTEXT PROVIDED:\n".concat(i.map(e=>"".concat(e.title,": ").concat(e.content)).join("\n\n"),"\n"):"",l=s?"\n\n".concat(s,"\n"):"\n\n\ud83d\udeab ANTI-REPETITION INTELLIGENCE:\nAnalyze the conversation history to avoid asking repetitive questions about topics already covered in detail.\n";return"Continue this strategic career interview with AI-POWERED ANTI-REPETITION protocols active.\n\nYOUR KNOWLEDGE OF THEIR BACKGROUND:\n".concat(r,"\n\nCONVERSATION SO FAR:\n").concat(a,"\n").concat(o,"\n").concat(l,"\n\nINTERVIEW PROGRESS TRACKING:\nCurrent question count: ").concat(Math.floor(e.length/2)+1,"\nQuestions completed: ").concat(e.filter(e=>"assistant"===e.role).length,"\nQuestions remaining: ").concat(10-e.filter(e=>"assistant"===e.role).length,'\n\nCRITICAL ANTI-REPETITION ANALYSIS:\nBefore asking your next question, identify what has ALREADY been covered:\n\ud83d\udd0d **Topics Already Discussed**: [Scan conversation for roles, companies, projects, skills, achievements mentioned]\n\ud83d\udd0d **Experiences Already Explored**: [Note specific work situations, challenges, accomplishments detailed] \n\ud83d\udd0d **Skills Already Covered**: [Track technical and soft skills discussed]\n\ud83d\udd0d **Time Periods Already Addressed**: [Identify which parts of their career timeline have been explored]\n\nMANDATORY PHASE-BASED PROGRESSION:\n**Phase 1 (Questions 1-3, 8-35%): Current Reality & Recent Impact**\n- Current role responsibilities, recent projects, day-to-day work, immediate challenges\n- Recent achievements and outcomes from the last 1-2 years\n- Current team dynamics and work environment\n\n**Phase 2 (Questions 4-6, 36-68%): Skills & Quantified Impact**\n- Technical abilities and tools used, problem-solving methodologies\n- Measurable business outcomes, metrics, process improvements\n- Specific examples of impact with numbers and results\n\n**Phase 3 (Questions 7-8, 69-88%): Growth & Leadership Evolution**\n- Career progression story, learning and development experiences  \n- Leadership moments, mentoring, team collaboration examples\n- Challenges overcome and professional growth\n\n**Phase 4 (Questions 9-10, 89-100%): Vision & Unique Value**\n- Career motivations, what energizes them professionally\n- Future goals and aspirations, unique strengths and differentiators\n\nENHANCED PROGRESS CALCULATION SYSTEM:\nCalculate progress based on BOTH question number AND information density:\n\n**Question-Based Minimum**: Question number \xd7 10% (ensures forward movement)\n**Content-Based Bonus**: Additional 0-8% based on information quality gathered\n- High detail responses: +5-8%\n- Medium detail responses: +2-4%  \n- Brief responses: +0-1%\n\n**Specific Progress Ranges**:\n- Question 2: 16-24% | Question 3: 25-35% \n- Question 4: 36-48% | Question 5: 49-58% | Question 6: 59-68%\n- Question 7: 69-78% | Question 8: 79-88%\n- Question 9: 89-95% | Question 10: 96-100%\n\nTACTICAL EMPATHY TECHNIQUES FOR FOLLOW-UP QUESTIONS:\nYou must rotate through these techniques to avoid predictable patterns. Never use the same technique twice in a row:\n\n**1. LABELING EMOTIONS** (recognize feelings behind their words):\n- "It sounds like that project was really meaningful to you..."\n- "I can hear the pride in your voice when you talk about..."\n- "That seems like it might have been quite challenging to navigate..."\n- "It sounds like that experience really shaped how you approach..."\n\n**2. MIRRORING** (repeat key words to encourage deeper exploration):\n- "You mentioned it was \'transformative\' - what made it transformative?"\n- "\'Game-changing\' - how did it change the game for you?"\n- "You said it was \'the breakthrough moment\' - what happened in that moment?"\n- "\'Turning point\' - tell me more about that turn..."\n\n**3. CALIBRATED QUESTIONS** (How/What questions that invite storytelling):\n- "What was going through your mind when you had to...?"\n- "How did you know that was the right approach?"\n- "What was it like when you first realized...?"\n- "How did you handle the situation when...?"\n\n**4. SUMMARIZING & PARAPHRASING** (show deep listening before asking):\n- "So if I understand correctly, you went from [situation] to [outcome] by [action] - what drove that decision?"\n- "It sounds like the real breakthrough came when you [insight] - how did that change everything?"\n- "What I\'m hearing is that [summary] - what was the most challenging part of that process?"\n\n**5. CREATING SAFE SPACE** (validate before exploring sensitive areas):\n- "That takes real courage to make that kind of change - what gave you the confidence?"\n- "Most people would find that intimidating - what helped you push through?"\n- "It\'s impressive how you handled that - what was the learning experience like?"\n\n**6. EMOTIONAL VALIDATION + DEEPER PROBE**:\n- "That must have been incredibly satisfying to achieve - what did that success mean to you personally?"\n- "I can imagine that was frustrating - how did you work through that challenge?"\n- "It sounds like that was a pivotal moment - what made it so significant?"\n\nTECHNIQUE ROTATION GUIDELINES:\n- Track which technique you used in the previous question\n- Choose a DIFFERENT technique for the next question\n- Make it feel natural and conversational, not robotic\n- Adapt the technique to their personality and communication style\n- If they\'re more analytical, use calibrated questions; if emotional, use labeling\n\nINTELLIGENT QUESTION SELECTION:\nBased on current question number and conversation analysis:\n\n**For Questions 2-3**: If Question 1 covered current role basics, explore recent specific projects, challenges, or achievements. Avoid re-asking about current role responsibilities.\n\n**For Questions 4-6**: Focus on skills and impact NOT yet discussed. If they mentioned using certain tools, ask about different technical abilities. If they discussed one type of achievement, explore different measurable outcomes.\n\n**For Questions 7-8**: Address growth and leadership experiences from time periods NOT yet covered. If recent work was discussed, ask about career progression or earlier development.\n\n**For Questions 9-10**: Explore motivations, goals, and unique value that haven\'t emerged in previous responses.\n\nREPETITION HANDLING PROTOCOLS:\n\ufffd **If user indicates they feel they\'ve answered something similar:**\n- Immediately acknowledge: "You\'re absolutely right - thanks for pointing that out!"\n- Quickly pivot to unexplored territory: "Let me ask about [completely different topic]"\n- Show active listening: "I can see we covered [specific topic] well already"\n- Never penalize or push back - adjust gracefully\n\nCOMPLETION SIGNALS AND VERBAL NOTIFICATIONS:\n- Questions 7+: Verbally acknowledge we have solid foundation: "I\'m getting a great picture of your experience so far!"\n- Questions 8+: Mention early finish option via "Finish Interview" button and verbally note: "We\'ve covered excellent ground - you can generate your resume now if you\'d like, or continue for even more detail."\n- Question 9+: Add verbal celebration: "This has been incredibly insightful! I have rich information about your career story. Feel free to continue sharing, or we can proceed to create your enhanced resume."\n- Question 10: Add completion celebration and readiness confirmation\n- Never let progress decrease from previous percentage\n\nPROGRESS EXPLANATION REQUIREMENTS:\nProgress explanations must be SPECIFIC to the current question focus, not generic. Use these phase-appropriate explanations:\n\n**Phase 1 (Questions 1-3):**\n- "Understanding your current role and responsibilities"\n- "Exploring your recent projects and daily work reality" \n- "Learning about your immediate challenges and team dynamics"\n\n**Phase 2 (Questions 4-6):**\n- "Diving into your technical skills and problem-solving approach"\n- "Exploring measurable outcomes and business impact you\'ve created"\n- "Understanding your process improvements and quantified results"\n\n**Phase 3 (Questions 7-8):**\n- "Exploring your career growth and learning experiences"\n- "Understanding your leadership and mentoring moments"\n- "Learning about challenges you\'ve overcome and professional development"\n\n**Phase 4 (Questions 9-10):**\n- "Understanding what motivates and energizes you professionally"\n- "Exploring your career vision and unique strengths"\n- "Capturing your professional aspirations and distinctive value"\n\nNEVER use generic phrases like "Just getting started" or "Continuing our conversation" after question 2.\n\nYour next question MUST:\n\u2705 Cover completely NEW territory not discussed before\n\u2705 Follow the phase-appropriate content focus\n\u2705 Use a DIFFERENT tactical empathy technique than the previous question\n\u2705 Calculate accurate progress (question minimum + content bonus)  \n\u2705 Move efficiently toward valuable information gathering\n\u2705 Show you\'ve been actively listening to avoid repetition\n\u2705 Create emotional safety for deeper, more authentic responses\n\u2705 Feel natural and conversational, not formulaic or robotic\n\nTACTICAL EMPATHY QUESTION CONSTRUCTION:\n1. **Review their last response** for emotional cues, key words, or significant statements\n2. **Choose your tactical empathy technique** (different from previous question)\n3. **Reference something specific** they mentioned to show you\'re listening\n4. **Create psychological safety** before asking for vulnerable information\n5. **Ask in a way that invites storytelling**, not just facts\n\n\u26a0\ufe0f **MANDATORY RESPONSE FORMAT** - YOU MUST INCLUDE BOTH:\nFORMAT:\nQUESTION: [Strategic question using tactical empathy, exploring new territory based on interview phase]\nPROGRESS: [X]% - [Specific phase-appropriate explanation describing current question focus]\n\n\ud83d\udea8 **CRITICAL**: Every response MUST include a PROGRESS line. This is not optional. Use the progress calculation system above to determine the percentage and provide a specific explanation of what this question is exploring.\n\nVERBAL NOTIFICATIONS (include in question text when applicable):\n- Questions 7+: Include encouraging acknowledgment: "I\'m getting a wonderful picture of your experience!"\n- Questions 8+: Add progress notification: "We\'ve covered excellent ground - you can generate your resume anytime using the button below, or continue for even more detail."\n- Questions 9+: Add completion readiness: "This conversation has been incredibly insightful! I have rich information to create a compelling resume. Feel free to continue sharing more, or proceed to see your enhanced resume."\n\nIf this is Question 10, add:\n"\ud83c\udf89 **Excellent! That completes our comprehensive career conversation.** I now have rich information about your experience, skills, achievements, and professional vision. You can continue chatting if you\'d like to add more details, or proceed to see your enhanced resume whenever you\'re ready!"')}},resume:{system:"You are an expert resume writer who enhances existing resumes using conversation insights. You preserve original content while adding depth and personality. You write in natural, human language and avoid AI buzzwords and corporate clich\xe9s. You create authentic bullet points that read like mini-stories with specific details and real impact.",generate:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i=e.map(e=>"".concat("assistant"===e.role?"Counselor":"Person",": ").concat(e.content)).join("\n"),s=[t.resumeText,t.pdfText].filter(e=>e&&e.trim()).join("\n\n"),a=n.length>0?"\n\nADDITIONAL CONTEXT PROVIDED:\n".concat(n.map(e=>"".concat(e.title,": ").concat(e.content)).join("\n\n"),"\n"):"";return"You are creating a polished resume by combining the person's ORIGINAL RESUME/CAREER INFORMATION with insights from their career conversation and any additional context provided.\n\nORIGINAL RESUME/CAREER INFORMATION:\n".concat(s,"\n\nCAREER CONVERSATION INSIGHTS:\n").concat(i).concat(a,'\n\nYOUR TASK:\n1. Use the ORIGINAL content as your foundation - preserve their actual experience, education, skills, and achievements\n2. Keep all factual information exactly as provided (job titles, company names, dates, education, certifications)\n3. Enhance and refine the original content using insights from the conversation\n4. Add depth, personality, and specific details based on what they shared in the interview\n5. Transform bland job descriptions into compelling stories while staying truthful\n6. Write in natural, human language that sounds like THEY wrote it\n7. If original content is minimal, use conversation insights to build a complete picture\n8. Maintain the same career progression and timeline as in the original\n9. INCORPORATE ADDITIONAL CONTEXT: If job descriptions, company information, or other context was provided, use this to tailor the resume accordingly - highlight relevant skills, adjust language to match job requirements, and emphasize experiences that align with the target role\n\nWRITING STYLE - AVOID AI BUZZWORDS:\n\u274c Never use: "spearheaded," "leveraged," "synergized," "optimized," "streamlined," "pioneered," "orchestrated," "facilitated," "utilized," "implemented strategic initiatives"\n\u2705 Use instead: managed, created, built, developed, led, improved, designed, worked on, achieved, delivered, organized, coordinated, handled, established\n\nBULLET POINT STYLE - Short Stories with Highlights:\n- Each bullet should be a mini-story that feels natural to read\n- Include specific details, numbers, and outcomes when available\n- Focus on what they actually DID and the real impact\n- Write like a human describing their own work\n- Start with action verbs but make the whole sentence flow naturally\n- Include context, action, and result in a conversational way\n\nEXAMPLE OF GOOD BULLET POINTS:\n"Built a customer database system that reduced order processing time from 2 hours to 15 minutes, helping our small team handle 3x more orders during busy seasons"\n\n"Managed a team of 5 junior developers through our biggest product launch, creating daily check-ins and code review processes that kept us on schedule despite tight deadlines"\n\nAVOID THESE AI-GENERATED PATTERNS:\n\u274c "Spearheaded cross-functional initiatives to optimize operational efficiency"\n\u274c "Leveraged data-driven insights to streamline processes"\n\nUSE HUMAN LANGUAGE INSTEAD:\n\u2705 "Led a project with different departments to improve how we handle customer orders"\n\u2705 "Used sales data to figure out which products customers wanted most"\n\nSTRUCTURE REQUIREMENTS:\n- Format the resume in clean, well-structured Markdown\n- Keep their original job titles, companies, dates, education exactly as provided\n- Enhance job descriptions with conversation insights while maintaining authenticity\n- Add sections for skills, achievements, or other relevant areas based on what\'s in the original\n- Make it ATS-friendly while preserving the human voice\n- Focus on their actual accomplishments, not generic responsibilities\n\nCreate a resume that feels like an enhanced version of their original document, incorporating the personality and depth revealed in the conversation, written in genuinely human language.')}},narrative:{system:"You are a master storyteller who crafts compelling personal career narratives. You transform professional experiences into engaging first-person stories that capture the human side of career journeys. You focus on authentic voice, emotional depth, and the personal growth behind professional achievements.",generate:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i=e.map(e=>"".concat("assistant"===e.role?"Counselor":"Person",": ").concat(e.content)).join("\n"),s=[t.resumeText,t.pdfText].filter(e=>e&&e.trim()).join("\n\n"),a=n.length>0?"\n\nADDITIONAL CONTEXT PROVIDED:\n".concat(n.map(e=>"".concat(e.title,": ").concat(e.content)).join("\n\n"),"\n"):"";return"You are creating a personal career narrative story based on this person's interview conversation, their provided background, and any additional context provided. This should be a compelling first-person story that captures their authentic professional journey.\n\nORIGINAL RESUME/CAREER INFORMATION (for reference):\n".concat(s,"\n\nCAREER CONVERSATION INSIGHTS (PRIMARY SOURCE):\n").concat(i).concat(a,'\n\nYOUR TASK - CREATE A NARRATIVE STORY:\nWrite a compelling first-person career story based on what they shared in the conversation, their resume, and any additional context provided. This should read like someone authentically telling their own professional journey - personal, reflective, and engaging. If specific goals, company interests, or career context was provided, weave these naturally into the narrative to show alignment and direction.\n\nWRITING STYLE:\n- First person narrative ("I", "my", "we")\n- Conversational and personal tone\n- Include specific stories and examples they mentioned\n- Show personality, emotions, and authentic voice\n- Tell the story chronologically or thematically\n- Include challenges, growth moments, and achievements\n- Make it feel like reading someone\'s personal career memoir\n- Use storytelling techniques: scene-setting, dialogue, reflection\n- Balance professional accomplishments with personal insights\n\nCONTENT TO INCLUDE:\n- Their career path and major transitions\n- Specific projects, challenges, and achievements they discussed\n- What motivates them and what they\'re passionate about\n- How they\'ve grown and what they\'ve learned\n- Their perspective on their work and industry\n- Personal insights and reflections on their journey\n- Stories that showcase their skills and impact\n- Their goals and what excites them about the future\n- Moments of doubt, learning, and breakthrough\n- The "why" behind their career choices\n\nNARRATIVE STRUCTURE:\n- Opening hook that draws readers in\n- Clear progression through their career journey\n- Include turning points and pivotal moments\n- Show character development and growth\n- End with forward-looking perspective or reflection\n\nAVOID:\n- Resume format or bullet points\n- Generic corporate language\n- Third person descriptions\n- Formal professional bio style\n- Dry recitation of job duties\n- Overly promotional tone\n\nEXAMPLE OPENING STYLES:\n"Looking back on my career, I never thought I\'d end up where I am today. It all started when..."\n"The moment I realized I wanted to change everything was..."\n"If someone had told me five years ago that I\'d be..."\n\nWrite this as an engaging personal story that someone would want to read - authentic, human, and compelling. Focus on the stories and insights they shared in the interview conversation. Make it feel like sitting down with them over coffee while they tell you their career story.')}},linkedin:{system:"You are a LinkedIn content specialist who creates compelling, authentic professional profiles. You help people tell their career story in a way that attracts opportunities and builds their professional brand. You write in natural, conversational language while including relevant keywords for discoverability.",generate:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i=e.map(e=>"".concat("assistant"===e.role?"Counselor":"Person",": ").concat(e.content)).join("\n"),s=[t.resumeText,t.pdfText].filter(e=>e&&e.trim()).join("\n\n"),a=n.length>0?"\n\nADDITIONAL CONTEXT PROVIDED:\n".concat(n.map(e=>"".concat(e.title,": ").concat(e.content)).join("\n\n"),"\n"):"";return"Based on the person's career information, conversation insights, and any additional context provided, create compelling LinkedIn content that captures their professional brand and personality.\n\nORIGINAL CAREER INFORMATION:\n".concat(s,"\n\nCAREER CONVERSATION INSIGHTS:\n").concat(i).concat(a,'\n\nCreate two LinkedIn sections:\n\n1. LINKEDIN HEADLINE (120 characters max)\n- Professional, attention-grabbing, keyword-rich\n- Show value proposition and expertise\n- Include industry keywords for searchability\n- If targeting a specific role (from additional context), tailor keywords accordingly\n- Example format: "Senior Marketing Manager | Brand Strategy Expert | Driving 40% Revenue Growth Through Data-Driven Campaigns"\n\n2. LINKEDIN ABOUT SECTION (2600 characters max)\n- Start with a compelling opening hook\n- Tell their professional story in first person\n- Include specific achievements with numbers\n- Show personality and passion for their work\n- End with a call-to-action (connecting, collaborating, etc.)\n- Write in a conversational, authentic tone\n- Include relevant keywords naturally throughout\n- Structure with short paragraphs for easy reading\n- If job descriptions or company info was provided, subtly align language and emphasis with target roles\n\nWRITING STYLE FOR ABOUT SECTION:\n\u2705 Personal, conversational tone (use "I", "my", "me")\n\u2705 Include specific examples and numbers from their experience\n\u2705 Show enthusiasm and passion for their work\n\u2705 Include industry keywords naturally\n\u2705 Tell a story of growth and impact\n\u2705 End with how they can help others or what they\'re looking for\n\n\u274c Avoid corporate jargon and buzzwords\n\u274c Don\'t sound robotic or overly formal\n\u274c Don\'t just list job duties\n\u274c Don\'t use third person\n\nRESPONSE FORMAT:\nLINKEDIN_HEADLINE:\n[Your 120-character headline here]\n\nLINKEDIN_ABOUT:\n[Your complete about section here - maximum 2600 characters]\n\nFocus on making both pieces authentic, engaging, and true to their experience while optimizing for LinkedIn\'s professional networking context.')}},coverLetter:{system:'You are an expert career coach specializing in personalized cover letter writing. \n    \nCreate a compelling, ATS-optimized cover letter that:\n1. Addresses the specific job requirements mentioned in the job description\n2. Incorporates specific achievements and experiences from the interview conversation\n3. Shows genuine enthusiasm for the role and company\n4. Maintains a professional yet personable tone\n5. Is concise but impactful (ideally 3-4 paragraphs)\n6. Uses action verbs and quantified achievements where possible\n\nFormat as professional business letter format in Markdown with:\n- Proper salutation (use "Dear Hiring Manager" if no specific name given)\n- Opening paragraph that captures attention and states the position\n- 1-2 body paragraphs highlighting relevant experience and achievements\n- Closing paragraph expressing enthusiasm and next steps\n- Professional closing\n\nDo not include placeholder information like "[Your Name]" or "[Company Address]" - write as if the candidate will add their header information separately.',generate:(e,t,n)=>{var i;const s=(null===(i=n.find(e=>"job-description"===e.type))||void 0===i?void 0:i.content)||"";return"Based on the following information, write a personalized cover letter:\n\nINTERVIEW CONVERSATION:\n".concat(e.map(e=>"".concat(e.role,": ").concat(e.content)).join("\n"),"\n\nRESUME/BACKGROUND INFORMATION:\n").concat([t.resumeText,t.pdfText].filter(e=>e).join("\n\n"),"\n\nJOB DESCRIPTION:\n").concat(s||"No specific job description provided - write a general cover letter highlighting key strengths and achievements.","\n\nADDITIONAL CONTEXT:\n").concat(n.filter(e=>"job-description"!==e.type).map(e=>"".concat(e.title,": ").concat(e.content)).join("\n\n"),"\n\nCreate a compelling cover letter that connects the candidate's experience to the role requirements.")}},careerImprovement:{system:"You are a senior career strategist and professional development expert. \n    \nStart your analysis with a **Confidence Assessment** that provides:\n- **Overall Job Fit Score**: Percentage (0-100%) indicating likelihood of landing this specific role\n- **Confidence Level**: Perfect Match (95%+), Almost Certain (85-94%), High Confidence (75-84%), Good Prospects (65-74%), Moderate Chance (55-64%), Developing Potential (45-54%), Challenging but Possible (35-44%), Very Challenging (25-34%), Extremely Difficult (15-24%), Nearly Impossible (5-14%), or Impossible Match (under 5%)\n- **Key Strengths**: Top 2-3 aspects of their background that make them competitive\n- **Primary Challenge**: The biggest gap to address\n- **Timeline to Readiness**: Realistic timeframe to become a strong candidate\n\nThen analyze the gap between the candidate's current profile and the target job requirements, providing:\n\n1. **Skill Gap Analysis**: Specific skills or technologies mentioned in the job description that the candidate should develop\n2. **Experience Enhancement**: Types of projects, responsibilities, or achievements that would strengthen their profile\n3. **Certification & Learning**: Relevant certifications, courses, or training programs to consider\n4. **Network & Industry Presence**: Professional development activities like conferences, communities, or thought leadership\n5. **Resume Optimization**: Specific ways to better position current experience for this type of role\n6. **Short-term Action Plan**: 3-6 month roadmap with prioritized action items\n\nFormat your response in clear, actionable markdown with specific recommendations and timelines.\nBe encouraging while being realistic about the effort required.",generate:(e,t,n)=>{var i;const s=(null===(i=n.find(e=>"job-description"===e.type))||void 0===i?void 0:i.content)||"";return"Analyze the following candidate profile against the target job requirements:\n\nCANDIDATE BACKGROUND (from interview):\n".concat(e.map(e=>"".concat(e.role,": ").concat(e.content)).join("\n"),"\n\nRESUME/EXPERIENCE:\n").concat([t.resumeText,t.pdfText].filter(e=>e).join("\n\n"),"\n\nTARGET JOB DESCRIPTION:\n").concat(s,"\n\nADDITIONAL CONTEXT:\n").concat(n.filter(e=>"job-description"!==e.type).map(e=>"".concat(e.title,": ").concat(e.content)).join("\n\n"),"\n\nProvide a comprehensive career development plan to help this candidate become a stronger fit for this type of role.")}},contextManagement:{aiSummarization:"You are an expert conversation summarizer for career interviews. Create a comprehensive, structured summary of this interview conversation that captures ALL essential information for resume writing.\n\nCONVERSATION TO SUMMARIZE:\n{conversationText}\n\nREQUIREMENTS:\n1. **COMPREHENSIVE COVERAGE**: Capture every meaningful detail mentioned\n2. **STRUCTURED FORMAT**: Organize information logically for easy reference\n3. **QUANTIFIED DETAILS**: Preserve all numbers, metrics, dates, and specific examples\n4. **EMOTIONAL CONTEXT**: Note the candidate's passion, challenges, and motivations\n5. **TOPIC TRACKING**: Clearly identify what topics have been thoroughly explored vs. briefly mentioned\n6. **ANTI-REPETITION DATA**: List specific questions/topics that should NOT be asked again\n\nSUMMARY FORMAT:\n## TOPICS THOROUGHLY EXPLORED \u2705\n[List topics that have been discussed in detail and should NOT be repeated]\n\n## CURRENT ROLE & RESPONSIBILITIES\n[Detailed summary of current position, daily work, team structure, company context]\n\n## CAREER PROGRESSION & EXPERIENCE\n[Chronological career journey with specific roles, companies, durations, and transitions]\n\n## TECHNICAL SKILLS & EXPERTISE\n[All technical skills, tools, technologies, certifications mentioned with proficiency levels]\n\n## ACHIEVEMENTS & QUANTIFIED IMPACT\n[Specific accomplishments with numbers, percentages, dollar amounts, timelines, and business impact]\n\n## LEADERSHIP & COLLABORATION\n[Team leadership, mentoring, cross-functional work, management experience]\n\n## CHALLENGES & PROBLEM SOLVING\n[Specific problems faced, solutions implemented, lessons learned, growth experiences]\n\n## CAREER MOTIVATIONS & GOALS\n[What drives them, career aspirations, interests, values, preferred work environments]\n\n## PROJECTS & INITIATIVES\n[Specific projects worked on with scope, technologies, outcomes, and personal contributions]\n\n## PERSONALITY & WORK STYLE\n[Communication style, work preferences, personality traits, collaborative approach]\n\n## GAPS & UNEXPLORED AREAS\n[Important career aspects that still need exploration in future questions]\n\n## REPETITION PREVENTION\n**DO NOT ASK AGAIN ABOUT:**\n- [Specific topics/questions that were already covered in detail]\n- [Areas where sufficient information was gathered]\n\nCreate a summary that serves as a comprehensive career profile while preventing repetitive questioning."}},h="openai",u="gemini",p="claude";const m={[h]:{baseUrl:"https://api.openai.com/v1",headers:e=>({Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}),endpoints:{chat:"/chat/completions",speech:"/audio/speech",transcription:"/audio/transcriptions",models:"/models"}},[u]:{baseUrl:"https://generativelanguage.googleapis.com/v1beta",headers:e=>({"Content-Type":"application/json"}),endpoints:{chat:"/models/{model}:generateContent",models:"/models"}},[p]:{baseUrl:"https://api.anthropic.com/v1",headers:e=>({"x-api-key":e,"Content-Type":"application/json","anthropic-version":"2023-06-01"}),endpoints:{chat:"/messages",models:"/models"}}};class f{constructor(e){this.model=e,this.provider=function(e){return e.startsWith("gpt-")||e.startsWith("o1-")||e.startsWith("o3-")||e.startsWith("o4-")?h:e.startsWith("gemini-")?u:e.startsWith("claude-")?p:h}(e),this.isO1Model=e.startsWith("o1"),this.isO3Model=e.startsWith("o3"),this.isO4Model=e.startsWith("o4"),this.isOSeriesModel=this.isO1Model||this.isO3Model||this.isO4Model,this.isGPT5Model=e.startsWith("gpt-5"),this.isGPT41Model=e.startsWith("gpt-4.1"),this.isNewerModel=this.isGPT5Model||this.isOSeriesModel||this.isGPT41Model}supportsSystemMessages(){return!this.isOSeriesModel}supportsTemperature(){return!this.isGPT5Model&&!this.isOSeriesModel}getTokenLimitParam(){return this.isNewerModel?"max_completion_tokens":"max_tokens"}getDefaultTemperature(){return this.isGPT5Model?1:this.isOSeriesModel?void 0:.7}buildRequestParams(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={model:this.model,messages:[...e]};if(this.supportsSystemMessages()&&t.systemMessage&&n.messages.unshift({role:"system",content:t.systemMessage}),t.maxTokens){n[this.getTokenLimitParam()]=t.maxTokens}return this.supportsTemperature()&&void 0!==t.temperature?n.temperature=t.temperature:this.isGPT5Model&&void 0!==t.temperature&&1!==t.temperature&&console.warn("GPT-5 model ".concat(this.model," only supports temperature=1, ignoring custom temperature ").concat(t.temperature)),n}getProviderConfig(){return m[this.provider]}buildHeaders(e){return this.getProviderConfig().headers(e)}getChatEndpoint(){const e=this.getProviderConfig();return e.baseUrl+e.endpoints.chat}static async validateModel(e,t){const n=new f(e),i=n.getProviderConfig();try{const s=await fetch(i.baseUrl+i.endpoints.models,{headers:n.buildHeaders(t)});if(!s.ok)return!1;const a=await s.json();return n.provider!==h||a.data.some(t=>t.id===e)}catch(s){return console.error("Model validation failed:",s),!1}}}class g{static parseOpenAIResponse(e){return e.choices[0].message.content}static parseGeminiResponse(e){return e.candidates[0].content.parts[0].text}static parseClaudeResponse(e){return e.content[0].text}static parseResponse(e,t){switch(t){case h:return this.parseOpenAIResponse(e);case u:return this.parseGeminiResponse(e);case p:return this.parseClaudeResponse(e);default:return this.parseOpenAIResponse(e)}}}class v extends Error{constructor(e,t,n,i){super(e),this.name="AIServiceError",this.provider=t,this.statusCode=n,this.originalError=i}static fromResponse(e,t){return new v("API request failed: ".concat(e.status),t,e.status,e)}static fromError(e,t){return new v(e.message,t,null,e)}}class y{constructor(e,t){this.paramHandler=new f(e),this.apiKey=t}async makeRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const n=this.paramHandler.buildRequestParams(e,t),i=this.paramHandler.getChatEndpoint(),s=this.paramHandler.buildHeaders(this.apiKey),a=await fetch(i,{method:"POST",headers:s,body:JSON.stringify(n)});if(!a.ok)throw v.fromResponse(a,this.paramHandler.provider);const r=await a.json();return g.parseResponse(r,this.paramHandler.provider)}catch(n){if(n instanceof v)throw n;throw v.fromError(n,this.paramHandler.provider)}}}const b="https://api.openai.com/v1";class x extends Error{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(e),this.name="APIError",this.status=t,this.isRetryable=n}}async function w(e,t){const n=await fetch(e,t);if(!n.ok){const e=(i=n.status,[500,502,503,504,429].includes(i));let t="API request failed: ".concat(n.status);throw 500===n.status?t="Server error occurred. Please try again.":502===n.status||503===n.status||504===n.status?t="Service temporarily unavailable. Please try again.":429===n.status?t="Rate limit exceeded. Please try again in a moment.":401===n.status?t="Invalid API key. Please check your OpenAI API key.":403===n.status&&(t="Access denied. Please check your API key permissions."),new x(t,n.status,e)}var i;return n}async function A(e,t,n){try{const i=new f(n),s=[{role:"user",content:d.careerAnalysis.user(e)}],a={systemMessage:i.supportsSystemMessages()?d.careerAnalysis.system:null,maxTokens:2e3,temperature:.2},r=i.buildRequestParams(s,a),o=await w("".concat(b,"/chat/completions"),{method:"POST",headers:i.buildHeaders(t),body:JSON.stringify(r)}),l=await o.json(),c=function(e){try{const n=e.match(/SUMMARY:\s*\n([^]*?)(?=\n\s*JSON_DATA:|$)/),i=n?n[1].trim():e.split("\n")[0]||"Career analysis completed.",s=e.match(/JSON_DATA:\s*\n([\s\S]*?)(?=\n\s*[A-Z_]+:|$)/);let a={};if(s)try{const e=s[1].trim(),t=e.indexOf("{"),n=e.lastIndexOf("}")+1;if(t>=0&&n>t){const i=e.substring(t,n);a=JSON.parse(i)}}catch(t){console.warn("Failed to parse JSON data from response:",t),a=S(e)}else a=S(e);return{name:a.name||null,current_role:a.current_role||null,career_level:a.career_level||null,career_level_justification:a.career_level_justification||null,years_experience:a.years_experience||null,summary:i,key_strengths:Array.isArray(a.key_strengths)?a.key_strengths:[],experience_highlights:Array.isArray(a.experience_highlights)?a.experience_highlights:[],achievements:Array.isArray(a.achievements)?a.achievements:[],skills_mentioned:Array.isArray(a.skills_mentioned)?a.skills_mentioned:[],career_themes:Array.isArray(a.career_themes)?a.career_themes:[],gaps_to_explore:Array.isArray(a.gaps_to_explore)?a.gaps_to_explore:[],interview_focus_areas:Array.isArray(a.interview_focus_areas)?a.interview_focus_areas:[],next_questions:["What project or accomplishment are you most proud of?","Can you tell me about a time you solved a difficult problem?","What motivates you most in your work?"]}}catch(n){return console.error("Error parsing structured response:",n),{name:null,current_role:null,career_level:null,career_level_justification:null,years_experience:null,summary:e.substring(0,200)+"...",key_strengths:[],experience_highlights:[],achievements:[],skills_mentioned:[],career_themes:[],gaps_to_explore:[],interview_focus_areas:[],next_questions:["What project or accomplishment are you most proud of?","Can you tell me about a time you solved a difficult problem?","What motivates you most in your work?"]}}}(l.choices[0].message.content);return c}catch(i){throw console.error("Analysis request failed:",i),i}}function _(e){if(!e)return e;let t=e.trim();return(t.startsWith('"')&&t.endsWith('"')||t.startsWith("'")&&t.endsWith("'"))&&(t=t.slice(1,-1)),t=t.replace(/^```(json|markdown|text)?\s*/i,""),t=t.replace(/\s*```\s*$/i,""),t.trim()}function S(e){const t=e.split("\n").map(e=>e.trim()).filter(e=>e.length>0),n={name:null,key_strengths:[],experience_highlights:[],achievements:[],career_themes:[]};return t.forEach(e=>{if(e.match(/^[-\u2022*]\s+/)||e.match(/^\d+\.\s+/)){const t=e.replace(/^[-\u2022*\d.\s]+/,"").trim();t.length>10&&(e.toLowerCase().includes("strength")||e.toLowerCase().includes("skill")?n.key_strengths.push(t):e.toLowerCase().includes("achieve")||e.toLowerCase().includes("accomplish")?n.achievements.push(t):e.toLowerCase().includes("experience")||e.toLowerCase().includes("role")?n.experience_highlights.push({role:t,company:"",impact:""}):n.key_strengths.push(t))}}),n}async function E(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"";try{console.log("getNextQuestion called:",{isFirstQuestion:i,conversationLength:e.length,hasAnalysis:!!s,hasAntiRepetition:!!o});const l=new f(n);let c;c=i?d.interview.firstQuestion(s,a,r):d.interview.followUp(e,s,a,r,o);const h=[{role:"user",content:c}],u={systemMessage:l.supportsSystemMessages()?d.interview.system:null,maxTokens:400,temperature:.8},p=l.buildRequestParams(h,u),m=await w("".concat(b,"/chat/completions"),{method:"POST",headers:l.buildHeaders(t),body:JSON.stringify(p)}),g=(await m.json()).choices[0].message.content;console.log("OpenAI response received:",g.substring(0,100)+"...");const v=g.match(/QUESTION:\s*([^]*?)(?=\nPROGRESS:|$)/),y=g.match(/PROGRESS:\s*(\d+)%\s*-\s*([^]*)/);let x=v?v[1].trim():g;x=_(x);const A=y?{percentage:parseInt(y[1]),explanation:y[2].trim()}:{percentage:Math.max(20,8*e.length),explanation:"Building comprehensive career profile"};return console.log("Parsed question:",x),console.log("Parsed progress:",A),{question:x,progress:A}}catch(l){throw console.error("Question generation failed:",l),l}}async function k(e,t,n,i,s){try{const a=new f(s),r=[{role:"user",content:d.resume.generate(e,t,n)}],o={systemMessage:a.supportsSystemMessages()?d.resume.system:null,maxTokens:2e3,temperature:.7},l=a.buildRequestParams(r,o),c=await w("".concat(b,"/chat/completions"),{method:"POST",headers:a.buildHeaders(i),body:JSON.stringify(l)}),h=await c.json();return _(h.choices[0].message.content)}catch(a){throw console.error("Resume generation failed:",a),a}}async function C(e,t,n,i,s){try{const a=new f(s),r=[{role:"user",content:d.linkedin.generate(e,t,n)}],o={systemMessage:a.supportsSystemMessages()?d.linkedin.system:null,maxTokens:1500,temperature:.7},l=a.buildRequestParams(r,o),c=await w("".concat(b,"/chat/completions"),{method:"POST",headers:a.buildHeaders(i),body:JSON.stringify(l)}),h=_((await c.json()).choices[0].message.content),u=h.match(/LINKEDIN_HEADLINE:\s*\n?([^]*?)(?=\n\s*LINKEDIN_ABOUT:|$)/),p=h.match(/LINKEDIN_ABOUT:\s*\n?([^]*?)$/);let m="",g="";return u&&(m=_(u[1].trim()),m=m.replace(/^\*\*|\*\*$/g,"").trim(),m=m.split("\n")[0].trim()),p&&(g=_(p[1].trim()),g=g.replace(/^\*\*|\*\*$/g,"").trim()),{headline:m||"",about:g||h}}catch(a){throw console.error("LinkedIn content generation failed:",a),a}}const T=[{id:"gpt-4.1",name:"ChatGPT 4.1",description:"Latest flagship model - $2.00 per 1M input tokens, $8.00 per 1M output tokens",restrictions:"standard parameters"},{id:"gpt-4.1-mini",name:"ChatGPT 4.1 Mini (Recommended)",description:"Cost-optimized latest generation - $0.40 per 1M input tokens, $1.60 per 1M output tokens",restrictions:"standard parameters"},{id:"gpt-4.1-nano",name:"ChatGPT 4.1 Nano",description:"Ultra-efficient for simple tasks - $0.10 per 1M input tokens, $0.40 per 1M output tokens",restrictions:"standard parameters"},{id:"gpt-4o-mini",name:"GPT-4o Mini",description:"Fast and efficient - $0.15 per 1M input tokens",restrictions:"standard parameters"},{id:"gpt-4o",name:"GPT-4o",description:"High intelligence flagship - $2.50 per 1M input tokens",restrictions:"standard parameters"},{id:"o4-mini",name:"o4-mini",description:"Advanced reasoning model - $1.10 per 1M input tokens, $4.40 per 1M output tokens",restrictions:"no system messages, no temperature, max_completion_tokens parameter"},{id:"o3-mini",name:"o3-mini",description:"Enhanced reasoning model - $1.10 per 1M input tokens, $4.40 per 1M output tokens",restrictions:"no system messages, no temperature, max_completion_tokens parameter"},{id:"o1-mini",name:"o1-mini (Legacy)",description:"Cost-effective reasoning (previous generation) - $1.10 per 1M input tokens, $4.40 per 1M output tokens",restrictions:"no system messages, no temperature, max_completion_tokens parameter"}],N="gpt-4.1-mini";var M=n(414);const R=e=>{let{state:t,dispatch:n,actions:s}=e;const[a,r]=(0,i.useState)(""),[o,l]=(0,i.useState)(!1),[c,d]=(0,i.useState)(null),h=T;(0,i.useEffect)(()=>{t.apiKey&&t.apiKey.trim()&&r(t.apiKey)},[t.apiKey]),(0,i.useEffect)(()=>{t.selectedModel&&""!==t.selectedModel||n({type:s.SET_MODEL,payload:N})},[t.selectedModel,n,s.SET_MODEL]);return(0,M.jsxs)("div",{className:"max-w-2xl mx-auto text-center animate-fade-in",children:[(0,M.jsxs)("div",{className:"mb-8",children:[(0,M.jsx)("h1",{className:"text-h1 font-bold text-midnight-blue mb-4",children:"AI Career & Resume Polisher"}),(0,M.jsx)("p",{className:"text-body text-muted leading-body",children:"Transform your career documents into powerful narratives through personalized AI conversation. We'll help you uncover your unique strengths and craft a compelling professional story."})]}),(0,M.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-8 space-y-6",children:[(0,M.jsxs)("div",{className:"text-left",children:[(0,M.jsx)("h2",{className:"text-h2 font-semibold text-midnight-blue mb-6",children:"Setup & Configuration"}),(0,M.jsxs)("div",{className:"mb-6",children:[(0,M.jsx)("label",{className:"block text-body font-medium text-midnight-blue mb-2",children:"Select AI Model"}),(0,M.jsx)("select",{value:t.selectedModel,onChange:e=>{n({type:s.SET_MODEL,payload:e.target.value})},className:"input-field",children:h.map(e=>(0,M.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,M.jsxs)("div",{className:"mb-6",children:[(0,M.jsx)("label",{className:"block text-body font-medium text-midnight-blue mb-2",children:"OpenAI API Key"}),(0,M.jsxs)("div",{className:"relative",children:[(0,M.jsx)("input",{type:"password",value:a,onChange:e=>{r(e.target.value),d(null),n({type:s.SET_KEY_VERIFIED,payload:!1})},placeholder:"sk-...",className:"input-field pr-12"}),"success"===c&&(0,M.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:(0,M.jsx)("svg",{className:"w-5 h-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),"error"===c&&(0,M.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:(0,M.jsx)("svg",{className:"w-5 h-5 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),(0,M.jsxs)("p",{className:"text-ui-label text-muted mt-1",children:["Your API key is stored securely in your browser and never sent to our servers."," ",(0,M.jsx)("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"text-coral hover:underline",children:"Get your API key here"})]})]}),(0,M.jsx)("div",{className:"mb-6",children:(0,M.jsx)("button",{onClick:async()=>{if(a.trim()){l(!0),n({type:s.CLEAR_ERROR});try{await async function(e){try{return(await fetch("".concat(b,"/models"),{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}})).ok}catch(t){return console.error("API key verification failed:",t),!1}}(a.trim())?(n({type:s.SET_API_KEY,payload:a.trim()}),n({type:s.SET_KEY_VERIFIED,payload:!0}),d("success")):(d("error"),n({type:s.SET_ERROR,payload:"Invalid API key. Please check your key and try again."}))}catch(e){d("error"),n({type:s.SET_ERROR,payload:"Failed to verify API key. Please check your connection and try again."})}finally{l(!1)}}else n({type:s.SET_ERROR,payload:"Please enter an API key"})},disabled:!a.trim()||o,className:"btn-secondary w-full disabled:opacity-50 disabled:cursor-not-allowed",children:o?(0,M.jsxs)("div",{className:"flex items-center justify-center",children:[(0,M.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,M.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,M.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Verifying..."]}):"Verify API Key"})})]}),(0,M.jsx)("div",{className:"pt-4 border-t border-gray-200",children:(0,M.jsx)("button",{onClick:()=>{n({type:s.SET_PHASE,payload:"ONBOARDING"})},disabled:!t.isKeyVerified,className:"btn-primary w-full",children:"Continue to Data Input"})})]}),(0,M.jsxs)("div",{className:"mt-8 text-left bg-gray-50 rounded-lg p-6",children:[(0,M.jsx)("h3",{className:"text-body font-medium text-midnight-blue mb-3",children:"What to expect:"}),(0,M.jsxs)("ul",{className:"space-y-2 text-ui-label text-muted",children:[(0,M.jsxs)("li",{className:"flex items-start",children:[(0,M.jsx)("span",{className:"text-amber-gold mr-2",children:"\u2022"}),"Upload or paste your existing resume content"]}),(0,M.jsxs)("li",{className:"flex items-start",children:[(0,M.jsx)("span",{className:"text-amber-gold mr-2",children:"\u2022"}),"Engage in a personalized voice conversation about your career"]}),(0,M.jsxs)("li",{className:"flex items-start",children:[(0,M.jsx)("span",{className:"text-amber-gold mr-2",children:"\u2022"}),"Receive a polished, professional resume tailored to your strengths"]})]})]})]})};function I(e,t,n){t||(t=[]);var i=t.length++;return Object.defineProperty({},"_",{set:function(s){t[i]=s,e.apply(n,t)}})}function P(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function L(e,t){P(e,t),t.add(e)}function j(e,t,n){P(e,t),t.set(e,n)}function D(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function O(e,t,n){return n(D(e,t))}function F(e,t){return e.get(D(e,t))}function W(e,t,n){return e.set(D(e,t),n),n}function z(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return z=function(e){this.s=e,this.n=e.next},z.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new z(e)}var B,H,U,G,V,q,Y,K,X,Q,$,J,Z,ee,te;const ne="object"===typeof process&&process+""==="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&"browser"!==process.type),ie=[.001,0,0,.001,0,0],se=1.35,ae=1,re=2,oe=4,le=16,ce=32,de=64,he=128,ue=256,pe={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},me="pdfjs_internal_editor_",fe={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101,COMMENT:102},ge={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},ve=0,ye=1,be=2,xe=3,we=3,Ae=4,_e={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Se={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Ee=1,ke=2,Ce=3,Te=4,Ne=5,Me={ERRORS:0,WARNINGS:1,INFOS:5},Re={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Ie=0,Pe=1,Le=2,je=3;let De=Me.WARNINGS;function Oe(e){Number.isInteger(e)&&(De=e)}function Fe(){return De}function We(e){De>=Me.INFOS&&console.log("Info: ".concat(e))}function ze(e){De>=Me.WARNINGS&&console.log("Warning: ".concat(e))}function Be(e){throw new Error(e)}function He(e,t){e||Be(t)}function Ue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return null;if(n&&"string"===typeof e){if(n.addDefaultProtocol&&e.startsWith("www.")){const t=e.match(/\./g);(null===t||void 0===t?void 0:t.length)>=2&&(e="http://".concat(e))}if(n.tryConvertEncoding)try{e=decodeURIComponent(escape(e))}catch(s){}}const i=t?URL.parse(e,t):URL.parse(e);return function(e){switch(null===e||void 0===e?void 0:e.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(i)?i:null}function Ge(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=URL.parse(e);return i?(i.hash=t,i.href):n&&Ue(e,"http://example.com")?e.split("#",1)[0]+"".concat(t?"#".concat(t):""):""}function Ve(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Object.defineProperty(e,t,{value:n,enumerable:!i,configurable:!0,writable:!1}),n}const qe=function(){function e(e,t){this.message=e,this.name=t}return e.prototype=new Error,e.constructor=e,e}();class Ye extends qe{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Ke extends qe{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Xe extends qe{constructor(e){super(e,"InvalidPDFException")}}class Qe extends qe{constructor(e,t,n){super(e,"ResponseException"),this.status=t,this.missing=n}}class $e extends qe{constructor(e){super(e,"FormatError")}}class Je extends qe{constructor(e){super(e,"AbortException")}}function Ze(e){"object"===typeof e&&void 0!==(null===e||void 0===e?void 0:e.length)||Be("Invalid argument for bytesToString");const t=e.length,n=8192;if(t<n)return String.fromCharCode.apply(null,e);const i=[];for(let s=0;s<t;s+=n){const a=Math.min(s+n,t),r=e.subarray(s,a);i.push(String.fromCharCode.apply(null,r))}return i.join("")}function et(e){"string"!==typeof e&&Be("Invalid argument for stringToBytes");const t=e.length,n=new Uint8Array(t);for(let i=0;i<t;++i)n[i]=255&e.charCodeAt(i);return n}class tt{static get isLittleEndian(){return Ve(this,"isLittleEndian",function(){const e=new Uint8Array(4);return e[0]=1,1===new Uint32Array(e.buffer,0,1)[0]}())}static get isEvalSupported(){return Ve(this,"isEvalSupported",function(){try{return new Function(""),!0}catch(e){return!1}}())}static get isOffscreenCanvasSupported(){return Ve(this,"isOffscreenCanvasSupported","undefined"!==typeof OffscreenCanvas)}static get isImageDecoderSupported(){return Ve(this,"isImageDecoderSupported","undefined"!==typeof ImageDecoder)}static get platform(){const{platform:e,userAgent:t}=navigator;return Ve(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return Ve(this,"isCSSRoundSupported",null===(e=globalThis.CSS)||void 0===e||null===(t=e.supports)||void 0===t?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const nt=Array.from(Array(256).keys(),e=>e.toString(16).padStart(2,"0"));class it{static makeHexColor(e,t,n){return"#".concat(nt[e]).concat(nt[t]).concat(nt[n])}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=e[n],s=e[n+1];e[n]=i*t[0]+s*t[2]+t[4],e[n+1]=i*t[1]+s*t[3]+t[5]}static applyTransformToBezier(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=t[0],s=t[1],a=t[2],r=t[3],o=t[4],l=t[5];for(let c=0;c<6;c+=2){const t=e[n+c],d=e[n+c+1];e[n+c]=t*i+d*a+o,e[n+c+1]=t*s+d*r+l}}static applyInverseTransform(e,t){const n=e[0],i=e[1],s=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/s,e[1]=(-n*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/s}static axialAlignedBoundingBox(e,t,n){const i=t[0],s=t[1],a=t[2],r=t[3],o=t[4],l=t[5],c=e[0],d=e[1],h=e[2],u=e[3];let p=i*c+o,m=p,f=i*h+o,g=f,v=r*d+l,y=v,b=r*u+l,x=b;if(0!==s||0!==a){const e=s*c,t=s*h,n=a*d,i=a*u;p+=n,g+=n,f+=i,m+=i,v+=e,x+=e,b+=t,y+=t}n[0]=Math.min(n[0],p,f,m,g),n[1]=Math.min(n[1],v,b,y,x),n[2]=Math.max(n[2],p,f,m,g),n[3]=Math.max(n[3],v,b,y,x)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const n=e[0],i=e[1],s=e[2],a=e[3],r=n**2+i**2,o=n*s+i*a,l=s**2+a**2,c=(r+l)/2,d=Math.sqrt(c**2-(r*l-o**2));t[0]=Math.sqrt(c+d||1),t[1]=Math.sqrt(c-d||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>i)return null;const s=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return s>a?null:[n,s,i,a]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,i,s){s[0]=Math.min(s[0],e,n),s[1]=Math.min(s[1],t,i),s[2]=Math.max(s[2],e,n),s[3]=Math.max(s[3],t,i)}static bezierBoundingBox(e,t,n,i,s,a,r,o,l){l[0]=Math.min(l[0],e,r),l[1]=Math.min(l[1],t,o),l[2]=Math.max(l[2],e,r),l[3]=Math.max(l[3],t,o),D(it,this,at).call(this,e,n,s,r,t,i,a,o,3*(3*(n-s)-e+r),6*(e-2*n+s),3*(n-e),l),D(it,this,at).call(this,e,n,s,r,t,i,a,o,3*(3*(i-a)-t+o),6*(t-2*i+a),3*(i-t),l)}}function st(e,t,n,i,s,a,r,o,l,c){if(l<=0||l>=1)return;const d=1-l,h=l*l,u=h*l,p=d*(d*(d*e+3*l*t)+3*h*n)+u*i,m=d*(d*(d*s+3*l*a)+3*h*r)+u*o;c[0]=Math.min(c[0],p),c[1]=Math.min(c[1],m),c[2]=Math.max(c[2],p),c[3]=Math.max(c[3],m)}function at(e,t,n,i,s,a,r,o,l,c,d,h){if(Math.abs(l)<1e-12)return void(Math.abs(c)>=1e-12&&D(B,this,st).call(this,e,t,n,i,s,a,r,o,-d/c,h));const u=c**2-4*d*l;if(u<0)return;const p=Math.sqrt(u),m=2*l;D(B,this,st).call(this,e,t,n,i,s,a,r,o,(-c+p)/m,h),D(B,this,st).call(this,e,t,n,i,s,a,r,o,(-c-p)/m,h)}B=it;let rt=null,ot=null;function lt(){if("function"===typeof crypto.randomUUID)return crypto.randomUUID();const e=new Uint8Array(32);return crypto.getRandomValues(e),Ze(e)}const ct="pdfjs_internal_id_";function dt(e,t,n){return Math.min(Math.max(e,t),n)}function ht(e){return Uint8Array.prototype.toBase64?e.toBase64():btoa(Ze(e))}"function"!==typeof Promise.try&&(Promise.try=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new Promise(t=>{t(e(...n))})}),"function"!==typeof Math.sumPrecise&&(Math.sumPrecise=function(e){return e.reduce((e,t)=>e+t,0)});const ut="http://www.w3.org/2000/svg";class pt{}async function mt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";if(xt(e,document.baseURI)){const n=await fetch(e);if(!n.ok)throw new Error(n.statusText);switch(t){case"arraybuffer":return n.arrayBuffer();case"blob":return n.blob();case"json":return n.json()}return n.text()}return new Promise((n,i)=>{const s=new XMLHttpRequest;s.open("GET",e,!0),s.responseType=t,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE)if(200!==s.status&&0!==s.status)i(new Error(s.statusText));else{switch(t){case"arraybuffer":case"blob":case"json":return void n(s.response)}n(s.responseText)}},s.send(null)})}H=pt,o(pt,"CSS",96),o(pt,"PDF",72),o(pt,"PDF_TO_CSS_UNITS",H.CSS/H.PDF);class ft{constructor(e){let{viewBox:t,userUnit:n,scale:i,rotation:s,offsetX:a=0,offsetY:r=0,dontFlip:o=!1}=e;this.viewBox=t,this.userUnit=n,this.scale=i,this.rotation=s,this.offsetX=a,this.offsetY=r,i*=n;const l=(t[2]+t[0])/2,c=(t[3]+t[1])/2;let d,h,u,p,m,f,g,v;switch(s%=360,s<0&&(s+=360),s){case 180:d=-1,h=0,u=0,p=1;break;case 90:d=0,h=1,u=1,p=0;break;case 270:d=0,h=-1,u=-1,p=0;break;case 0:d=1,h=0,u=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(u=-u,p=-p),0===d?(m=Math.abs(c-t[1])*i+a,f=Math.abs(l-t[0])*i+r,g=(t[3]-t[1])*i,v=(t[2]-t[0])*i):(m=Math.abs(l-t[0])*i+a,f=Math.abs(c-t[1])*i+r,g=(t[2]-t[0])*i,v=(t[3]-t[1])*i),this.transform=[d*i,h*i,u*i,p*i,m-d*i*l-u*i*c,f-h*i*l-p*i*c],this.width=g,this.height=v}get rawDims(){const e=this.viewBox;return Ve(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone(){let{scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:s=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new ft({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:s})}convertToViewportPoint(e,t){const n=[e,t];return it.applyTransform(n,this.transform),n}convertToViewportRectangle(e){const t=[e[0],e[1]];it.applyTransform(t,this.transform);const n=[e[2],e[3]];return it.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){const n=[e,t];return it.applyInverseTransform(n,this.transform),n}}class gt extends qe{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super(e,"RenderingCancelledException"),this.extraDelay=t}}function vt(e){const t=e.length;let n=0;for(;n<t&&""===e[n].trim();)n++;return"data:"===e.substring(n,n+5).toLowerCase()}function yt(e){return"string"===typeof e&&/\.pdf$/i.test(e)}class bt{constructor(){o(this,"started",Object.create(null)),o(this,"times",[])}time(e){e in this.started&&ze("Timer is already running for ".concat(e)),this.started[e]=Date.now()}timeEnd(e){e in this.started||ze("Timer has not been started for ".concat(e)),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:i,end:s}of this.times)e.push("".concat(n.padEnd(t)," ").concat(s-i,"ms\n"));return e.join("")}}function xt(e,t){const n=t?URL.parse(e,t):URL.parse(e);return"http:"===(null===n||void 0===n?void 0:n.protocol)||"https:"===(null===n||void 0===n?void 0:n.protocol)}function wt(e){e.preventDefault()}function At(e){e.preventDefault(),e.stopPropagation()}class _t{static toDateObject(e){if(e instanceof Date)return e;if(!e||"string"!==typeof e)return null;D(_t,this,St)._||(St._=D(_t,this,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?")));const t=D(_t,this,St)._.exec(e);if(!t)return null;const n=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let s=parseInt(t[3],10);s=s>=1&&s<=31?s:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let r=parseInt(t[5],10);r=r>=0&&r<=59?r:0;let o=parseInt(t[6],10);o=o>=0&&o<=59?o:0;const l=t[7]||"Z";let c=parseInt(t[8],10);c=c>=0&&c<=23?c:0;let d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,"-"===l?(a+=c,r+=d):"+"===l&&(a-=c,r-=d),new Date(Date.UTC(n,i,s,a,r,o))}}var St={_:void 0};function Et(e){if(e.startsWith("#")){const t=parseInt(e.slice(1),16);return[(16711680&t)>>16,(65280&t)>>8,255&t]}return e.startsWith("rgb(")?e.slice(4,-1).split(",").map(e=>parseInt(e)):e.startsWith("rgba(")?e.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(ze('Not a valid color format: "'.concat(e,'"')),[0,0,0])}function kt(e){const{a:t,b:n,c:i,d:s,e:a,f:r}=e.getTransform();return[t,n,i,s,a,r]}function Ct(e){const{a:t,b:n,c:i,d:s,e:a,f:r}=e.getTransform().invertSelf();return[t,n,i,s,a,r]}function Tt(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t instanceof ft){const{pageWidth:i,pageHeight:s}=t.rawDims,{style:a}=e,r=tt.isCSSRoundSupported,o="var(--total-scale-factor) * ".concat(i,"px"),l="var(--total-scale-factor) * ".concat(s,"px"),c=r?"round(down, ".concat(o,", var(--scale-round-x))"):"calc(".concat(o,")"),d=r?"round(down, ".concat(l,", var(--scale-round-y))"):"calc(".concat(l,")");n&&t.rotation%180!==0?(a.width=d,a.height=c):(a.width=c,a.height=d)}i&&e.setAttribute("data-main-rotation",t.rotation)}class Nt{constructor(){const{pixelRatio:e}=Nt;this.sx=e,this.sy=e}get scaled(){return 1!==this.sx||1!==this.sy}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,n,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,a=1/0,r=1/0,o=1/0;(n=Nt.capPixels(n,s))>0&&(a=Math.sqrt(n/(e*t))),-1!==i&&(r=i/e,o=i/t);const l=Math.min(a,r,o);return(this.sx>l||this.sy>l)&&(this.sx=l,this.sy=l,!0)}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}}const Mt=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];var Rt=new WeakMap,It=new WeakMap,Pt=new WeakMap,Lt=new WeakMap,jt=new WeakMap,Dt=new WeakMap,Ot=new WeakMap,Ft=new WeakSet;class Wt{constructor(e){L(this,Ft),j(this,Rt,null),j(this,It,null),j(this,Pt,void 0),j(this,Lt,null),j(this,jt,null),j(this,Dt,null),j(this,Ot,null),W(Pt,this,e),Vt._||(Vt._=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=W(Rt,this,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=F(Pt,this)._uiManager._signal;e.addEventListener("contextmenu",wt,{signal:t}),e.addEventListener("pointerdown",zt,{signal:t});const n=W(Lt,this,document.createElement("div"));n.className="buttons",e.append(n);const i=F(Pt,this).toolbarPosition;if(i){const{style:t}=e,n="ltr"===F(Pt,this)._uiManager.direction?1-i[0]:i[0];t.insetInlineEnd="".concat(100*n,"%"),t.top="calc(".concat(100*i[1],"% + var(--editor-toolbar-vert-offset))")}return e}get div(){return F(Rt,this)}hide(){var e;F(Rt,this).classList.add("hidden"),null===(e=F(It,this))||void 0===e||e.hideDropdown()}show(){var e,t;F(Rt,this).classList.remove("hidden"),null===(e=F(jt,this))||void 0===e||e.shown(),null===(t=F(Dt,this))||void 0===t||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=F(Pt,this),n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",Vt._[e]),D(Ft,this,Ut).call(this,n),n.addEventListener("click",e=>{t.delete()},{signal:t._signal}),F(Lt,this).append(n)}async addAltText(e){const t=await e.render();D(Ft,this,Ut).call(this,t),F(Lt,this).append(t,O(Ft,this,Gt)),W(jt,this,e)}addComment(e){if(F(Dt,this))return;const t=e.render();t&&(D(Ft,this,Ut).call(this,t),F(Lt,this).prepend(t,O(Ft,this,Gt)),W(Dt,this,e),e.toolbar=this)}addColorPicker(e){if(F(It,this))return;W(It,this,e);const t=e.renderButton();D(Ft,this,Ut).call(this,t),F(Lt,this).append(t,O(Ft,this,Gt))}async addEditSignatureButton(e){const t=W(Ot,this,await e.renderEditButton(F(Pt,this)));D(Ft,this,Ut).call(this,t),F(Lt,this).append(t,O(Ft,this,Gt))}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(t)}}updateEditSignatureButton(e){F(Ot,this)&&(F(Ot,this).title=e)}remove(){var e;F(Rt,this).remove(),null===(e=F(It,this))||void 0===e||e.destroy(),W(It,this,null)}}function zt(e){e.stopPropagation()}function Bt(e){F(Pt,this)._focusEventsAllowed=!1,At(e)}function Ht(e){F(Pt,this)._focusEventsAllowed=!0,At(e)}function Ut(e){const t=F(Pt,this)._uiManager._signal;e.addEventListener("focusin",D(Ft,this,Bt).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",D(Ft,this,Ht).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",wt,{signal:t})}function Gt(e){const t=document.createElement("div");return t.className="divider",t}var Vt={_:null},qt=new WeakMap,Yt=new WeakMap,Kt=new WeakMap,Xt=new WeakSet;class Qt{constructor(e){L(this,Xt),j(this,qt,null),j(this,Yt,null),j(this,Kt,void 0),W(Kt,this,e)}show(e,t,n){const[i,s]=D(Xt,this,Jt).call(this,t,n),{style:a}=F(Yt,this)||W(Yt,this,D(Xt,this,$t).call(this));e.append(F(Yt,this)),a.insetInlineEnd="".concat(100*i,"%"),a.top="calc(".concat(100*s,"% + var(--editor-toolbar-vert-offset))")}hide(){F(Yt,this).remove()}}function $t(){const e=W(Yt,this,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",wt,{signal:F(Kt,this)._signal});const t=W(qt,this,document.createElement("div"));return t.className="buttons",e.append(t),D(Xt,this,Zt).call(this),e}function Jt(e,t){let n=0,i=0;for(const s of e){const e=s.y+s.height;if(e<n)continue;const a=s.x+(t?s.width:0);e>n?(i=a,n=e):t?a>i&&(i=a):a<i&&(i=a)}return[t?1-i:i,n]}function Zt(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=F(Kt,this)._signal;e.addEventListener("contextmenu",wt,{signal:n}),e.addEventListener("click",()=>{F(Kt,this).highlightSelection("floating_button")},{signal:n}),F(qt,this).append(e)}function en(e,t,n){for(const i of n)t.addEventListener(i,e[i].bind(e))}var tn=new WeakMap;class nn{constructor(){j(this,tn,0)}get id(){var e,t;return"".concat(me).concat((W(tn,this,(e=F(tn,this),t=e++,e)),t))}}var sn=new WeakMap,an=new WeakMap,rn=new WeakMap,on=new WeakSet;class ln{constructor(){L(this,on),j(this,sn,lt()),j(this,an,0),j(this,rn,null)}static get _isSVGFittingCanvas(){const e=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),t=new Image;t.src='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>';return Ve(this,"_isSVGFittingCanvas",t.decode().then(()=>(e.drawImage(t,0,0,1,1,0,0,1,3),0===new Uint32Array(e.getImageData(0,0,1,1).data.buffer)[0])))}async getFromFile(e){const{lastModified:t,name:n,size:i,type:s}=e;return D(on,this,cn).call(this,"".concat(t,"_").concat(n,"_").concat(i,"_").concat(s),e)}async getFromUrl(e){return D(on,this,cn).call(this,e,e)}async getFromBlob(e,t){const n=await t;return D(on,this,cn).call(this,e,n)}async getFromId(e){F(rn,this)||W(rn,this,new Map);const t=F(rn,this).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:e}=t;return delete t.blobPromise,this.getFromBlob(t.id,e)}return this.getFromUrl(t.url)}getFromCanvas(e,t){var n,i,s;F(rn,this)||W(rn,this,new Map);let a=F(rn,this).get(e);if(null!==(s=a)&&void 0!==s&&s.bitmap)return a.refCounter+=1,a;const r=new OffscreenCanvas(t.width,t.height);return r.getContext("2d").drawImage(t,0,0),a={bitmap:r.transferToImageBitmap(),id:"image_".concat(F(sn,this),"_").concat((W(an,this,(n=F(an,this),i=n++,n)),i)),refCounter:1,isSvg:!1},F(rn,this).set(e,a),F(rn,this).set(a.id,a),a}getSvgUrl(e){const t=F(rn,this).get(e);return null!==t&&void 0!==t&&t.isSvg?t.svgUrl:null}deleteId(e){var t;F(rn,this)||W(rn,this,new Map);const n=F(rn,this).get(e);if(!n)return;if(n.refCounter-=1,0!==n.refCounter)return;const{bitmap:i}=n;if(!n.url&&!n.file){const e=new OffscreenCanvas(i.width,i.height);e.getContext("bitmaprenderer").transferFromImageBitmap(i),n.blobPromise=e.convertToBlob()}null===(t=i.close)||void 0===t||t.call(i),n.bitmap=null}isValidId(e){return e.startsWith("image_".concat(F(sn,this),"_"))}}async function cn(e,t){var n;F(rn,this)||W(rn,this,new Map);let i=F(rn,this).get(e);if(null===i)return null;if(null!==(n=i)&&void 0!==n&&n.bitmap)return i.refCounter+=1,i;try{var s,a;let e;if(i||(i={bitmap:null,id:"image_".concat(F(sn,this),"_").concat((W(an,this,(s=F(an,this),a=s++,s)),a)),refCounter:0,isSvg:!1}),"string"===typeof t?(i.url=t,e=await mt(t,"blob")):t instanceof File?e=i.file=t:t instanceof Blob&&(e=t),"image/svg+xml"===e.type){const t=U._isSVGFittingCanvas,n=new FileReader,s=new Image,a=new Promise((e,a)=>{s.onload=()=>{i.bitmap=s,i.isSvg=!0,e()},n.onload=async()=>{const e=i.svgUrl=n.result;s.src=await t?"".concat(e,"#svgView(preserveAspectRatio(none))"):e},s.onerror=n.onerror=a});n.readAsDataURL(e),await a}else i.bitmap=await createImageBitmap(e);i.refCounter=1}catch(r){ze(r),i=null}return F(rn,this).set(e,i),i&&F(rn,this).set(i.id,i),i}U=ln;var dn=new WeakMap,hn=new WeakMap,un=new WeakMap,pn=new WeakMap;class mn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;j(this,dn,[]),j(this,hn,!1),j(this,un,void 0),j(this,pn,-1),W(un,this,e)}add(e){let{cmd:t,undo:n,post:i,mustExec:s,type:a=NaN,overwriteIfSameType:r=!1,keepUndo:o=!1}=e;if(s&&t(),F(hn,this))return;const l={cmd:t,undo:n,post:i,type:a};if(-1===F(pn,this))return F(dn,this).length>0&&(F(dn,this).length=0),W(pn,this,0),void F(dn,this).push(l);if(r&&F(dn,this)[F(pn,this)].type===a)return o&&(l.undo=F(dn,this)[F(pn,this)].undo),void(F(dn,this)[F(pn,this)]=l);const c=F(pn,this)+1;c===F(un,this)?F(dn,this).splice(0,1):(W(pn,this,c),c<F(dn,this).length&&F(dn,this).splice(c)),F(dn,this).push(l)}undo(){if(-1===F(pn,this))return;W(hn,this,!0);const{undo:e,post:t}=F(dn,this)[F(pn,this)];e(),null===t||void 0===t||t(),W(hn,this,!1),W(pn,this,F(pn,this)-1)}redo(){if(F(pn,this)<F(dn,this).length-1){W(pn,this,F(pn,this)+1),W(hn,this,!0);const{cmd:e,post:t}=F(dn,this)[F(pn,this)];e(),null===t||void 0===t||t(),W(hn,this,!1)}}hasSomethingToUndo(){return-1!==F(pn,this)}hasSomethingToRedo(){return F(pn,this)<F(dn,this).length-1}cleanType(e){if(-1!==F(pn,this)){for(let t=F(pn,this);t>=0;t--)if(F(dn,this)[t].type!==e)return F(dn,this).splice(t+1,F(pn,this)-t),void W(pn,this,t);F(dn,this).length=0,W(pn,this,-1)}}destroy(){W(dn,this,null)}}var fn=new WeakSet;class gn{constructor(e){L(this,fn),this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=tt.platform;for(const[n,i,s={}]of e)for(const e of n){const n=e.startsWith("mac+");t&&n?(this.callbacks.set(e.slice(4),{callback:i,options:s}),this.allKeys.add(e.split("+").at(-1))):t||n||(this.callbacks.set(e,{callback:i,options:s}),this.allKeys.add(e.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(D(fn,this,vn).call(this,t));if(!n)return;const{callback:i,options:{bubbles:s=!1,args:a=[],checker:r=null}}=n;r&&!r(e,t)||(i.bind(e,...a,t)(),s||At(t))}}function vn(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}class yn{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return function(e){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const n of e.keys()){t.style.color=n;const i=window.getComputedStyle(t).color;e.set(n,Et(i))}t.remove()}(e),Ve(this,"_colors",e)}convert(e){const t=Et(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,i]of this._colors)if(i.every((e,n)=>e===t[n]))return yn._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?it.makeHexColor(...t):e}}o(yn,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));var bn=new WeakMap,xn=new WeakMap,wn=new WeakMap,An=new WeakMap,_n=new WeakMap,Sn=new WeakMap,En=new WeakMap,kn=new WeakMap,Cn=new WeakMap,Tn=new WeakMap,Nn=new WeakMap,Mn=new WeakMap,Rn=new WeakMap,In=new WeakMap,Pn=new WeakMap,Ln=new WeakMap,jn=new WeakMap,Dn=new WeakMap,On=new WeakMap,Fn=new WeakMap,Wn=new WeakMap,zn=new WeakMap,Bn=new WeakMap,Hn=new WeakMap,Un=new WeakMap,Gn=new WeakMap,Vn=new WeakMap,qn=new WeakMap,Yn=new WeakMap,Kn=new WeakMap,Xn=new WeakMap,Qn=new WeakMap,$n=new WeakMap,Jn=new WeakMap,Zn=new WeakMap,ei=new WeakMap,ti=new WeakMap,ni=new WeakMap,ii=new WeakMap,si=new WeakMap,ai=new WeakMap,ri=new WeakMap,oi=new WeakMap,li=new WeakMap,ci=new WeakMap,di=new WeakMap,hi=new WeakSet;class ui{static get _keyboardManager(){const e=ui.prototype,t=e=>F(oi,e).contains(document.activeElement)&&"BUTTON"!==document.activeElement.tagName&&e.hasSomethingToControl(),n=(e,t)=>{let{target:n}=t;if(n instanceof HTMLInputElement){const{type:e}=n;return"text"!==e&&"number"!==e}return!0},i=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return Ve(this,"_keyboardManager",new gn([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(e,t)=>{let{target:n}=t;return!(n instanceof HTMLButtonElement)&&F(oi,e).contains(n)&&!e.isEnterHandled}}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(e,t)=>{let{target:n}=t;return!(n instanceof HTMLButtonElement)&&F(oi,e).contains(document.activeElement)}}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}]]))}constructor(e,t,n,i,s,a,r,l,c,d,h,u,p,m,f,g){L(this,hi),j(this,bn,new AbortController),j(this,xn,null),j(this,wn,new Map),j(this,An,new Map),j(this,_n,null),j(this,Sn,null),j(this,En,null),j(this,kn,new mn),j(this,Cn,null),j(this,Tn,null),j(this,Nn,null),j(this,Mn,0),j(this,Rn,new Set),j(this,In,null),j(this,Pn,null),j(this,Ln,new Set),o(this,"_editorUndoBar",null),j(this,jn,!1),j(this,Dn,!1),j(this,On,!1),j(this,Fn,null),j(this,Wn,null),j(this,zn,null),j(this,Bn,null),j(this,Hn,!1),j(this,Un,null),j(this,Gn,new nn),j(this,Vn,!1),j(this,qn,!1),j(this,Yn,null),j(this,Kn,null),j(this,Xn,null),j(this,Qn,null),j(this,$n,null),j(this,Jn,fe.NONE),j(this,Zn,new Set),j(this,ei,null),j(this,ti,null),j(this,ni,null),j(this,ii,null),j(this,si,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1}),j(this,ai,[0,0]),j(this,ri,null),j(this,oi,null),j(this,li,null),j(this,ci,null),j(this,di,null);const v=this._signal=F(bn,this).signal;W(oi,this,e),W(li,this,t),W(ci,this,n),W(_n,this,i),W(Cn,this,s),W(ti,this,a),this._eventBus=r,r._on("editingaction",this.onEditingAction.bind(this),{signal:v}),r._on("pagechanging",this.onPageChanging.bind(this),{signal:v}),r._on("scalechanging",this.onScaleChanging.bind(this),{signal:v}),r._on("rotationchanging",this.onRotationChanging.bind(this),{signal:v}),r._on("setpreference",this.onSetPreference.bind(this),{signal:v}),r._on("switchannotationeditorparams",e=>this.updateParams(e.type,e.value),{signal:v}),D(hi,this,yi).call(this),D(hi,this,Ei).call(this),D(hi,this,wi).call(this),W(Sn,this,l.annotationStorage),W(Fn,this,l.filterFactory),W(ni,this,c),W(Bn,this,d||null),W(jn,this,h),W(Dn,this,u),W(On,this,p),W($n,this,m||null),this.viewParameters={realScale:pt.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=f||null,this._supportsPinchToZoom=!1!==g}destroy(){var e,t,n,i,s,a,r,o,l;null===(e=F(di,this))||void 0===e||e.resolve(),W(di,this,null),null===(t=F(bn,this))||void 0===t||t.abort(),W(bn,this,null),this._signal=null;for(const c of F(An,this).values())c.destroy();F(An,this).clear(),F(wn,this).clear(),F(Ln,this).clear(),null===(n=F(Qn,this))||void 0===n||n.clear(),W(xn,this,null),F(Zn,this).clear(),F(kn,this).destroy(),null===(i=F(_n,this))||void 0===i||i.destroy(),null===(s=F(Cn,this))||void 0===s||s.destroy(),null===(a=F(ti,this))||void 0===a||a.destroy(),null===(r=F(Un,this))||void 0===r||r.hide(),W(Un,this,null),null===(o=F(Xn,this))||void 0===o||o.destroy(),W(Xn,this,null),F(Wn,this)&&(clearTimeout(F(Wn,this)),W(Wn,this,null)),F(ri,this)&&(clearTimeout(F(ri,this)),W(ri,this,null)),null===(l=this._editorUndoBar)||void 0===l||l.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return F($n,this)}get useNewAltTextFlow(){return F(Dn,this)}get useNewAltTextWhenAddingImage(){return F(On,this)}get hcmFilter(){return Ve(this,"hcmFilter",F(ni,this)?F(Fn,this).addHCMFilter(F(ni,this).foreground,F(ni,this).background):"none")}get direction(){return Ve(this,"direction",getComputedStyle(F(oi,this)).direction)}get _highlightColors(){return Ve(this,"_highlightColors",F(Bn,this)?new Map(F(Bn,this).split(",").map(e=>((e=e.split("=").map(e=>e.trim()))[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return Ve(this,"highlightColors",null);const t=new Map,n=!!F(ni,this);for(const[i,s]of e){const e=i.endsWith("_HCM");n&&e?t.set(i.replace("_HCM",""),s):n||e||t.set(i,s)}return Ve(this,"highlightColors",t)}get highlightColorNames(){return Ve(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),W(Nn,this,e)}setMainHighlightColorPicker(e){W(Xn,this,e)}editAltText(e){var t;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null===(t=F(_n,this))||void 0===t||t.editAltText(this,e,n)}hasCommentManager(){return!!F(Cn,this)}editComment(e,t){var n;null===(n=F(Cn,this))||void 0===n||n.open(this,e,t)}getSignature(e){var t;null===(t=F(ti,this))||void 0===t||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return F(ti,this)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference(e){let{name:t,value:n}=e;if("enableNewAltTextWhenAddingImage"===t)W(On,this,n)}onPageChanging(e){let{pageNumber:t}=e;W(Mn,this,t-1)}focusMainContainer(){F(oi,this).focus()}findParent(e,t){for(const n of F(An,this).values()){const{x:i,y:s,width:a,height:r}=n.div.getBoundingClientRect();if(e>=i&&e<=i+a&&t>=s&&t<=s+r)return n}return null}disableUserSelect(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];F(li,this).classList.toggle("noUserSelect",e)}addShouldRescale(e){F(Ln,this).add(e)}removeShouldRescale(e){F(Ln,this).delete(e)}onScaleChanging(e){var t;let{scale:n}=e;this.commitOrRemove(),this.viewParameters.realScale=n*pt.PDF_TO_CSS_UNITS;for(const i of F(Ln,this))i.onScaleChanging();null===(t=F(Nn,this))||void 0===t||t.onScaleChanging()}onRotationChanging(e){let{pagesRotation:t}=e;this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:n,anchorOffset:i,focusNode:s,focusOffset:a}=t,r=t.toString(),o=D(hi,this,pi).call(this,t).closest(".textLayer"),l=this.getSelectionBoxes(o);if(!l)return;t.empty();const c=D(hi,this,mi).call(this,o),d=F(Jn,this)===fe.NONE,h=()=>{null===c||void 0===c||c.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:l,anchorNode:n,anchorOffset:i,focusNode:s,focusOffset:a,text:r}),d&&this.showAllEditors("highlight",!0,!0)};d?this.switchToMode(fe.HIGHLIGHT,h):h()}addToAnnotationStorage(e){e.isEmpty()||!F(Sn,this)||F(Sn,this).has(e.id)||F(Sn,this).setValue(e.id,e)}a11yAlert(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=F(ci,this);n&&(n.setAttribute("data-l10n-id",e),t?n.setAttribute("data-l10n-args",JSON.stringify(t)):n.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,F(Hn,this)&&(W(Hn,this,!1),D(hi,this,vi).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of F(Zn,this))if(t.div.contains(e)){W(Kn,this,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!F(Kn,this))return;const[e,t]=F(Kn,this);W(Kn,this,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){D(hi,this,wi).call(this),D(hi,this,_i).call(this)}removeEditListeners(){D(hi,this,Ai).call(this),D(hi,this,Si).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of F(Pn,this))if(n.isHandlingMimeForPasting(t))return e.dataTransfer.dropEffect="copy",void e.preventDefault()}drop(e){for(const t of e.dataTransfer.items)for(const n of F(Pn,this))if(n.isHandlingMimeForPasting(t.type))return n.paste(t,this.currentLayer),void e.preventDefault()}copy(e){var t;if(e.preventDefault(),null===(t=F(xn,this))||void 0===t||t.commitOrRemove(),!this.hasSelection)return;const n=[];for(const i of F(Zn,this)){const e=i.serialize(!0);e&&n.push(e)}0!==n.length&&e.clipboardData.setData("application/pdfjs",JSON.stringify(n))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const a of t.items)for(const e of F(Pn,this))if(e.isHandlingMimeForPasting(a.type))return void e.paste(a,this.currentLayer);let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(s){return void ze('paste: "'.concat(s.message,'".'))}if(!Array.isArray(n))return;this.unselectAll();const i=this.currentLayer;try{const e=[];for(const a of n){const t=await i.deserialize(a);if(!t)return;e.push(t)}const t=()=>{for(const t of e)D(hi,this,Mi).call(this,t);D(hi,this,Pi).call(this,e)},s=()=>{for(const t of e)t.remove()};this.addCommands({cmd:t,undo:s,mustExec:!0})}catch(s){ze('paste: "'.concat(s.message,'".'))}}keydown(e){this.isShiftKeyDown||"Shift"!==e.key||(this.isShiftKeyDown=!0),F(Jn,this)===fe.NONE||this.isEditorHandlingKeyboard||ui._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&"Shift"===e.key&&(this.isShiftKeyDown=!1,F(Hn,this)&&(W(Hn,this,!1),D(hi,this,vi).call(this,"main_toolbar")))}onEditingAction(e){let{name:t}=e;switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu")}}setEditingState(e){e?(D(hi,this,bi).call(this),D(hi,this,_i).call(this),D(hi,this,ki).call(this,{isEditing:F(Jn,this)!==fe.NONE,isEmpty:D(hi,this,Ii).call(this),hasSomethingToUndo:F(kn,this).hasSomethingToUndo(),hasSomethingToRedo:F(kn,this).hasSomethingToRedo(),hasSelectedEditor:!1})):(D(hi,this,xi).call(this),D(hi,this,Si).call(this),D(hi,this,ki).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!F(Pn,this)){W(Pn,this,e);for(const e of F(Pn,this))D(hi,this,Ci).call(this,e.defaultPropertiesToUpdate)}}getId(){return F(Gn,this).id}get currentLayer(){return F(An,this).get(F(Mn,this))}getLayer(e){return F(An,this).get(e)}get currentPageIndex(){return F(Mn,this)}addLayer(e){F(An,this).set(e.pageIndex,e),F(Vn,this)?e.enable():e.disable()}removeLayer(e){F(An,this).delete(e.pageIndex)}async updateMode(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(F(Jn,this)!==e&&(!F(di,this)||(await F(di,this).promise,F(di,this)))){var r,o;if(W(di,this,Promise.withResolvers()),null===(t=F(Nn,this))||void 0===t||t.commitOrRemove(),W(Jn,this,e),e===fe.NONE)return this.setEditingState(!1),D(hi,this,Ni).call(this),null===(r=this._editorUndoBar)||void 0===r||r.hide(),void F(di,this).resolve();if(e===fe.SIGNATURE)await(null===(o=F(ti,this))||void 0===o?void 0:o.loadSignatures());this.setEditingState(!0),await D(hi,this,Ti).call(this),this.unselectAll();for(const t of F(An,this).values())t.updateMode(e);if(!n)return i&&this.addNewEditorFromKeyboard(),void F(di,this).resolve();for(const e of F(wn,this).values())e.annotationElementId===n||e.id===n?(this.setSelected(e),a?e.editComment():s&&e.enterInEditMode()):e.unselect();F(di,this).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==F(Jn,this)&&this._eventBus.dispatch("switchannotationeditormode",c({source:this},e))}updateParams(e,t){if(F(Pn,this)){switch(e){case ge.CREATE:return void this.currentLayer.addNewEditor(t);case ge.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(F(ii,this)||W(ii,this,new Map)).set(e,t),this.showAllEditors("highlight",t)}if(this.hasSelection)for(const n of F(Zn,this))n.updateParams(e,t);else for(const n of F(Pn,this))n.updateDefaultParams(e,t)}}showAllEditors(e,t){var n,i;for(const s of F(wn,this).values())s.editorType===e&&s.show(t);(null===(n=null===(i=F(ii,this))||void 0===i?void 0:i.get(ge.HIGHLIGHT_SHOW_ALL))||void 0===n||n)!==t&&D(hi,this,Ci).call(this,[[ge.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(F(qn,this)!==e){W(qn,this,e);for(const t of F(An,this).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const n of F(wn,this).values())n.pageIndex===e&&t.push(n);return t}getEditor(e){return F(wn,this).get(e)}addEditor(e){F(wn,this).set(e.id,e)}removeEditor(e){var t,n;(e.div.contains(document.activeElement)&&(F(Wn,this)&&clearTimeout(F(Wn,this)),W(Wn,this,setTimeout(()=>{this.focusMainContainer(),W(Wn,this,null)},0))),F(wn,this).delete(e.id),e.annotationElementId)&&(null===(t=F(Qn,this))||void 0===t||t.delete(e.annotationElementId));(this.unselect(e),e.annotationElementId&&F(Rn,this).has(e.annotationElementId))||(null===(n=F(Sn,this))||void 0===n||n.remove(e.id))}addDeletedAnnotationElement(e){F(Rn,this).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return F(Rn,this).has(e)}removeDeletedAnnotationElement(e){F(Rn,this).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){F(xn,this)!==e&&(W(xn,this,e),e&&D(hi,this,Ci).call(this,e.propertiesToUpdate))}updateUI(e){O(hi,this,Ri)===e&&D(hi,this,Ci).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){D(hi,this,Ci).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(F(Zn,this).has(e))return F(Zn,this).delete(e),e.unselect(),void D(hi,this,ki).call(this,{hasSelectedEditor:this.hasSelection});F(Zn,this).add(e),e.select(),D(hi,this,Ci).call(this,e.propertiesToUpdate),D(hi,this,ki).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.id}),null===(t=F(Nn,this))||void 0===t||t.commitOrRemove();for(const n of F(Zn,this))n!==e&&n.unselect();F(Zn,this).clear(),F(Zn,this).add(e),e.select(),D(hi,this,Ci).call(this,e.propertiesToUpdate),D(hi,this,ki).call(this,{hasSelectedEditor:!0})}isSelected(e){return F(Zn,this).has(e)}get firstSelectedEditor(){return F(Zn,this).values().next().value}unselect(e){e.unselect(),F(Zn,this).delete(e),D(hi,this,ki).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==F(Zn,this).size}get isEnterHandled(){return 1===F(Zn,this).size&&this.firstSelectedEditor.isEnterHandled}undo(){var e;F(kn,this).undo(),D(hi,this,ki).call(this,{hasSomethingToUndo:F(kn,this).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:D(hi,this,Ii).call(this)}),null===(e=this._editorUndoBar)||void 0===e||e.hide()}redo(){F(kn,this).redo(),D(hi,this,ki).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:F(kn,this).hasSomethingToRedo(),isEmpty:D(hi,this,Ii).call(this)})}addCommands(e){F(kn,this).add(e),D(hi,this,ki).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:D(hi,this,Ii).call(this)})}cleanUndoStack(e){F(kn,this).cleanType(e)}delete(){var e;this.commitOrRemove();const t=null===(e=this.currentLayer)||void 0===e?void 0:e.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const n=t?[t]:[...F(Zn,this)],i=()=>{for(const e of n)D(hi,this,Mi).call(this,e)};this.addCommands({cmd:()=>{var e;null===(e=this._editorUndoBar)||void 0===e||e.show(i,1===n.length?n[0].editorType:n.length);for(const t of n)t.remove()},undo:i,mustExec:!0})}commitOrRemove(){var e;null===(e=F(xn,this))||void 0===e||e.commitOrRemove()}hasSomethingToControl(){return F(xn,this)||this.hasSelection}selectAll(){for(const e of F(Zn,this))e.commit();D(hi,this,Pi).call(this,F(wn,this).values())}unselectAll(){var e;if((!F(xn,this)||(F(xn,this).commitOrRemove(),F(Jn,this)===fe.NONE))&&(null===(e=F(Nn,this))||void 0===e||!e.commitOrRemove())&&this.hasSelection){for(const e of F(Zn,this))e.unselect();F(Zn,this).clear(),D(hi,this,ki).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]||this.commitOrRemove(),!this.hasSelection)return;F(ai,this)[0]+=e,F(ai,this)[1]+=t;const[n,i]=F(ai,this),s=[...F(Zn,this)];F(ri,this)&&clearTimeout(F(ri,this)),W(ri,this,setTimeout(()=>{W(ri,this,null),F(ai,this)[0]=F(ai,this)[1]=0,this.addCommands({cmd:()=>{for(const e of s)F(wn,this).has(e.id)&&(e.translateInPage(n,i),e.translationDone())},undo:()=>{for(const e of s)F(wn,this).has(e.id)&&(e.translateInPage(-n,-i),e.translationDone())},mustExec:!1})},1e3));for(const a of s)a.translateInPage(e,t),a.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),W(In,this,new Map);for(const e of F(Zn,this))F(In,this).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!F(In,this))return!1;this.disableUserSelect(!1);const e=F(In,this);W(In,this,null);let t=!1;for(const[{x:i,y:s,pageIndex:a},r]of e)r.newX=i,r.newY=s,r.newPageIndex=a,t||(t=i!==r.savedX||s!==r.savedY||a!==r.savedPageIndex);if(!t)return!1;const n=(e,t,n,i)=>{if(F(wn,this).has(e.id)){const s=F(An,this).get(i);s?e._setParentAndPosition(s,t,n):(e.pageIndex=i,e.x=t,e.y=n)}};return this.addCommands({cmd:()=>{for(const[t,{newX:i,newY:s,newPageIndex:a}]of e)n(t,i,s,a)},undo:()=>{for(const[t,{savedX:i,savedY:s,savedPageIndex:a}]of e)n(t,i,s,a)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(F(In,this))for(const n of F(In,this).keys())n.drag(e,t)}rebuild(e){if(null===e.parent){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return(null===(e=this.getActive())||void 0===e?void 0:e.shouldGetKeyboardEvents())||1===F(Zn,this).size&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return F(xn,this)===e}getActive(){return F(xn,this)}getMode(){return F(Jn,this)}get imageManager(){return Ve(this,"imageManager",new ln)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let l=0,c=t.rangeCount;l<c;l++)if(!e.contains(t.getRangeAt(l).commonAncestorContainer))return null;const{x:n,y:i,width:s,height:a}=e.getBoundingClientRect();let r;switch(e.getAttribute("data-main-rotation")){case"90":r=(e,t,r,o)=>({x:(t-i)/a,y:1-(e+r-n)/s,width:o/a,height:r/s});break;case"180":r=(e,t,r,o)=>({x:1-(e+r-n)/s,y:1-(t+o-i)/a,width:r/s,height:o/a});break;case"270":r=(e,t,r,o)=>({x:1-(t+o-i)/a,y:(e-n)/s,width:o/a,height:r/s});break;default:r=(e,t,r,o)=>({x:(e-n)/s,y:(t-i)/a,width:r/s,height:o/a})}const o=[];for(let l=0,c=t.rangeCount;l<c;l++){const e=t.getRangeAt(l);if(!e.collapsed)for(const{x:t,y:n,width:i,height:s}of e.getClientRects())0!==i&&0!==s&&o.push(r(t,n,i,s))}return 0===o.length?null:o}addChangedExistingAnnotation(e){let{annotationElementId:t,id:n}=e;(F(En,this)||W(En,this,new Map)).set(t,n)}removeChangedExistingAnnotation(e){var t;let{annotationElementId:n}=e;null===(t=F(En,this))||void 0===t||t.delete(n)}renderAnnotationElement(e){var t;const n=null===(t=F(En,this))||void 0===t?void 0:t.get(e.data.id);if(!n)return;const i=F(Sn,this).getRawValue(n);i&&(F(Jn,this)!==fe.NONE||i.hasBeenModified)&&i.renderAnnotationElement(e)}setMissingCanvas(e,t,n){var i;const s=null===(i=F(Qn,this))||void 0===i?void 0:i.get(e);s&&(s.setCanvas(t,n),F(Qn,this).delete(e))}addMissingCanvas(e,t){(F(Qn,this)||W(Qn,this,new Map)).set(e,t)}}function pi(e){let{anchorNode:t}=e;return t.nodeType===Node.TEXT_NODE?t.parentElement:t}function mi(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of F(An,this).values())if(n.hasTextLayer(e))return n;return null}function fi(){const e=document.getSelection();if(!e||e.isCollapsed)return;const t=D(hi,this,pi).call(this,e).closest(".textLayer"),n=this.getSelectionBoxes(t);n&&(F(Un,this)||W(Un,this,new Qt(this)),F(Un,this).show(t,n,"ltr"===this.direction))}function gi(){var e;const t=document.getSelection();if(!t||t.isCollapsed){var n;if(F(ei,this))null===(n=F(Un,this))||void 0===n||n.hide(),W(ei,this,null),D(hi,this,ki).call(this,{hasSelectedText:!1});return}const{anchorNode:i}=t;if(i===F(ei,this))return;const s=D(hi,this,pi).call(this,t).closest(".textLayer");var a;if(s){if(null===(e=F(Un,this))||void 0===e||e.hide(),W(ei,this,i),D(hi,this,ki).call(this,{hasSelectedText:!0}),(F(Jn,this)===fe.HIGHLIGHT||F(Jn,this)===fe.NONE)&&(F(Jn,this)===fe.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),W(Hn,this,this.isShiftKeyDown),!this.isShiftKeyDown)){const e=F(Jn,this)===fe.HIGHLIGHT?D(hi,this,mi).call(this,s):null;null===e||void 0===e||e.toggleDrawing();const t=new AbortController,n=this.combinedSignal(t),i=n=>{"pointerup"===n.type&&0!==n.button||(t.abort(),null===e||void 0===e||e.toggleDrawing(!0),"pointerup"===n.type&&D(hi,this,vi).call(this,"main_toolbar"))};window.addEventListener("pointerup",i,{signal:n}),window.addEventListener("blur",i,{signal:n})}}else F(ei,this)&&(null===(a=F(Un,this))||void 0===a||a.hide(),W(ei,this,null),D(hi,this,ki).call(this,{hasSelectedText:!1}))}function vi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";F(Jn,this)===fe.HIGHLIGHT?this.highlightSelection(e):F(jn,this)&&D(hi,this,fi).call(this)}function yi(){document.addEventListener("selectionchange",D(hi,this,gi).bind(this),{signal:this._signal})}function bi(){if(F(zn,this))return;W(zn,this,new AbortController);const e=this.combinedSignal(F(zn,this));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}function xi(){var e;null===(e=F(zn,this))||void 0===e||e.abort(),W(zn,this,null)}function wi(){if(F(Yn,this))return;W(Yn,this,new AbortController);const e=this.combinedSignal(F(Yn,this));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}function Ai(){var e;null===(e=F(Yn,this))||void 0===e||e.abort(),W(Yn,this,null)}function _i(){if(F(Tn,this))return;W(Tn,this,new AbortController);const e=this.combinedSignal(F(Tn,this));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}function Si(){var e;null===(e=F(Tn,this))||void 0===e||e.abort(),W(Tn,this,null)}function Ei(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}function ki(e){Object.entries(e).some(e=>{let[t,n]=e;return F(si,this)[t]!==n})&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(F(si,this),e)}),F(Jn,this)===fe.HIGHLIGHT&&!1===e.hasSelectedEditor&&D(hi,this,Ci).call(this,[[ge.HIGHLIGHT_FREE,!0]]))}function Ci(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}async function Ti(){if(!F(Vn,this)){W(Vn,this,!0);const e=[];for(const t of F(An,this).values())e.push(t.enable());await Promise.all(e);for(const t of F(wn,this).values())t.enable()}}function Ni(){if(this.unselectAll(),F(Vn,this)){W(Vn,this,!1);for(const e of F(An,this).values())e.disable();for(const e of F(wn,this).values())e.disable()}}function Mi(e){const t=F(An,this).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}function Ri(e){let t=null;for(t of F(Zn,e));return t}function Ii(){if(0===F(wn,this).size)return!0;if(1===F(wn,this).size)for(const e of F(wn,this).values())return e.isEmpty();return!1}function Pi(e){for(const t of F(Zn,this))t.unselect();F(Zn,this).clear();for(const t of e)t.isEmpty()||(F(Zn,this).add(t),t.select());D(hi,this,ki).call(this,{hasSelectedEditor:this.hasSelection})}o(ui,"TRANSLATE_SMALL",1),o(ui,"TRANSLATE_BIG",10);var Li=new WeakMap,ji=new WeakMap,Di=new WeakMap,Oi=new WeakMap,Fi=new WeakMap,Wi=new WeakMap,zi=new WeakMap,Bi=new WeakMap,Hi=new WeakMap,Ui=new WeakMap,Gi=new WeakMap,Vi=new WeakMap,qi=new WeakSet;class Yi{constructor(e){L(this,qi),j(this,Li,null),j(this,ji,!1),j(this,Di,null),j(this,Oi,null),j(this,Fi,null),j(this,Wi,null),j(this,zi,!1),j(this,Bi,null),j(this,Hi,null),j(this,Ui,null),j(this,Gi,null),j(this,Vi,!1),W(Hi,this,e),W(Vi,this,e._uiManager.useNewAltTextFlow),Qi._||(Qi._=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){var t;null!==(t=Yi._l10n)&&void 0!==t||(Yi._l10n=e)}async render(){const e=W(Di,this,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=W(Oi,this,document.createElement("span"));e.append(t),F(Vi,this)?(e.classList.add("new"),e.setAttribute("data-l10n-id",Qi._.missing),t.setAttribute("data-l10n-id",Qi._["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=F(Hi,this)._uiManager._signal;e.addEventListener("contextmenu",wt,{signal:n}),e.addEventListener("pointerdown",e=>e.stopPropagation(),{signal:n});const i=e=>{e.preventDefault(),F(Hi,this)._uiManager.editAltText(F(Hi,this)),F(Vi,this)&&F(Hi,this)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:O(qi,this,Ki)}})};return e.addEventListener("click",i,{capture:!0,signal:n}),e.addEventListener("keydown",t=>{t.target===e&&"Enter"===t.key&&(W(zi,this,!0),i(t))},{signal:n}),await D(qi,this,Xi).call(this),e}finish(){F(Di,this)&&(F(Di,this).focus({focusVisible:F(zi,this)}),W(zi,this,!1))}isEmpty(){return F(Vi,this)?null===F(Li,this):!F(Li,this)&&!F(ji,this)}hasData(){return F(Vi,this)?null!==F(Li,this)||!!F(Ui,this):this.isEmpty()}get guessedText(){return F(Ui,this)}async setGuessedText(e){null===F(Li,this)&&(W(Ui,this,e),W(Gi,this,await Yi._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),D(qi,this,Xi).call(this))}toggleAltTextBadge(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t;if(!F(Vi,this)||F(Li,this))return null===(t=F(Bi,this))||void 0===t||t.remove(),void W(Bi,this,null);if(!F(Bi,this)){const e=W(Bi,this,document.createElement("div"));e.className="noAltTextBadge",F(Hi,this).div.append(e)}F(Bi,this).classList.toggle("hidden",!e)}serialize(e){let t=F(Li,this);return e||F(Ui,this)!==t||(t=F(Gi,this)),{altText:t,decorative:F(ji,this),guessedText:F(Ui,this),textWithDisclaimer:F(Gi,this)}}get data(){return{altText:F(Li,this),decorative:F(ji,this)}}set data(e){let{altText:t,decorative:n,guessedText:i,textWithDisclaimer:s,cancel:a=!1}=e;i&&(W(Ui,this,i),W(Gi,this,s)),F(Li,this)===t&&F(ji,this)===n||(a||(W(Li,this,t),W(ji,this,n)),D(qi,this,Xi).call(this))}toggle(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];F(Di,this)&&(!e&&F(Wi,this)&&(clearTimeout(F(Wi,this)),W(Wi,this,null)),F(Di,this).disabled=!e)}shown(){F(Hi,this)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:O(qi,this,Ki)}})}destroy(){var e,t;null===(e=F(Di,this))||void 0===e||e.remove(),W(Di,this,null),W(Oi,this,null),W(Fi,this,null),null===(t=F(Bi,this))||void 0===t||t.remove(),W(Bi,this,null)}}function Ki(e){return(F(Li,e)?"added":null===F(Li,e)&&e.guessedText&&"review")||"missing"}async function Xi(){const e=F(Di,this);if(!e)return;if(F(Vi,this)){var t,n;if(e.classList.toggle("done",!!F(Li,this)),e.setAttribute("data-l10n-id",Qi._[O(qi,this,Ki)]),null===(t=F(Oi,this))||void 0===t||t.setAttribute("data-l10n-id",Qi._["".concat(O(qi,this,Ki),"-label")]),!F(Li,this))return void(null===(n=F(Fi,this))||void 0===n||n.remove())}else{var i;if(!F(Li,this)&&!F(ji,this))return e.classList.remove("done"),void(null===(i=F(Fi,this))||void 0===i||i.remove());e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let s=F(Fi,this);if(!s){W(Fi,this,s=document.createElement("span")),s.className="tooltip",s.setAttribute("role","tooltip"),s.id="alt-text-tooltip-".concat(F(Hi,this).id);const t=100,n=F(Hi,this)._uiManager._signal;n.addEventListener("abort",()=>{clearTimeout(F(Wi,this)),W(Wi,this,null)},{once:!0}),e.addEventListener("mouseenter",()=>{W(Wi,this,setTimeout(()=>{W(Wi,this,null),F(Fi,this).classList.add("show"),F(Hi,this)._reportTelemetry({action:"alt_text_tooltip"})},t))},{signal:n}),e.addEventListener("mouseleave",()=>{var e;F(Wi,this)&&(clearTimeout(F(Wi,this)),W(Wi,this,null)),null===(e=F(Fi,this))||void 0===e||e.classList.remove("show")},{signal:n})}F(ji,this)?s.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(s.removeAttribute("data-l10n-id"),s.textContent=F(Li,this)),s.parentNode||e.append(s);const a=F(Hi,this).getElementForAltText();null===a||void 0===a||a.setAttribute("aria-describedby",s.id)}var Qi={_:null};o(Yi,"_l10n",null);var $i=new WeakMap,Ji=new WeakMap,Zi=new WeakMap,es=new WeakMap,ts=new WeakMap,ns=new WeakMap,is=new WeakMap;class ss{constructor(e){j(this,$i,null),j(this,Ji,!1),j(this,Zi,null),j(this,es,null),j(this,ts,null),j(this,ns,null),j(this,is,!1),W(Zi,this,e),this.toolbar=null}render(){if(!F(Zi,this)._uiManager.hasCommentManager())return null;const e=W($i,this,document.createElement("button"));e.className="comment",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button");const t=F(Zi,this)._uiManager._signal;e.addEventListener("contextmenu",wt,{signal:t}),e.addEventListener("pointerdown",e=>e.stopPropagation(),{signal:t});const n=e=>{e.preventDefault(),this.edit()};return e.addEventListener("click",n,{capture:!0,signal:t}),e.addEventListener("keydown",t=>{t.target===e&&"Enter"===t.key&&(W(Ji,this,!0),n(t))},{signal:t}),e}edit(){const{bottom:e,left:t,right:n}=F(Zi,this).getClientDimensions(),i={top:e};"ltr"===F(Zi,this)._uiManager.direction?i.right=n:i.left=t,F(Zi,this)._uiManager.editComment(F(Zi,this),i)}finish(){F($i,this)&&(F($i,this).focus({focusVisible:F(Ji,this)}),W(Ji,this,!1))}isDeleted(){return F(is,this)||""===F(ts,this)}hasBeenEdited(){return this.isDeleted()||F(ts,this)!==F(es,this)}serialize(){return this.data}get data(){return{text:F(ts,this),date:F(ns,this),deleted:F(is,this)}}set data(e){if(null===e)return W(ts,this,""),void W(is,this,!0);W(ts,this,e),W(ns,this,new Date),W(is,this,!1)}setInitialText(e){W(es,this,e),this.data=e}toggle(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];F($i,this)&&(F($i,this).disabled=!e)}shown(){}destroy(){var e;null===(e=F($i,this))||void 0===e||e.remove(),W($i,this,null),W(ts,this,""),W(ns,this,null),W(Zi,this,null),W(Ji,this,!1),W(is,this,!1)}}var as=new WeakMap,rs=new WeakMap,os=new WeakMap,ls=new WeakMap,cs=new WeakMap,ds=new WeakMap,hs=new WeakMap,us=new WeakMap,ps=new WeakMap,ms=new WeakMap,fs=new WeakMap,gs=new WeakMap,vs=new WeakSet;class ys{constructor(e){let{container:t,isPinchingDisabled:n=null,isPinchingStopped:i=null,onPinchStart:s=null,onPinching:a=null,onPinchEnd:r=null,signal:o}=e;L(this,vs),j(this,as,void 0),j(this,rs,!1),j(this,os,null),j(this,ls,void 0),j(this,cs,void 0),j(this,ds,void 0),j(this,hs,void 0),j(this,us,null),j(this,ps,void 0),j(this,ms,null),j(this,fs,void 0),j(this,gs,null),W(as,this,t),W(os,this,i),W(ls,this,n),W(cs,this,s),W(ds,this,a),W(hs,this,r),W(fs,this,new AbortController),W(ps,this,AbortSignal.any([o,F(fs,this).signal])),t.addEventListener("touchstart",D(vs,this,bs).bind(this),{passive:!1,signal:F(ps,this)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Nt.pixelRatio}destroy(){var e,t;null===(e=F(fs,this))||void 0===e||e.abort(),W(fs,this,null),null===(t=F(us,this))||void 0===t||t.abort(),W(us,this,null)}}function bs(e){var t,n;if(null!==(t=F(ls,this))&&void 0!==t&&t.call(this))return;if(1===e.touches.length){if(F(us,this))return;const e=W(us,this,new AbortController),t=AbortSignal.any([F(ps,this),e.signal]),n=F(as,this),i={capture:!0,signal:t,passive:!1},s=e=>{var t;"touch"===e.pointerType&&(null===(t=F(us,this))||void 0===t||t.abort(),W(us,this,null))};return n.addEventListener("pointerdown",e=>{"touch"===e.pointerType&&(At(e),s(e))},i),n.addEventListener("pointerup",s,i),void n.addEventListener("pointercancel",s,i)}if(!F(gs,this)){var i;W(gs,this,new AbortController);const e=AbortSignal.any([F(ps,this),F(gs,this).signal]),t=F(as,this),n={signal:e,capture:!1,passive:!1};t.addEventListener("touchmove",D(vs,this,xs).bind(this),n);const s=D(vs,this,ws).bind(this);t.addEventListener("touchend",s,n),t.addEventListener("touchcancel",s,n),n.capture=!0,t.addEventListener("pointerdown",At,n),t.addEventListener("pointermove",At,n),t.addEventListener("pointercancel",At,n),t.addEventListener("pointerup",At,n),null===(i=F(cs,this))||void 0===i||i.call(this)}if(At(e),2!==e.touches.length||null!==(n=F(os,this))&&void 0!==n&&n.call(this))return void W(ms,this,null);let[s,a]=e.touches;s.identifier>a.identifier&&([s,a]=[a,s]),W(ms,this,{touch0X:s.screenX,touch0Y:s.screenY,touch1X:a.screenX,touch1Y:a.screenY})}function xs(e){var t;if(!F(ms,this)||2!==e.touches.length)return;At(e);let[n,i]=e.touches;n.identifier>i.identifier&&([n,i]=[i,n]);const{screenX:s,screenY:a}=n,{screenX:r,screenY:o}=i,l=F(ms,this),{touch0X:c,touch0Y:d,touch1X:h,touch1Y:u}=l,p=h-c,m=u-d,f=r-s,g=o-a,v=Math.hypot(f,g)||1,y=Math.hypot(p,m)||1;if(!F(rs,this)&&Math.abs(y-v)<=G.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=s,l.touch0Y=a,l.touch1X=r,l.touch1Y=o,!F(rs,this))return void W(rs,this,!0);const b=[(s+r)/2,(a+o)/2];null===(t=F(ds,this))||void 0===t||t.call(this,b,y,v)}function ws(e){if(!(e.touches.length>=2)){var t;if(F(gs,this))F(gs,this).abort(),W(gs,this,null),null===(t=F(hs,this))||void 0===t||t.call(this);F(ms,this)&&(At(e),W(ms,this,null),W(rs,this,!1))}}G=ys;var As=new WeakMap,_s=new WeakMap,Ss=new WeakMap,Es=new WeakMap,ks=new WeakMap,Cs=new WeakMap,Ts=new WeakMap,Ns=new WeakMap,Ms=new WeakMap,Rs=new WeakMap,Is=new WeakMap,Ps=new WeakMap,Ls=new WeakMap,js=new WeakMap,Ds=new WeakMap,Os=new WeakMap,Fs=new WeakMap,Ws=new WeakMap,zs=new WeakMap,Bs=new WeakMap,Hs=new WeakMap,Us=new WeakMap,Gs=new WeakMap,Vs=new WeakMap,qs=new WeakMap,Ys=new WeakSet;class Ks{static get _resizerKeyboardManager(){const e=Ks.prototype._resizeWithKeyboard,t=ui.TRANSLATE_SMALL,n=ui.TRANSLATE_BIG;return Ve(this,"_resizerKeyboardManager",new gn([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],Ks.prototype._stopResizingWithKeyboard]]))}constructor(e){L(this,Ys),j(this,As,null),j(this,_s,null),j(this,Ss,null),j(this,Es,null),j(this,ks,!1),j(this,Cs,null),j(this,Ts,""),j(this,Ns,!1),j(this,Ms,null),j(this,Rs,null),j(this,Is,null),j(this,Ps,null),j(this,Ls,""),j(this,js,!1),j(this,Ds,null),j(this,Os,!1),j(this,Fs,!1),j(this,Ws,!1),j(this,zs,null),j(this,Bs,0),j(this,Hs,0),j(this,Us,null),j(this,Gs,null),o(this,"isSelected",!1),o(this,"_isCopy",!1),o(this,"_editToolbar",null),o(this,"_initialOptions",Object.create(null)),o(this,"_initialData",null),o(this,"_isVisible",!0),o(this,"_uiManager",null),o(this,"_focusEventsAllowed",!0),j(this,Vs,!1),j(this,qs,Ks._zIndex++),this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null;const{rotation:t,rawDims:{pageWidth:n,pageHeight:i,pageX:s,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,i],this.pageTranslation=[s,a];const[r,l]=this.parentDimensions;this.x=e.x/r,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Ve(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new ma({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){var n;if(null!==(n=Ks._l10n)&&void 0!==n||(Ks._l10n=e),Ks._l10nResizer||(Ks._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),-1!==Ks._borderLineWidth)return;const i=getComputedStyle(document.documentElement);Ks._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Be("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return F(Vs,this)}set _isDraggable(e){var t;W(Vs,this,e),null===(t=this.div)||void 0===t||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(2*e),this.y+=this.width*e/(2*t);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(2*e),this.y-=this.width*e/(2*t);break;default:this.x-=this.width/2,this.y-=this.height/2}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=F(qs,this)}setParent(e){null!==e?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):D(Ys,this,pa).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(F(js,this)?W(js,this,!1):this.parent.setSelected(this))}focusout(e){var t;if(!this._focusEventsAllowed)return;if(!this.isAttachedToDOM)return;const n=e.relatedTarget;null!==n&&void 0!==n&&n.closest("#".concat(this.id))||(e.preventDefault(),null!==(t=this.parent)&&void 0!==t&&t.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,i){const[s,a]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(e+n)/s,this.y=(t+i)/a,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[n,i]=this.parentDimensions;this.setAt(e*n,t*i,this.width*n,this.height*i),this._onTranslated()}translate(e,t){D(Ys,this,Xs).call(this,this.parentDimensions,e,t)}translateInPage(e,t){F(Ds,this)||W(Ds,this,[this.x,this.y,this.width,this.height]),D(Ys,this,Xs).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){F(Ds,this)||W(Ds,this,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[i,s]}=this;if(this.x+=e/i,this.y+=t/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:e,y:t}=this.div.getBoundingClientRect();this.parent.findNewParent(this,e,t)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:r}=this;const[o,l]=this.getBaseTranslation();a+=o,r+=l;const{style:c}=n;c.left="".concat((100*a).toFixed(2),"%"),c.top="".concat((100*r).toFixed(2),"%"),this._onTranslating(a,r),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!F(Ds,this)&&(F(Ds,this)[0]!==this.x||F(Ds,this)[1]!==this.y)}get _hasBeenResized(){return!!F(Ds,this)&&(F(Ds,this)[2]!==this.width||F(Ds,this)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=Ks,i=n/e,s=n/t;switch(this.rotation){case 90:return[-i,s];case 180:return[i,s];case 270:return[i,-s];default:return[-i,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.rotation;const{div:{style:t},pageDimensions:[n,i]}=this;let{x:s,y:a,width:r,height:o}=this;if(r*=n,o*=i,s*=n,a*=i,this._mustFixPosition)switch(e){case 0:s=dt(s,0,n-r),a=dt(a,0,i-o);break;case 90:s=dt(s,0,n-o),a=dt(a,r,i);break;case 180:s=dt(s,r,n),a=dt(a,o,i);break;case 270:s=dt(s,o,n),a=dt(a,0,i-r)}this.x=s/=n,this.y=a/=i;const[l,c]=this.getBaseTranslation();s+=l,a+=c,t.left="".concat((100*s).toFixed(2),"%"),t.top="".concat((100*a).toFixed(2),"%"),this.moveInDOM()}screenToPageTranslation(e,t){return Qs.call(Ks,e,t,this.parentRotation)}pageTranslationToScreen(e,t){return Qs.call(Ks,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(e,t){const[n,i]=this.parentDimensions,{style:s}=this.div;s.width="".concat((100*e/n).toFixed(2),"%"),F(Ns,this)||(s.height="".concat((100*t/i).toFixed(2),"%"))}fixDims(){const{style:e}=this.div,{height:t,width:n}=e,i=n.endsWith("%"),s=!F(Ns,this)&&t.endsWith("%");if(i&&s)return;const[a,r]=this.parentDimensions;i||(e.width="".concat((100*parseFloat(n)/a).toFixed(2),"%")),F(Ns,this)||s||(e.height="".concat((100*parseFloat(t)/r).toFixed(2),"%"))}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(1e4*e)/1e4}_onResizing(){}altTextFinish(){var e;null===(e=F(Ss,this))||void 0===e||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||F(Fs,this))return this._editToolbar;this._editToolbar=new Wt(this),this.div.append(this._editToolbar.render()),this._editToolbar.addButton("comment",this.addCommentButton());const{toolbarButtons:e}=this;if(e)for(const[t,n]of e)await this._editToolbar.addButton(t,n);return this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,null===(e=F(Ss,this))||void 0===e||e.destroy())}addContainer(e){var t;const n=null===(t=this._editToolbar)||void 0===t?void 0:t.div;n?n.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return F(Ss,this)||(Yi.initialize(Ks._l10n),W(Ss,this,new Yi(this)),F(As,this)&&(F(Ss,this).data=F(As,this),W(As,this,null))),F(Ss,this)}get altTextData(){var e;return null===(e=F(Ss,this))||void 0===e?void 0:e.data}set altTextData(e){F(Ss,this)&&(F(Ss,this).data=e)}get guessedAltText(){var e;return null===(e=F(Ss,this))||void 0===e?void 0:e.guessedText}async setGuessedAltText(e){var t;await(null===(t=F(Ss,this))||void 0===t?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return null===(t=F(Ss,this))||void 0===t?void 0:t.serialize(e)}hasAltText(){return!!F(Ss,this)&&!F(Ss,this).isEmpty()}hasAltTextData(){var e,t;return null!==(e=null===(t=F(Ss,this))||void 0===t?void 0:t.hasData())&&void 0!==e&&e}addCommentButton(){return F(Es,this)?F(Es,this):W(Es,this,new ss(this))}get commentColor(){return null}get comment(){const e=F(Es,this);return{text:e.data.text,date:e.data.date,deleted:e.isDeleted(),color:this.commentColor}}set comment(e){F(Es,this)||W(Es,this,new ss(this)),F(Es,this).data=e}setCommentData(e){F(Es,this)||W(Es,this,new ss(this)),F(Es,this).setInitialText(e)}get hasEditedComment(){var e;return null===(e=F(Es,this))||void 0===e?void 0:e.hasBeenEdited()}async editComment(){F(Es,this)||W(Es,this,new ss(this)),F(Es,this).edit()}addComment(e){this.hasEditedComment&&(e.popup={contents:this.comment.text,deleted:this.comment.deleted})}render(){var e;const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=F(ks,this)?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),D(Ys,this,la).call(this);const[n,i]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth="".concat((100*i/n).toFixed(2),"%"),t.style.maxHeight="".concat((100*n/i).toFixed(2),"%"));const[s,a]=this.getInitialTranslation();return this.translate(s,a),en(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(F(Gs,this)||W(Gs,this,new ys({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:D(Ys,this,ia).bind(this),onPinching:D(Ys,this,sa).bind(this),onPinchEnd:D(Ys,this,aa).bind(this),signal:this._uiManager._signal}))),null===(e=this._uiManager._editorUndoBar)||void 0===e||e.hide(),t}pointerdown(e){const{isMac:t}=tt.platform;0!==e.button||e.ctrlKey&&t?e.preventDefault():(W(js,this,!0),this._isDraggable?D(Ys,this,oa).call(this,e):D(Ys,this,ra).call(this,e))}_onStartDragging(){}_onStopDragging(){}moveInDOM(){F(zs,this)&&clearTimeout(F(zs,this)),W(zs,this,setTimeout(()=>{var e;W(zs,this,null),null===(e=this.parent)||void 0===e||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.rotation;const i=this.parentScale,[s,a]=this.pageDimensions,[r,o]=this.pageTranslation,l=e/i,c=t/i,d=this.x*s,h=this.y*a,u=this.width*s,p=this.height*a;switch(n){case 0:return[d+l+r,a-h-c-p+o,d+l+u+r,a-h-c+o];case 90:return[d+c+r,a-h+l+o,d+c+p+r,a-h+l+u+o];case 180:return[d-l-u+r,a-h+c+o,d-l+r,a-h+c+p+o];case 270:return[d-c-p+r,a-h-l-u+o,d-c+r,a-h-l+o];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,i,s,a]=e,r=s-n,o=a-i;switch(this.rotation){case 0:return[n,t-a,r,o];case 90:return[n,t-i,o,r];case 180:return[s,t-i,r,o];case 270:return[s,t-a,o,r];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return!this.isInEditMode()&&(this.parent.setEditingState(!1),W(Fs,this,!0),!0)}disableEditMode(){return!!this.isInEditMode()&&(this.parent.setEditingState(!0),W(Fs,this,!1),!0)}isInEditMode(){return F(Fs,this)}shouldGetKeyboardEvents(){return F(Ws,this)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:i}=this.getClientDimensions(),{innerHeight:s,innerWidth:a}=window;return t<a&&i>0&&e<s&&n>0}rebuild(){D(Ys,this,la).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:(null===(e=this._initialData)||void 0===e?void 0:e.popupRef)||""}}serialize(){Be("An editor must be serializable")}static async deserialize(e,t,n){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId});i.rotation=e.rotation,W(As,i,e.accessibilityData),i._isCopy=e.isCopy||!1;const[s,a]=i.pageDimensions,[r,o,l,c]=i.getRectInCurrentCoords(e.rect,a);return i.x=r/s,i.y=o/a,i.width=l/s,i.height=c/a,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||null!==this.serialize())}remove(){var e,t;if(null===(e=F(Ps,this))||void 0===e||e.abort(),W(Ps,this,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),F(zs,this)&&(clearTimeout(F(zs,this)),W(zs,this,null)),D(Ys,this,pa).call(this),this.removeEditToolbar(),F(Us,this)){for(const e of F(Us,this).values())clearTimeout(e);W(Us,this,null)}this.parent=null,null===(t=F(Gs,this))||void 0===t||t.destroy(),W(Gs,this,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(D(Ys,this,Js).call(this),F(Ms,this).classList.remove("hidden"))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||"Enter"!==e.key)return;this._uiManager.setSelected(this),W(Is,this,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=F(Ms,this).children;if(!F(_s,this)){W(_s,this,Array.from(t));const e=D(Ys,this,ca).bind(this),n=D(Ys,this,da).bind(this),i=this._uiManager._signal;for(const t of F(_s,this)){const s=t.getAttribute("data-resizer-name");t.setAttribute("role","spinbutton"),t.addEventListener("keydown",e,{signal:i}),t.addEventListener("blur",n,{signal:i}),t.addEventListener("focus",D(Ys,this,ha).bind(this,s),{signal:i}),t.setAttribute("data-l10n-id",Ks._l10nResizer[s])}}const n=F(_s,this)[0];let i=0;for(const a of t){if(a===n)break;i++}const s=(360-this.rotation+this.parentRotation)%360/90*(F(_s,this).length/4);if(s!==i){if(s<i)for(let t=0;t<i-s;t++)F(Ms,this).append(F(Ms,this).firstChild);else if(s>i)for(let t=0;t<s-i;t++)F(Ms,this).firstChild.before(F(Ms,this).lastChild);let e=0;for(const n of t){const t=F(_s,this)[e++].getAttribute("data-resizer-name");n.setAttribute("data-l10n-id",Ks._l10nResizer[t])}}D(Ys,this,ua).call(this,0),W(Ws,this,!0),F(Ms,this).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){F(Ws,this)&&D(Ys,this,na).call(this,F(Ls,this),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){D(Ys,this,pa).call(this),this.div.focus()}select(){var e,t,n;this.isSelected&&this._editToolbar||(this.isSelected=!0,this.makeResizable(),null===(e=this.div)||void 0===e||e.classList.add("selectedEditor"),this._editToolbar?(null===(t=this._editToolbar)||void 0===t||t.show(),null===(n=F(Ss,this))||void 0===n||n.toggleAltTextBadge(!1)):this.addEditToolbar().then(()=>{var e,t;null!==(e=this.div)&&void 0!==e&&e.classList.contains("selectedEditor")&&(null===(t=this._editToolbar)||void 0===t||t.show())}))}unselect(){var e,t,n,i,s;this.isSelected&&(this.isSelected=!1,null===(e=F(Ms,this))||void 0===e||e.classList.add("hidden"),null===(t=this.div)||void 0===t||t.classList.remove("selectedEditor"),null!==(n=this.div)&&void 0!==n&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),null===(i=this._editToolbar)||void 0===i||i.hide(),null===(s=F(Ss,this))||void 0===s||s.toggleAltTextBadge(!0))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return F(Os,this)}set isEditing(e){W(Os,this,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){W(Ns,this,!0);const n=e/t,{style:i}=this.div;i.aspectRatio=n,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){F(Us,this)||W(Us,this,new Map);const{action:t}=e;let n=F(Us,this).get(t);return n&&clearTimeout(n),n=setTimeout(()=>{this._reportTelemetry(e),F(Us,this).delete(t),0===F(Us,this).size&&W(Us,this,null)},Ks._telemetryTimeout),void F(Us,this).set(t,n)}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._isVisible;this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),W(ks,this,!1)}disable(){this.div&&(this.div.tabIndex=-1),W(ks,this,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(t){if("CANVAS"===t.nodeName){const e=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.before(t)}}else t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);return t}resetAnnotationElement(e){const{firstChild:t}=e.container;"DIV"===(null===t||void 0===t?void 0:t.nodeName)&&t.classList.contains("annotationContent")&&t.remove()}}function Xs(e,t,n){let[i,s]=e;[t,n]=this.screenToPageTranslation(t,n),this.x+=t/i,this.y+=n/s,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}function Qs(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}function $s(e){switch(e){case 90:{const[e,t]=this.pageDimensions;return[0,-e/t,t/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,t]=this.pageDimensions;return[0,e/t,-t/e,0]}default:return[1,0,0,1]}}function Js(){if(F(Ms,this))return;W(Ms,this,document.createElement("div")),F(Ms,this).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const e=document.createElement("div");F(Ms,this).append(e),e.classList.add("resizer",n),e.setAttribute("data-resizer-name",n),e.addEventListener("pointerdown",D(Ys,this,Zs).bind(this,n),{signal:t}),e.addEventListener("contextmenu",wt,{signal:t}),e.tabIndex=-1}this.div.prepend(F(Ms,this))}function Zs(e,t){var n;t.preventDefault();const{isMac:i}=tt.platform;if(0!==t.button||t.ctrlKey&&i)return;null===(n=F(Ss,this))||void 0===n||n.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,W(Rs,this,[t.screenX,t.screenY]);const a=new AbortController,r=this._uiManager.combinedSignal(a);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",D(Ys,this,na).bind(this,e),{passive:!0,capture:!0,signal:r}),window.addEventListener("touchmove",At,{passive:!1,signal:r}),window.addEventListener("contextmenu",wt,{signal:r}),W(Is,this,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const c=()=>{var e;a.abort(),this.parent.togglePointerEvents(!0),null===(e=F(Ss,this))||void 0===e||e.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=o,this.div.style.cursor=l,D(Ys,this,ta).call(this)};window.addEventListener("pointerup",c,{signal:r}),window.addEventListener("blur",c,{signal:r})}function ea(e,t,n,i){this.width=n,this.height=i,this.x=e,this.y=t;const[s,a]=this.parentDimensions;this.setDims(s*n,a*i),this.fixAndSetPosition(),this._onResized()}function ta(){if(!F(Is,this))return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:i}=F(Is,this);W(Is,this,null);const s=this.x,a=this.y,r=this.width,o=this.height;s===e&&a===t&&r===n&&o===i||this.addCommands({cmd:D(Ys,this,ea).bind(this,s,a,r,o),undo:D(Ys,this,ea).bind(this,e,t,n,i),mustExec:!0})}function na(e,t){const[n,i]=this.parentDimensions,s=this.x,a=this.y,r=this.width,o=this.height,l=V.MIN_SIZE/n,c=V.MIN_SIZE/i,d=D(Ys,this,$s).call(this,this.rotation),h=(e,t)=>[d[0]*e+d[2]*t,d[1]*e+d[3]*t],u=D(Ys,this,$s).call(this,360-this.rotation);let p,m,f=!1,g=!1;switch(e){case"topLeft":f=!0,p=(e,t)=>[0,0],m=(e,t)=>[e,t];break;case"topMiddle":p=(e,t)=>[e/2,0],m=(e,t)=>[e/2,t];break;case"topRight":f=!0,p=(e,t)=>[e,0],m=(e,t)=>[0,t];break;case"middleRight":g=!0,p=(e,t)=>[e,t/2],m=(e,t)=>[0,t/2];break;case"bottomRight":f=!0,p=(e,t)=>[e,t],m=(e,t)=>[0,0];break;case"bottomMiddle":p=(e,t)=>[e/2,t],m=(e,t)=>[e/2,0];break;case"bottomLeft":f=!0,p=(e,t)=>[0,t],m=(e,t)=>[e,0];break;case"middleLeft":g=!0,p=(e,t)=>[0,t/2],m=(e,t)=>[e,t/2]}const v=p(r,o),y=m(r,o);let b=h(...y);const x=V._round(s+b[0]),w=V._round(a+b[1]);let A,_,S=1,E=1;if(t.fromKeyboard)({deltaX:A,deltaY:_}=t);else{const{screenX:e,screenY:n}=t,[i,s]=F(Rs,this);[A,_]=this.screenToPageTranslation(e-i,n-s),F(Rs,this)[0]=e,F(Rs,this)[1]=n}var k,C;if([A,_]=(k=A/n,C=_/i,[u[0]*k+u[2]*C,u[1]*k+u[3]*C]),f){const e=Math.hypot(r,o);S=E=Math.max(Math.min(Math.hypot(y[0]-v[0]-A,y[1]-v[1]-_)/e,1/r,1/o),l/r,c/o)}else g?S=dt(Math.abs(y[0]-v[0]-A),l,1)/r:E=dt(Math.abs(y[1]-v[1]-_),c,1)/o;const T=V._round(r*S),N=V._round(o*E);b=h(...m(T,N));const M=x-b[0],R=w-b[1];F(Ds,this)||W(Ds,this,[this.x,this.y,this.width,this.height]),this.width=T,this.height=N,this.x=M,this.y=R,this.setDims(n*T,i*N),this.fixAndSetPosition(),this._onResizing()}function ia(){var e;W(Is,this,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),null===(e=F(Ss,this))||void 0===e||e.toggle(!1),this.parent.togglePointerEvents(!1)}function sa(e,t,n){let i=n/t*.7+1-.7;if(1===i)return;const s=D(Ys,this,$s).call(this,this.rotation),a=(e,t)=>[s[0]*e+s[2]*t,s[1]*e+s[3]*t],[r,o]=this.parentDimensions,l=this.x,c=this.y,d=this.width,h=this.height,u=V.MIN_SIZE/r,p=V.MIN_SIZE/o;i=Math.max(Math.min(i,1/d,1/h),u/d,p/h);const m=V._round(d*i),f=V._round(h*i);if(m===d&&f===h)return;F(Ds,this)||W(Ds,this,[l,c,d,h]);const g=a(d/2,h/2),v=V._round(l+g[0]),y=V._round(c+g[1]),b=a(m/2,f/2);this.x=v-b[0],this.y=y-b[1],this.width=m,this.height=f,this.setDims(r*m,o*f),this.fixAndSetPosition(),this._onResizing()}function aa(){var e;null===(e=F(Ss,this))||void 0===e||e.toggle(!0),this.parent.togglePointerEvents(!0),D(Ys,this,ta).call(this)}function ra(e){const{isMac:t}=tt.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}function oa(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const i=new AbortController,s=this._uiManager.combinedSignal(i),a={capture:!0,passive:!1,signal:s},r=e=>{i.abort(),W(Cs,this,null),W(js,this,!1),this._uiManager.endDragSession()||D(Ys,this,ra).call(this,e),n&&this._onStopDragging()};t&&(W(Bs,this,e.clientX),W(Hs,this,e.clientY),W(Cs,this,e.pointerId),W(Ts,this,e.pointerType),window.addEventListener("pointermove",e=>{n||(n=!0,this._onStartDragging());const{clientX:t,clientY:i,pointerId:s}=e;if(s!==F(Cs,this))return void At(e);const[a,r]=this.screenToPageTranslation(t-F(Bs,this),i-F(Hs,this));W(Bs,this,t),W(Hs,this,i),this._uiManager.dragSelectedEditors(a,r)},a),window.addEventListener("touchmove",At,a),window.addEventListener("pointerdown",e=>{e.pointerType===F(Ts,this)&&(F(Gs,this)||e.isPrimary)&&r(e),At(e)},a));const o=e=>{F(Cs,this)&&F(Cs,this)!==e.pointerId?At(e):r(e)};window.addEventListener("pointerup",o,{signal:s}),window.addEventListener("blur",o,{signal:s})}function la(){if(F(Ps,this)||!this.div)return;W(Ps,this,new AbortController);const e=this._uiManager.combinedSignal(F(Ps,this));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}function ca(e){V._resizerKeyboardManager.exec(this,e)}function da(e){var t;F(Ws,this)&&(null===(t=e.relatedTarget)||void 0===t?void 0:t.parentNode)!==F(Ms,this)&&D(Ys,this,pa).call(this)}function ha(e){W(Ls,this,F(Ws,this)?e:"")}function ua(e){if(F(_s,this))for(const t of F(_s,this))t.tabIndex=e}function pa(){W(Ws,this,!1),D(Ys,this,ua).call(this,-1),D(Ys,this,ta).call(this)}V=Ks,o(Ks,"_l10n",null),o(Ks,"_l10nResizer",null),o(Ks,"_borderLineWidth",-1),o(Ks,"_colorManager",new yn),o(Ks,"_zIndex",1),o(Ks,"_telemetryTimeout",1e3);class ma extends Ks{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const fa=3285377520,ga=4294901760,va=65535;class ya{constructor(e){this.h1=e?4294967295&e:fa,this.h2=e?4294967295&e:fa}update(e){let t,n;if("string"===typeof e){t=new Uint8Array(2*e.length),n=0;for(let i=0,s=e.length;i<s;i++){const s=e.charCodeAt(i);s<=255?t[n++]=s:(t[n++]=s>>>8,t[n++]=255&s)}}else{if(!ArrayBuffer.isView(e))throw new Error("Invalid data format, must be a string or TypedArray.");t=e.slice(),n=t.byteLength}const i=n>>2,s=n-4*i,a=new Uint32Array(t.buffer,0,i);let r=0,o=0,l=this.h1,c=this.h2;const d=3432918353,h=461845907,u=11601,p=13715;for(let m=0;m<i;m++)1&m?(r=a[m],r=r*d&ga|r*u&va,r=r<<15|r>>>17,r=r*h&ga|r*p&va,l^=r,l=l<<13|l>>>19,l=5*l+3864292196):(o=a[m],o=o*d&ga|o*u&va,o=o<<15|o>>>17,o=o*h&ga|o*p&va,c^=o,c=c<<13|c>>>19,c=5*c+3864292196);switch(r=0,s){case 3:r^=t[4*i+2]<<16;case 2:r^=t[4*i+1]<<8;case 1:r^=t[4*i],r=r*d&ga|r*u&va,r=r<<15|r>>>17,r=r*h&ga|r*p&va,1&i?l^=r:c^=r}this.h1=l,this.h2=c}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=3981806797*e&ga|36045*e&va,t=4283543511*t&ga|(2950163797*(t<<16|e>>>16)&ga)>>>16,e^=t>>>1,e=444984403*e&ga|60499*e&va,t=3301882366*t&ga|(3120437893*(t<<16|e>>>16)&ga)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const ba=Object.freeze({map:null,hash:"",transfer:void 0});var xa=new WeakMap,wa=new WeakMap,Aa=new WeakMap,_a=new WeakSet;class Sa{constructor(){L(this,_a),j(this,xa,!1),j(this,wa,null),j(this,Aa,new Map),this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=F(Aa,this).get(e);return void 0===n?t:Object.assign(t,n)}getRawValue(e){return F(Aa,this).get(e)}remove(e){if(F(Aa,this).delete(e),0===F(Aa,this).size&&this.resetModified(),"function"===typeof this.onAnnotationEditor){for(const e of F(Aa,this).values())if(e instanceof Ks)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=F(Aa,this).get(e);let i=!1;if(void 0!==n)for(const[s,a]of Object.entries(t))n[s]!==a&&(i=!0,n[s]=a);else i=!0,F(Aa,this).set(e,t);i&&D(_a,this,Ea).call(this),t instanceof Ks&&"function"===typeof this.onAnnotationEditor&&this.onAnnotationEditor(t.constructor._type)}has(e){return F(Aa,this).has(e)}get size(){return F(Aa,this).size}resetModified(){F(xa,this)&&(W(xa,this,!1),"function"===typeof this.onResetModified&&this.onResetModified())}get print(){return new Ca(this)}get serializable(){if(0===F(Aa,this).size)return ba;const e=new Map,t=new ya,n=[],i=Object.create(null);let s=!1;for(const[a,r]of F(Aa,this)){const n=r instanceof Ks?r.serialize(!1,i):r;n&&(e.set(a,n),t.update("".concat(a,":").concat(JSON.stringify(n))),s||(s=!!n.bitmap))}if(s)for(const a of e.values())a.bitmap&&n.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:ba}get editorStats(){let e=null;const t=new Map;for(const s of F(Aa,this).values()){var n;if(!(s instanceof Ks))continue;const a=s.telemetryFinalData;if(!a)continue;const{type:r}=a;t.has(r)||t.set(r,Object.getPrototypeOf(s).constructor),e||(e=Object.create(null));const o=(n=e)[r]||(n[r]=new Map);for(const[e,t]of Object.entries(a)){var i;if("type"===e)continue;let n=o.get(e);n||(n=new Map,o.set(e,n));const s=null!==(i=n.get(t))&&void 0!==i?i:0;n.set(t,s+1)}}for(const[s,a]of t)e[s]=a.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){W(wa,this,null)}get modifiedIds(){if(F(wa,this))return F(wa,this);const e=[];for(const t of F(Aa,this).values())t instanceof Ks&&t.annotationElementId&&t.serialize()&&e.push(t.annotationElementId);return W(wa,this,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return F(Aa,this).entries()}}function Ea(){F(xa,this)||(W(xa,this,!0),"function"===typeof this.onSetModified&&this.onSetModified())}var ka=new WeakMap;class Ca extends Sa{constructor(e){super(),j(this,ka,void 0);const{map:t,hash:n,transfer:i}=e.serializable,s=structuredClone(t,i?{transfer:i}:null);W(ka,this,{map:s,hash:n,transfer:i})}get print(){Be("Should not call PrintAnnotationStorage.print")}get serializable(){return F(ka,this)}get modifiedIds(){return Ve(this,"modifiedIds",{ids:new Set,hash:""})}}var Ta=new WeakMap;class Na{constructor(e){let{ownerDocument:t=globalThis.document,styleElement:n=null}=e;j(this,Ta,new Set),this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),F(Ta,this).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(e){let{systemFontInfo:t,disableFontFace:n,_inspectFont:i}=e;if(t&&!F(Ta,this).has(t.loadedName)){if(He(!n,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:e,src:n,style:a}=t,r=new FontFace(e,n,a);this.addNativeFontFace(r);try{await r.load(),F(Ta,this).add(e),null===i||void 0===i||i(t)}catch(s){ze("Cannot load system font: ".concat(t.baseFontName,", installing it could help to improve PDF rendering.")),this.removeNativeFontFace(r)}return}Be("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo)return void await this.loadSystemFont(e);if(this.isFontLoadingAPISupported){const t=e.createNativeFontFace();if(t){this.addNativeFontFace(t);try{await t.loaded}catch(n){throw ze("Failed to load font '".concat(t.family,"': '").concat(n,"'.")),e.disableFontFace=!0,n}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(t=>{const n=this._queueLoadingCallback(t);this._prepareFontLoadEvent(e,n)})}}get isFontLoadingAPISupported(){var e;return Ve(this,"isFontLoadingAPISupported",!(null===(e=this._document)||void 0===e||!e.fonts))}get isSyncFontLoadingSupported(){return Ve(this,"isSyncFontLoadingSupported",ne||tt.platform.isFirefox)}_queueLoadingCallback(e){const{loadingRequests:t}=this,n={done:!1,complete:function(){for(He(!n.done,"completeRequest() cannot be called twice."),n.done=!0;t.length>0&&t[0].done;){const e=t.shift();setTimeout(e.callback,0)}},callback:e};return t.push(n),n}get _loadTestFont(){return Ve(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(e,t){function n(e,t){return e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|255&e.charCodeAt(t+3)}function i(e,t,n,i){return e.substring(0,t)+i+e.substring(t+n)}let s,a;const r=this._document.createElement("canvas");r.width=1,r.height=1;const o=r.getContext("2d");let l=0;const c="lt".concat(Date.now()).concat(this.loadTestFontId++);let d=this._loadTestFont;d=i(d,976,c.length,c);const h=1482184792;let u=n(d,16);for(s=0,a=c.length-3;s<a;s+=4)u=u-h+n(c,s)|0;var p;s<c.length&&(u=u-h+n(c+"XXX",s)|0),d=i(d,16,4,(p=u,String.fromCharCode(p>>24&255,p>>16&255,p>>8&255,255&p)));const m="url(data:font/opentype;base64,".concat(btoa(d),");"),f='@font-face {font-family:"'.concat(c,'";src:').concat(m,"}");this.insertRule(f);const g=this._document.createElement("div");g.style.visibility="hidden",g.style.width=g.style.height="10px",g.style.position="absolute",g.style.top=g.style.left="0px";for(const v of[e.loadedName,c]){const e=this._document.createElement("span");e.textContent="Hi",e.style.fontFamily=v,g.append(e)}this._document.body.append(g),function e(t,n){if(++l>30)return ze("Load test font never loaded."),void n();o.font="30px "+t,o.fillText(".",0,20),o.getImageData(0,0,1,1).data[3]>0?n():setTimeout(e.bind(null,t,n))}(c,()=>{g.remove(),t.complete()})}}class Ma{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.compiledGlyphs=Object.create(null);for(const n in e)this[n]=e[n];this._inspectFont=t}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(this.cssFontInfo){const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style="oblique ".concat(this.cssFontInfo.italicAngle,"deg")),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}else t=new FontFace(this.loadedName,this.data,{});return null===(e=this._inspectFont)||void 0===e||e.call(this,this),t}createFontFaceRule(){var e;if(!this.data||this.disableFontFace)return null;const t="url(data:".concat(this.mimetype,";base64,").concat(ht(this.data),");");let n;if(this.cssFontInfo){let e="font-weight: ".concat(this.cssFontInfo.fontWeight,";");this.cssFontInfo.italicAngle&&(e+="font-style: oblique ".concat(this.cssFontInfo.italicAngle,"deg;")),n='@font-face {font-family:"'.concat(this.cssFontInfo.fontFamily,'";').concat(e,"src:").concat(t,"}")}else n='@font-face {font-family:"'.concat(this.loadedName,'";src:').concat(t,"}");return null===(e=this._inspectFont)||void 0===e||e.call(this,this,t),n}getPathGenerator(e,t){if(void 0!==this.compiledGlyphs[t])return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let i;try{i=e.get(n)}catch(a){ze('getPathGenerator - ignoring character: "'.concat(a,'".'))}const s=new Path2D(i||"");return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=s}}function Ra(e){if("string"!==typeof e)return null;if(e.endsWith("/"))return e;throw new Error('Invalid factory url: "'.concat(e,'" must include trailing slash.'))}const Ia=e=>"object"===typeof e&&Number.isInteger(null===e||void 0===e?void 0:e.num)&&e.num>=0&&Number.isInteger(null===e||void 0===e?void 0:e.gen)&&e.gen>=0,Pa=function(e,t,n){if(!Array.isArray(n)||n.length<2)return!1;const[i,s,...a]=n;if(!e(i)&&!Number.isInteger(i))return!1;if(!t(s))return!1;const r=a.length;let o=!0;switch(s.name){case"XYZ":if(r<2||r>3)return!1;break;case"Fit":case"FitB":return 0===r;case"FitH":case"FitBH":case"FitV":case"FitBV":if(r>1)return!1;break;case"FitR":if(4!==r)return!1;o=!1;break;default:return!1}for(const l of a)if(!("number"===typeof l||o&&null===l))return!1;return!0}.bind(null,Ia,e=>"object"===typeof e&&"string"===typeof(null===e||void 0===e?void 0:e.name));var La=new WeakMap,ja=new WeakMap;class Da{constructor(){j(this,La,new Map),j(this,ja,Promise.resolve())}postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};F(ja,this).then(()=>{for(const[e]of F(La,this))e.call(this,n)})}addEventListener(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=null;if((null===n||void 0===n?void 0:n.signal)instanceof AbortSignal){const{signal:s}=n;if(s.aborted)return void ze("LoopbackPort - cannot use an `aborted` signal.");const a=()=>this.removeEventListener(e,t);i=()=>s.removeEventListener("abort",a),s.addEventListener("abort",a)}F(La,this).set(t,i)}removeEventListener(e,t){const n=F(La,this).get(t);null===n||void 0===n||n(),F(La,this).delete(t)}terminate(){for(const[,e]of F(La,this))null===e||void 0===e||e();F(La,this).clear()}}const Oa=1,Fa=2,Wa=1,za=2,Ba=3,Ha=4,Ua=5,Ga=6,Va=7,qa=8;function Ya(){}function Ka(e){if(e instanceof Je||e instanceof Xe||e instanceof Ye||e instanceof Qe||e instanceof Ke)return e;switch(e instanceof Error||"object"===typeof e&&null!==e||Be('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),e.name){case"AbortException":return new Je(e.message);case"InvalidPDFException":return new Xe(e.message);case"PasswordException":return new Ye(e.message,e.code);case"ResponseException":return new Qe(e.message,e.status,e.missing);case"UnknownErrorException":return new Ke(e.message,e.details)}return new Ke(e.message,e.toString())}var Xa=new WeakMap,Qa=new WeakSet;class $a{constructor(e,t,n){L(this,Qa),j(this,Xa,new AbortController),this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",D(Qa,this,Ja).bind(this),{signal:F(Xa,this).signal})}on(e,t){const n=this.actionHandler;if(n[e])throw new Error('There is already an actionName called "'.concat(e,'"'));n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const i=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[i]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},n)}catch(a){s.reject(a)}return s.promise}sendWithStream(e,t,n,i){const s=this.streamId++,a=this.sourceName,r=this.targetName,o=this.comObj;return new ReadableStream({start:n=>{const l=Promise.withResolvers();return this.streamControllers[s]={controller:n,startCall:l,pullCall:null,cancelCall:null,isClosed:!1},o.postMessage({sourceName:a,targetName:r,action:e,streamId:s,data:t,desiredSize:n.desiredSize},i),l.promise},pull:e=>{const t=Promise.withResolvers();return this.streamControllers[s].pullCall=t,o.postMessage({sourceName:a,targetName:r,stream:Ga,streamId:s,desiredSize:e.desiredSize}),t.promise},cancel:e=>{He(e instanceof Error,"cancel must have a valid reason");const t=Promise.withResolvers();return this.streamControllers[s].cancelCall=t,this.streamControllers[s].isClosed=!0,o.postMessage({sourceName:a,targetName:r,stream:Wa,streamId:s,reason:Ka(e)}),t.promise}},n)}destroy(){var e;null===(e=F(Xa,this))||void 0===e||e.abort(),W(Xa,this,null)}}function Ja(e){let{data:t}=e;if(t.targetName!==this.sourceName)return;if(t.stream)return void D(Qa,this,er).call(this,t);if(t.callback){const e=t.callbackId,n=this.callbackCapabilities[e];if(!n)throw new Error("Cannot resolve callback ".concat(e));if(delete this.callbackCapabilities[e],t.callback===Oa)n.resolve(t.data);else{if(t.callback!==Fa)throw new Error("Unexpected callback case");n.reject(Ka(t.reason))}return}const n=this.actionHandler[t.action];if(!n)throw new Error("Unknown action from worker: ".concat(t.action));if(t.callbackId){const e=this.sourceName,i=t.sourceName,s=this.comObj;return void Promise.try(n,t.data).then(function(n){s.postMessage({sourceName:e,targetName:i,callback:Oa,callbackId:t.callbackId,data:n})},function(n){s.postMessage({sourceName:e,targetName:i,callback:Fa,callbackId:t.callbackId,reason:Ka(n)})})}t.streamId?D(Qa,this,Za).call(this,t):n(t.data)}function Za(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,s=this.comObj,a=this,r=this.actionHandler[e.action],o={enqueue(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.isCancelled)return;const o=this.desiredSize;this.desiredSize-=a,o>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:n,targetName:i,stream:Ha,streamId:t,chunk:e},r)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:i,stream:Ba,streamId:t}),delete a.streamSinks[t])},error(e){He(e instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:i,stream:Ua,streamId:t,reason:Ka(e)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};o.sinkCapability.resolve(),o.ready=o.sinkCapability.promise,this.streamSinks[t]=o,Promise.try(r,e.data,o).then(function(){s.postMessage({sourceName:n,targetName:i,stream:qa,streamId:t,success:!0})},function(e){s.postMessage({sourceName:n,targetName:i,stream:qa,streamId:t,reason:Ka(e)})})}function er(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,s=this.comObj,a=this.streamControllers[t],r=this.streamSinks[t];switch(e.stream){case qa:e.success?a.startCall.resolve():a.startCall.reject(Ka(e.reason));break;case Va:e.success?a.pullCall.resolve():a.pullCall.reject(Ka(e.reason));break;case Ga:if(!r){s.postMessage({sourceName:n,targetName:i,stream:Va,streamId:t,success:!0});break}r.desiredSize<=0&&e.desiredSize>0&&r.sinkCapability.resolve(),r.desiredSize=e.desiredSize,Promise.try(r.onPull||Ya).then(function(){s.postMessage({sourceName:n,targetName:i,stream:Va,streamId:t,success:!0})},function(e){s.postMessage({sourceName:n,targetName:i,stream:Va,streamId:t,reason:Ka(e)})});break;case Ha:if(He(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case Ba:if(He(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),D(Qa,this,tr).call(this,a,t);break;case Ua:He(a,"error should have stream controller"),a.controller.error(Ka(e.reason)),D(Qa,this,tr).call(this,a,t);break;case za:e.success?a.cancelCall.resolve():a.cancelCall.reject(Ka(e.reason)),D(Qa,this,tr).call(this,a,t);break;case Wa:if(!r)break;const o=Ka(e.reason);Promise.try(r.onCancel||Ya,o).then(function(){s.postMessage({sourceName:n,targetName:i,stream:za,streamId:t,success:!0})},function(e){s.postMessage({sourceName:n,targetName:i,stream:za,streamId:t,reason:Ka(e)})}),r.sinkCapability.reject(o),r.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async function tr(e,t){var n,i,s;await Promise.allSettled([null===(n=e.startCall)||void 0===n?void 0:n.promise,null===(i=e.pullCall)||void 0===i?void 0:i.promise,null===(s=e.cancelCall)||void 0===s?void 0:s.promise]),delete this.streamControllers[t]}var nr=new WeakMap;class ir{constructor(e){let{enableHWA:t=!1}=e;j(this,nr,!1),W(nr,this,t)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!F(nr,this)})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Be("Abstract method `_createCanvas` called.")}}class sr extends ir{constructor(e){let{ownerDocument:t=globalThis.document,enableHWA:n=!1}=e;super({enableHWA:n}),this._document=t}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class ar{constructor(e){let{baseUrl:t=null,isCompressed:n=!0}=e;this.baseUrl=t,this.isCompressed=n}async fetch(e){let{name:t}=e;if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const n=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(n).then(e=>({cMapData:e,isCompressed:this.isCompressed})).catch(e=>{throw new Error("Unable to load ".concat(this.isCompressed?"binary ":"","CMap at: ").concat(n))})}async _fetch(e){Be("Abstract method `_fetch` called.")}}class rr extends ar{async _fetch(e){const t=await mt(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):et(t)}}class or{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,i,s){return"none"}destroy(){}}var lr=new WeakMap,cr=new WeakMap,dr=new WeakMap,hr=new WeakMap,ur=new WeakMap,pr=new WeakMap,mr=new WeakMap,fr=new WeakSet;class gr extends or{constructor(e){let{docId:t,ownerDocument:n=globalThis.document}=e;super(),L(this,fr),j(this,lr,void 0),j(this,cr,void 0),j(this,dr,void 0),j(this,hr,void 0),j(this,ur,void 0),j(this,pr,void 0),j(this,mr,0),W(hr,this,t),W(ur,this,n)}addFilter(e){var t,n;if(!e)return"none";let i=O(fr,this,vr).get(e);if(i)return i;const[s,a,r]=D(fr,this,xr).call(this,e),o=1===e.length?s:"".concat(s).concat(a).concat(r);if(i=O(fr,this,vr).get(o),i)return O(fr,this,vr).set(e,i),i;const l="g_".concat(F(hr,this),"_transfer_map_").concat((W(mr,this,(t=F(mr,this),n=t++,t)),n)),c=D(fr,this,wr).call(this,l);O(fr,this,vr).set(e,c),O(fr,this,vr).set(o,c);const d=D(fr,this,Sr).call(this,l);return D(fr,this,kr).call(this,s,a,r,d),c}addHCMFilter(e,t){var n;const i="".concat(e,"-").concat(t),s="base";let a=O(fr,this,yr).get(s);if((null===(n=a)||void 0===n?void 0:n.key)===i)return a.url;var r;a?(null===(r=a.filter)||void 0===r||r.remove(),a.key=i,a.url="none",a.filter=null):(a={key:i,url:"none",filter:null},O(fr,this,yr).set(s,a));if(!e||!t)return a.url;const o=D(fr,this,Tr).call(this,e);e=it.makeHexColor(...o);const l=D(fr,this,Tr).call(this,t);if(t=it.makeHexColor(...l),O(fr,this,br).style.color="","#000000"===e&&"#ffffff"===t||e===t)return a.url;const c=new Array(256);for(let m=0;m<=255;m++){const e=m/255;c[m]=e<=.03928?e/12.92:((e+.055)/1.055)**2.4}const d=c.join(","),h="g_".concat(F(hr,this),"_hcm_filter"),u=a.filter=D(fr,this,Sr).call(this,h);D(fr,this,kr).call(this,d,d,d,u),D(fr,this,_r).call(this,u);const p=(e,t)=>{const n=o[e]/255,i=l[e]/255,s=new Array(t+1);for(let a=0;a<=t;a++)s[a]=n+a/t*(i-n);return s.join(",")};return D(fr,this,kr).call(this,p(0,5),p(1,5),p(2,5),u),a.url=D(fr,this,wr).call(this,h),a.url}addAlphaFilter(e){var t,n;let i=O(fr,this,vr).get(e);if(i)return i;const[s]=D(fr,this,xr).call(this,[e]),a="alpha_".concat(s);if(i=O(fr,this,vr).get(a),i)return O(fr,this,vr).set(e,i),i;const r="g_".concat(F(hr,this),"_alpha_map_").concat((W(mr,this,(t=F(mr,this),n=t++,t)),n)),o=D(fr,this,wr).call(this,r);O(fr,this,vr).set(e,o),O(fr,this,vr).set(a,o);const l=D(fr,this,Sr).call(this,r);return D(fr,this,Cr).call(this,s,l),o}addLuminosityFilter(e){var t,n;let i,s,a=O(fr,this,vr).get(e||"luminosity");if(a)return a;if(e?([i]=D(fr,this,xr).call(this,[e]),s="luminosity_".concat(i)):s="luminosity",a=O(fr,this,vr).get(s),a)return O(fr,this,vr).set(e,a),a;const r="g_".concat(F(hr,this),"_luminosity_map_").concat((W(mr,this,(t=F(mr,this),n=t++,t)),n)),o=D(fr,this,wr).call(this,r);O(fr,this,vr).set(e,o),O(fr,this,vr).set(s,o);const l=D(fr,this,Sr).call(this,r);return D(fr,this,Ar).call(this,l),e&&D(fr,this,Cr).call(this,i,l),o}addHighlightHCMFilter(e,t,n,i,s){var a;const r="".concat(t,"-").concat(n,"-").concat(i,"-").concat(s);let o=O(fr,this,yr).get(e);if((null===(a=o)||void 0===a?void 0:a.key)===r)return o.url;var l;o?(null===(l=o.filter)||void 0===l||l.remove(),o.key=r,o.url="none",o.filter=null):(o={key:r,url:"none",filter:null},O(fr,this,yr).set(e,o));if(!t||!n)return o.url;const[c,d]=[t,n].map(D(fr,this,Tr).bind(this));let h=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),u=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[p,m]=[i,s].map(D(fr,this,Tr).bind(this));u<h&&([h,u,p,m]=[u,h,m,p]),O(fr,this,br).style.color="";const f=(e,t,n)=>{const i=new Array(256),s=(u-h)/n,a=e/255,r=(t-e)/(255*n);let o=0;for(let l=0;l<=n;l++){const e=Math.round(h+l*s),t=a+l*r;for(let n=o;n<=e;n++)i[n]=t;o=e+1}for(let l=o;l<256;l++)i[l]=i[o-1];return i.join(",")},g="g_".concat(F(hr,this),"_hcm_").concat(e,"_filter"),v=o.filter=D(fr,this,Sr).call(this,g);return D(fr,this,_r).call(this,v),D(fr,this,kr).call(this,f(p[0],m[0],5),f(p[1],m[1],5),f(p[2],m[2],5),v),o.url=D(fr,this,wr).call(this,g),o.url}destroy(){var e,t,n,i;arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&null!==(e=F(pr,this))&&void 0!==e&&e.size||(null===(t=F(dr,this))||void 0===t||t.parentNode.parentNode.remove(),W(dr,this,null),null===(n=F(cr,this))||void 0===n||n.clear(),W(cr,this,null),null===(i=F(pr,this))||void 0===i||i.clear(),W(pr,this,null),W(mr,this,0))}}function vr(e){return F(cr,e)||W(cr,e,new Map)}function yr(e){return F(pr,e)||W(pr,e,new Map)}function br(e){if(!F(dr,e)){const t=F(ur,e).createElement("div"),{style:n}=t;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const i=F(ur,e).createElementNS(ut,"svg");i.setAttribute("width",0),i.setAttribute("height",0),W(dr,e,F(ur,e).createElementNS(ut,"defs")),t.append(i),i.append(F(dr,e)),F(ur,e).body.append(t)}return F(dr,e)}function xr(e){if(1===e.length){const t=e[0],n=new Array(256);for(let e=0;e<256;e++)n[e]=t[e]/255;const i=n.join(",");return[i,i,i]}const[t,n,i]=e,s=new Array(256),a=new Array(256),r=new Array(256);for(let o=0;o<256;o++)s[o]=t[o]/255,a[o]=n[o]/255,r[o]=i[o]/255;return[s.join(","),a.join(","),r.join(",")]}function wr(e){if(void 0===F(lr,this)){W(lr,this,"");const e=F(ur,this).URL;e!==F(ur,this).baseURI&&(vt(e)?ze('#createUrl: ignore "data:"-URL for performance reasons.'):W(lr,this,Ge(e,"")))}return"url(".concat(F(lr,this),"#").concat(e,")")}function Ar(e){const t=F(ur,this).createElementNS(ut,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}function _r(e){const t=F(ur,this).createElementNS(ut,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}function Sr(e){const t=F(ur,this).createElementNS(ut,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),O(fr,this,br).append(t),t}function Er(e,t,n){const i=F(ur,this).createElementNS(ut,t);i.setAttribute("type","discrete"),i.setAttribute("tableValues",n),e.append(i)}function kr(e,t,n,i){const s=F(ur,this).createElementNS(ut,"feComponentTransfer");i.append(s),D(fr,this,Er).call(this,s,"feFuncR",e),D(fr,this,Er).call(this,s,"feFuncG",t),D(fr,this,Er).call(this,s,"feFuncB",n)}function Cr(e,t){const n=F(ur,this).createElementNS(ut,"feComponentTransfer");t.append(n),D(fr,this,Er).call(this,n,"feFuncA",e)}function Tr(e){return O(fr,this,br).style.color=e,Et(getComputedStyle(O(fr,this,br)).getPropertyValue("color"))}class Nr{constructor(e){let{baseUrl:t=null}=e;this.baseUrl=t}async fetch(e){let{filename:t}=e;if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const n="".concat(this.baseUrl).concat(t);return this._fetch(n).catch(e=>{throw new Error("Unable to load font data at: ".concat(n))})}async _fetch(e){Be("Abstract method `_fetch` called.")}}class Mr extends Nr{async _fetch(e){const t=await mt(e,"arraybuffer");return new Uint8Array(t)}}class Rr{constructor(e){let{baseUrl:t=null}=e;this.baseUrl=t}async fetch(e){let{filename:t}=e;if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const n="".concat(this.baseUrl).concat(t);return this._fetch(n).catch(e=>{throw new Error("Unable to load wasm data at: ".concat(n))})}async _fetch(e){Be("Abstract method `_fetch` called.")}}class Ir extends Rr{async _fetch(e){const t=await mt(e,"arraybuffer");return new Uint8Array(t)}}async function Pr(e){const t=process.getBuiltinModule("fs"),n=await t.promises.readFile(e);return new Uint8Array(n)}ne&&ze("Please use the `legacy` build in Node.js environments.");class Lr extends or{}class jr extends ir{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire("file:///Users/wenyu/Code/ResumePolisher/node_modules/pdfjs-dist/build/pdf.mjs")("@napi-rs/canvas").createCanvas(e,t)}}class Dr extends ar{async _fetch(e){return Pr(e)}}class Or extends Nr{async _fetch(e){return Pr(e)}}class Fr extends Rr{async _fetch(e){return Pr(e)}}const Wr="Fill",zr="Stroke",Br="Shading";function Hr(e,t){if(!t)return;const n=t[2]-t[0],i=t[3]-t[1],s=new Path2D;s.rect(t[0],t[1],n,i),e.clip(s)}class Ur{isModifyingCurrentTransform(){return!1}getPattern(){Be("Abstract method `getPattern` called.")}}class Gr extends Ur{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;"axial"===this._type?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,i){let s;if(i===zr||i===Wr){const a=t.current.getClippedPathBoundingBox(i,kt(e))||[0,0,0,0],r=Math.ceil(a[2]-a[0])||1,o=Math.ceil(a[3]-a[1])||1,l=t.cachedCanvases.getCanvas("pattern",r,o),c=l.context;c.clearRect(0,0,c.canvas.width,c.canvas.height),c.beginPath(),c.rect(0,0,c.canvas.width,c.canvas.height),c.translate(-a[0],-a[1]),n=it.transform(n,[1,0,0,1,a[0],a[1]]),c.transform(...t.baseTransform),this.matrix&&c.transform(...this.matrix),Hr(c,this._bbox),c.fillStyle=this._createGradient(c),c.fill(),s=e.createPattern(l.canvas,"no-repeat");const d=new DOMMatrix(n);s.setTransform(d)}else Hr(e,this._bbox),s=this._createGradient(e);return s}}function Vr(e,t,n,i,s,a,r,o){const l=t.coords,c=t.colors,d=e.data,h=4*e.width;let u;l[n+1]>l[i+1]&&(u=n,n=i,i=u,u=a,a=r,r=u),l[i+1]>l[s+1]&&(u=i,i=s,s=u,u=r,r=o,o=u),l[n+1]>l[i+1]&&(u=n,n=i,i=u,u=a,a=r,r=u);const p=(l[n]+t.offsetX)*t.scaleX,m=(l[n+1]+t.offsetY)*t.scaleY,f=(l[i]+t.offsetX)*t.scaleX,g=(l[i+1]+t.offsetY)*t.scaleY,v=(l[s]+t.offsetX)*t.scaleX,y=(l[s+1]+t.offsetY)*t.scaleY;if(m>=y)return;const b=c[a],x=c[a+1],w=c[a+2],A=c[r],_=c[r+1],S=c[r+2],E=c[o],k=c[o+1],C=c[o+2],T=Math.round(m),N=Math.round(y);let M,R,I,P,L,j,D,O;for(let F=T;F<=N;F++){if(F<g){const e=F<m?0:(m-F)/(m-g);M=p-(p-f)*e,R=b-(b-A)*e,I=x-(x-_)*e,P=w-(w-S)*e}else{let e;e=F>y?1:g===y?0:(g-F)/(g-y),M=f-(f-v)*e,R=A-(A-E)*e,I=_-(_-k)*e,P=S-(S-C)*e}let e;e=F<m?0:F>y?1:(m-F)/(m-y),L=p-(p-v)*e,j=b-(b-E)*e,D=x-(x-k)*e,O=w-(w-C)*e;const t=Math.round(Math.min(M,L)),n=Math.round(Math.max(M,L));let i=h*F+4*t;for(let s=t;s<=n;s++)e=(M-s)/(M-L),e<0?e=0:e>1&&(e=1),d[i++]=R-(R-j)*e|0,d[i++]=I-(I-D)*e|0,d[i++]=P-(P-O)*e|0,d[i++]=255}}function qr(e,t,n){const i=t.coords,s=t.colors;let a,r;switch(t.type){case"lattice":const o=t.verticesPerRow,l=Math.floor(i.length/o)-1,c=o-1;for(a=0;a<l;a++){let t=a*o;for(let a=0;a<c;a++,t++)Vr(e,n,i[t],i[t+1],i[t+o],s[t],s[t+1],s[t+o]),Vr(e,n,i[t+o+1],i[t+1],i[t+o],s[t+o+1],s[t+1],s[t+o])}break;case"triangles":for(a=0,r=i.length;a<r;a+=3)Vr(e,n,i[a],i[a+1],i[a+2],s[a],s[a+1],s[a+2]);break;default:throw new Error("illegal figure")}}class Yr extends Ur{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){const i=Math.floor(this._bounds[0]),s=Math.floor(this._bounds[1]),a=Math.ceil(this._bounds[2])-i,r=Math.ceil(this._bounds[3])-s,o=Math.min(Math.ceil(Math.abs(a*e[0]*1.1)),3e3),l=Math.min(Math.ceil(Math.abs(r*e[1]*1.1)),3e3),c=a/o,d=r/l,h={coords:this._coords,colors:this._colors,offsetX:-i,offsetY:-s,scaleX:1/c,scaleY:1/d},u=o+4,p=l+4,m=n.getCanvas("mesh",u,p),f=m.context,g=f.createImageData(o,l);if(t){const e=g.data;for(let n=0,i=e.length;n<i;n+=4)e[n]=t[0],e[n+1]=t[1],e[n+2]=t[2],e[n+3]=255}for(const v of this._figures)qr(g,v,h);f.putImageData(g,2,2);return{canvas:m.canvas,offsetX:i-2*c,offsetY:s-2*d,scaleX:c,scaleY:d}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,i){Hr(e,this._bbox);const s=new Float32Array(2);if(i===Br)it.singularValueDecompose2dScale(kt(e),s);else if(this.matrix){it.singularValueDecompose2dScale(this.matrix,s);const[e,n]=s;it.singularValueDecompose2dScale(t.baseTransform,s),s[0]*=e,s[1]*=n}else it.singularValueDecompose2dScale(t.baseTransform,s);const a=this._createMeshCanvas(s,i===Br?null:this._background,t.cachedCanvases);return i!==Br&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class Kr extends Ur{getPattern(){return"hotpink"}}const Xr=1,Qr=2;class $r{constructor(e,t,n,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=i}createPatternCanvas(e){const{bbox:t,operatorList:n,paintType:i,tilingType:s,color:a,canvasGraphicsFactory:r}=this;let{xstep:o,ystep:l}=this;o=Math.abs(o),l=Math.abs(l),We("TilingType: "+s);const c=t[0],d=t[1],h=t[2],u=t[3],p=h-c,m=u-d,f=new Float32Array(2);it.singularValueDecompose2dScale(this.matrix,f);const[g,v]=f;it.singularValueDecompose2dScale(this.baseTransform,f);const y=g*f[0],b=v*f[1];let x=p,w=m,A=!1,_=!1;const S=Math.ceil(o*y),E=Math.ceil(l*b);S>=Math.ceil(p*y)?x=o:A=!0,E>=Math.ceil(m*b)?w=l:_=!0;const k=this.getSizeAndScale(x,this.ctx.canvas.width,y),C=this.getSizeAndScale(w,this.ctx.canvas.height,b),T=e.cachedCanvases.getCanvas("pattern",k.size,C.size),N=T.context,M=r.createCanvasGraphics(N);if(M.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(M,i,a),N.translate(-k.scale*c,-C.scale*d),M.transform(k.scale,0,0,C.scale,0,0),N.save(),this.clipBbox(M,c,d,h,u),M.baseTransform=kt(M.ctx),M.executeOperatorList(n),M.endDrawing(),N.restore(),A||_){const t=T.canvas;A&&(x=o),_&&(w=l);const n=this.getSizeAndScale(x,this.ctx.canvas.width,y),i=this.getSizeAndScale(w,this.ctx.canvas.height,b),s=n.size,a=i.size,r=e.cachedCanvases.getCanvas("pattern-workaround",s,a),h=r.context,u=A?Math.floor(p/o):0,f=_?Math.floor(m/l):0;for(let e=0;e<=u;e++)for(let n=0;n<=f;n++)h.drawImage(t,s*e,a*n,s,a,0,0,s,a);return{canvas:r.canvas,scaleX:n.scale,scaleY:i.scale,offsetX:c,offsetY:d}}return{canvas:T.canvas,scaleX:k.scale,scaleY:C.scale,offsetX:c,offsetY:d}}getSizeAndScale(e,t,n){const i=Math.max($r.MAX_PATTERN_SIZE,t);let s=Math.ceil(e*n);return s>=i?s=i:n=s/e,{scale:n,size:s}}clipBbox(e,t,n,i,s){const a=i-t,r=s-n;e.ctx.rect(t,n,a,r),it.axialAlignedBoundingBox([t,n,i,s],kt(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const i=e.ctx,s=e.current;switch(t){case Xr:const{fillStyle:e,strokeStyle:a}=this.ctx;i.fillStyle=s.fillColor=e,i.strokeStyle=s.strokeColor=a;break;case Qr:i.fillStyle=i.strokeStyle=n,s.fillColor=s.strokeColor=n;break;default:throw new $e("Unsupported paint type: ".concat(t))}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,i){let s=n;i!==Br&&(s=it.transform(s,t.baseTransform),this.matrix&&(s=it.transform(s,this.matrix)));const a=this.createPatternCanvas(t);let r=new DOMMatrix(s);r=r.translate(a.offsetX,a.offsetY),r=r.scale(1/a.scaleX,1/a.scaleY);const o=e.createPattern(a.canvas,"repeat");return o.setTransform(r),o}}function Jr(e){let{src:t,srcPos:n=0,dest:i,width:s,height:a,nonBlackColor:r=4294967295,inverseDecode:o=!1}=e;const l=tt.isLittleEndian?4278190080:255,[c,d]=o?[r,l]:[l,r],h=s>>3,u=7&s,p=t.length;i=new Uint32Array(i.buffer);let m=0;for(let f=0;f<a;f++){for(const s=n+h;n<s;n++){const e=n<p?t[n]:255;i[m++]=128&e?d:c,i[m++]=64&e?d:c,i[m++]=32&e?d:c,i[m++]=16&e?d:c,i[m++]=8&e?d:c,i[m++]=4&e?d:c,i[m++]=2&e?d:c,i[m++]=1&e?d:c}if(0===u)continue;const e=n<p?t[n++]:255;for(let t=0;t<u;t++)i[m++]=e&1<<7-t?d:c}return{srcPos:n,destPos:m}}o($r,"MAX_PATTERN_SIZE",3e3);const Zr=16,eo=new DOMMatrix,to=new Float32Array(2),no=new Float32Array([1/0,1/0,-1/0,-1/0]);class io{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let i;return void 0!==this.cache[e]?(i=this.cache[e],this.canvasFactory.reset(i,t,n)):(i=this.canvasFactory.create(t,n),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function so(e,t,n,i,s,a,r,o,l,c){const[d,h,u,p,m,f]=kt(e);if(0===h&&0===u){const g=r*d+m,v=Math.round(g),y=o*p+f,b=Math.round(y),x=(r+l)*d+m,w=Math.abs(Math.round(x)-v)||1,A=(o+c)*p+f,_=Math.abs(Math.round(A)-b)||1;return e.setTransform(Math.sign(d),0,0,Math.sign(p),v,b),e.drawImage(t,n,i,s,a,0,0,w,_),e.setTransform(d,h,u,p,m,f),[w,_]}if(0===d&&0===p){const g=o*u+m,v=Math.round(g),y=r*h+f,b=Math.round(y),x=(o+c)*u+m,w=Math.abs(Math.round(x)-v)||1,A=(r+l)*h+f,_=Math.abs(Math.round(A)-b)||1;return e.setTransform(0,Math.sign(h),Math.sign(u),0,v,b),e.drawImage(t,n,i,s,a,0,0,_,w),e.setTransform(d,h,u,p,m,f),[_,w]}e.drawImage(t,n,i,s,a,r,o,l,c);return[Math.hypot(d,h)*l,Math.hypot(u,p)*c]}class ao{constructor(e,t){o(this,"alphaIsShape",!1),o(this,"fontSize",0),o(this,"fontSizeScale",1),o(this,"textMatrix",null),o(this,"textMatrixScale",1),o(this,"fontMatrix",ie),o(this,"leading",0),o(this,"x",0),o(this,"y",0),o(this,"lineX",0),o(this,"lineY",0),o(this,"charSpacing",0),o(this,"wordSpacing",0),o(this,"textHScale",1),o(this,"textRenderingMode",ve),o(this,"textRise",0),o(this,"fillColor","#000000"),o(this,"strokeColor","#000000"),o(this,"patternFill",!1),o(this,"patternStroke",!1),o(this,"fillAlpha",1),o(this,"strokeAlpha",1),o(this,"lineWidth",1),o(this,"activeSMask",null),o(this,"transferMaps","none"),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=no.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wr,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.minMax.slice();if(e===zr){t||Be("Stroke bounding box must include transform."),it.singularValueDecompose2dScale(t,to);const e=to[0]*this.lineWidth/2,i=to[1]*this.lineWidth/2;n[0]-=e,n[1]-=i,n[2]+=e,n[3]+=i}return n}updateClipFromPath(){const e=it.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(no,0)}getClippedPathBoundingBox(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wr,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return it.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function ro(e,t){if(t instanceof ImageData)return void e.putImageData(t,0,0);const n=t.height,i=t.width,s=n%Zr,a=(n-s)/Zr,r=0===s?a:a+1,o=e.createImageData(i,Zr);let l,c=0;const d=t.data,h=o.data;let u,p,m,f;if(t.kind===_e.GRAYSCALE_1BPP){const t=d.byteLength,n=new Uint32Array(h.buffer,0,h.byteLength>>2),f=n.length,g=i+7>>3,v=4294967295,y=tt.isLittleEndian?4278190080:255;for(u=0;u<r;u++){for(m=u<a?Zr:s,l=0,p=0;p<m;p++){const e=t-c;let s=0;const a=e>g?i:8*e-7,r=-8&a;let o=0,h=0;for(;s<r;s+=8)h=d[c++],n[l++]=128&h?v:y,n[l++]=64&h?v:y,n[l++]=32&h?v:y,n[l++]=16&h?v:y,n[l++]=8&h?v:y,n[l++]=4&h?v:y,n[l++]=2&h?v:y,n[l++]=1&h?v:y;for(;s<a;s++)0===o&&(h=d[c++],o=128),n[l++]=h&o?v:y,o>>=1}for(;l<f;)n[l++]=0;e.putImageData(o,0,u*Zr)}}else if(t.kind===_e.RGBA_32BPP){for(p=0,f=i*Zr*4,u=0;u<a;u++)h.set(d.subarray(c,c+f)),c+=f,e.putImageData(o,0,p),p+=Zr;u<r&&(f=i*s*4,h.set(d.subarray(c,c+f)),e.putImageData(o,0,p))}else{if(t.kind!==_e.RGB_24BPP)throw new Error("bad image kind: ".concat(t.kind));for(m=Zr,f=i*m,u=0;u<r;u++){for(u>=a&&(m=s,f=i*m),l=0,p=f;p--;)h[l++]=d[c++],h[l++]=d[c++],h[l++]=d[c++],h[l++]=255;e.putImageData(o,0,u*Zr)}}}function oo(e,t){if(t.bitmap)return void e.drawImage(t.bitmap,0,0);const n=t.height,i=t.width,s=n%Zr,a=(n-s)/Zr,r=0===s?a:a+1,o=e.createImageData(i,Zr);let l=0;const c=t.data,d=o.data;for(let h=0;h<r;h++){const t=h<a?Zr:s;({srcPos:l}=Jr({src:c,srcPos:l,dest:d,width:i,height:t,nonBlackColor:0})),e.putImageData(o,0,h*Zr)}}function lo(e,t){const n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of n)void 0!==e[i]&&(t[i]=e[i]);void 0!==e.setLineDash&&(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset)}function co(e){e.strokeStyle=e.fillStyle="#000000",e.fillRule="nonzero",e.globalAlpha=1,e.lineWidth=1,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.globalCompositeOperation="source-over",e.font="10px sans-serif",void 0!==e.setLineDash&&(e.setLineDash([]),e.lineDashOffset=0);const{filter:t}=e;"none"!==t&&""!==t&&(e.filter="none")}function ho(e,t){if(t)return!0;it.singularValueDecompose2dScale(e,to);const n=Math.fround(Nt.pixelRatio*pt.PDF_TO_CSS_UNITS);return to[0]<=n&&to[1]<=n}const uo=["butt","round","square"],po=["miter","round","bevel"],mo={},fo={};var go=new WeakSet;class vo{constructor(e,t,n,i,s,a,r,o){let{optionalContentConfig:l,markedContentStack:c=null}=a;L(this,go),this.ctx=e,this.current=new ao(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=i,this.filterFactory=s,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=l,this.cachedCanvases=new io(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=r,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=o,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"string"===typeof e?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing(e){let{transform:t,viewport:n,transparency:i=!1,background:s=null}=e;const a=this.ctx.canvas.width,r=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,a,r),this.ctx.fillStyle=o,i){const e=this.cachedCanvases.getCanvas("transparent",a,r);this.compositeCtx=this.ctx,this.transparentCanvas=e.canvas,this.ctx=e.context,this.ctx.save(),this.ctx.transform(...kt(this.compositeCtx))}this.ctx.save(),co(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...n.transform),this.viewportScale=n.scale,this.baseTransform=kt(this.ctx)}executeOperatorList(e,t,n,i){const s=e.argsArray,a=e.fnArray;let r=t||0;const o=s.length;if(o===r)return r;const l=o-r>10&&"function"===typeof n,c=l?Date.now()+15:0;let d=0;const h=this.commonObjs,u=this.objs;let p;for(;;){if(void 0!==i&&r===i.nextBreakPoint)return i.breakIt(r,n),r;if(p=a[r],p!==Re.dependency)this[p].apply(this,s[r]);else for(const e of s[r]){const t=e.startsWith("g_")?h:u;if(!t.has(e))return t.get(e,n),r}if(r++,r===o)return r;if(l&&++d>10){if(Date.now()>c)return n(),r;d=0}}}endDrawing(){D(go,this,yo).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),D(go,this,bo).call(this)}_scaleImage(e,t){var n,i;const s=null!==(n=e.width)&&void 0!==n?n:e.displayWidth,a=null!==(i=e.height)&&void 0!==i?i:e.displayHeight;let r,o,l=Math.max(Math.hypot(t[0],t[1]),1),c=Math.max(Math.hypot(t[2],t[3]),1),d=s,h=a,u="prescale1";for(;l>2&&d>1||c>2&&h>1;){let t=d,n=h;l>2&&d>1&&(t=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d/2),l/=d/t),c>2&&h>1&&(n=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,c/=h/n),r=this.cachedCanvases.getCanvas(u,t,n),o=r.context,o.clearRect(0,0,t,n),o.drawImage(e,0,0,d,h,0,0,t,n),e=r.canvas,d=t,h=n,u="prescale1"===u?"prescale2":"prescale1"}return{img:e,paintWidth:d,paintHeight:h}}_createMaskCanvas(e){const t=this.ctx,{width:n,height:i}=e,s=this.current.fillColor,a=this.current.patternFill,r=kt(t);let o,l,c,d;if((e.bitmap||e.data)&&e.count>1){const t=e.bitmap||e.data.buffer;l=JSON.stringify(a?r:[r.slice(0,4),s]),o=this._cachedBitmapsMap.get(t),o||(o=new Map,this._cachedBitmapsMap.set(t,o));const n=o.get(l);if(n&&!a){return{canvas:n,offsetX:Math.round(Math.min(r[0],r[2])+r[4]),offsetY:Math.round(Math.min(r[1],r[3])+r[5])}}c=n}c||(d=this.cachedCanvases.getCanvas("maskCanvas",n,i),oo(d.context,e));let h=it.transform(r,[1/n,0,0,-1/i,0,0]);h=it.transform(h,[1,0,0,1,0,-i]);const u=no.slice();it.axialAlignedBoundingBox([0,0,n,i],h,u);const[p,m,f,g]=u,v=Math.round(f-p)||1,y=Math.round(g-m)||1,b=this.cachedCanvases.getCanvas("fillCanvas",v,y),x=b.context,w=p,A=m;x.translate(-w,-A),x.transform(...h),c||(c=this._scaleImage(d.canvas,Ct(x)),c=c.img,o&&a&&o.set(l,c)),x.imageSmoothingEnabled=ho(kt(x),e.interpolate),so(x,c,0,0,c.width,c.height,0,0,n,i),x.globalCompositeOperation="source-in";const _=it.transform(Ct(x),[1,0,0,1,-w,-A]);return x.fillStyle=a?s.getPattern(t,this,_,Wr):s,x.fillRect(0,0,n,i),o&&!a&&(this.cachedCanvases.delete("fillCanvas"),o.set(l,b.canvas)),{canvas:b.canvas,offsetX:Math.round(w),offsetY:Math.round(A)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=uo[e]}setLineJoin(e){this.ctx.lineJoin=po[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const n=this.ctx;void 0!==n.setLineDash&&(n.setLineDash(e),n.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,n]of e)switch(t){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n)}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(n,e,t);this.suspendedCtx=this.ctx;const s=this.ctx=i.context;s.setTransform(this.suspendedCtx.getTransform()),lo(this.suspendedCtx,s),function(e,t){if(e._removeMirroring)throw new Error("Context is already forwarding operations.");e.__originalSave=e.save,e.__originalRestore=e.restore,e.__originalRotate=e.rotate,e.__originalScale=e.scale,e.__originalTranslate=e.translate,e.__originalTransform=e.transform,e.__originalSetTransform=e.setTransform,e.__originalResetTransform=e.resetTransform,e.__originalClip=e.clip,e.__originalMoveTo=e.moveTo,e.__originalLineTo=e.lineTo,e.__originalBezierCurveTo=e.bezierCurveTo,e.__originalRect=e.rect,e.__originalClosePath=e.closePath,e.__originalBeginPath=e.beginPath,e._removeMirroring=()=>{e.save=e.__originalSave,e.restore=e.__originalRestore,e.rotate=e.__originalRotate,e.scale=e.__originalScale,e.translate=e.__originalTranslate,e.transform=e.__originalTransform,e.setTransform=e.__originalSetTransform,e.resetTransform=e.__originalResetTransform,e.clip=e.__originalClip,e.moveTo=e.__originalMoveTo,e.lineTo=e.__originalLineTo,e.bezierCurveTo=e.__originalBezierCurveTo,e.rect=e.__originalRect,e.closePath=e.__originalClosePath,e.beginPath=e.__originalBeginPath,delete e._removeMirroring},e.save=function(){t.save(),this.__originalSave()},e.restore=function(){t.restore(),this.__originalRestore()},e.translate=function(e,n){t.translate(e,n),this.__originalTranslate(e,n)},e.scale=function(e,n){t.scale(e,n),this.__originalScale(e,n)},e.transform=function(e,n,i,s,a,r){t.transform(e,n,i,s,a,r),this.__originalTransform(e,n,i,s,a,r)},e.setTransform=function(e,n,i,s,a,r){t.setTransform(e,n,i,s,a,r),this.__originalSetTransform(e,n,i,s,a,r)},e.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},e.rotate=function(e){t.rotate(e),this.__originalRotate(e)},e.clip=function(e){t.clip(e),this.__originalClip(e)},e.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},e.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},e.bezierCurveTo=function(e,n,i,s,a,r){t.bezierCurveTo(e,n,i,s,a,r),this.__originalBezierCurveTo(e,n,i,s,a,r)},e.rect=function(e,n,i,s){t.rect(e,n,i,s),this.__originalRect(e,n,i,s)},e.closePath=function(){t.closePath(),this.__originalClosePath()},e.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}(s,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),lo(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,i){const s=i[0],a=i[1],r=i[2]-s,o=i[3]-a;0!==r&&0!==o&&(this.genericComposeSMask(t.context,n,r,o,t.subtype,t.backdrop,t.transferMap,s,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,i,s,a,r,o,l,c,d){let h=e.canvas,u=o-c,p=l-d;if(a)if(u<0||p<0||u+n>h.width||p+i>h.height){const e=this.cachedCanvases.getCanvas("maskExtension",n,i),t=e.context;t.drawImage(h,-u,-p),t.globalCompositeOperation="destination-atop",t.fillStyle=a,t.fillRect(0,0,n,i),t.globalCompositeOperation="source-over",h=e.canvas,u=p=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const t=new Path2D;t.rect(u,p,n,i),e.clip(t),e.globalCompositeOperation="destination-atop",e.fillStyle=a,e.fillRect(u,p,n,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),"Alpha"===s&&r?t.filter=this.filterFactory.addAlphaFilter(r):"Luminosity"===s&&(t.filter=this.filterFactory.addLuminosityFilter(r));const m=new Path2D;m.rect(o,l,n,i),t.clip(m),t.globalCompositeOperation="destination-in",t.drawImage(h,u,p,n,i,o,l,n,i),t.restore()}save(){this.inSMaskMode&&lo(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){0!==this.stateStack.length?(this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&lo(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null):this.inSMaskMode&&this.endSMaskMode()}transform(e,t,n,i,s,a){this.ctx.transform(e,t,n,i,s,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n){let[i]=t;if(!n)return i||(i=t[0]=new Path2D),void this[e](i);if(!(i instanceof Path2D)){const e=t[0]=new Path2D;for(let t=0,n=i.length;t<n;)switch(i[t++]){case Ie:e.moveTo(i[t++],i[t++]);break;case Pe:e.lineTo(i[t++],i[t++]);break;case Le:e.bezierCurveTo(i[t++],i[t++],i[t++],i[t++],i[t++],i[t++]);break;case je:e.closePath();break;default:ze("Unrecognized drawing path operator: ".concat(i[t-1]))}i=e}it.axialAlignedBoundingBox(n,kt(this.ctx),this.current.minMax),this[e](i)}closePath(){this.ctx.closePath()}stroke(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.ctx,i=this.current.strokeColor;if(n.globalAlpha=this.current.strokeAlpha,this.contentVisible)if("object"===typeof i&&null!==i&&void 0!==i&&i.getPattern){const t=i.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.strokeStyle=i.getPattern(n,this,Ct(n),zr),t){const i=new Path2D;i.addPath(e,n.getTransform().invertSelf().multiplySelf(t)),e=i}this.rescaleAndStroke(e,!1),n.restore()}else this.rescaleAndStroke(e,!0);t&&this.consumePath(e,this.current.getClippedPathBoundingBox(zr,kt(this.ctx))),n.globalAlpha=this.current.fillAlpha}closeStroke(e){this.stroke(e)}fill(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.ctx,i=this.current.fillColor;let s=!1;if(this.current.patternFill){const t=i.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.fillStyle=i.getPattern(n,this,Ct(n),Wr),t){const i=new Path2D;i.addPath(e,n.getTransform().invertSelf().multiplySelf(t)),e=i}s=!0}const a=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==a&&(this.pendingEOFill?(n.fill(e,"evenodd"),this.pendingEOFill=!1):n.fill(e)),s&&n.restore(),t&&this.consumePath(e,a)}eoFill(e){this.pendingEOFill=!0,this.fill(e)}fillStroke(e){this.fill(e,!1),this.stroke(e,!1),this.consumePath(e)}eoFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}closeFillStroke(e){this.fillStroke(e)}closeEOFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}endPath(e){this.consumePath(e)}rawFillPath(e){this.ctx.fill(e)}clip(){this.pendingClip=mo}eoClip(){this.pendingClip=fo}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(void 0===e)return;const n=new Path2D,i=t.getTransform().invertSelf();for(const{transform:s,x:a,y:r,fontSize:o,path:l}of e)l&&n.addPath(l,new DOMMatrix(s).preMultiplySelf(i).translate(a,r).scale(o,-o));t.clip(n),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var n;const i=this.commonObjs.get(e),s=this.current;if(!i)throw new Error("Can't find font for ".concat(e));if(s.fontMatrix=i.fontMatrix||ie,0!==s.fontMatrix[0]&&0!==s.fontMatrix[3]||ze("Invalid font matrix for font "+e),t<0?(t=-t,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=t,i.isType3Font)return;const a=i.loadedName||"sans-serif",r=(null===(n=i.systemFontInfo)||void 0===n?void 0:n.css)||'"'.concat(a,'", ').concat(i.fallbackName);let o="normal";i.black?o="900":i.bold&&(o="bold");const l=i.italic?"italic":"normal";let c=t;t<16?c=16:t>100&&(c=100),this.current.fontSizeScale=t/c,this.ctx.font="".concat(l," ").concat(o," ").concat(c,"px ").concat(r)}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e){const{current:t}=this;t.textMatrix=e,t.textMatrixScale=Math.hypot(e[0],e[1]),t.x=t.lineX=0,t.y=t.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,n,i,s){const a=this.ctx,r=this.current,o=r.font,l=r.textRenderingMode,c=r.fontSize/r.fontSizeScale,d=l&we,h=!!(l&Ae),u=r.patternFill&&!o.missingFile,p=r.patternStroke&&!o.missingFile;let m;if((o.disableFontFace||h||u||p)&&!o.missingFile&&(m=o.getPathGenerator(this.commonObjs,e)),m&&(o.disableFontFace||u||p)){let e;if(a.save(),a.translate(t,n),a.scale(c,-c),d!==ve&&d!==be||(i?(e=a.getTransform(),a.setTransform(...i),a.fill(D(go,this,xo).call(this,m,e,i))):a.fill(m)),d===ye||d===be)if(s){e||(e=a.getTransform()),a.setTransform(...s);const{a:t,b:n,c:i,d:r}=e,o=it.inverseTransform(s),l=it.transform([t,n,i,r,0,0],o);it.singularValueDecompose2dScale(l,to),a.lineWidth*=Math.max(to[0],to[1])/c,a.stroke(D(go,this,xo).call(this,m,e,s))}else a.lineWidth/=c,a.stroke(m);a.restore()}else d!==ve&&d!==be||a.fillText(e,t,n),d!==ye&&d!==be||a.strokeText(e,t,n);if(h){(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:kt(a),x:t,y:n,fontSize:c,path:m})}}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){n=!0;break}return Ve(this,"isFontSubpixelAAEnabled",n)}showText(e){const t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);const i=t.fontSize;if(0===i)return;const s=this.ctx,a=t.fontSizeScale,r=t.charSpacing,o=t.wordSpacing,l=t.fontDirection,c=t.textHScale*l,d=e.length,h=n.vertical,u=h?1:-1,p=n.defaultVMetrics,m=i*t.fontMatrix[0],f=t.textRenderingMode===ve&&!n.disableFontFace&&!t.patternFill;let g,v;if(s.save(),t.textMatrix&&s.transform(...t.textMatrix),s.translate(t.x,t.y+t.textRise),l>0?s.scale(c,-1):s.scale(c,1),t.patternFill){s.save();const e=t.fillColor.getPattern(s,this,Ct(s),Wr);g=kt(s),s.restore(),s.fillStyle=e}if(t.patternStroke){s.save();const e=t.strokeColor.getPattern(s,this,Ct(s),zr);v=kt(s),s.restore(),s.strokeStyle=e}let y=t.lineWidth;const b=t.textMatrixScale;if(0===b||0===y){const e=t.textRenderingMode&we;e!==ye&&e!==be||(y=this.getSinglePixelWidth())}else y/=b;if(1!==a&&(s.scale(a,a),y/=a),s.lineWidth=y,n.isInvalidPDFjsFont){const n=[];let i=0;for(const t of e)n.push(t.unicode),i+=t.width;return s.fillText(n.join(""),0,0),t.x+=i*m*c,s.restore(),void this.compose()}let x,w=0;for(x=0;x<d;++x){const t=e[x];if("number"===typeof t){w+=u*t*i/1e3;continue}let c=!1;const d=(t.isSpace?o:0)+r,y=t.fontChar,b=t.accent;let A,_,S=t.width;if(h){const e=t.vmetric||p,n=-(t.vmetric?e[1]:.5*S)*m,i=e[2]*m;S=e?-e[0]:S,A=n/a,_=(w+i)/a}else A=w/a,_=0;if(n.remeasure&&S>0){const e=1e3*s.measureText(y).width/i*a;if(S<e&&this.isFontSubpixelAAEnabled){const t=S/e;c=!0,s.save(),s.scale(t,1),A/=t}else S!==e&&(A+=(S-e)/2e3*i/a)}if(this.contentVisible&&(t.isInFont||n.missingFile))if(f&&!b)s.fillText(y,A,_);else if(this.paintChar(y,A,_,g,v),b){const e=A+i*b.offset.x/a,t=_-i*b.offset.y/a;this.paintChar(b.fontChar,e,t,g,v)}w+=h?S*m-d*l:S*m+d*l,c&&s.restore()}h?t.y-=w:t.x+=w*c,s.restore(),this.compose()}showType3Text(e){const t=this.ctx,n=this.current,i=n.font,s=n.fontSize,a=n.fontDirection,r=i.vertical?1:-1,o=n.charSpacing,l=n.wordSpacing,c=n.textHScale*a,d=n.fontMatrix||ie,h=e.length;let u,p,m,f;if(!(n.textRenderingMode===xe)&&0!==s){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),n.textMatrix&&t.transform(...n.textMatrix),t.translate(n.x,n.y+n.textRise),t.scale(c,a),u=0;u<h;++u){if(p=e[u],"number"===typeof p){f=r*p*s/1e3,this.ctx.translate(f,0),n.x+=f*c;continue}const a=(p.isSpace?l:0)+o,h=i.charProcOperatorList[p.operatorListId];h?this.contentVisible&&(this.save(),t.scale(s,s),t.transform(...d),this.executeOperatorList(h),this.restore()):ze('Type3 character "'.concat(p.operatorListId,'" is not available.'));const g=[p.width,0];it.applyTransform(g,d),m=g[0]*s+a,t.translate(m,0),n.x+=m*c}t.restore()}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,n,i,s,a){const r=new Path2D;r.rect(n,i,s-n,a-i),this.ctx.clip(r),this.endPath()}getColorN_Pattern(e){let t;if("TilingPattern"===e[0]){const n=this.baseTransform||kt(this.ctx),i={createCanvasGraphics:e=>new vo(e,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new $r(e,this.ctx,i,n)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e){this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e){this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.cachedPatterns.has(e)?t=this.cachedPatterns.get(e):(t=function(e){switch(e[0]){case"RadialAxial":return new Gr(e);case"Mesh":return new Yr(e);case"Dummy":return new Kr}throw new Error("Unknown IR type: ".concat(e[0]))}(this.getObject(e)),this.cachedPatterns.set(e,t)),n&&(t.matrix=n),t}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const n=this._getPattern(e);t.fillStyle=n.getPattern(t,this,Ct(t),Br);const i=Ct(t);if(i){const{width:e,height:n}=t.canvas,s=no.slice();it.axialAlignedBoundingBox([0,0,e,n],i,s);const[a,r,o,l]=s;this.ctx.fillRect(a,r,o-a,l-r)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Be("Should not call beginInlineImage")}beginImageData(){Be("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=kt(this.ctx),t)){it.axialAlignedBoundingBox(t,this.baseTransform,this.current.minMax);const[e,n,i,s]=t,a=new Path2D;a.rect(e,n,i-e,s-n),this.ctx.clip(a),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||We("TODO: Support non-isolated groups."),e.knockout&&ze("Knockout groups not supported.");const n=kt(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=no.slice();it.axialAlignedBoundingBox(e.bbox,kt(t),i);const s=[0,0,t.canvas.width,t.canvas.height];i=it.intersect(i,s)||[0,0,0,0];const a=Math.floor(i[0]),r=Math.floor(i[1]),o=Math.max(Math.ceil(i[2])-a,1),l=Math.max(Math.ceil(i[3])-r,1);this.current.startNewPathAndClipBox([0,0,o,l]);let c="groupAt"+this.groupLevel;e.smask&&(c+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(c,o,l),h=d.context;h.translate(-a,-r),h.transform(...n);let u=new Path2D;const[p,m,f,g]=e.bbox;if(u.rect(p,m,f-p,g-m),e.matrix){const t=new Path2D;t.addPath(u,new DOMMatrix(e.matrix)),u=t}h.clip(u),e.smask?this.smaskStack.push({canvas:d.canvas,context:h,offsetX:a,offsetY:r,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,r),t.save()),lo(t,h),this.ctx=h,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const e=kt(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...e);const n=no.slice();it.axialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],e,n),this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(e,t,n,i,s){if(D(go,this,yo).call(this),co(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const i=t[2]-t[0],a=t[3]-t[1];if(s&&this.annotationCanvasMap){(n=n.slice())[4]-=t[0],n[5]-=t[1],(t=t.slice())[0]=t[1]=0,t[2]=i,t[3]=a,it.singularValueDecompose2dScale(kt(this.ctx),to);const{viewportScale:s}=this,r=Math.ceil(i*this.outputScaleX*s),o=Math.ceil(a*this.outputScaleY*s);this.annotationCanvas=this.canvasFactory.create(r,o);const{canvas:l,context:c}=this.annotationCanvas;this.annotationCanvasMap.set(e,l),this.annotationCanvas.savedCtx=this.ctx,this.ctx=c,this.ctx.save(),this.ctx.setTransform(to[0],0,0,-to[1],0,a*to[1]),co(this.ctx)}else{co(this.ctx),this.endPath();const e=new Path2D;e.rect(t[0],t[1],i,a),this.ctx.clip(e)}}this.current=new ao(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),D(go,this,bo).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;(e=this.getObject(e.data,e)).count=t;const n=this.ctx,i=this._createMaskCanvas(e),s=i.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(s,i.offsetX,i.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;if(!this.contentVisible)return;e=this.getObject(e.data,e);const r=this.ctx;r.save();const o=kt(r);r.transform(t,n,i,s,0,0);const l=this._createMaskCanvas(e);r.setTransform(1,0,0,1,l.offsetX-o[4],l.offsetY-o[5]);for(let c=0,d=a.length;c<d;c+=2){const e=it.transform(o,[t,n,i,s,a[c],a[c+1]]);r.drawImage(l.canvas,e[4],e[5])}r.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,n=this.current.fillColor,i=this.current.patternFill;for(const s of e){const{data:e,width:a,height:r,transform:o}=s,l=this.cachedCanvases.getCanvas("maskCanvas",a,r),c=l.context;c.save();oo(c,this.getObject(e,s)),c.globalCompositeOperation="source-in",c.fillStyle=i?n.getPattern(c,this,Ct(t),Wr):n,c.fillRect(0,0,a,r),c.restore(),t.save(),t.transform(...o),t.scale(1,-1),so(t,l.canvas,0,0,a,r,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);t?this.paintInlineImageXObject(t):ze("Dependent image isn't ready yet")}paintImageXObjectRepeat(e,t,n,i){if(!this.contentVisible)return;const s=this.getObject(e);if(!s)return void ze("Dependent image isn't ready yet");const a=s.width,r=s.height,o=[];for(let l=0,c=i.length;l<c;l+=2)o.push({transform:[t,0,0,n,i[l],i[l+1]],x:0,y:0,w:a,h:r});this.paintInlineImageXObjectGroup(s,o)}applyTransferMapsToCanvas(e){return"none"!==this.current.transferMaps&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if("none"===this.current.transferMaps)return e.bitmap;const{bitmap:t,width:n,height:i}=e,s=this.cachedCanvases.getCanvas("inlineImage",n,i),a=s.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",s.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,n=e.height,i=this.ctx;this.save();const{filter:s}=i;let a;if("none"!==s&&""!==s&&(i.filter="none"),i.scale(1/t,-1/n),e.bitmap)a=this.applyTransferMapsToBitmap(e);else if("function"===typeof HTMLElement&&e instanceof HTMLElement||!e.data)a=e;else{const i=this.cachedCanvases.getCanvas("inlineImage",t,n).context;ro(i,e),a=this.applyTransferMapsToCanvas(i)}const r=this._scaleImage(a,Ct(i));i.imageSmoothingEnabled=ho(kt(i),e.interpolate),so(i,r.img,0,0,r.paintWidth,r.paintHeight,0,-n,t,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx;let i;if(e.bitmap)i=e.bitmap;else{const t=e.width,n=e.height,s=this.cachedCanvases.getCanvas("inlineImage",t,n).context;ro(s,e),i=this.applyTransferMapsToCanvas(s)}for(const s of t)n.save(),n.transform(...s.transform),n.scale(1,-1),so(n,i,s.x,s.y,s.w,s.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){"OC"===e?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e,t){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const i=this.ctx;this.pendingClip&&(n||(this.pendingClip===fo?i.clip(e,"evenodd"):i.clip(e)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=kt(this.ctx);if(0===e[1]&&0===e[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(-1===this._cachedScaleForStroking[0]){const{lineWidth:e}=this.current,{a:t,b:n,c:i,d:s}=this.ctx.getTransform();let a,r;if(0===n&&0===i){const n=Math.abs(t),i=Math.abs(s);if(n===i)if(0===e)a=r=1/n;else{const t=n*e;a=r=t<1?1/t:1}else if(0===e)a=1/n,r=1/i;else{const t=n*e,s=i*e;a=t<1?1/t:1,r=s<1?1/s:1}}else{const o=Math.abs(t*s-n*i),l=Math.hypot(t,n),c=Math.hypot(i,s);if(0===e)a=c/o,r=l/o;else{const t=e*o;a=c>t?c/t:1,r=l>t?l/t:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=r}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:n,current:{lineWidth:i}}=this,[s,a]=this.getScaleForStroking();if(s===a)return n.lineWidth=(i||1)*s,void n.stroke(e);const r=n.getLineDash();t&&n.save(),n.scale(s,a),eo.a=1/s,eo.d=1/a;const o=new Path2D;if(o.addPath(e,eo),r.length>0){const e=Math.max(s,a);n.setLineDash(r.map(t=>t/e)),n.lineDashOffset/=e}n.lineWidth=i||1,n.stroke(o),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}function yo(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}function bo(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if("none"!==e){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}function xo(e,t,n){const i=new Path2D;return i.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),i}for(const Rg in Re)void 0!==vo.prototype[Rg]&&(vo.prototype[Re[Rg]]=vo.prototype[Rg]);class wo{static get workerPort(){return D(wo,this,Ao)._}static set workerPort(e){if(!("undefined"!==typeof Worker&&e instanceof Worker)&&null!==e)throw new Error("Invalid `workerPort` type.");Ao._=D(wo,this,e)}static get workerSrc(){return D(wo,this,_o)._}static set workerSrc(e){if("string"!==typeof e)throw new Error("Invalid `workerSrc` type.");_o._=D(wo,this,e)}}var Ao={_:null},_o={_:""},So=new WeakMap,Eo=new WeakMap;class ko{constructor(e){let{parsedData:t,rawData:n}=e;j(this,So,void 0),j(this,Eo,void 0),W(So,this,t),W(Eo,this,n)}getRaw(){return F(Eo,this)}get(e){var t;return null!==(t=F(So,this).get(e))&&void 0!==t?t:null}[Symbol.iterator](){return F(So,this).entries()}}const Co=Symbol("INTERNAL");var To=new WeakMap,No=new WeakMap,Mo=new WeakMap,Ro=new WeakMap;class Io{constructor(e,t){let{name:n,intent:i,usage:s,rbGroups:a}=t;j(this,To,!1),j(this,No,!1),j(this,Mo,!1),j(this,Ro,!0),W(To,this,!!(e&re)),W(No,this,!!(e&oe)),this.name=n,this.intent=i,this.usage=s,this.rbGroups=a}get visible(){if(F(Mo,this))return F(Ro,this);if(!F(Ro,this))return!1;const{print:e,view:t}=this.usage;return F(To,this)?"OFF"!==(null===t||void 0===t?void 0:t.viewState):!F(No,this)||"OFF"!==(null===e||void 0===e?void 0:e.printState)}_setVisible(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e!==Co&&Be("Internal method `_setVisible` called."),W(Mo,this,n),W(Ro,this,t)}}var Po=new WeakMap,Lo=new WeakMap,jo=new WeakMap,Do=new WeakMap,Oo=new WeakSet;class Fo{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:re;if(L(this,Oo),j(this,Po,null),j(this,Lo,new Map),j(this,jo,null),j(this,Do,null),this.renderingIntent=t,this.name=null,this.creator=null,null!==e){this.name=e.name,this.creator=e.creator,W(Do,this,e.order);for(const n of e.groups)F(Lo,this).set(n.id,new Io(t,n));if("OFF"===e.baseState)for(const e of F(Lo,this).values())e._setVisible(Co,!1);for(const t of e.on)F(Lo,this).get(t)._setVisible(Co,!0);for(const t of e.off)F(Lo,this).get(t)._setVisible(Co,!1);W(jo,this,this.getHash())}}isVisible(e){if(0===F(Lo,this).size)return!0;if(!e)return We("Optional content group not defined."),!0;if("OCG"===e.type)return F(Lo,this).has(e.id)?F(Lo,this).get(e.id).visible:(ze("Optional content group not found: ".concat(e.id)),!0);if("OCMD"===e.type){if(e.expression)return D(Oo,this,Wo).call(this,e.expression);if(!e.policy||"AnyOn"===e.policy){for(const t of e.ids){if(!F(Lo,this).has(t))return ze("Optional content group not found: ".concat(t)),!0;if(F(Lo,this).get(t).visible)return!0}return!1}if("AllOn"===e.policy){for(const t of e.ids){if(!F(Lo,this).has(t))return ze("Optional content group not found: ".concat(t)),!0;if(!F(Lo,this).get(t).visible)return!1}return!0}if("AnyOff"===e.policy){for(const t of e.ids){if(!F(Lo,this).has(t))return ze("Optional content group not found: ".concat(t)),!0;if(!F(Lo,this).get(t).visible)return!0}return!1}if("AllOff"===e.policy){for(const t of e.ids){if(!F(Lo,this).has(t))return ze("Optional content group not found: ".concat(t)),!0;if(F(Lo,this).get(t).visible)return!1}return!0}return ze("Unknown optional content policy ".concat(e.policy,".")),!0}return ze("Unknown group type ".concat(e.type,".")),!0}setVisibility(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=F(Lo,this).get(e);if(i){if(n&&t&&i.rbGroups.length)for(const t of i.rbGroups)for(const n of t){var s;if(n!==e)null===(s=F(Lo,this).get(n))||void 0===s||s._setVisible(Co,!1,!0)}i._setVisible(Co,!!t,!0),W(Po,this,null)}else ze("Optional content group not found: ".concat(e))}setOCGState(e){let t,{state:n,preserveRB:i}=e;for(const s of n){switch(s){case"ON":case"OFF":case"Toggle":t=s;continue}const e=F(Lo,this).get(s);if(e)switch(t){case"ON":this.setVisibility(s,!0,i);break;case"OFF":this.setVisibility(s,!1,i);break;case"Toggle":this.setVisibility(s,!e.visible,i)}}W(Po,this,null)}get hasInitialVisibility(){return null===F(jo,this)||this.getHash()===F(jo,this)}getOrder(){return F(Lo,this).size?F(Do,this)?F(Do,this).slice():[...F(Lo,this).keys()]:null}getGroup(e){return F(Lo,this).get(e)||null}getHash(){if(null!==F(Po,this))return F(Po,this);const e=new ya;for(const[t,n]of F(Lo,this))e.update("".concat(t,":").concat(n.visible));return W(Po,this,e.hexdigest())}[Symbol.iterator](){return F(Lo,this).entries()}}function Wo(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let i=1;i<t;i++){const t=e[i];let s;if(Array.isArray(t))s=D(Oo,this,Wo).call(this,t);else{if(!F(Lo,this).has(t))return ze("Optional content group not found: ".concat(t)),!0;s=F(Lo,this).get(t).visible}switch(n){case"And":if(!s)return!1;break;case"Or":if(s)return!0;break;case"Not":return!s;default:return!0}}return"And"===n}class zo{constructor(e,t){let{disableRange:n=!1,disableStream:i=!1}=t;He(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:a,progressiveDone:r,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=r,this._contentDispositionFilename=o,(null===a||void 0===a?void 0:a.length)>0){const e=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;this._queuedChunks.push(e)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!i,this._isRangeSupported=!n,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((e,t)=>{this._onReceiveData({begin:e,chunk:t})}),e.addProgressListener((e,t)=>{this._onProgress({loaded:e,total:t})}),e.addProgressiveReadListener(e=>{this._onReceiveData({chunk:e})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData(e){let{begin:t,chunk:n}=e;const i=n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer;if(void 0===t)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{He(this._rangeReaders.some(function(e){return e._begin===t&&(e._enqueue(i),!0)}),"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e,t;return null!==(e=null===(t=this._fullRequestReader)||void 0===t?void 0:t._loaded)&&void 0!==e?e:0}_onProgress(e){var t,n,i,s;void 0===e.total?null===(t=this._rangeReaders[0])||void 0===t||null===(n=t.onProgress)||void 0===n||n.call(t,{loaded:e.loaded}):null===(i=this._fullRequestReader)||void 0===i||null===(s=i.onProgress)||void 0===s||s.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;null===(e=this._fullRequestReader)||void 0===e||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){He(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new Bo(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new Ho(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){var t;null===(t=this._fullRequestReader)||void 0===t||t.cancel(e);for(const n of this._rangeReaders.slice(0))n.cancel(e);this._pdfDataRangeTransport.abort()}}class Bo{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this._stream=e,this._done=n||!1,this._filename=yt(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length>0){this._requests.shift().resolve({value:e,done:!1})}else this._queuedChunks.push(e);this._loaded+=e.byteLength}}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0){return{value:this._queuedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Ho{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(0===this._requests.length)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Uo(e,t){const n=new Headers;if(!e||!t||"object"!==typeof t)return n;for(const i in t){const e=t[i];void 0!==e&&n.append(i,e)}return n}function Go(e){var t,n;return null!==(t=null===(n=URL.parse(e))||void 0===n?void 0:n.origin)&&void 0!==t?t:null}function Vo(e){let{responseHeaders:t,isHttp:n,rangeChunkSize:i,disableRange:s}=e;const a={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(t.get("Content-Length"),10);if(!Number.isInteger(r))return a;if(a.suggestedLength=r,r<=2*i)return a;if(s||!n)return a;if("bytes"!==t.get("Accept-Ranges"))return a;return"identity"!==(t.get("Content-Encoding")||"identity")||(a.allowRangeRequests=!0),a}function qo(e){const t=e.get("Content-Disposition");if(t){let e=function(e){let t=!0,n=i("filename\\*","i").exec(e);if(n){n=n[1];let e=r(n);return e=unescape(e),e=o(e),e=l(e),a(e)}if(n=function(e){const t=[];let n;const s=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(n=s.exec(e));){let[,e,i,s]=n;if(e=parseInt(e,10),e in t){if(0===e)break}else t[e]=[i,s]}const a=[];for(let i=0;i<t.length&&i in t;++i){let[e,n]=t[i];n=r(n),e&&(n=unescape(n),0===i&&(n=o(n))),a.push(n)}return a.join("")}(e),n)return a(l(n));if(n=i("filename","i").exec(e),n){n=n[1];let e=r(n);return e=l(e),a(e)}function i(e,t){return new RegExp("(?:^|;)\\s*"+e+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',t)}function s(e,n){if(e){if(!/^[\x00-\xFF]+$/.test(n))return n;try{const i=new TextDecoder(e,{fatal:!0}),s=et(n);n=i.decode(s),t=!1}catch(i){}}return n}function a(e){return t&&/[\x80-\xff]/.test(e)&&(e=s("utf-8",e),t&&(e=s("iso-8859-1",e))),e}function r(e){if(e.startsWith('"')){const t=e.slice(1).split('\\"');for(let e=0;e<t.length;++e){const n=t[e].indexOf('"');-1!==n&&(t[e]=t[e].slice(0,n),t.length=e+1),t[e]=t[e].replaceAll(/\\(.)/g,"$1")}e=t.join('"')}return e}function o(e){const t=e.indexOf("'");return-1===t?e:s(e.slice(0,t),e.slice(t+1).replace(/^[^']*'/,""))}function l(e){return!e.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(e)?e:e.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(e,t,n,i){if("q"===n||"Q"===n)return s(t,i=(i=i.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,function(e,t){return String.fromCharCode(parseInt(t,16))}));try{i=atob(i)}catch(a){}return s(t,i)})}return""}(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch(n){}if(yt(e))return e}return null}function Yo(e,t){return new Qe("Unexpected server response (".concat(e,') while retrieving PDF "').concat(t,'".'),e,404===e||0===e&&t.startsWith("file:"))}function Ko(e){return 200===e||206===e}function Xo(e,t,n){return{method:"GET",headers:e,signal:n.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function Qo(e){return e instanceof Uint8Array?e.buffer:e instanceof ArrayBuffer?e:(ze("getArrayBuffer - unexpected data format: ".concat(e)),new Uint8Array(e).buffer)}class $o{constructor(e){o(this,"_responseOrigin",null),this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=Uo(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e,t;return null!==(e=null===(t=this._fullRequestReader)||void 0===t?void 0:t._loaded)&&void 0!==e?e:0}getFullReader(){return He(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Jo(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new Zo(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;null===(t=this._fullRequestReader)||void 0===t||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class Jo{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),i=t.url;fetch(i,Xo(n,this._withCredentials,this._abortController)).then(t=>{if(e._responseOrigin=Go(t.url),!Ko(t.status))throw Yo(t.status,i);this._reader=t.body.getReader(),this._headersCapability.resolve();const n=t.headers,{allowRangeRequests:s,suggestedLength:a}=Vo({responseHeaders:n,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=a||this._contentLength,this._filename=qo(n),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Je("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;await this._headersCapability.promise;const{value:t,done:n}=await this._reader.read();return n?{value:t,done:n}:(this._loaded+=t.byteLength,null===(e=this.onProgress)||void 0===e||e.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Qo(t),done:!1})}cancel(e){var t;null===(t=this._reader)||void 0===t||t.cancel(e),this._abortController.abort()}}class Zo{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const s=new Headers(e.headers);s.append("Range","bytes=".concat(t,"-").concat(n-1));const a=i.url;fetch(a,Xo(s,this._withCredentials,this._abortController)).then(t=>{const n=Go(t.url);if(n!==e._responseOrigin)throw new Error('Expected range response-origin "'.concat(n,'" to match "').concat(e._responseOrigin,'".'));if(!Ko(t.status))throw Yo(t.status,a);this._readCapability.resolve(),this._reader=t.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;await this._readCapability.promise;const{value:t,done:n}=await this._reader.read();return n?{value:t,done:n}:(this._loaded+=t.byteLength,null===(e=this.onProgress)||void 0===e||e.call(this,{loaded:this._loaded}),{value:Qo(t),done:!1})}cancel(e){var t;null===(t=this._reader)||void 0===t||t.cancel(e),this._abortController.abort()}}class el{constructor(e){let{url:t,httpHeaders:n,withCredentials:i}=e;o(this,"_responseOrigin",null),this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=Uo(this.isHttp,n),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,i=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[s,a]of this.headers)t.setRequestHeader(s,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range","bytes=".concat(e.begin,"-").concat(e.end-1)),i.expectedStatus=206):i.expectedStatus=200,t.responseType="arraybuffer",He(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){var n;const i=this.pendingRequests[e];i&&(null===(n=i.onProgress)||void 0===n||n.call(i,t))}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),4!==i.readyState)return;if(!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],0===i.status&&this.isHttp)return void n.onError(i.status);const s=i.status||200;if(!(200===s&&206===n.expectedStatus)&&s!==n.expectedStatus)return void n.onError(i.status);const a=function(e){const t=e.response;return"string"!==typeof t?t:et(t).buffer}(i);if(206===s){const e=i.getResponseHeader("Content-Range"),t=/bytes (\d+)-(\d+)\/(\d+)/.exec(e);t?n.onDone({begin:parseInt(t[1],10),chunk:a}):(ze('Missing or invalid "Content-Range" header.'),n.onError(0))}else a?n.onDone({begin:0,chunk:a}):n.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class tl{constructor(e){this._source=e,this._manager=new el(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return He(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new nl(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new il(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;null===(t=this._fullRequestReader)||void 0===t||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class nl{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Go(t.responseURL);const n=t.getAllResponseHeaders(),i=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(e=>{const[t,...n]=e.split(": ");return[t,n.join(": ")]}):[]),{allowRangeRequests:s,suggestedLength:a}=Vo({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=qo(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e)if(this._requests.length>0){this._requests.shift().resolve({value:e.chunk,done:!1})}else this._cachedChunks.push(e.chunk);if(this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Yo(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;null===(t=this.onProgress)||void 0===t||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0){return{value:this._cachedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class il{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var e;const t=Go(null===(e=this._manager.getRequestXhr(this._requestId))||void 0===e?void 0:e.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error('Expected range response-origin "'.concat(t,'" to match "').concat(this._manager._responseOrigin,'".')),this._onError(0))}_close(){var e;null===(e=this.onClosed)||void 0===e||e.call(this,this)}_onDone(e){const t=e.chunk;if(this._requests.length>0){this._requests.shift().resolve({value:t,done:!1})}else this._queuedChunk=t;this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){var t;null!==(t=this._storedError)&&void 0!==t||(this._storedError=Yo(e,this._url));for(const n of this._requests)n.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(null===(t=this.onProgress)||void 0===t||t.call(this,{loaded:e.loaded}))}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(null!==this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const sl=/^[a-z][a-z0-9\-+.]+:/i;class al{constructor(e){this.source=e,this.url=function(e){if(sl.test(e))return new URL(e);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(e))}(e.url),He("file:"===this.url.protocol,"PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e,t;return null!==(e=null===(t=this._fullRequestReader)||void 0===t?void 0:t._loaded)&&void 0!==e?e:0}getFullReader(){return He(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new rl(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new ol(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;null===(t=this._fullRequestReader)||void 0===t||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class rl{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(e=>{this._contentLength=e.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},e=>{"ENOENT"===e.code&&(e=Yo(0,this._url.href)),this._storedError=e,this._headersCapability.reject(e)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();if(null===t)return this._readCapability=Promise.withResolvers(),this.read();this._loaded+=t.length,null===(e=this.onProgress)||void 0===e||e.call(this,{loaded:this._loaded,total:this._contentLength});return{value:new Uint8Array(t).buffer,done:!1}}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Je("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class ol{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();if(null===t)return this._readCapability=Promise.withResolvers(),this.read();this._loaded+=t.length,null===(e=this.onProgress)||void 0===e||e.call(this,{loaded:this._loaded});return{value:new Uint8Array(t).buffer,done:!1}}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const ll=Symbol("INITIAL_DATA");var cl=new WeakMap,dl=new WeakSet;class hl{constructor(){L(this,dl),j(this,cl,Object.create(null))}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t){const n=D(dl,this,ul).call(this,e);return n.promise.then(()=>t(n.data)),null}const n=F(cl,this)[e];if(!n||n.data===ll)throw new Error("Requesting object that isn't resolved yet ".concat(e,"."));return n.data}has(e){const t=F(cl,this)[e];return!!t&&t.data!==ll}delete(e){const t=F(cl,this)[e];return!(!t||t.data===ll)&&(delete F(cl,this)[e],!0)}resolve(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=D(dl,this,ul).call(this,e);n.data=t,n.resolve()}clear(){for(const t in F(cl,this)){var e;const{data:n}=F(cl,this)[t];null===n||void 0===n||null===(e=n.bitmap)||void 0===e||e.close()}W(cl,this,Object.create(null))}*[Symbol.iterator](){for(const e in F(cl,this)){const{data:t}=F(cl,this)[e];t!==ll&&(yield[e,t])}}}function ul(e){var t;return(t=F(cl,this))[e]||(t[e]=c(c({},Promise.withResolvers()),{},{data:ll}))}var pl=new WeakMap,ml=new WeakMap,fl=new WeakMap,gl=new WeakMap,vl=new WeakMap,yl=new WeakMap,bl=new WeakMap,xl=new WeakMap,wl=new WeakMap,Al=new WeakMap,_l=new WeakMap,Sl=new WeakMap,El=new WeakMap,kl=new WeakMap,Cl=new WeakMap,Tl=new WeakMap,Nl=new WeakMap,Ml=new WeakMap,Rl=new WeakSet;class Il{constructor(e){var t;let{textContentSource:n,container:i,viewport:s}=e;if(L(this,Rl),j(this,pl,Promise.withResolvers()),j(this,ml,null),j(this,fl,!1),j(this,gl,!(null===(t=globalThis.FontInspector)||void 0===t||!t.enabled)),j(this,vl,null),j(this,yl,null),j(this,bl,0),j(this,xl,0),j(this,wl,null),j(this,Al,null),j(this,_l,0),j(this,Sl,0),j(this,El,Object.create(null)),j(this,kl,[]),j(this,Cl,null),j(this,Tl,[]),j(this,Nl,new WeakMap),j(this,Ml,null),n instanceof ReadableStream)W(Cl,this,n);else{if("object"!==typeof n)throw new Error('No "textContentSource" parameter specified.');W(Cl,this,new ReadableStream({start(e){e.enqueue(n),e.close()}}))}W(ml,this,W(Al,this,i)),W(Sl,this,s.scale*Nt.pixelRatio),W(_l,this,s.rotation),W(yl,this,{div:null,properties:null,ctx:null});const{pageWidth:a,pageHeight:r,pageX:o,pageY:l}=s.rawDims;W(Ml,this,[1,0,0,-1,-o,l+r]),W(xl,this,a),W(bl,this,r),Fl.call(Il),Tt(i,s),F(pl,this).promise.finally(()=>{Gl._.delete(this),W(yl,this,null),W(El,this,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=tt.platform;return Ve(this,"fontFamilyMap",new Map([["sans-serif","".concat(e&&t?"Calibri, ":"","sans-serif")],["monospace","".concat(e&&t?"Lucida Console, ":"","monospace")]]))}render(){const e=()=>{F(wl,this).read().then(t=>{var n;let{value:i,done:s}=t;s?F(pl,this).resolve():(null!==(n=F(vl,this))&&void 0!==n||W(vl,this,i.lang),Object.assign(F(El,this),i.styles),D(Rl,this,Pl).call(this,i.items),e())},F(pl,this).reject)};return W(wl,this,F(Cl,this).getReader()),Gl._.add(this),e(),F(pl,this).promise}update(e){let{viewport:t,onBefore:n=null}=e;const i=t.scale*Nt.pixelRatio,s=t.rotation;if(s!==F(_l,this)&&(null===n||void 0===n||n(),W(_l,this,s),Tt(F(Al,this),{rotation:s})),i!==F(Sl,this)){null===n||void 0===n||n(),W(Sl,this,i);const e={div:null,properties:null,ctx:Dl.call(Il,F(vl,this))};for(const t of F(Tl,this))e.properties=F(Nl,this).get(t),e.div=t,D(Rl,this,jl).call(this,e)}}cancel(){var e;const t=new Je("TextLayer task cancelled.");null===(e=F(wl,this))||void 0===e||e.cancel(t).catch(()=>{}),W(wl,this,null),F(pl,this).reject(t)}get textDivs(){return F(Tl,this)}get textContentItemsStr(){return F(kl,this)}static cleanup(){if(!(D(Il,this,Gl)._.size>0)){D(Il,this,zl)._.clear();for(const{canvas:e}of D(Il,this,Bl)._.values())e.remove();D(Il,this,Bl)._.clear()}}}function Pl(e){var t,n;if(F(fl,this))return;null!==(n=(t=F(yl,this)).ctx)&&void 0!==n||(t.ctx=Dl.call(q,F(vl,this)));const i=F(Tl,this),s=F(kl,this);for(const a of e){if(i.length>1e5)return ze("Ignoring additional textDivs for performance reasons."),void W(fl,this,!0);if(void 0!==a.str)s.push(a.str),D(Rl,this,Ll).call(this,a);else if("beginMarkedContentProps"===a.type||"beginMarkedContent"===a.type){const e=F(ml,this);W(ml,this,document.createElement("span")),F(ml,this).classList.add("markedContent"),a.id&&F(ml,this).setAttribute("id","".concat(a.id)),e.append(F(ml,this))}else"endMarkedContent"===a.type&&W(ml,this,F(ml,this).parentNode)}}function Ll(e){const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:""!==e.str,hasEOL:e.hasEOL,fontSize:0};F(Tl,this).push(t);const i=it.transform(F(Ml,this),e.transform);let s=Math.atan2(i[1],i[0]);const a=F(El,this)[e.fontName];a.vertical&&(s+=Math.PI/2);let r=F(gl,this)&&a.fontSubstitution||a.fontFamily;r=q.fontFamilyMap.get(r)||r;const o=Math.hypot(i[2],i[3]),l=o*Wl.call(q,r,a,F(vl,this));let c,d;0===s?(c=i[4],d=i[5]-l):(c=i[4]+l*Math.sin(s),d=i[5]-l*Math.cos(s));const h="calc(var(--total-scale-factor) *",u=t.style;F(ml,this)===F(Al,this)?(u.left="".concat((100*c/F(xl,this)).toFixed(2),"%"),u.top="".concat((100*d/F(bl,this)).toFixed(2),"%")):(u.left="".concat(h).concat(c.toFixed(2),"px)"),u.top="".concat(h).concat(d.toFixed(2),"px)")),u.fontSize="".concat(h).concat((Ul._*o).toFixed(2),"px)"),u.fontFamily=r,n.fontSize=o,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,F(gl,this)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),0!==s&&(n.angle=s*(180/Math.PI));let p=!1;if(e.str.length>1)p=!0;else if(" "!==e.str&&e.transform[0]!==e.transform[3]){const t=Math.abs(e.transform[0]),n=Math.abs(e.transform[3]);t!==n&&Math.max(t,n)/Math.min(t,n)>1.5&&(p=!0)}if(p&&(n.canvasWidth=a.vertical?e.height:e.width),F(Nl,this).set(t,n),F(yl,this).div=t,F(yl,this).properties=n,D(Rl,this,jl).call(this,F(yl,this)),n.hasText&&F(ml,this).append(t),n.hasEOL){const e=document.createElement("br");e.setAttribute("role","presentation"),F(ml,this).append(e)}}function jl(e){const{div:t,properties:n,ctx:i}=e,{style:s}=t;let a="";if(Ul._>1&&(a="scale(".concat(1/Ul._,")")),0!==n.canvasWidth&&n.hasText){const{fontFamily:e}=s,{canvasWidth:r,fontSize:o}=n;Ol.call(q,i,o*F(Sl,this),e);const{width:l}=i.measureText(t.textContent);l>0&&(a="scaleX(".concat(r*F(Sl,this)/l,") ").concat(a))}0!==n.angle&&(a="rotate(".concat(n.angle,"deg) ").concat(a)),a.length>0&&(s.transform=a)}function Dl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=D(q,this,Bl)._.get(e||(e=""));if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),D(q,this,Bl)._.set(e,t),D(q,this,Hl)._.set(t,{size:0,family:""})}return t}function Ol(e,t,n){const i=D(q,this,Hl)._.get(e);t===i.size&&n===i.family||(e.font="".concat(t,"px ").concat(n),i.size=t,i.family=n)}function Fl(){if(null!==D(q,this,Ul)._)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),Ul._=D(q,this,e.getBoundingClientRect().height),e.remove()}function Wl(e,t,n){const i=D(q,this,zl)._.get(e);if(i)return i;const s=D(q,this,Dl).call(this,n);s.canvas.width=s.canvas.height=30,D(q,this,Ol).call(this,s,30,e);const a=s.measureText(""),r=a.fontBoundingBoxAscent,o=Math.abs(a.fontBoundingBoxDescent);s.canvas.width=s.canvas.height=0;let l=.8;return r?l=r/(r+o):(tt.platform.isFirefox&&ze("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?l=t.ascent:t.descent&&(l=1+t.descent)),D(q,this,zl)._.set(e,l),l}q=Il;var zl={_:new Map},Bl={_:new Map},Hl={_:new WeakMap},Ul={_:null},Gl={_:new Set};class Vl{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};return function e(n){var i;if(!n)return;let s=null;const a=n.name;if("#text"===a)s=n.value;else{if(!Vl.shouldBuildText(a))return;null!==n&&void 0!==n&&null!==(i=n.attributes)&&void 0!==i&&i.textContent?s=n.attributes.textContent:n.value&&(s=n.value)}if(null!==s&&t.push({str:s}),n.children)for(const t of n.children)e(t)}(e),n}static shouldBuildText(e){return!("textarea"===e||"input"===e||"option"===e||"select"===e)}}function ql(){var e,t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"string"===typeof n||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const i=new Yl,{docId:s}=i,a=n.url?function(e){if(e instanceof URL)return e.href;if("string"===typeof e){if(ne)return e;const t=URL.parse(e,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}(n.url):null,r=n.data?function(e){if(ne&&"undefined"!==typeof Buffer&&e instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength)return e;if("string"===typeof e)return et(e);if(e instanceof ArrayBuffer||ArrayBuffer.isView(e)||"object"===typeof e&&!isNaN(null===e||void 0===e?void 0:e.length))return new Uint8Array(e);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}(n.data):null,o=n.httpHeaders||null,l=!0===n.withCredentials,c=null!==(e=n.password)&&void 0!==e?e:null,d=n.range instanceof ec?n.range:null,h=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:65536;let u=n.worker instanceof hc?n.worker:null;const p=n.verbosity,m="string"!==typeof n.docBaseUrl||vt(n.docBaseUrl)?null:n.docBaseUrl,f=Ra(n.cMapUrl),g=!1!==n.cMapPacked,v=n.CMapReaderFactory||(ne?Dr:rr),y=Ra(n.iccUrl),b=Ra(n.standardFontDataUrl),x=n.StandardFontDataFactory||(ne?Or:Mr),w=Ra(n.wasmUrl),A=n.WasmFactory||(ne?Fr:Ir),_=!0!==n.stopAtErrors,S=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,E=!1!==n.isEvalSupported,k="boolean"===typeof n.isOffscreenCanvasSupported?n.isOffscreenCanvasSupported:!ne,C="boolean"===typeof n.isImageDecoderSupported?n.isImageDecoderSupported:!ne&&(tt.platform.isFirefox||!globalThis.chrome),T=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,N="boolean"===typeof n.disableFontFace?n.disableFontFace:ne,M=!0===n.fontExtraProperties,R=!0===n.enableXfa,I=n.ownerDocument||globalThis.document,P=!0===n.disableRange,L=!0===n.disableStream,j=!0===n.disableAutoFetch,D=!0===n.pdfBug,O=n.CanvasFactory||(ne?jr:sr),F=n.FilterFactory||(ne?Lr:gr),W=!0===n.enableHWA,z=!1!==n.useWasm,B=d?d.length:null!==(t=n.length)&&void 0!==t?t:NaN,H="boolean"===typeof n.useSystemFonts?n.useSystemFonts:!ne&&!N,U="boolean"===typeof n.useWorkerFetch?n.useWorkerFetch:!!(v===rr&&x===Mr&&A===Ir&&f&&b&&w&&xt(f,document.baseURI)&&xt(b,document.baseURI)&&xt(w,document.baseURI));Oe(p);const G={canvasFactory:new O({ownerDocument:I,enableHWA:W}),filterFactory:new F({docId:s,ownerDocument:I}),cMapReaderFactory:U?null:new v({baseUrl:f,isCompressed:g}),standardFontDataFactory:U?null:new x({baseUrl:b}),wasmFactory:U?null:new A({baseUrl:w})};u||(u=hc.create({verbosity:p,port:wo.workerPort}),i._worker=u);const V={docId:s,apiVersion:"5.4.54",data:r,password:c,disableAutoFetch:j,rangeChunkSize:h,length:B,docBaseUrl:m,enableXfa:R,evaluatorOptions:{maxImageSize:S,disableFontFace:N,ignoreErrors:_,isEvalSupported:E,isOffscreenCanvasSupported:k,isImageDecoderSupported:C,canvasMaxAreaInBytes:T,fontExtraProperties:M,useSystemFonts:H,useWasm:z,useWorkerFetch:U,cMapUrl:f,iccUrl:y,standardFontDataUrl:b,wasmUrl:w}},q={ownerDocument:I,pdfBug:D,styleElement:null,loadingParams:{disableAutoFetch:j,enableXfa:R}};return u.promise.then(function(){if(i.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const e=u.messageHandler.sendWithPromise("GetDocRequest",V,r?[r.buffer]:null);let t;if(d)t=new zo(d,{disableRange:P,disableStream:L});else if(!r){if(!a)throw new Error("getDocument - no `url` parameter provided.");const e=xt(a)?$o:ne?al:tl;t=new e({url:a,length:B,httpHeaders:o,withCredentials:l,rangeChunkSize:h,disableRange:P,disableStream:L})}return e.then(e=>{if(i.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const n=new $a(s,e,u.port),a=new kc(n,i,t,q,G,W);i._transport=a,n.send("Ready",null)})}).catch(i._capability.reject),i}class Yl{constructor(){o(this,"_capability",Promise.withResolvers()),o(this,"_transport",null),o(this,"_worker",null),o(this,"docId","d".concat((Kl._=(Y=Kl._,K=Y++,Y),K))),o(this,"destroyed",!1),o(this,"onPassword",null),o(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e;this.destroyed=!0;try{var t,n;null!==(t=this._worker)&&void 0!==t&&t.port&&(this._worker._pendingDestroy=!0),await(null===(n=this._transport)||void 0===n?void 0:n.destroy())}catch(s){var i;throw null!==(i=this._worker)&&void 0!==i&&i.port&&delete this._worker._pendingDestroy,s}this._transport=null,null===(e=this._worker)||void 0===e||e.destroy(),this._worker=null}async getData(){return this._transport.getData()}}var Kl={_:0},Xl=new WeakMap,Ql=new WeakMap,$l=new WeakMap,Jl=new WeakMap,Zl=new WeakMap;class ec{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;j(this,Xl,Promise.withResolvers()),j(this,Ql,[]),j(this,$l,[]),j(this,Jl,[]),j(this,Zl,[]),this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=i}addRangeListener(e){F(Zl,this).push(e)}addProgressListener(e){F(Jl,this).push(e)}addProgressiveReadListener(e){F($l,this).push(e)}addProgressiveDoneListener(e){F(Ql,this).push(e)}onDataRange(e,t){for(const n of F(Zl,this))n(e,t)}onDataProgress(e,t){F(Xl,this).promise.then(()=>{for(const n of F(Jl,this))n(e,t)})}onDataProgressiveRead(e){F(Xl,this).promise.then(()=>{for(const t of F($l,this))t(e)})}onDataProgressiveDone(){F(Xl,this).promise.then(()=>{for(const e of F(Ql,this))e()})}transportReady(){F(Xl,this).resolve()}requestDataRange(e,t){Be("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class tc{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ve(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){let{intent:e="display"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var nc=new WeakMap,ic=new WeakSet;class sc{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];L(this,ic),j(this,nc,!1),this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=i?new bt:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new hl,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport(){let{scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:s=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new ft({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:s})}getAnnotations(){let{intent:e="display"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ve(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return(null===(e=this._transport._htmlForXfa)||void 0===e?void 0:e.children[this._pageIndex])||null}render(e){var t,n;let{canvasContext:i,canvas:s=i.canvas,viewport:a,intent:r="display",annotationMode:o=pe.ENABLE,transform:l=null,background:c=null,optionalContentConfigPromise:d=null,annotationCanvasMap:h=null,pageColors:u=null,printAnnotationStorage:p=null,isEditing:m=!1}=e;null===(t=this._stats)||void 0===t||t.time("Overall");const f=this._transport.getRenderingIntent(r,o,p,m),{renderingIntent:g,cacheKey:v}=f;W(nc,this,!1),d||(d=this._transport.getOptionalContentConfig(g));let y=this._intentStates.get(v);y||(y=Object.create(null),this._intentStates.set(v,y)),y.streamReaderCancelTimeout&&(clearTimeout(y.streamReaderCancelTimeout),y.streamReaderCancelTimeout=null);const b=!!(g&oe);var x;y.displayReadyCapability||(y.displayReadyCapability=Promise.withResolvers(),y.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},null===(x=this._stats)||void 0===x||x.time("Page Request"),this._pumpOperatorList(f));const w=e=>{var t;(y.renderTasks.delete(A),b&&W(nc,this,!0),D(ic,this,ac).call(this),e?(A.capability.reject(e),this._abortOperatorList({intentState:y,reason:e instanceof Error?e:new Error(e)})):A.capability.resolve(),this._stats)&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),null!==(t=globalThis.Stats)&&void 0!==t&&t.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},A=new Rc({callback:w,params:{canvas:s,canvasContext:i,viewport:a,transform:l,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:y.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!b,pdfBug:this._pdfBug,pageColors:u,enableHWA:this._transport.enableHWA});((n=y).renderTasks||(n.renderTasks=new Set)).add(A);const _=A.task;return Promise.all([y.displayReadyCapability.promise,d]).then(e=>{var t;let[n,i]=e;if(this.destroyed)w();else{if(null===(t=this._stats)||void 0===t||t.time("Rendering"),!(i.renderingIntent&g))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");A.initializeGraphics({transparency:n,optionalContentConfig:i}),A.operatorListChanged()}}).catch(w),_}getOperatorList(){let{intent:e="display",annotationMode:t=pe.ENABLE,printAnnotationStorage:n=null,isEditing:i=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const s=this._transport.getRenderingIntent(e,t,n,i,!0);let a,r=this._intentStates.get(s.cacheKey);var o,l;(r||(r=Object.create(null),this._intentStates.set(s.cacheKey,r)),r.opListReadCapability)||(a=Object.create(null),a.operatorListChanged=function(){r.operatorList.lastChunk&&(r.opListReadCapability.resolve(r.operatorList),r.renderTasks.delete(a))},r.opListReadCapability=Promise.withResolvers(),((o=r).renderTasks||(o.renderTasks=new Set)).add(a),r.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},null===(l=this._stats)||void 0===l||l.time("Page Request"),this._pumpOperatorList(s));return r.opListReadCapability.promise}streamTextContent(){let{includeMarkedContent:e=!1,disableNormalization:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:!0===e,disableNormalization:!0===t},{highWaterMark:100,size:e=>e.items.length})}getTextContent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._transport._htmlForXfa)return this.getXfa().then(e=>Vl.textContent(e));const t=this.streamTextContent(e);return new Promise(function(e,n){const i=t.getReader(),s={items:[],styles:Object.create(null),lang:null};!function t(){i.read().then(function(n){var i;let{value:a,done:r}=n;r?e(s):(null!==(i=s.lang)&&void 0!==i||(s.lang=a.lang),Object.assign(s.styles,a.styles),s.items.push(...a.items),t())},n)}()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),W(nc,this,!1),Promise.all(e)}cleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];W(nc,this,!0);const t=D(ic,this,ac).call(this);return e&&t&&this._stats&&(this._stats=new bt),t}_startRenderPage(e,t){var n,i;const s=this._intentStates.get(t);s&&(null===(n=this._stats)||void 0===n||n.timeEnd("Page Request"),null===(i=s.displayReadyCapability)||void 0===i||i.resolve(e))}_renderPageChunk(e,t){for(let n=0,i=e.length;n<i;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&D(ic,this,ac).call(this)}_pumpOperatorList(e){let{renderingIntent:t,cacheKey:n,annotationStorageSerializable:i,modifiedIds:s}=e;const{map:a,transfer:r}=i,o=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:n,annotationStorage:a,modifiedIds:s},r).getReader(),l=this._intentStates.get(n);l.streamReader=o;const c=()=>{o.read().then(e=>{let{value:t,done:n}=e;n?l.streamReader=null:this._transport.destroyed||(this._renderPageChunk(t,l),c())},e=>{if(l.streamReader=null,!this._transport.destroyed){if(l.operatorList){l.operatorList.lastChunk=!0;for(const e of l.renderTasks)e.operatorListChanged();D(ic,this,ac).call(this)}if(l.displayReadyCapability)l.displayReadyCapability.reject(e);else{if(!l.opListReadCapability)throw e;l.opListReadCapability.reject(e)}}})};c()}_abortOperatorList(e){let{intentState:t,reason:n,force:i=!1}=e;if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(n instanceof gt){let e=100;return n.extraDelay>0&&n.extraDelay<1e3&&(e+=n.extraDelay),void(t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:n,force:!0})},e))}}if(t.streamReader.cancel(new Je(n.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[e,n]of this._intentStates)if(n===t){this._intentStates.delete(e);break}this.cleanup()}}}get stats(){return this._stats}}function ac(){if(!F(nc,this)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),W(nc,this,!1),!0}var rc=new WeakMap,oc=new WeakMap,lc=new WeakMap,cc=new WeakMap,dc=new WeakSet;class hc{constructor(){let{name:e=null,port:t=null,verbosity:n=Fe()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(L(this,dc),j(this,rc,Promise.withResolvers()),j(this,oc,null),j(this,lc,null),j(this,cc,null),this.name=e,this.destroyed=!1,this.verbosity=n,t){if(bc._.has(t))throw new Error("Cannot use more than one PDFWorker per port.");bc._.set(t,this),D(dc,this,pc).call(this,t)}else D(dc,this,mc).call(this)}get promise(){return F(rc,this).promise}get port(){return F(lc,this)}get messageHandler(){return F(oc,this)}destroy(){var e,t;this.destroyed=!0,null===(e=F(cc,this))||void 0===e||e.terminate(),W(cc,this,null),bc._.delete(F(lc,this)),W(lc,this,null),null===(t=F(oc,this))||void 0===t||t.destroy(),W(oc,this,null)}static create(e){const t=D(hc,this,bc)._.get(null===e||void 0===e?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new hc(e)}static get workerSrc(){if(wo.workerSrc)return wo.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ve(this,"_setupFakeWorkerGlobal",(async()=>{if(O(hc,this,gc))return O(hc,this,gc);return(await import(this.workerSrc)).WorkerMessageHandler})())}}function uc(){F(rc,this).resolve(),F(oc,this).send("configure",{verbosity:this.verbosity})}function pc(e){W(lc,this,e),W(oc,this,new $a("main","worker",e)),F(oc,this).on("ready",()=>{}),D(dc,this,uc).call(this)}function mc(){if(yc._||gc(X))return void D(dc,this,fc).call(this);let{workerSrc:e}=X;try{X._isSameOrigin(window.location,e)||(e=X._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new $a("main","worker",t),i=()=>{s.abort(),n.destroy(),t.terminate(),this.destroyed?F(rc,this).reject(new Error("Worker was destroyed")):D(dc,this,fc).call(this)},s=new AbortController;t.addEventListener("error",()=>{F(cc,this)||i()},{signal:s.signal}),n.on("test",e=>{s.abort(),!this.destroyed&&e?(W(oc,this,n),W(lc,this,t),W(cc,this,t),D(dc,this,uc).call(this)):i()}),n.on("ready",e=>{if(s.abort(),this.destroyed)i();else try{a()}catch(t){D(dc,this,fc).call(this)}});const a=()=>{const e=new Uint8Array;n.send("test",e,[e.buffer])};return void a()}catch(t){We("The worker has been disabled.")}D(dc,this,fc).call(this)}function fc(){yc._||(ze("Setting up fake worker."),yc._=!0),X._setupFakeWorkerGlobal.then(e=>{var t,n;if(this.destroyed)return void F(rc,this).reject(new Error("Worker was destroyed"));const i=new Da;W(lc,this,i);const s="fake".concat((vc._=(t=vc._,n=t++,t),n)),a=new $a(s+"_worker",s,i);e.setup(a,i),W(oc,this,new $a(s,s+"_worker",i)),D(dc,this,uc).call(this)}).catch(e=>{F(rc,this).reject(new Error('Setting up fake worker failed: "'.concat(e.message,'".')))})}function gc(e){try{var t;return(null===(t=globalThis.pdfjsWorker)||void 0===t?void 0:t.WorkerMessageHandler)||null}catch(n){return null}}X=hc;var vc={_:0},yc={_:!1},bc={_:new WeakMap};ne&&(yc._=D(X,X,!0),wo.workerSrc||(wo.workerSrc="./pdf.worker.mjs")),X._isSameOrigin=(e,t)=>{const n=URL.parse(e);if(null===n||void 0===n||!n.origin||"null"===n.origin)return!1;const i=new URL(t,n);return n.origin===i.origin},X._createCDNWrapper=e=>{const t='await import("'.concat(e,'");');return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},X.fromPort=e=>{var t;if(t="`PDFWorker.fromPort` - please use `PDFWorker.create` instead.",console.log("Deprecated API usage: "+t),null===e||void 0===e||!e.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return X.create(e)};var xc=new WeakMap,wc=new WeakMap,Ac=new WeakMap,_c=new WeakMap,Sc=new WeakMap,Ec=new WeakSet;class kc{constructor(e,t,n,i,s,a){L(this,Ec),j(this,xc,new Map),j(this,wc,new Map),j(this,Ac,new Map),j(this,_c,new Map),j(this,Sc,null),this.messageHandler=e,this.loadingTask=t,this.commonObjs=new hl,this.fontLoader=new Na({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.wasmFactory=s.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=a,this.setupMessageHandler()}get annotationStorage(){return Ve(this,"annotationStorage",new Sa)}getRenderingIntent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pe.ENABLE,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=re,r=ba;switch(e){case"any":a=ae;break;case"display":break;case"print":a=oe;break;default:ze("getRenderingIntent - invalid intent: ".concat(e))}const o=a&oe&&n instanceof Ca?n:this.annotationStorage;switch(t){case pe.DISABLE:a+=de;break;case pe.ENABLE:break;case pe.ENABLE_FORMS:a+=le;break;case pe.ENABLE_STORAGE:a+=ce,r=o.serializable;break;default:ze("getRenderingIntent - invalid annotationMode: ".concat(t))}i&&(a+=he),s&&(a+=ue);const{ids:l,hash:c}=o.modifiedIds;return{renderingIntent:a,cacheKey:[a,r.hash,c].join("_"),annotationStorageSerializable:r,modifiedIds:l}}destroy(){var e;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),null===(e=F(Sc,this))||void 0===e||e.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of F(wc,this).values())t.push(i._destroy());F(wc,this).clear(),F(Ac,this).clear(),F(_c,this).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const n=this.messageHandler.sendWithPromise("Terminate",null);return t.push(n),Promise.all(t).then(()=>{var e,t;this.commonObjs.clear(),this.fontLoader.clear(),F(xc,this).clear(),this.filterFactory.destroy(),Il.cleanup(),null===(e=this._networkStream)||void 0===e||e.cancelAllRequests(new Je("Worker was terminated.")),null===(t=this.messageHandler)||void 0===t||t.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(e,t)=>{He(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=e=>{this._lastProgress={loaded:e.loaded,total:e.total}},t.onPull=()=>{this._fullReader.read().then(function(e){let{value:n,done:i}=e;i?t.close():(He(n instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(n),1,[n]))}).catch(e=>{t.error(e)})},t.onCancel=e=>{this._fullReader.cancel(e),t.ready.catch(e=>{if(!this.destroyed)throw e})}}),e.on("ReaderHeadersReady",async e=>{await this._fullReader.headersReady;const{isStreamingSupported:n,isRangeSupported:i,contentLength:s}=this._fullReader;if(!n||!i){var a;if(this._lastProgress)null===(a=t.onProgress)||void 0===a||a.call(t,this._lastProgress);this._fullReader.onProgress=e=>{var n;null===(n=t.onProgress)||void 0===n||n.call(t,{loaded:e.loaded,total:e.total})}}return{isStreamingSupported:n,isRangeSupported:i,contentLength:s}}),e.on("GetRangeReader",(e,t)=>{He(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const n=this._networkStream.getRangeReader(e.begin,e.end);n?(t.onPull=()=>{n.read().then(function(e){let{value:n,done:i}=e;i?t.close():(He(n instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(n),1,[n]))}).catch(e=>{t.error(e)})},t.onCancel=e=>{n.cancel(e),t.ready.catch(e=>{if(!this.destroyed)throw e})}):t.close()}),e.on("GetDoc",e=>{let{pdfInfo:n}=e;this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new tc(n,this))}),e.on("DocException",e=>{t._capability.reject(Ka(e))}),e.on("PasswordRequest",e=>{W(Sc,this,Promise.withResolvers());try{if(!t.onPassword)throw Ka(e);const n=e=>{e instanceof Error?F(Sc,this).reject(e):F(Sc,this).resolve({password:e})};t.onPassword(n,e.code)}catch(n){F(Sc,this).reject(n)}return F(Sc,this).promise}),e.on("DataLoaded",e=>{var n;null===(n=t.onProgress)||void 0===n||n.call(t,{loaded:e.length,total:e.length}),this.downloadInfoCapability.resolve(e)}),e.on("StartRenderPage",e=>{if(this.destroyed)return;F(wc,this).get(e.pageIndex)._startRenderPage(e.transparency,e.cacheKey)}),e.on("commonobj",t=>{var n;let[i,s,a]=t;if(this.destroyed)return null;if(this.commonObjs.has(i))return null;switch(s){case"Font":if("error"in a){const e=a.error;ze("Error during font loading: ".concat(e)),this.commonObjs.resolve(i,e);break}const t=this._params.pdfBug&&null!==(n=globalThis.FontInspector)&&void 0!==n&&n.enabled?(e,t)=>globalThis.FontInspector.fontAdded(e,t):null,r=new Ma(a,t);this.fontLoader.bind(r).catch(()=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!r.fontExtraProperties&&r.data&&(r.data=null),this.commonObjs.resolve(i,r)});break;case"CopyLocalImage":const{imageRef:o}=a;He(o,"The imageRef must be defined.");for(const e of F(wc,this).values())for(const[,t]of e.objs)if((null===t||void 0===t?void 0:t.ref)===o)return t.dataLen?(this.commonObjs.resolve(i,structuredClone(t)),t.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,a);break;default:throw new Error("Got unknown common object type ".concat(s))}return null}),e.on("obj",e=>{let[t,n,i,s]=e;if(this.destroyed)return;const a=F(wc,this).get(n);var r;if(!a.objs.has(t))if(0!==a._intentStates.size)switch(i){case"Image":case"Pattern":a.objs.resolve(t,s);break;default:throw new Error("Got unknown object type ".concat(i))}else null===s||void 0===s||null===(r=s.bitmap)||void 0===r||r.close()}),e.on("DocProgress",e=>{var n;this.destroyed||null===(n=t.onProgress)||void 0===n||n.call(t,{loaded:e.loaded,total:e.total})}),e.on("FetchBinaryData",async e=>{if(this.destroyed)throw new Error("Worker was destroyed.");const t=this[e.type];if(!t)throw new Error("".concat(e.type," not initialized, see the `useWorkerFetch` parameter."));return t.fetch(e)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var e,t;this.annotationStorage.size<=0&&ze("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:n,transfer:i}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:n,filename:null!==(e=null===(t=this._fullReader)||void 0===t?void 0:t.filename)&&void 0!==e?e:null},i).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=F(Ac,this).get(t);if(n)return n;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(n=>{if(this.destroyed)throw new Error("Transport destroyed");n.refStr&&F(_c,this).set(n.refStr,e);const i=new sc(t,n,this,this._params.pdfBug);return F(wc,this).set(t,i),i});return F(Ac,this).set(t,i),i}getPageIndex(e){return Ia(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return D(Ec,this,Cc).call(this,"GetFieldObjects")}hasJSActions(){return D(Ec,this,Cc).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return"string"!==typeof e?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return D(Ec,this,Cc).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return D(Ec,this,Cc).call(this,"GetOptionalContentConfig").then(t=>new Fo(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=F(xc,this).get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(e=>{var t,n,i,s;return{info:e[0],metadata:e[1]?new ko(e[1]):null,contentDispositionFilename:null!==(t=null===(n=this._fullReader)||void 0===n?void 0:n.filename)&&void 0!==t?t:null,contentLength:null!==(i=null===(s=this._fullReader)||void 0===s?void 0:s.contentLength)&&void 0!==i?i:null}});return F(xc,this).set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of F(wc,this).values()){if(!e.cleanup())throw new Error("startCleanup: Page ".concat(e.pageNumber," is currently rendering."))}this.commonObjs.clear(),e||this.fontLoader.clear(),F(xc,this).clear(),this.filterFactory.destroy(!0),Il.cleanup()}}cachedPageNumber(e){var t;if(!Ia(e))return null;const n=0===e.gen?"".concat(e.num,"R"):"".concat(e.num,"R").concat(e.gen);return null!==(t=F(_c,this).get(n))&&void 0!==t?t:null}}function Cc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=F(xc,this).get(e);if(n)return n;const i=this.messageHandler.sendWithPromise(e,t);return F(xc,this).set(e,i),i}var Tc=new WeakMap;class Nc{constructor(e){j(this,Tc,null),o(this,"onContinue",null),o(this,"onError",null),W(Tc,this,e)}get promise(){return F(Tc,this).capability.promise}cancel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;F(Tc,this).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=F(Tc,this).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=F(Tc,this);return e.form||e.canvas&&(null===t||void 0===t?void 0:t.size)>0}}var Mc=new WeakMap;class Rc{constructor(e){let{callback:t,params:n,objs:i,commonObjs:s,annotationCanvasMap:a,operatorList:r,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:d=!1,pdfBug:h=!1,pageColors:u=null,enableHWA:p=!1}=e;j(this,Mc,null),this.callback=t,this.params=n,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=r,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=h,this.pageColors=u,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===d&&"undefined"!==typeof window,this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new Nc(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=n.canvas,this._canvasContext=n.canvas?null:n.canvasContext,this._enableHWA=p}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics(e){var t,n;let{transparency:i=!1,optionalContentConfig:s}=e;if(this.cancelled)return;if(this._canvas){if(Ic._.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Ic._.add(this._canvas)}this._pdfBug&&null!==(t=globalThis.StepperManager)&&void 0!==t&&t.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:a,transform:r,background:o}=this.params,l=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new vo(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:s},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:a,transparency:i,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,null===(n=this.graphicsReadyCallback)||void 0===n||n.call(this)}cancel(){var e,t,n;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.running=!1,this.cancelled=!0,null===(e=this.gfx)||void 0===e||e.endDrawing(),F(Mc,this)&&(window.cancelAnimationFrame(F(Mc,this)),W(Mc,this,null)),Ic._.delete(this._canvas),i||(i=new gt("Rendering cancelled, page ".concat(this._pageIndex+1),s)),this.callback(i),null===(t=(n=this.task).onError)||void 0===t||t.call(n,i)}operatorListChanged(){var e;this.graphicsReady?(null===(e=this.stepper)||void 0===e||e.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?W(Mc,this,window.requestAnimationFrame(()=>{W(Mc,this,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Ic._.delete(this._canvas),this.callback())))}}var Ic={_:new WeakSet};var Pc=new WeakMap,Lc=new WeakMap,jc=new WeakMap,Dc=new WeakMap,Oc=new WeakMap,Fc=new WeakMap,Wc=new WeakMap,zc=new WeakMap,Bc=new WeakMap,Hc=new WeakMap,Uc=new WeakSet;class Gc{static get _keyboardManager(){return Ve(this,"_keyboardManager",new gn([[["Escape","mac+Escape"],Gc.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Gc.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Gc.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Gc.prototype._moveToPrevious],[["Home","mac+Home"],Gc.prototype._moveToBeginning],[["End","mac+End"],Gc.prototype._moveToEnd]]))}constructor(e){var t,n;let{editor:i=null,uiManager:s=null}=e;L(this,Uc),j(this,Pc,null),j(this,Lc,null),j(this,jc,void 0),j(this,Dc,null),j(this,Oc,!1),j(this,Fc,!1),j(this,Wc,null),j(this,zc,void 0),j(this,Bc,null),j(this,Hc,null),i?(W(Fc,this,!1),W(Wc,this,i)):W(Fc,this,!0),W(Hc,this,(null===i||void 0===i?void 0:i._uiManager)||s),W(zc,this,F(Hc,this)._eventBus),W(jc,this,(null===i||void 0===i||null===(t=i.color)||void 0===t?void 0:t.toUpperCase())||(null===(n=F(Hc,this))||void 0===n?void 0:n.highlightColors.values().next().value)||"#FFFF98"),$c._||($c._=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}renderButton(){const e=W(Pc,this,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",F(Wc,this)&&(e.ariaControls="".concat(F(Wc,this).id,"_colorpicker_dropdown"));const t=F(Hc,this)._signal;e.addEventListener("click",D(Uc,this,Kc).bind(this),{signal:t}),e.addEventListener("keydown",D(Uc,this,Yc).bind(this),{signal:t});const n=W(Lc,this,document.createElement("span"));return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=F(jc,this),e.append(n),e}renderMainDropdown(){const e=W(Dc,this,D(Uc,this,Vc).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===F(Pc,this))return void D(Uc,this,Kc).call(this,e);const t=e.target.getAttribute("data-color");t&&D(Uc,this,qc).call(this,t,e)}_moveToNext(e){var t,n;O(Uc,this,Qc)?e.target!==F(Pc,this)?null===(t=e.target.nextSibling)||void 0===t||t.focus():null===(n=F(Dc,this).firstChild)||void 0===n||n.focus():D(Uc,this,Kc).call(this,e)}_moveToPrevious(e){var t,n;e.target!==(null===(t=F(Dc,this))||void 0===t?void 0:t.firstChild)&&e.target!==F(Pc,this)?(O(Uc,this,Qc)||D(Uc,this,Kc).call(this,e),null===(n=e.target.previousSibling)||void 0===n||n.focus()):O(Uc,this,Qc)&&this._hideDropdownFromKeyboard()}_moveToBeginning(e){var t;O(Uc,this,Qc)?null===(t=F(Dc,this).firstChild)||void 0===t||t.focus():D(Uc,this,Kc).call(this,e)}_moveToEnd(e){var t;O(Uc,this,Qc)?null===(t=F(Dc,this).lastChild)||void 0===t||t.focus():D(Uc,this,Kc).call(this,e)}hideDropdown(){var e,t;null===(e=F(Dc,this))||void 0===e||e.classList.add("hidden"),F(Pc,this).ariaExpanded="false",null===(t=F(Bc,this))||void 0===t||t.abort(),W(Bc,this,null)}_hideDropdownFromKeyboard(){var e;F(Fc,this)||(O(Uc,this,Qc)?(this.hideDropdown(),F(Pc,this).focus({preventScroll:!0,focusVisible:F(Oc,this)})):null===(e=F(Wc,this))||void 0===e||e.unselect())}updateColor(e){if(F(Lc,this)&&(F(Lc,this).style.backgroundColor=e),!F(Dc,this))return;const t=F(Hc,this).highlightColors.values();for(const n of F(Dc,this).children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;null===(e=F(Pc,this))||void 0===e||e.remove(),W(Pc,this,null),W(Lc,this,null),null===(t=F(Dc,this))||void 0===t||t.remove(),W(Dc,this,null)}}function Vc(){const e=document.createElement("div"),t=F(Hc,this)._signal;e.addEventListener("contextmenu",wt,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),F(Wc,this)&&(e.id="".concat(F(Wc,this).id,"_colorpicker_dropdown"));for(const[n,i]of F(Hc,this).highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",i),s.title=n,s.setAttribute("data-l10n-id",$c._[n]);const a=document.createElement("span");s.append(a),a.className="swatch",a.style.backgroundColor=i,s.ariaSelected=i===F(jc,this),s.addEventListener("click",D(Uc,this,qc).bind(this,i),{signal:t}),e.append(s)}return e.addEventListener("keydown",D(Uc,this,Yc).bind(this),{signal:t}),e}function qc(e,t){t.stopPropagation(),F(zc,this).dispatch("switchannotationeditorparams",{source:this,type:ge.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)}function Yc(e){Q._keyboardManager.exec(this,e)}function Kc(e){if(O(Uc,this,Qc))return void this.hideDropdown();if(W(Oc,this,0===e.detail),F(Bc,this)||(W(Bc,this,new AbortController),window.addEventListener("pointerdown",D(Uc,this,Xc).bind(this),{signal:F(Hc,this).combinedSignal(F(Bc,this))})),F(Pc,this).ariaExpanded="true",F(Dc,this))return void F(Dc,this).classList.remove("hidden");const t=W(Dc,this,D(Uc,this,Vc).call(this));F(Pc,this).append(t)}function Xc(e){var t;null!==(t=F(Dc,this))&&void 0!==t&&t.contains(e.target)||this.hideDropdown()}function Qc(e){return F(Dc,e)&&!F(Dc,e).classList.contains("hidden")}Q=Gc;var $c={_:null},Jc=new WeakMap,Zc=new WeakMap,ed=new WeakMap;class td{constructor(e){j(this,Jc,null),j(this,Zc,null),j(this,ed,null),W(Zc,this,e),W(ed,this,e._uiManager),nd._||(nd._=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(F(Jc,this))return F(Jc,this);const{editorType:e,colorType:t,colorValue:n}=F(Zc,this),i=W(Jc,this,document.createElement("input"));return i.type="color",i.value=n||"#000000",i.className="basicColorPicker",i.tabIndex=0,i.setAttribute("data-l10n-id",nd._[e]),i.addEventListener("input",()=>{F(ed,this).updateParams(t,i.value)},{signal:F(ed,this)._signal}),i}update(e){F(Jc,this)&&(F(Jc,this).value=e)}destroy(){var e;null===(e=F(Jc,this))||void 0===e||e.remove(),W(Jc,this,null)}hideDropdown(){}}var nd={_:null};function id(e){return Math.floor(255*Math.max(0,Math.min(1,e))).toString(16).padStart(2,"0")}function sd(e){return Math.max(0,Math.min(255,255*e))}class ad{static CMYK_G(e){let[t,n,i,s]=e;return["G",1-Math.min(1,.3*t+.59*i+.11*n+s)]}static G_CMYK(e){let[t]=e;return["CMYK",0,0,0,1-t]}static G_RGB(e){let[t]=e;return["RGB",t,t,t]}static G_rgb(e){let[t]=e;return t=sd(t),[t,t,t]}static G_HTML(e){let[t]=e;const n=id(t);return"#".concat(n).concat(n).concat(n)}static RGB_G(e){let[t,n,i]=e;return["G",.3*t+.59*n+.11*i]}static RGB_rgb(e){return e.map(sd)}static RGB_HTML(e){return"#".concat(e.map(id).join(""))}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB(e){let[t,n,i,s]=e;return["RGB",1-Math.min(1,t+s),1-Math.min(1,i+s),1-Math.min(1,n+s)]}static CMYK_rgb(e){let[t,n,i,s]=e;return[sd(1-Math.min(1,t+s)),sd(1-Math.min(1,i+s)),sd(1-Math.min(1,n+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK(e){let[t,n,i]=e;const s=1-t,a=1-n,r=1-i;return["CMYK",s,a,r,Math.min(s,a,r)]}}class rd{create(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width","".concat(e,"px")),i.setAttribute("height","".concat(t,"px"))),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox","0 0 ".concat(e," ").concat(t)),i}createElement(e){if("string"!==typeof e)throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Be("Abstract method `_createSVG` called.")}}class od extends rd{_createSVG(e){return document.createElementNS(ut,e)}}class ld{static setupStorage(e,t,n,i,s){const a=i.getValue(t,{value:null});switch(n.name){case"textarea":if(null!==a.value&&(e.textContent=a.value),"print"===s)break;e.addEventListener("input",e=>{i.setValue(t,{value:e.target.value})});break;case"input":if("radio"===n.attributes.type||"checkbox"===n.attributes.type){if(a.value===n.attributes.xfaOn?e.setAttribute("checked",!0):a.value===n.attributes.xfaOff&&e.removeAttribute("checked"),"print"===s)break;e.addEventListener("change",e=>{i.setValue(t,{value:e.target.checked?e.target.getAttribute("xfaOn"):e.target.getAttribute("xfaOff")})})}else{if(null!==a.value&&e.setAttribute("value",a.value),"print"===s)break;e.addEventListener("input",e=>{i.setValue(t,{value:e.target.value})})}break;case"select":if(null!==a.value){e.setAttribute("value",a.value);for(const e of n.children)e.attributes.value===a.value?e.attributes.selected=!0:e.attributes.hasOwnProperty("selected")&&delete e.attributes.selected}e.addEventListener("input",e=>{const n=e.target.options,s=-1===n.selectedIndex?"":n[n.selectedIndex].value;i.setValue(t,{value:s})})}}static setAttributes(e){let{html:t,element:n,storage:i=null,intent:s,linkService:a}=e;const{attributes:r}=n,o=t instanceof HTMLAnchorElement;"radio"===r.type&&(r.name="".concat(r.name,"-").concat(s));for(const[l,c]of Object.entries(r))if(null!==c&&void 0!==c)switch(l){case"class":c.length&&t.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",c);break;case"style":Object.assign(t.style,c);break;case"textContent":t.textContent=c;break;default:(!o||"href"!==l&&"newWindow"!==l)&&t.setAttribute(l,c)}o&&a.addLinkAttributes(t,r.href,r.newWindow),i&&r.dataId&&this.setupStorage(t,r.dataId,n,i)}static render(e){const t=e.annotationStorage,n=e.linkService,i=e.xfaHtml,s=e.intent||"display",a=document.createElement(i.name);i.attributes&&this.setAttributes({html:a,element:i,intent:s,linkService:n});const r="richText"!==s,o=e.div;if(o.append(a),e.viewport){const t="matrix(".concat(e.viewport.transform.join(","),")");o.style.transform=t}r&&o.setAttribute("class","xfaLayer xfaFont");const l=[];if(0===i.children.length){if(i.value){const e=document.createTextNode(i.value);a.append(e),r&&Vl.shouldBuildText(i.name)&&l.push(e)}return{textDivs:l}}const c=[[i,-1,a]];for(;c.length>0;){var d,h;const[e,i,a]=c.at(-1);if(i+1===e.children.length){c.pop();continue}const o=e.children[++c.at(-1)[1]];if(null===o)continue;const{name:u}=o;if("#text"===u){const e=document.createTextNode(o.value);l.push(e),a.append(e);continue}const p=null!==o&&void 0!==o&&null!==(d=o.attributes)&&void 0!==d&&d.xmlns?document.createElementNS(o.attributes.xmlns,u):document.createElement(u);if(a.append(p),o.attributes&&this.setAttributes({html:p,element:o,storage:t,intent:s,linkService:n}),(null===(h=o.children)||void 0===h?void 0:h.length)>0)c.push([o,-1,p]);else if(o.value){const e=document.createTextNode(o.value);r&&Vl.shouldBuildText(u)&&l.push(e),p.append(e)}}for(const u of o.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))u.setAttribute("readOnly",!0);return{textDivs:l}}static update(e){const t="matrix(".concat(e.viewport.transform.join(","),")");e.div.style.transform=t,e.div.hidden=!1}}const cd=new WeakSet,dd=60*(new Date).getTimezoneOffset()*1e3;class hd{static create(e){switch(e.data.annotationType){case Se.LINK:return new bd(e);case Se.TEXT:return new _d(e);case Se.WIDGET:switch(e.data.fieldType){case"Tx":return new Ed(e);case"Btn":return e.data.radioButton?new Td(e):e.data.checkBox?new Cd(e):new Nd(e);case"Ch":return new Md(e);case"Sig":return new kd(e)}return new Sd(e);case Se.POPUP:return new Rd(e);case Se.FREETEXT:return new dh(e);case Se.LINE:return new uh(e);case Se.SQUARE:return new mh(e);case Se.CIRCLE:return new gh(e);case Se.POLYLINE:return new yh(e);case Se.CARET:return new xh(e);case Se.INK:return new Sh(e);case Se.POLYGON:return new bh(e);case Se.HIGHLIGHT:return new kh(e);case Se.UNDERLINE:return new Ch(e);case Se.SQUIGGLY:return new Th(e);case Se.STRIKEOUT:return new Nh(e);case Se.STAMP:return new Mh(e);case Se.FILEATTACHMENT:return new Ph(e);default:return new gd(e)}}}var ud=new WeakMap,pd=new WeakMap,md=new WeakMap,fd=new WeakSet;class gd{constructor(e){let{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};L(this,fd),j(this,ud,null),j(this,pd,!1),j(this,md,null),this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData(e){let{contentsObj:t,richText:n}=e;return!!(null!==t&&void 0!==t&&t.str||null!==n&&void 0!==n&&n.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return gd._hasPopupData(this.data)}updateEdited(e){var t;if(!this.container)return;e.rect&&(F(ud,this)||W(ud,this,{rect:this.data.rect.slice(0)}));const{rect:n,popup:i}=e;n&&D(fd,this,vd).call(this,n);let s=(null===(t=F(md,this))||void 0===t?void 0:t.popup)||this.popup;!s&&null!==i&&void 0!==i&&i.text&&(this._createPopup(i),s=F(md,this).popup),s&&(s.updateEdited(e),null!==i&&void 0!==i&&i.deleted&&(s.remove(),W(md,this,null),this.popup=null))}resetEdited(){var e;F(ud,this)&&(D(fd,this,vd).call(this,F(ud,this).rect),null===(e=F(md,this))||void 0===e||e.popup.resetEdited(),W(ud,this,null))}_createContainer(e){const{data:t,parent:{page:n,viewport:i}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",t.id),this instanceof Sd||this instanceof bd||(s.tabIndex=0);const{style:a}=s;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(s.title=t.alternativeText),t.noRotate&&s.classList.add("norotate"),!t.rect||this instanceof Rd){const{rotation:e}=t;return t.hasOwnCanvas||0===e||this.setRotation(e,s),s}const{width:r,height:o}=this;if(!e&&t.borderStyle.width>0){a.borderWidth="".concat(t.borderStyle.width,"px");const e=t.borderStyle.horizontalCornerRadius,n=t.borderStyle.verticalCornerRadius;if(e>0||n>0){const t="calc(".concat(e,"px * var(--total-scale-factor)) / calc(").concat(n,"px * var(--total-scale-factor))");a.borderRadius=t}else if(this instanceof Td){const e="calc(".concat(r,"px * var(--total-scale-factor)) / calc(").concat(o,"px * var(--total-scale-factor))");a.borderRadius=e}switch(t.borderStyle.style){case Ee:a.borderStyle="solid";break;case ke:a.borderStyle="dashed";break;case Ce:ze("Unimplemented border style: beveled");break;case Te:ze("Unimplemented border style: inset");break;case Ne:a.borderBottomStyle="solid"}const i=t.borderColor||null;i?(W(pd,this,!0),a.borderColor=it.makeHexColor(0|i[0],0|i[1],0|i[2])):a.borderWidth=0}const l=it.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:c,pageHeight:d,pageX:h,pageY:u}=i.rawDims;a.left="".concat(100*(l[0]-h)/c,"%"),a.top="".concat(100*(l[1]-u)/d,"%");const{rotation:p}=t;return t.hasOwnCanvas||0===p?(a.width="".concat(100*r/c,"%"),a.height="".concat(100*o/d,"%")):this.setRotation(p,s),s}setRotation(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container;if(!this.data.rect)return;const{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims;let{width:s,height:a}=this;e%180!==0&&([s,a]=[a,s]),t.style.width="".concat(100*s/n,"%"),t.style.height="".concat(100*a/i,"%"),t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(e,t,n)=>{const i=n.detail[e],s=i[0],a=i.slice(1);n.target.style[t]=ad["".concat(s,"_HTML")](a),this.annotationStorage.setValue(this.data.id,{[t]:ad["".concat(s,"_rgb")](a)})};return Ve(this,"_commonActions",{display:e=>{const{display:t}=e.detail,n=t%2===1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:1===t||2===t})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:t}=e.detail;this.container.style.visibility=t?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:t,noView:t})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:e=>{const t=e.detail.rotation;this.setRotation(t),this.annotationStorage.setValue(this.data.id,{rotation:t})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const i of Object.keys(t.detail)){const s=e[i]||n[i];null===s||void 0===s||s(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[i,s]of Object.entries(t)){const a=n[i];if(a){a({detail:{[i]:s},target:e}),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,i,s]=this.data.rect.map(e=>Math.fround(e));if(8===e.length){const[a,r,o,l]=e.subarray(2,6);if(i===a&&s===r&&t===o&&n===l)return}const{style:a}=this.container;let r;if(F(pd,this)){const{borderColor:e,borderWidth:t}=a;a.borderWidth=0,r=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">','<g fill="transparent" stroke="'.concat(e,'" stroke-width="').concat(t,'">')],this.container.classList.add("hasBorder")}const o=i-t,l=s-n,{svgFactory:c}=this,d=c.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0),d.role="none";const h=c.createElement("defs");d.append(h);const u=c.createElement("clipPath"),p="clippath_".concat(this.data.id);u.setAttribute("id",p),u.setAttribute("clipPathUnits","objectBoundingBox"),h.append(u);for(let f=2,g=e.length;f<g;f+=8){var m;const n=e[f],i=e[f+1],a=e[f+2],d=e[f+3],h=c.createElement("rect"),p=(a-t)/o,g=(s-i)/l,v=(n-a)/o,y=(i-d)/l;h.setAttribute("x",p),h.setAttribute("y",g),h.setAttribute("width",v),h.setAttribute("height",y),u.append(h),null===(m=r)||void 0===m||m.push('<rect vector-effect="non-scaling-stroke" x="'.concat(p,'" y="').concat(g,'" width="').concat(v,'" height="').concat(y,'"/>'))}F(pd,this)&&(r.push("</g></svg>')"),a.backgroundImage=r.join("")),this.container.append(d),this.container.style.clipPath="url(#".concat(p,")")}_createPopup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const{data:t}=this;let n,i;e?(n={str:e.text},i=e.date):(n=t.contentsObj,i=t.modificationDate);const s=W(md,this,new Rd({data:{color:t.color,titleObj:t.titleObj,modificationDate:i,contentsObj:n,richText:t.richText,parentRect:t.rect,borderStyle:0,id:"popup_".concat(t.id),rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}));this.parent.div.append(s.render())}get hasPopupElement(){return!!(F(md,this)||this.popup||this.data.popupRef)}render(){Be("Abstract method `AnnotationElement.render` called")}_getElementsByName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:e,id:s,exportValues:a}of i){if(-1===e)continue;if(s===t)continue;const i="string"===typeof a?a:null,r=document.querySelector('[data-element-id="'.concat(s,'"]'));!r||cd.has(r)?n.push({id:s,exportValue:i,domElement:r}):ze("_getElementsByName - element not allowed: ".concat(s))}return n}for(const i of document.getElementsByName(e)){const{exportValue:e}=i,s=i.getAttribute("data-element-id");s!==t&&(cd.has(i)&&n.push({id:s,exportValue:e,domElement:i}))}return n}show(){var e;this.container&&(this.container.hidden=!1),null===(e=this.popup)||void 0===e||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),null===(e=this.popup)||void 0===e||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var n;null===(n=this.linkService.eventBus)||void 0===n||n.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}function vd(e){const{container:{style:t},data:{rect:n,rotation:i},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:a,pageX:r,pageY:o}}}}=this;null===n||void 0===n||n.splice(0,4,...e),t.left="".concat(100*(e[0]-r)/s,"%"),t.top="".concat(100*(a-e[3]+o)/a,"%"),0===i?(t.width="".concat(100*(e[2]-e[0])/s,"%"),t.height="".concat(100*(e[3]-e[1])/a,"%")):this.setRotation(i)}var yd=new WeakSet;class bd extends gd{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,{isRenderable:!0,ignoreBorder:!(null===t||void 0===t||!t.ignoreBorder),createQuadrilaterals:!0}),L(this,yd),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let i=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),i=!0):e.action?(this._bindNamedAction(n,e.action,e.overlaidText),i=!0):e.attachment?(D(yd,this,wd).call(this,n,e.attachment,e.overlaidText,e.attachmentDest),i=!0):e.setOCGState?(D(yd,this,Ad).call(this,n,e.setOCGState,e.overlaidText),i=!0):e.dest?(this._bindLink(n,e.dest,e.overlaidText),i=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),i=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(n,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(n),this.container}_bindLink(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||""===t)&&D(yd,this,xd).call(this),n&&(e.title=n)}_bindNamedAction(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),n&&(e.title=n),D(yd,this,xd).call(this)}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(t.actions)){const s=n.get(i);s&&(e[s]=()=>{var e;return null===(e=this.linkService.eventBus)||void 0===e||e.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:i}}),!1})}t.overlaidText&&(e.title=t.overlaidText),e.onclick||(e.onclick=()=>!1),D(yd,this,xd).call(this)}_bindResetFormAction(e,t){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),D(yd,this,xd).call(this),!this._fieldObjects)return ze('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(n||(e.onclick=()=>!1));e.onclick=()=>{null===n||void 0===n||n();const{fields:e,refs:i,include:s}=t,a=[];if(0!==e.length||0!==i.length){const t=new Set(i);for(const n of e){const e=this._fieldObjects[n]||[];for(const{id:n}of e)t.add(n)}for(const e of Object.values(this._fieldObjects))for(const n of e)t.has(n.id)===s&&a.push(n)}else for(const t of Object.values(this._fieldObjects))a.push(...t);const r=this.annotationStorage,o=[];for(const t of a){const{id:e}=t;switch(o.push(e),t.type){case"text":{const n=t.defaultValue||"";r.setValue(e,{value:n});break}case"checkbox":case"radiobutton":{const n=t.defaultValue===t.exportValues;r.setValue(e,{value:n});break}case"combobox":case"listbox":{const n=t.defaultValue||"";r.setValue(e,{value:n});break}default:continue}const n=document.querySelector('[data-element-id="'.concat(e,'"]'));n&&(cd.has(n)?n.dispatchEvent(new Event("resetform")):ze("_bindResetFormAction - element not allowed: ".concat(e)))}var l;this.enableScripting&&(null===(l=this.linkService.eventBus)||void 0===l||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:o,name:"ResetForm"}}));return!1}}}function xd(){this.container.setAttribute("data-internal-link","")}function wd(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e.href=this.linkService.getAnchorUrl(""),t.description?e.title=t.description:n&&(e.title=n),e.onclick=()=>{var e;return null===(e=this.downloadManager)||void 0===e||e.openOrDownloadData(t.content,t.filename,i),!1},D(yd,this,xd).call(this)}function Ad(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),n&&(e.title=n),D(yd,this,xd).call(this)}class _d extends gd{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Sd extends gd{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&("CANVAS"===(null===(t=e.previousSibling)||void 0===t?void 0:t.nodeName)&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return tt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,i,s){n.includes("mouse")?e.addEventListener(n,e=>{var t;null===(t=this.linkService.eventBus)||void 0===t||t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(e),shift:e.shiftKey,modifier:this._getKeyModifier(e)}})}):e.addEventListener(n,e=>{var a;if("blur"===n){if(!t.focused||!e.relatedTarget)return;t.focused=!1}else if("focus"===n){if(t.focused)return;t.focused=!0}s&&(null===(a=this.linkService.eventBus)||void 0===a||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(e)}}))})}_setEventListeners(e,t,n,i){for(const[o,l]of n){var s,a,r;if("Action"===l||null!==(s=this.data.actions)&&void 0!==s&&s[l])"Focus"!==l&&"Blur"!==l||t||(t={focused:!1}),this._setEventListener(e,t,o,l,i),"Focus"!==l||null!==(a=this.data.actions)&&void 0!==a&&a.Blur?"Blur"!==l||null!==(r=this.data.actions)&&void 0!==r&&r.Focus||this._setEventListener(e,t,"focus","Focus",null):this._setEventListener(e,t,"blur","Blur",null)}}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=null===t?"transparent":it.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||9,s=e.style;let a;const r=e=>Math.round(10*e)/10;if(this.data.multiLine){const e=Math.abs(this.data.rect[3]-this.data.rect[1]-2),t=e/(Math.round(e/(se*i))||1);a=Math.min(i,r(t/se))}else{const e=Math.abs(this.data.rect[3]-this.data.rect[1]-2);a=Math.min(i,r(e/se))}s.fontSize="calc(".concat(a,"px * var(--total-scale-factor))"),s.color=it.makeHexColor(n[0],n[1],n[2]),null!==this.data.textAlignment&&(s.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class Ed extends Sd{constructor(e){super(e,{isRenderable:e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue})}setPropertyOnSiblings(e,t,n,i){const s=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=n),s.setValue(a.id,{[i]:n})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){var i;const a=e.getValue(t,{value:this.data.fieldValue});let r=a.value||"";const o=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;o&&r.length>o&&(r=r.slice(0,o));let l=a.formattedValue||(null===(i=this.data.textContent)||void 0===i?void 0:i.join("\n"))||null;l&&this.data.comb&&(l=l.replaceAll(/\s+/g,""));const c={userValue:r,formattedValue:l,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=null!==l&&void 0!==l?l:r,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",null!==l&&void 0!==l?l:r),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),cd.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:d,datetimeType:h,timeStep:u}=this.data,p=!!h&&this.enableScripting;d&&(n.title=d),this._setRequired(n,this.data.required),o&&(n.maxLength=o),n.addEventListener("input",i=>{e.setValue(t,{value:i.target.value}),this.setPropertyOnSiblings(n,"value",i.target.value,"value"),c.formattedValue=null}),n.addEventListener("resetform",e=>{var t;const i=null!==(t=this.data.defaultFieldValue)&&void 0!==t?t:"";n.value=c.userValue=i,c.formattedValue=null});let m=e=>{const{formattedValue:t}=c;null!==t&&void 0!==t&&(e.target.value=t),e.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){var s;n.addEventListener("focus",e=>{var t;if(c.focused)return;const{target:n}=e;if(p&&(n.type=h,u&&(n.step=u)),c.userValue){const e=c.userValue;if(p)if("time"===h){const t=new Date(e),i=[t.getHours(),t.getMinutes(),t.getSeconds()];n.value=i.map(e=>e.toString().padStart(2,"0")).join(":")}else n.value=new Date(e-dd).toISOString().split("date"===h?"T":".",1)[0];else n.value=e}c.lastCommittedValue=n.value,c.commitKey=1,null!==(t=this.data.actions)&&void 0!==t&&t.Focus||(c.focused=!0)}),n.addEventListener("updatefromsandbox",n=>{this.showElementAndHideCanvas(n.target);const i={value(n){var i;c.userValue=null!==(i=n.detail.value)&&void 0!==i?i:"",p||e.setValue(t,{value:c.userValue.toString()}),n.target.value=c.userValue},formattedValue(n){const{formattedValue:i}=n.detail;c.formattedValue=i,null!==i&&void 0!==i&&n.target!==document.activeElement&&(n.target.value=i);const s={formattedValue:i};p&&(s.value=i),e.setValue(t,s)},selRange(e){e.target.setSelectionRange(...e.detail.selRange)},charLimit:n=>{var i;const{charLimit:s}=n.detail,{target:a}=n;if(0===s)return void a.removeAttribute("maxLength");a.setAttribute("maxLength",s);let r=c.userValue;!r||r.length<=s||(r=r.slice(0,s),a.value=c.userValue=r,e.setValue(t,{value:r}),null===(i=this.linkService.eventBus)||void 0===i||i.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:r,willCommit:!0,commitKey:1,selStart:a.selectionStart,selEnd:a.selectionEnd}}))}};this._dispatchEventFromSandbox(i,n)}),n.addEventListener("keydown",e=>{var n;c.commitKey=1;let i=-1;if("Escape"===e.key?i=0:"Enter"!==e.key||this.data.multiLine?"Tab"===e.key&&(c.commitKey=3):i=2,-1===i)return;const{value:s}=e.target;c.lastCommittedValue!==s&&(c.lastCommittedValue=s,c.userValue=s,null===(n=this.linkService.eventBus)||void 0===n||n.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:s,willCommit:!0,commitKey:i,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}))});const i=m;m=null,n.addEventListener("blur",e=>{var n;if(!c.focused||!e.relatedTarget)return;null!==(n=this.data.actions)&&void 0!==n&&n.Blur||(c.focused=!1);const{target:s}=e;let{value:a}=s;if(p){if(a&&"time"===h){const e=a.split(":").map(e=>parseInt(e,10));a=new Date(2e3,0,1,e[0],e[1],e[2]||0).valueOf(),s.step=""}else a=new Date(a).valueOf();s.type="text"}var r;(c.userValue=a,c.lastCommittedValue!==a)&&(null===(r=this.linkService.eventBus)||void 0===r||r.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:a,willCommit:!0,commitKey:c.commitKey,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}));i(e)}),null!==(s=this.data.actions)&&void 0!==s&&s.Keystroke&&n.addEventListener("beforeinput",e=>{var n;c.lastCommittedValue=null;const{data:i,target:s}=e,{value:a,selectionStart:r,selectionEnd:o}=s;let l=r,d=o;switch(e.inputType){case"deleteWordBackward":{const e=a.substring(0,r).match(/\w*[^\w]*$/);e&&(l-=e[0].length);break}case"deleteWordForward":{const e=a.substring(r).match(/^[^\w]*\w*/);e&&(d+=e[0].length);break}case"deleteContentBackward":r===o&&(l-=1);break;case"deleteContentForward":r===o&&(d+=1)}e.preventDefault(),null===(n=this.linkService.eventBus)||void 0===n||n.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:a,change:i||"",willCommit:!1,selStart:l,selEnd:d}})}),this._setEventListeners(n,c,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.value)}if(m&&n.addEventListener("blur",m),this.data.comb){const e=(this.data.rect[2]-this.data.rect[0])/o;n.classList.add("comb"),n.style.letterSpacing="calc(".concat(e,"px * var(--total-scale-factor) - 1ch)")}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class kd extends Sd{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class Cd extends Sd{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;"string"===typeof i&&(i="Off"!==i,e.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return cd.add(s),s.setAttribute("data-element-id",n),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=t.fieldName,i&&s.setAttribute("checked",!0),s.setAttribute("exportValue",t.exportValue),s.tabIndex=0,s.addEventListener("change",i=>{const{name:s,checked:a}=i.target;for(const r of this._getElementsByName(s,n)){const n=a&&r.exportValue===t.exportValue;r.domElement&&(r.domElement.checked=n),e.setValue(r.id,{value:n})}e.setValue(n,{value:a})}),s.addEventListener("resetform",e=>{const n=t.defaultFieldValue||"Off";e.target.checked=n===t.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",t=>{const i={value(t){t.target.checked="Off"!==t.detail.value,e.setValue(n,{value:t.target.checked})}};this._dispatchEventFromSandbox(i,t)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Td extends Sd{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if("string"===typeof i&&(i=i!==t.buttonValue,e.setValue(n,{value:i})),i)for(const a of this._getElementsByName(t.fieldName,n))e.setValue(a.id,{value:!1});const s=document.createElement("input");if(cd.add(s),s.setAttribute("data-element-id",n),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=t.fieldName,i&&s.setAttribute("checked",!0),s.tabIndex=0,s.addEventListener("change",t=>{const{name:i,checked:s}=t.target;for(const a of this._getElementsByName(i,n))e.setValue(a.id,{value:!1});e.setValue(n,{value:s})}),s.addEventListener("resetform",e=>{const n=t.defaultFieldValue;e.target.checked=null!==n&&void 0!==n&&n===t.buttonValue}),this.enableScripting&&this.hasJSActions){const i=t.buttonValue;s.addEventListener("updatefromsandbox",t=>{const s={value:t=>{const s=i===t.detail.value;for(const i of this._getElementsByName(t.target.name)){const t=s&&i.id===n;i.domElement&&(i.domElement.checked=t),e.setValue(i.id,{value:t})}}};this._dispatchEventFromSandbox(s,t)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Nd extends bd{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",e=>{this._dispatchEventFromSandbox({},e)})),e}}class Md extends Sd{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");cd.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",e=>{const t=this.data.defaultFieldValue;for(const n of i.options)n.selected=n.value===t});for(const c of this.data.options){const e=document.createElement("option");e.textContent=c.displayValue,e.value=c.exportValue,n.value.includes(c.exportValue)&&(e.setAttribute("selected",!0),s=!1),i.append(e)}let a=null;if(s){const e=document.createElement("option");e.value=" ",e.setAttribute("hidden",!0),e.setAttribute("selected",!0),i.prepend(e),a=()=>{e.remove(),i.removeEventListener("input",a),a=null},i.addEventListener("input",a)}const r=e=>{const t=e?"value":"textContent",{options:n,multiple:s}=i;return s?Array.prototype.filter.call(n,e=>e.selected).map(e=>e[t]):-1===n.selectedIndex?null:n[n.selectedIndex][t]};let o=r(!1);const l=e=>{const t=e.target.options;return Array.prototype.map.call(t,e=>({displayValue:e.textContent,exportValue:e.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",n=>{const s={value(n){var s;null===(s=a)||void 0===s||s();const l=n.detail.value,c=new Set(Array.isArray(l)?l:[l]);for(const e of i.options)e.selected=c.has(e.value);e.setValue(t,{value:r(!0)}),o=r(!1)},multipleSelection(e){i.multiple=!0},remove(n){const s=i.options,a=n.detail.remove;if(s[a].selected=!1,i.remove(a),s.length>0){-1===Array.prototype.findIndex.call(s,e=>e.selected)&&(s[0].selected=!0)}e.setValue(t,{value:r(!0),items:l(n)}),o=r(!1)},clear(n){for(;0!==i.length;)i.remove(0);e.setValue(t,{value:null,items:[]}),o=r(!1)},insert(n){const{index:s,displayValue:a,exportValue:c}=n.detail.insert,d=i.children[s],h=document.createElement("option");h.textContent=a,h.value=c,d?d.before(h):i.append(h),e.setValue(t,{value:r(!0),items:l(n)}),o=r(!1)},items(n){const{items:s}=n.detail;for(;0!==i.length;)i.remove(0);for(const e of s){const{displayValue:t,exportValue:n}=e,s=document.createElement("option");s.textContent=t,s.value=n,i.append(s)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:r(!0),items:l(n)}),o=r(!1)},indices(n){const i=new Set(n.detail.indices);for(const e of n.target.options)e.selected=i.has(e.index);e.setValue(t,{value:r(!0)}),o=r(!1)},editable(e){e.target.disabled=!e.detail.editable}};this._dispatchEventFromSandbox(s,n)}),i.addEventListener("input",n=>{var i;const s=r(!0),a=r(!1);e.setValue(t,{value:s}),n.preventDefault(),null===(i=this.linkService.eventBus)||void 0===i||i.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:o,change:a,changeEx:s,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],e=>e.target.value)):i.addEventListener("input",function(n){e.setValue(t,{value:r(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class Rd extends gd{constructor(e){const{data:t,elements:n}=e;super(e,{isRenderable:gd._hasPopupData(t)}),this.elements=n,this.popup=null}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=new Zd({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),n=[];for(const i of this.elements)i.popup=t,i.container.ariaHasPopup="dialog",n.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(e=>"".concat(ct).concat(e)).join(",")),this.container}}var Id=new WeakMap,Pd=new WeakMap,Ld=new WeakMap,jd=new WeakMap,Dd=new WeakMap,Od=new WeakMap,Fd=new WeakMap,Wd=new WeakMap,zd=new WeakMap,Bd=new WeakMap,Hd=new WeakMap,Ud=new WeakMap,Gd=new WeakMap,Vd=new WeakMap,qd=new WeakMap,Yd=new WeakMap,Kd=new WeakMap,Xd=new WeakMap,Qd=new WeakMap,$d=new WeakMap,Jd=new WeakSet;class Zd{constructor(e){let{container:t,color:n,elements:i,titleObj:s,modificationDate:a,contentsObj:r,richText:o,parent:l,rect:c,parentRect:d,open:h}=e;L(this,Jd),j(this,Id,D(Jd,this,ah).bind(this)),j(this,Pd,D(Jd,this,ch).bind(this)),j(this,Ld,D(Jd,this,lh).bind(this)),j(this,jd,D(Jd,this,oh).bind(this)),j(this,Dd,null),j(this,Od,null),j(this,Fd,null),j(this,Wd,null),j(this,zd,null),j(this,Bd,null),j(this,Hd,null),j(this,Ud,!1),j(this,Gd,null),j(this,Vd,null),j(this,qd,null),j(this,Yd,null),j(this,Kd,null),j(this,Xd,null),j(this,Qd,null),j(this,$d,!1),W(Od,this,t),W(Xd,this,s),W(Fd,this,r),W(Kd,this,o),W(Bd,this,l),W(Dd,this,n),W(Yd,this,c),W(Hd,this,d),W(zd,this,i),W(Wd,this,_t.toDateObject(a)),this.trigger=i.flatMap(e=>e.getElementsToTriggerPopup()),D(Jd,this,eh).call(this),F(Od,this).hidden=!0,h&&D(Jd,this,oh).call(this)}render(){var e;if(F(Gd,this))return;const t=W(Gd,this,document.createElement("div"));if(t.className="popup",F(Dd,this)){const e=t.style.outlineColor=it.makeHexColor(...F(Dd,this));t.style.backgroundColor="color-mix(in srgb, ".concat(e," 30%, white)")}const n=document.createElement("span");if(n.className="header",null!==(e=F(Xd,this))&&void 0!==e&&e.str){const e=document.createElement("span");e.className="title",n.append(e),({dir:e.dir,str:e.textContent}=F(Xd,this))}if(t.append(n),F(Wd,this)){const e=document.createElement("time");e.className="popupDate",e.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),e.setAttribute("data-l10n-args",JSON.stringify({dateObj:F(Wd,this).valueOf()})),e.dateTime=F(Wd,this).toISOString(),n.append(e)}const i=O(Jd,this,th);if(i)ld.render({xfaHtml:i,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const e=this._formatContents(F(Fd,this));t.append(e)}F(Od,this).append(t)}_formatContents(e){let{str:t,dir:n}=e;const i=document.createElement("p");i.classList.add("popupContent"),i.dir=n;const s=t.split(/(?:\r\n?|\n)/);for(let a=0,r=s.length;a<r;++a){const e=s[a];i.append(document.createTextNode(e)),a<r-1&&i.append(document.createElement("br"))}return i}updateEdited(e){var t;let{rect:n,popup:i,deleted:s}=e;s||null!==i&&void 0!==i&&i.deleted?this.remove():(D(Jd,this,eh).call(this),F(Qd,this)||W(Qd,this,{contentsObj:F(Fd,this),richText:F(Kd,this)}),n&&W(qd,this,null),i&&(W(Kd,this,D(Jd,this,sh).call(this,i.text)),W(Wd,this,_t.toDateObject(i.date)),W(Fd,this,null)),null===(t=F(Gd,this))||void 0===t||t.remove(),W(Gd,this,null))}resetEdited(){var e;F(Qd,this)&&(({contentsObj:I(W,[Fd,this])._,richText:I(W,[Kd,this])._}=F(Qd,this)),W(Qd,this,null),null===(e=F(Gd,this))||void 0===e||e.remove(),W(Gd,this,null),W(qd,this,null))}remove(){var e,t;null===(e=F(Vd,this))||void 0===e||e.abort(),W(Vd,this,null),null===(t=F(Gd,this))||void 0===t||t.remove(),W(Gd,this,null),W($d,this,!1),W(Ud,this,!1);for(const n of this.trigger)n.classList.remove("popupTriggerArea")}forceHide(){W($d,this,this.isVisible),F($d,this)&&(F(Od,this).hidden=!0)}maybeShow(){D(Jd,this,eh).call(this),F($d,this)&&(F(Gd,this)||D(Jd,this,lh).call(this),W($d,this,!1),F(Od,this).hidden=!1)}get isVisible(){return!1===F(Od,this).hidden}}function eh(){if(F(Vd,this))return;W(Vd,this,new AbortController);const{signal:e}=F(Vd,this);for(const n of this.trigger)n.addEventListener("click",F(jd,this),{signal:e}),n.addEventListener("mouseenter",F(Ld,this),{signal:e}),n.addEventListener("mouseleave",F(Pd,this),{signal:e}),n.classList.add("popupTriggerArea");for(const n of F(zd,this)){var t;null===(t=n.container)||void 0===t||t.addEventListener("keydown",F(Id,this),{signal:e})}}function th(e){const t=F(Kd,e),n=F(Fd,e);return null===t||void 0===t||!t.str||null!==n&&void 0!==n&&n.str&&n.str!==t.str?null:F(Kd,e).html||null}function nh(e){var t;return(null===(t=O(Jd,e,th))||void 0===t||null===(t=t.attributes)||void 0===t||null===(t=t.style)||void 0===t?void 0:t.fontSize)||0}function ih(e){var t;return(null===(t=O(Jd,e,th))||void 0===t||null===(t=t.attributes)||void 0===t||null===(t=t.style)||void 0===t?void 0:t.color)||null}function sh(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:O(Jd,this,ih),fontSize:O(Jd,this,nh)?"calc(".concat(O(Jd,this,nh),"px * var(--total-scale-factor))"):""}};for(const s of e.split("\n"))t.push({name:"span",value:s,attributes:i});return n}function ah(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||("Enter"===e.key||"Escape"===e.key&&F(Ud,this))&&D(Jd,this,oh).call(this)}function rh(){if(null!==F(qd,this))return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:i,pageY:s}}}=F(Bd,this);let a=!!F(Hd,this),r=F(a?Hd:Yd,this);for(const u of F(zd,this))if(!r||null!==it.intersect(u.data.rect,r)){r=u.data.rect,a=!0;break}const o=it.normalizeRect([r[0],e[3]-r[1]+e[1],r[2],e[3]-r[3]+e[1]]),l=a?r[2]-r[0]+5:0,c=o[0]+l,d=o[1];W(qd,this,[100*(c-i)/t,100*(d-s)/n]);const{style:h}=F(Od,this);h.left="".concat(F(qd,this)[0],"%"),h.top="".concat(F(qd,this)[1],"%")}function oh(){W(Ud,this,!F(Ud,this)),F(Ud,this)?(D(Jd,this,lh).call(this),F(Od,this).addEventListener("click",F(jd,this)),F(Od,this).addEventListener("keydown",F(Id,this))):(D(Jd,this,ch).call(this),F(Od,this).removeEventListener("click",F(jd,this)),F(Od,this).removeEventListener("keydown",F(Id,this)))}function lh(){F(Gd,this)||this.render(),this.isVisible?F(Ud,this)&&F(Od,this).classList.add("focused"):(D(Jd,this,rh).call(this),F(Od,this).hidden=!1,F(Od,this).style.zIndex=parseInt(F(Od,this).style.zIndex)+1e3)}function ch(){F(Od,this).classList.remove("focused"),!F(Ud,this)&&this.isVisible&&(F(Od,this).hidden=!0,F(Od,this).style.zIndex=parseInt(F(Od,this).style.zIndex)-1e3)}class dh extends gd{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=fe.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var hh=new WeakMap;class uh extends gd{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),j(this,hh,null)}render(){this.container.classList.add("lineAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),s=W(hh,this,this.svgFactory.createElement("svg:line"));return s.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),s.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),s.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),s.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),s.setAttribute("stroke-width",e.borderStyle.width||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),i.append(s),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return F(hh,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}var ph=new WeakMap;class mh extends gd{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),j(this,ph,null)}render(){this.container.classList.add("squareAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),s=e.borderStyle.width,a=W(ph,this,this.svgFactory.createElement("svg:rect"));return a.setAttribute("x",s/2),a.setAttribute("y",s/2),a.setAttribute("width",t-s),a.setAttribute("height",n-s),a.setAttribute("stroke-width",s||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return F(ph,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}var fh=new WeakMap;class gh extends gd{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),j(this,fh,null)}render(){this.container.classList.add("circleAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),s=e.borderStyle.width,a=W(fh,this,this.svgFactory.createElement("svg:ellipse"));return a.setAttribute("cx",t/2),a.setAttribute("cy",n/2),a.setAttribute("rx",t/2-s/2),a.setAttribute("ry",n/2-s/2),a.setAttribute("stroke-width",s||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return F(fh,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}var vh=new WeakMap;class yh extends gd{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),j(this,vh,null),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:n,popupRef:i},width:s,height:a}=this;if(!t)return this.container;const r=this.svgFactory.create(s,a,!0);let o=[];for(let c=0,d=t.length;c<d;c+=2){const n=t[c]-e[0],i=e[3]-t[c+1];o.push("".concat(n,",").concat(i))}o=o.join(" ");const l=W(vh,this,this.svgFactory.createElement(this.svgElementName));return l.setAttribute("points",o),l.setAttribute("stroke-width",n.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return F(vh,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}class bh extends yh{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class xh extends gd{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var wh=new WeakMap,Ah=new WeakMap,_h=new WeakSet;class Sh extends gd{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),L(this,_h),j(this,wh,null),j(this,Ah,[]),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType="InkHighlight"===this.data.it?fe.HIGHLIGHT:fe.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:n,borderStyle:i,popupRef:s}}=this,{transform:a,width:r,height:o}=D(_h,this,Eh).call(this,t,e),l=this.svgFactory.create(r,o,!0),c=W(wh,this,this.svgFactory.createElement("svg:g"));l.append(c),c.setAttribute("stroke-width",i.width||1),c.setAttribute("stroke-linecap","round"),c.setAttribute("stroke-linejoin","round"),c.setAttribute("stroke-miterlimit",10),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),c.setAttribute("transform",a);for(let d=0,h=n.length;d<h;d++){const e=this.svgFactory.createElement(this.svgElementName);F(Ah,this).push(e),e.setAttribute("points",n[d].join(",")),c.append(e)}return!s&&this.hasPopupData&&this._createPopup(),this.container.append(l),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:n,rect:i}=e,s=F(wh,this);if(t>=0&&s.setAttribute("stroke-width",t||1),n)for(let a=0,r=F(Ah,this).length;a<r;a++)F(Ah,this)[a].setAttribute("points",n[a].join(","));if(i){const{transform:e,width:t,height:n}=D(_h,this,Eh).call(this,this.data.rotation,i);s.parentElement.setAttribute("viewBox","0 0 ".concat(t," ").concat(n)),s.setAttribute("transform",e)}}getElementsToTriggerPopup(){return F(Ah,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}function Eh(e,t){switch(e){case 90:return{transform:"rotate(90) translate(".concat(-t[0],",").concat(t[1],") scale(1,-1)"),width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:"rotate(180) translate(".concat(-t[2],",").concat(t[1],") scale(1,-1)"),width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:"rotate(270) translate(".concat(-t[2],",").concat(t[3],") scale(1,-1)"),width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:"translate(".concat(-t[0],",").concat(t[3],") scale(1,-1)"),width:t[2]-t[0],height:t[3]-t[1]}}}class kh extends gd{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=fe.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const t=document.createElement("mark");t.classList.add("overlaidText"),t.textContent=e,this.container.append(t)}return this.container}}class Ch extends gd{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const t=document.createElement("u");t.classList.add("overlaidText"),t.textContent=e,this.container.append(t)}return this.container}}class Th extends gd{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const t=document.createElement("u");t.classList.add("overlaidText"),t.textContent=e,this.container.append(t)}return this.container}}class Nh extends gd{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const t=document.createElement("s");t.classList.add("overlaidText"),t.textContent=e,this.container.append(t)}return this.container}}class Mh extends gd{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=fe.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Rh=new WeakMap,Ih=new WeakSet;class Ph extends gd{constructor(e){var t;super(e,{isRenderable:!0}),L(this,Ih),j(this,Rh,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,null===(t=this.linkService.eventBus)||void 0===t||t.dispatch("fileattachmentannotation",c({source:this},n))}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let n;t.hasAppearance||0===t.fillAlpha?n=document.createElement("div"):(n=document.createElement("img"),n.src="".concat(this.imageResourcesPath,"annotation-").concat(/paperclip/i.test(t.name)?"paperclip":"pushpin",".svg"),t.fillAlpha&&t.fillAlpha<1&&(n.style="filter: opacity(".concat(Math.round(100*t.fillAlpha),"%);"))),n.addEventListener("dblclick",D(Ih,this,Lh).bind(this)),W(Rh,this,n);const{isMac:i}=tt.platform;return e.addEventListener("keydown",e=>{"Enter"===e.key&&(i?e.metaKey:e.ctrlKey)&&D(Ih,this,Lh).call(this)}),!t.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return F(Rh,this)}addHighlightArea(){this.container.classList.add("highlightArea")}}function Lh(){var e;null===(e=this.downloadManager)||void 0===e||e.openOrDownloadData(this.content,this.filename)}var jh=new WeakMap,Dh=new WeakMap,Oh=new WeakMap,Fh=new WeakMap,Wh=new WeakSet;class zh{constructor(e){let{div:t,accessibilityManager:n,annotationCanvasMap:i,annotationEditorUIManager:s,page:a,viewport:r,structTreeLayer:o}=e;L(this,Wh),j(this,jh,null),j(this,Dh,null),j(this,Oh,new Map),j(this,Fh,null),this.div=t,W(jh,this,n),W(Dh,this,i),W(Fh,this,o||null),this.page=a,this.viewport=r,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return F(Oh,this).size>0}async render(e){const{annotations:t}=e,n=this.div;Tt(n,this.viewport);const i=new Map,s={data:null,layer:n,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:!1!==e.renderForms,svgFactory:new od,annotationStorage:e.annotationStorage||new Sa,enableScripting:!0===e.enableScripting,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const r of t){if(r.noHTML)continue;const e=r.annotationType===Se.POPUP;if(e){const e=i.get(r.id);if(!e)continue;s.elements=e}else if(r.rect[2]===r.rect[0]||r.rect[3]===r.rect[1])continue;s.data=r;const t=hd.create(s);if(!t.isRenderable)continue;if(!e&&r.popupRef){const e=i.get(r.popupRef);e?e.push(t):i.set(r.popupRef,[t])}const n=t.render();var a;if(r.hidden&&(n.style.visibility="hidden"),await D(Wh,this,Bh).call(this,n,r.id,s.elements),t._isEditable)F(Oh,this).set(t.data.id,t),null===(a=this._annotationEditorUIManager)||void 0===a||a.renderAnnotationElement(t)}D(Wh,this,Hh).call(this)}async addLinkAnnotations(e,t){const n={data:null,layer:this.div,linkService:t,svgFactory:new od,parent:this};for(const i of e){i.borderStyle||(i.borderStyle=zh._defaultBorderStyle),n.data=i;const e=hd.create(n);if(!e.isRenderable)continue;const t=e.render();await D(Wh,this,Bh).call(this,t,i.id,null)}}update(e){let{viewport:t}=e;const n=this.div;this.viewport=t,Tt(n,{rotation:t.rotation}),D(Wh,this,Hh).call(this),n.hidden=!1}getEditableAnnotations(){return Array.from(F(Oh,this).values())}getEditableAnnotation(e){return F(Oh,this).get(e)}static get _defaultBorderStyle(){return Ve(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Ee,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}async function Bh(e,t,n){var i;const s=e.firstChild||e,a=s.id="".concat(ct).concat(t),r=await(null===(i=F(Fh,this))||void 0===i?void 0:i.getAriaAttributes(a));if(r)for(const[l,c]of r)s.setAttribute(l,c);var o;n?n.at(-1).container.after(e):(this.div.append(e),null===(o=F(jh,this))||void 0===o||o.moveElementInDOM(this.div,e,s,!1))}function Hh(){if(!F(Dh,this))return;const e=this.div;for(const[n,i]of F(Dh,this)){const s=e.querySelector('[data-annotation-id="'.concat(n,'"]'));if(!s)continue;i.className="annotationContent";const{firstChild:a}=s;a?"CANVAS"===a.nodeName?a.replaceWith(i):a.classList.contains("annotationContent")?a.after(i):a.before(i):s.append(i);const r=F(Oh,this).get(n);var t;if(r)if(r._hasNoCanvas)null===(t=this._annotationEditorUIManager)||void 0===t||t.setMissingCanvas(n,s.id,i),r._hasNoCanvas=!1;else r.canvas=i}F(Dh,this).clear()}const Uh=/\r\n?|\n/g;var Gh=new WeakMap,Vh=new WeakMap,qh=new WeakMap,Yh=new WeakMap,Kh=new WeakMap,Xh=new WeakSet;class Qh extends Ks{static get _keyboardManager(){const e=Qh.prototype,t=e=>e.isEmpty(),n=ui.TRANSLATE_SMALL,i=ui.TRANSLATE_BIG;return Ve(this,"_keyboardManager",new gn([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,i],checker:t}]]))}constructor(e){super(c(c({},e),{},{name:"freeTextEditor"})),L(this,Xh),j(this,Gh,void 0),j(this,Vh,""),j(this,qh,"".concat(this.id,"-editor")),j(this,Yh,null),j(this,Kh,void 0),o(this,"_colorPicker",null),W(Gh,this,e.color||Qh._defaultColor||Ks._defaultLineColor),W(Kh,this,e.fontSize||Qh._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static initialize(e,t){Ks.initialize(e,t);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case ge.FREETEXT_SIZE:Qh._defaultFontSize=t;break;case ge.FREETEXT_COLOR:Qh._defaultColor=t}}updateParams(e,t){switch(e){case ge.FREETEXT_SIZE:D(Xh,this,$h).call(this,t);break;case ge.FREETEXT_COLOR:D(Xh,this,Jh).call(this,t)}}static get defaultPropertiesToUpdate(){return[[ge.FREETEXT_SIZE,Qh._defaultFontSize],[ge.FREETEXT_COLOR,Qh._defaultColor||Ks._defaultLineColor]]}get propertiesToUpdate(){return[[ge.FREETEXT_SIZE,F(Kh,this)],[ge.FREETEXT_COLOR,F(Gh,this)]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new td(this)),[["colorPicker",this._colorPicker]]}get colorType(){return ge.FREETEXT_COLOR}get colorValue(){return F(Gh,this)}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-Qh._internalPadding*e,-(Qh._internalPadding+F(Kh,this))*e]}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),W(Yh,this,new AbortController);const e=this._uiManager.combinedSignal(F(Yh,this));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){var e;return!!super.disableEditMode()&&(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",F(qh,this)),this._isDraggable=!0,null===(e=F(Yh,this))||void 0===e||e.abort(),W(Yh,this,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0)}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){var t;this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),null!==(t=this._initialOptions)&&void 0!==t&&t.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=F(Vh,this),t=W(Vh,this,D(Xh,this,Zh).call(this).trimEnd());if(e===t)return;const n=e=>{W(Vh,this,e),e?(D(Xh,this,nu).call(this),this._uiManager.rebuild(this),D(Xh,this,eu).call(this)):this.remove()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),D(Xh,this,eu).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&"Enter"===e.key&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){Qh._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",F(qh,this)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize="calc(".concat(F(Kh,this),"px * var(--total-scale-factor))"),n.color=F(Gh,this),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[n,i]=this.parentDimensions;if(this.annotationElementId){const{position:s}=this._initialData;let[a,r]=this.getInitialTranslation();[a,r]=this.pageTranslationToScreen(a,r);const[o,l]=this.pageDimensions,[c,d]=this.pageTranslation;let h,u;switch(this.rotation){case 0:h=e+(s[0]-c)/o,u=t+this.height-(s[1]-d)/l;break;case 90:h=e+(s[0]-c)/o,u=t-(s[1]-d)/l,[a,r]=[r,-a];break;case 180:h=e-this.width+(s[0]-c)/o,u=t-(s[1]-d)/l,[a,r]=[-a,-r];break;case 270:h=e+(s[0]-c-this.height*l)/o,u=t+(s[1]-d-this.width*o)/l,[a,r]=[-r,a]}this.setAt(h*n,u*i,a,r)}else this._moveAfterPaste(e,t);D(Xh,this,nu).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:n}=t;if(1===n.length&&"text/plain"===n[0])return;e.preventDefault();const i=su.call(Qh,t.getData("text")||"").replaceAll(Uh,"\n");if(!i)return;const s=window.getSelection();if(!s.rangeCount)return;this.editorDiv.normalize(),s.deleteFromDocument();const a=s.getRangeAt(0);if(!i.includes("\n"))return a.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),void s.collapseToStart();const{startContainer:r,startOffset:o}=a,l=[],c=[];if(r.nodeType===Node.TEXT_NODE){const e=r.parentElement;if(c.push(r.nodeValue.slice(o).replaceAll(Uh,"")),e!==this.editorDiv){let t=l;for(const n of this.editorDiv.childNodes)n!==e?t.push(tu.call(Qh,n)):t=c}l.push(r.nodeValue.slice(0,o).replaceAll(Uh,""))}else if(r===this.editorDiv){let e=l,t=0;for(const n of this.editorDiv.childNodes)t++===o&&(e=c),e.push(tu.call(Qh,n))}W(Vh,this,"".concat(l.join("\n")).concat(i).concat(c.join("\n"))),D(Xh,this,nu).call(this);const d=new Range;let h=Math.sumPrecise(l.map(e=>e.length));for(const{firstChild:u}of this.editorDiv.childNodes)if(u.nodeType===Node.TEXT_NODE){const e=u.nodeValue.length;if(h<=e){d.setStart(u,h),d.setEnd(u,h);break}h-=e}s.removeAllRanges(),s.addRange(d)}get contentDiv(){return this.editorDiv}static async deserialize(e,t,n){let i=null;if(e instanceof dh){const{data:{defaultAppearanceData:{fontSize:t,fontColor:n},rect:s,rotation:a,id:r,popupRef:o,contentsObj:l},textContent:c,textPosition:d,parent:{page:{pageNumber:h}}}=e;if(!c||0===c.length)return null;i=e={annotationType:fe.FREETEXT,color:Array.from(n),fontSize:t,value:c.join("\n"),position:d,pageIndex:h-1,rect:s.slice(0),rotation:a,annotationElementId:r,id:r,deleted:!1,popupRef:o,comment:(null===l||void 0===l?void 0:l.str)||null}}const s=await super.deserialize(e,t,n);return W(Kh,s,e.fontSize),W(Gh,s,it.makeHexColor(...e.color)),W(Vh,s,su.call(Qh,e.value)),s._initialData=i,e.comment&&s.setCommentData(e.comment),s}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=Qh._internalPadding*this.parentScale,n=this.getRect(t,t),i=Ks._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:F(Gh,this)),s={annotationType:fe.FREETEXT,color:i,fontSize:F(Kh,this),value:D(Xh,this,iu).call(this),pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(s),e?(s.isCopy=!0,s):this.annotationElementId&&!D(Xh,this,au).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(e){const t=super.renderAnnotationElement(e),{style:n}=t;n.fontSize="calc(".concat(F(Kh,this),"px * var(--total-scale-factor))"),n.color=F(Gh,this),t.replaceChildren();for(const a of F(Vh,this).split("\n")){const e=document.createElement("div");e.append(a?document.createTextNode(a):document.createElement("br")),t.append(e)}const i=Qh._internalPadding*this.parentScale,s={rect:this.getRect(i,i)};return s.popup=this.hasEditedComment?this.comment:{text:F(Vh,this)},e.updateEdited(s),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}function $h(e){const t=e=>{this.editorDiv.style.fontSize="calc(".concat(e,"px * var(--total-scale-factor))"),this.translate(0,-(e-F(Kh,this))*this.parentScale),W(Kh,this,e),D(Xh,this,eu).call(this)},n=F(Kh,this);this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ge.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}function Jh(e){const t=e=>{var t;W(Gh,this,this.editorDiv.style.color=e),null===(t=this._colorPicker)||void 0===t||t.update(e)},n=F(Gh,this);this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ge.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}function Zh(){const e=[];this.editorDiv.normalize();let t=null;for(const i of this.editorDiv.childNodes){var n;(null===(n=t)||void 0===n?void 0:n.nodeType)===Node.TEXT_NODE&&"BR"===i.nodeName||(e.push(tu.call($,i)),t=i)}return e.join("\n")}function eu(){const[e,t]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:e,div:t}=this,i=t.style.display,s=t.classList.contains("hidden");t.classList.remove("hidden"),t.style.display="hidden",e.div.append(this.div),n=t.getBoundingClientRect(),t.remove(),t.style.display=i,t.classList.toggle("hidden",s)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}function tu(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Uh,"")}function nu(){if(this.editorDiv.replaceChildren(),F(Vh,this))for(const e of F(Vh,this).split("\n")){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}function iu(){return F(Vh,this).replaceAll("\xa0"," ")}function su(e){return e.replaceAll(" ","\xa0")}function au(e){const{value:t,fontSize:n,color:i,pageIndex:s}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||e.value!==t||e.fontSize!==n||e.color.some((e,t)=>e!==i[t])||e.pageIndex!==s}$=Qh,o(Qh,"_freeTextDefaultContent",""),o(Qh,"_internalPadding",0),o(Qh,"_defaultColor",null),o(Qh,"_defaultFontSize",10),o(Qh,"_type","freetext"),o(Qh,"_editorType",fe.FREETEXT);class ru{toSVGPath(){Be("Abstract method `toSVGPath` must be implemented.")}get box(){Be("Abstract getter `box` must be implemented.")}serialize(e,t){Be("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,i,s,a){a||(a=new Float32Array(e.length));for(let r=0,o=e.length;r<o;r+=2)a[r]=t+e[r]*i,a[r+1]=n+e[r+1]*s;return a}static _rescaleAndSwap(e,t,n,i,s,a){a||(a=new Float32Array(e.length));for(let r=0,o=e.length;r<o;r+=2)a[r]=t+e[r+1]*i,a[r+1]=n+e[r]*s;return a}static _translate(e,t,n,i){i||(i=new Float32Array(e.length));for(let s=0,a=e.length;s<a;s+=2)i[s]=t+e[s],i[s+1]=n+e[s+1];return i}static svgRound(e){return Math.round(1e4*e)}static _normalizePoint(e,t,n,i,s){switch(s){case 90:return[1-t/n,e/i];case 180:return[1-e/n,1-t/i];case 270:return[t/n,1-e/i];default:return[e/n,t/i]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,i,s,a){return[(e+5*n)/6,(t+5*i)/6,(5*n+s)/6,(5*i+a)/6,(n+s)/2,(i+a)/2]}}o(ru,"PRECISION",1e-4);var ou=new WeakMap,lu=new WeakMap,cu=new WeakMap,du=new WeakMap,hu=new WeakMap,uu=new WeakMap,pu=new WeakMap,mu=new WeakMap,fu=new WeakMap,gu=new WeakMap,vu=new WeakMap,yu=new WeakMap,bu=new WeakMap,xu=new WeakSet;class wu{constructor(e,t,n,i,s){let{x:a,y:r}=e,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;L(this,xu),j(this,ou,void 0),j(this,lu,[]),j(this,cu,void 0),j(this,du,void 0),j(this,hu,[]),j(this,uu,new Float32Array(18)),j(this,pu,void 0),j(this,mu,void 0),j(this,fu,void 0),j(this,gu,void 0),j(this,vu,void 0),j(this,yu,void 0),j(this,bu,[]),W(ou,this,t),W(yu,this,i*n),W(du,this,s),F(uu,this).set([NaN,NaN,NaN,NaN,a,r],6),W(cu,this,o),W(gu,this,Nu._*n),W(fu,this,Mu._*n),W(vu,this,n),F(bu,this).push(a,r)}isEmpty(){return isNaN(F(uu,this)[8])}add(e){var t;let{x:n,y:i}=e;W(pu,this,n),W(mu,this,i);const[s,a,r,o]=F(ou,this);let[l,c,d,h]=F(uu,this).subarray(8,12);const u=n-d,p=i-h,m=Math.hypot(u,p);if(m<F(fu,this))return!1;const f=m-F(gu,this),g=f/m,v=g*u,y=g*p;let b=l,x=c;l=d,c=h,d+=v,h+=y,null===(t=F(bu,this))||void 0===t||t.push(n,i);const w=v/f,A=-y/f*F(yu,this),_=w*F(yu,this);if(F(uu,this).set(F(uu,this).subarray(2,8),0),F(uu,this).set([d+A,h+_],4),F(uu,this).set(F(uu,this).subarray(14,18),12),F(uu,this).set([d-A,h-_],16),isNaN(F(uu,this)[6]))return 0===F(hu,this).length&&(F(uu,this).set([l+A,c+_],2),F(hu,this).push(NaN,NaN,NaN,NaN,(l+A-s)/r,(c+_-a)/o),F(uu,this).set([l-A,c-_],14),F(lu,this).push(NaN,NaN,NaN,NaN,(l-A-s)/r,(c-_-a)/o)),F(uu,this).set([b,x,l,c,d,h],6),!this.isEmpty();F(uu,this).set([b,x,l,c,d,h],6);return Math.abs(Math.atan2(x-c,b-l)-Math.atan2(y,v))<Math.PI/2?([l,c,d,h]=F(uu,this).subarray(2,6),F(hu,this).push(NaN,NaN,NaN,NaN,((l+d)/2-s)/r,((c+h)/2-a)/o),[l,c,b,x]=F(uu,this).subarray(14,18),F(lu,this).push(NaN,NaN,NaN,NaN,((b+l)/2-s)/r,((x+c)/2-a)/o),!0):([b,x,l,c,d,h]=F(uu,this).subarray(0,6),F(hu,this).push(((b+5*l)/6-s)/r,((x+5*c)/6-a)/o,((5*l+d)/6-s)/r,((5*c+h)/6-a)/o,((l+d)/2-s)/r,((c+h)/2-a)/o),[d,h,l,c,b,x]=F(uu,this).subarray(12,18),F(lu,this).push(((b+5*l)/6-s)/r,((x+5*c)/6-a)/o,((5*l+d)/6-s)/r,((5*c+h)/6-a)/o,((l+d)/2-s)/r,((c+h)/2-a)/o),!0)}toSVGPath(){if(this.isEmpty())return"";const e=F(hu,this),t=F(lu,this);if(isNaN(F(uu,this)[6])&&!this.isEmpty())return D(xu,this,_u).call(this);const n=[];n.push("M".concat(e[4]," ").concat(e[5]));for(let i=6;i<e.length;i+=6)isNaN(e[i])?n.push("L".concat(e[i+4]," ").concat(e[i+5])):n.push("C".concat(e[i]," ").concat(e[i+1]," ").concat(e[i+2]," ").concat(e[i+3]," ").concat(e[i+4]," ").concat(e[i+5]));D(xu,this,Eu).call(this,n);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?n.push("L".concat(t[i+4]," ").concat(t[i+5])):n.push("C".concat(t[i]," ").concat(t[i+1]," ").concat(t[i+2]," ").concat(t[i+3]," ").concat(t[i+4]," ").concat(t[i+5]));return D(xu,this,Su).call(this,n),n.join(" ")}newFreeDrawOutline(e,t,n,i,s,a){return new Wu(e,t,n,i,s,a)}getOutlines(){var e,t;const n=F(hu,this),i=F(lu,this),s=F(uu,this),[a,r,o,l]=F(ou,this),c=new Float32Array((null!==(e=null===(t=F(bu,this))||void 0===t?void 0:t.length)&&void 0!==e?e:0)+2);for(let u=0,p=c.length-2;u<p;u+=2)c[u]=(F(bu,this)[u]-a)/o,c[u+1]=(F(bu,this)[u+1]-r)/l;if(c[c.length-2]=(F(pu,this)-a)/o,c[c.length-1]=(F(mu,this)-r)/l,isNaN(s[6])&&!this.isEmpty())return D(xu,this,ku).call(this,c);const d=new Float32Array(F(hu,this).length+24+F(lu,this).length);let h=n.length;for(let u=0;u<h;u+=2)isNaN(n[u])?d[u]=d[u+1]=NaN:(d[u]=n[u],d[u+1]=n[u+1]);h=D(xu,this,Tu).call(this,d,h);for(let u=i.length-6;u>=6;u-=6)for(let e=0;e<6;e+=2)isNaN(i[u+e])?(d[h]=d[h+1]=NaN,h+=2):(d[h]=i[u+e],d[h+1]=i[u+e+1],h+=2);return D(xu,this,Cu).call(this,d,h),this.newFreeDrawOutline(d,c,F(ou,this),F(vu,this),F(cu,this),F(du,this))}}function Au(){const e=F(uu,this).subarray(4,6),t=F(uu,this).subarray(16,18),[n,i,s,a]=F(ou,this);return[(F(pu,this)+(e[0]-t[0])/2-n)/s,(F(mu,this)+(e[1]-t[1])/2-i)/a,(F(pu,this)+(t[0]-e[0])/2-n)/s,(F(mu,this)+(t[1]-e[1])/2-i)/a]}function _u(){const[e,t,n,i]=F(ou,this),[s,a,r,o]=D(xu,this,Au).call(this);return"M".concat((F(uu,this)[2]-e)/n," ").concat((F(uu,this)[3]-t)/i," L").concat((F(uu,this)[4]-e)/n," ").concat((F(uu,this)[5]-t)/i," L").concat(s," ").concat(a," L").concat(r," ").concat(o," L").concat((F(uu,this)[16]-e)/n," ").concat((F(uu,this)[17]-t)/i," L").concat((F(uu,this)[14]-e)/n," ").concat((F(uu,this)[15]-t)/i," Z")}function Su(e){const t=F(lu,this);e.push("L".concat(t[4]," ").concat(t[5]," Z"))}function Eu(e){const[t,n,i,s]=F(ou,this),a=F(uu,this).subarray(4,6),r=F(uu,this).subarray(16,18),[o,l,c,d]=D(xu,this,Au).call(this);e.push("L".concat((a[0]-t)/i," ").concat((a[1]-n)/s," L").concat(o," ").concat(l," L").concat(c," ").concat(d," L").concat((r[0]-t)/i," ").concat((r[1]-n)/s))}function ku(e){const t=F(uu,this),[n,i,s,a]=F(ou,this),[r,o,l,c]=D(xu,this,Au).call(this),d=new Float32Array(36);return d.set([NaN,NaN,NaN,NaN,(t[2]-n)/s,(t[3]-i)/a,NaN,NaN,NaN,NaN,(t[4]-n)/s,(t[5]-i)/a,NaN,NaN,NaN,NaN,r,o,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,(t[16]-n)/s,(t[17]-i)/a,NaN,NaN,NaN,NaN,(t[14]-n)/s,(t[15]-i)/a],0),this.newFreeDrawOutline(d,e,F(ou,this),F(vu,this),F(cu,this),F(du,this))}function Cu(e,t){const n=F(lu,this);return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+6}function Tu(e,t){const n=F(uu,this).subarray(4,6),i=F(uu,this).subarray(16,18),[s,a,r,o]=F(ou,this),[l,c,d,h]=D(xu,this,Au).call(this);return e.set([NaN,NaN,NaN,NaN,(n[0]-s)/r,(n[1]-a)/o,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,d,h,NaN,NaN,NaN,NaN,(i[0]-s)/r,(i[1]-a)/o],t),t+24}var Nu={_:8},Mu={_:Nu._+2},Ru=new WeakMap,Iu=new WeakMap,Pu=new WeakMap,Lu=new WeakMap,ju=new WeakMap,Du=new WeakMap,Ou=new WeakMap,Fu=new WeakSet;class Wu extends ru{constructor(e,t,n,i,s,a){super(),L(this,Fu),j(this,Ru,void 0),j(this,Iu,new Float32Array(4)),j(this,Pu,void 0),j(this,Lu,void 0),j(this,ju,void 0),j(this,Du,void 0),j(this,Ou,void 0),W(Ou,this,e),W(ju,this,t),W(Ru,this,n),W(Du,this,i),W(Pu,this,s),W(Lu,this,a),this.lastPoint=[NaN,NaN],D(Fu,this,zu).call(this,a);const[r,o,l,c]=F(Iu,this);for(let d=0,h=e.length;d<h;d+=2)e[d]=(e[d]-r)/l,e[d+1]=(e[d+1]-o)/c;for(let d=0,h=t.length;d<h;d+=2)t[d]=(t[d]-r)/l,t[d+1]=(t[d+1]-o)/c}toSVGPath(){const e=["M".concat(F(Ou,this)[4]," ").concat(F(Ou,this)[5])];for(let t=6,n=F(Ou,this).length;t<n;t+=6)isNaN(F(Ou,this)[t])?e.push("L".concat(F(Ou,this)[t+4]," ").concat(F(Ou,this)[t+5])):e.push("C".concat(F(Ou,this)[t]," ").concat(F(Ou,this)[t+1]," ").concat(F(Ou,this)[t+2]," ").concat(F(Ou,this)[t+3]," ").concat(F(Ou,this)[t+4]," ").concat(F(Ou,this)[t+5]));return e.push("Z"),e.join(" ")}serialize(e,t){let[n,i,s,a]=e;const r=s-n,o=a-i;let l,c;switch(t){case 0:l=ru._rescale(F(Ou,this),n,a,r,-o),c=ru._rescale(F(ju,this),n,a,r,-o);break;case 90:l=ru._rescaleAndSwap(F(Ou,this),n,i,r,o),c=ru._rescaleAndSwap(F(ju,this),n,i,r,o);break;case 180:l=ru._rescale(F(Ou,this),s,i,-r,o),c=ru._rescale(F(ju,this),s,i,-r,o);break;case 270:l=ru._rescaleAndSwap(F(Ou,this),s,a,-r,-o),c=ru._rescaleAndSwap(F(ju,this),s,a,-r,-o)}return{outline:Array.from(l),points:[Array.from(c)]}}get box(){return F(Iu,this)}newOutliner(e,t,n,i,s){return new wu(e,t,n,i,s,arguments.length>5&&void 0!==arguments[5]?arguments[5]:0)}getNewOutline(e,t){const[n,i,s,a]=F(Iu,this),[r,o,l,c]=F(Ru,this),d=s*l,h=a*c,u=n*l+r,p=i*c+o,m=this.newOutliner({x:F(ju,this)[0]*d+u,y:F(ju,this)[1]*h+p},F(Ru,this),F(Du,this),e,F(Lu,this),null!==t&&void 0!==t?t:F(Pu,this));for(let f=2;f<F(ju,this).length;f+=2)m.add({x:F(ju,this)[f]*d+u,y:F(ju,this)[f+1]*h+p});return m.getOutlines()}}function zu(e){const t=F(Ou,this);let n=t[4],i=t[5];const s=[n,i,n,i];let a=n,r=i;const o=e?Math.max:Math.min;for(let c=6,d=t.length;c<d;c+=6){const e=t[c+4],l=t[c+5];if(isNaN(t[c]))it.pointBoundingBox(e,l,s),r<l?(a=e,r=l):r===l&&(a=o(a,e));else{const e=[1/0,1/0,-1/0,-1/0];it.bezierBoundingBox(n,i,...t.slice(c,c+6),e),it.rectBoundingBox(...e,s),r<e[3]?(a=e[2],r=e[3]):r===e[3]&&(a=o(a,e[2]))}n=e,i=l}const l=F(Iu,this);l[0]=s[0]-F(Pu,this),l[1]=s[1]-F(Pu,this),l[2]=s[2]-s[0]+2*F(Pu,this),l[3]=s[3]-s[1]+2*F(Pu,this),this.lastPoint=[a,r]}var Bu=new WeakMap,Hu=new WeakMap,Uu=new WeakMap,Gu=new WeakMap,Vu=new WeakSet;class qu{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];L(this,Vu),j(this,Bu,void 0),j(this,Hu,void 0),j(this,Uu,[]),j(this,Gu,[]);const s=[1/0,1/0,-1/0,-1/0],a=1e-4;for(const{x:u,y:p,width:m,height:f}of e){const e=Math.floor((u-t)/a)*a,n=Math.ceil((u+m+t)/a)*a,i=Math.floor((p-t)/a)*a,r=Math.ceil((p+f+t)/a)*a,o=[e,i,r,!0],l=[n,i,r,!1];F(Uu,this).push(o,l),it.rectBoundingBox(e,i,n,r,s)}const r=s[2]-s[0]+2*n,o=s[3]-s[1]+2*n,l=s[0]-n,c=s[1]-n,d=F(Uu,this).at(i?-1:-2),h=[d[0],d[2]];for(const u of F(Uu,this)){const[e,t,n]=u;u[0]=(e-l)/r,u[1]=(t-c)/o,u[2]=(n-c)/o}W(Bu,this,new Float32Array([l,c,r,o])),W(Hu,this,h)}getOutlines(){F(Uu,this).sort((e,t)=>e[0]-t[0]||e[1]-t[1]||e[2]-t[2]);const e=[];for(const t of F(Uu,this))t[3]?(e.push(...D(Vu,this,$u).call(this,t)),D(Vu,this,Xu).call(this,t)):(D(Vu,this,Qu).call(this,t),e.push(...D(Vu,this,$u).call(this,t)));return D(Vu,this,Yu).call(this,e)}}function Yu(e){const t=[],n=new Set;for(const a of e){const[e,n,i]=a;t.push([e,n,a],[e,i,a])}t.sort((e,t)=>e[1]-t[1]||e[0]-t[0]);for(let a=0,r=t.length;a<r;a+=2){const e=t[a][2],i=t[a+1][2];e.push(i),i.push(e),n.add(e),n.add(i)}const i=[];let s;for(;n.size>0;){const e=n.values().next().value;let[t,a,r,o,l]=e;n.delete(e);let c=t,d=a;for(s=[t,r],i.push(s);;){let e;if(n.has(o))e=o;else{if(!n.has(l))break;e=l}n.delete(e),[t,a,r,o,l]=e,c!==t&&(s.push(c,d,t,d===a?a:r),c=t),d=d===a?r:a}s.push(c,d)}return new ep(i,F(Bu,this),F(Hu,this))}function Ku(e){const t=F(Gu,this);let n=0,i=t.length-1;for(;n<=i;){const s=n+i>>1,a=t[s][0];if(a===e)return s;a<e?n=s+1:i=s-1}return i+1}function Xu(e){let[,t,n]=e;const i=D(Vu,this,Ku).call(this,t);F(Gu,this).splice(i,0,[t,n])}function Qu(e){let[,t,n]=e;const i=D(Vu,this,Ku).call(this,t);for(let s=i;s<F(Gu,this).length;s++){const[e,i]=F(Gu,this)[s];if(e!==t)break;if(e===t&&i===n)return void F(Gu,this).splice(s,1)}for(let s=i-1;s>=0;s--){const[e,i]=F(Gu,this)[s];if(e!==t)break;if(e===t&&i===n)return void F(Gu,this).splice(s,1)}}function $u(e){const[t,n,i]=e,s=[[t,n,i]],a=D(Vu,this,Ku).call(this,i);for(let r=0;r<a;r++){const[e,n]=F(Gu,this)[r];for(let i=0,a=s.length;i<a;i++){const[,r,o]=s[i];if(!(n<=r||o<=e))if(r>=e)if(o>n)s[i][1]=n;else{if(1===a)return[];s.splice(i,1),i--,a--}else s[i][2]=e,o>n&&s.push([t,n,o])}}return s}var Ju=new WeakMap,Zu=new WeakMap;class ep extends ru{constructor(e,t,n){super(),j(this,Ju,void 0),j(this,Zu,void 0),W(Zu,this,e),W(Ju,this,t),this.lastPoint=n}toSVGPath(){const e=[];for(const t of F(Zu,this)){let[n,i]=t;e.push("M".concat(n," ").concat(i));for(let s=2;s<t.length;s+=2){const a=t[s],r=t[s+1];a===n?(e.push("V".concat(r)),i=r):r===i&&(e.push("H".concat(a)),n=a)}e.push("Z")}return e.join(" ")}serialize(e,t){let[n,i,s,a]=e;const r=[],o=s-n,l=a-i;for(const c of F(Zu,this)){const e=new Array(c.length);for(let t=0;t<c.length;t+=2)e[t]=n+c[t]*o,e[t+1]=a-c[t+1]*l;r.push(e)}return r}get box(){return F(Ju,this)}get classNamesForOutlining(){return["highlightOutline"]}}class tp extends wu{newFreeDrawOutline(e,t,n,i,s,a){return new np(e,t,n,i,s,a)}}class np extends Wu{newOutliner(e,t,n,i,s){return new tp(e,t,n,i,s,arguments.length>5&&void 0!==arguments[5]?arguments[5]:0)}}var ip=new WeakMap,sp=new WeakMap,ap=new WeakMap,rp=new WeakMap,op=new WeakMap,lp=new WeakMap,cp=new WeakMap,dp=new WeakMap,hp=new WeakMap,up=new WeakMap,pp=new WeakMap,mp=new WeakMap,fp=new WeakMap,gp=new WeakMap,vp=new WeakMap,yp=new WeakMap,bp=new WeakMap,xp=new WeakMap,wp=new WeakSet;class Ap extends Ks{static get _keyboardManager(){const e=Ap.prototype;return Ve(this,"_keyboardManager",new gn([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super(c(c({},e),{},{name:"highlightEditor"})),L(this,wp),j(this,ip,null),j(this,sp,0),j(this,ap,void 0),j(this,rp,null),j(this,op,null),j(this,lp,null),j(this,cp,null),j(this,dp,0),j(this,hp,null),j(this,up,null),j(this,pp,null),j(this,mp,!1),j(this,fp,null),j(this,gp,void 0),j(this,vp,null),j(this,yp,""),j(this,bp,void 0),j(this,xp,""),this.color=e.color||Ap._defaultColor,W(bp,this,e.thickness||Ap._defaultThickness),W(gp,this,e.opacity||Ap._defaultOpacity),W(ap,this,e.boxes||null),W(xp,this,e.methodOfCreation||""),W(yp,this,e.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(W(mp,this,!0),D(wp,this,Sp).call(this,e),D(wp,this,Np).call(this)):F(ap,this)&&(W(ip,this,e.anchorNode),W(sp,this,e.anchorOffset),W(cp,this,e.focusNode),W(dp,this,e.focusOffset),D(wp,this,_p).call(this),D(wp,this,Np).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:F(mp,this)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:F(bp,this),methodOfCreation:F(xp,this)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}get commentColor(){return this.color}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,t){var n;Ks.initialize(e,t),Ap._defaultColor||(Ap._defaultColor=(null===(n=t.highlightColors)||void 0===n?void 0:n.values().next().value)||"#fff066")}static updateDefaultParams(e,t){switch(e){case ge.HIGHLIGHT_COLOR:Ap._defaultColor=t;break;case ge.HIGHLIGHT_THICKNESS:Ap._defaultThickness=t}}translateInPage(e,t){}get toolbarPosition(){return F(fp,this)}updateParams(e,t){switch(e){case ge.HIGHLIGHT_COLOR:D(wp,this,Ep).call(this,t);break;case ge.HIGHLIGHT_THICKNESS:D(wp,this,kp).call(this,t)}}static get defaultPropertiesToUpdate(){return[[ge.HIGHLIGHT_COLOR,Ap._defaultColor],[ge.HIGHLIGHT_THICKNESS,Ap._defaultThickness]]}get propertiesToUpdate(){return[[ge.HIGHLIGHT_COLOR,this.color||Ap._defaultColor],[ge.HIGHLIGHT_THICKNESS,F(bp,this)||Ap._defaultThickness],[ge.HIGHLIGHT_FREE,F(mp,this)]]}get toolbarButtons(){if(this._uiManager.highlightColors){return[["colorPicker",W(op,this,new Gc({editor:this}))]]}return super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(D(wp,this,Pp).call(this))}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,D(wp,this,Pp).call(this))}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){D(wp,this,Tp).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(D(wp,this,Np).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;if(this.parent&&!e)D(wp,this,Tp).call(this);else if(e){var n;D(wp,this,Np).call(this,e),t=!this.parent&&(null===(n=this.div)||void 0===n?void 0:n.classList.contains("selectedEditor"))}super.setParent(e),this.show(this._isVisible),t&&this.select()}rotate(e){const{drawLayer:t}=this.parent;let n;F(mp,this)?(e=(e-this.rotation+360)%360,n=Mp.call(Ap,F(up,this).box,e)):n=Mp.call(Ap,[this.x,this.y,this.width,this.height],e),t.updateProperties(F(pp,this),{bbox:n,root:{"data-main-rotation":e}}),t.updateProperties(F(vp,this),{bbox:Mp.call(Ap,F(lp,this).box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();F(yp,this)&&(e.setAttribute("aria-label",F(yp,this)),e.setAttribute("role","mark")),F(mp,this)?e.classList.add("free"):this.div.addEventListener("keydown",D(wp,this,Rp).bind(this),{signal:this._uiManager._signal});const t=W(hp,this,document.createElement("div"));e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=F(rp,this);const[n,i]=this.parentDimensions;return this.setDims(this.width*n,this.height*i),en(this,F(hp,this),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){var e;this.isSelected||(null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(F(vp,this),{rootClass:{hovered:!0}}))}pointerleave(){var e;this.isSelected||(null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(F(vp,this),{rootClass:{hovered:!1}}))}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:D(wp,this,Ip).call(this,!0);break;case 1:case 3:D(wp,this,Ip).call(this,!1)}}select(){var e;super.select(),F(vp,this)&&(null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(F(vp,this),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var e;super.unselect(),F(vp,this)&&(null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(F(vp,this),{rootClass:{selected:!1}}),F(mp,this)||D(wp,this,Ip).call(this,!1))}get _mustFixPosition(){return!F(mp,this)}show(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._isVisible;super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(F(pp,this),{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(F(vp,this),{rootClass:{hidden:!e}}))}static startHighlighting(e,t,n){let{target:i,x:s,y:a}=n;const{x:r,y:o,width:l,height:c}=i.getBoundingClientRect(),d=new AbortController,h=e.combinedSignal(d),u=t=>{d.abort(),D(Ap,this,Op).call(this,e,t)};window.addEventListener("blur",u,{signal:h}),window.addEventListener("pointerup",u,{signal:h}),window.addEventListener("pointerdown",At,{capture:!0,passive:!1,signal:h}),window.addEventListener("contextmenu",wt,{signal:h}),i.addEventListener("pointermove",D(Ap,this,Dp).bind(this,e),{signal:h}),this._freeHighlight=new tp({x:s,y:a},[r,o,l,c],e.scale,this._defaultThickness/2,t,.001),({id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0))}static async deserialize(e,t,n){let i=null;if(e instanceof kh){const{data:{quadPoints:t,rect:n,rotation:s,id:a,color:r,opacity:o,popupRef:l,contentsObj:c},parent:{page:{pageNumber:d}}}=e;i=e={annotationType:fe.HIGHLIGHT,color:Array.from(r),opacity:o,quadPoints:t,boxes:null,pageIndex:d-1,rect:n.slice(0),rotation:s,annotationElementId:a,id:a,deleted:!1,popupRef:l,comment:(null===c||void 0===c?void 0:c.str)||null}}else if(e instanceof Sh){const{data:{inkLists:t,rect:n,rotation:s,id:a,color:r,borderStyle:{rawWidth:o},popupRef:l,contentsObj:c},parent:{page:{pageNumber:d}}}=e;i=e={annotationType:fe.HIGHLIGHT,color:Array.from(r),thickness:o,inkLists:t,boxes:null,pageIndex:d-1,rect:n.slice(0),rotation:s,annotationElementId:a,id:a,deleted:!1,popupRef:l,comment:(null===c||void 0===c?void 0:c.str)||null}}const{color:s,quadPoints:a,inkLists:r,opacity:o}=e,l=await super.deserialize(e,t,n);l.color=it.makeHexColor(...s),W(gp,l,o||1),r&&W(bp,l,e.thickness),l._initialData=i,e.comment&&l.setCommentData(e.comment);const[c,d]=l.pageDimensions,[h,u]=l.pageTranslation;if(a){const e=W(ap,l,[]);for(let t=0;t<a.length;t+=8)e.push({x:(a[t]-h)/c,y:1-(a[t+1]-u)/d,width:(a[t+2]-a[t])/c,height:(a[t+1]-a[t+5])/d});D(wp,l,_p).call(l),D(wp,l,Np).call(l),l.rotate(l.rotation)}else if(r){W(mp,l,!0);const e=r[0],n={x:e[0]-h,y:d-(e[1]-u)},i=new tp(n,[0,0,c,d],1,F(bp,l)/2,!0,.001);for(let t=0,r=e.length;t<r;t+=2)n.x=e[t]-h,n.y=d-(e[t+1]-u),i.add(n);const{id:s,clipPathId:a}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:l.color,"fill-opacity":l._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:i.toSVGPath()}},!0,!0);D(wp,l,Sp).call(l,{highlightOutlines:i.getOutlines(),highlightId:s,clipPathId:a}),D(wp,l,Np).call(l),l.rotate(l.parentRotation)}return l}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=this.getRect(0,0),n=Ks._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i={annotationType:fe.HIGHLIGHT,color:n,opacity:F(gp,this),thickness:F(bp,this),quadPoints:D(wp,this,Lp).call(this),outlines:D(wp,this,jp).call(this,t),pageIndex:this.pageIndex,rect:t,rotation:D(wp,this,Pp).call(this),structTreeParentId:this._structTreeParentId};return this.addComment(i),this.annotationElementId&&!D(wp,this,Fp).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(e){const t={rect:this.getRect(0,0)};return this.hasEditedComment&&(t.popup=this.comment),e.updateEdited(t),null}static canCreateNewEmptyEditor(){return!1}}function _p(){const e=new qu(F(ap,this),.001);W(up,this,e.getOutlines()),[this.x,this.y,this.width,this.height]=F(up,this).box;const t=new qu(F(ap,this),.0025,.001,"ltr"===this._uiManager.direction);W(lp,this,t.getOutlines());const{lastPoint:n}=F(lp,this);W(fp,this,[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height])}function Sp(e){let{highlightOutlines:t,highlightId:n,clipPathId:i}=e;W(up,this,t);if(W(lp,this,t.getNewOutline(F(bp,this)/2+1.5,.0025)),n>=0)W(pp,this,n),W(rp,this,i),this.parent.drawLayer.finalizeDraw(n,{bbox:t.box,path:{d:t.toSVGPath()}}),W(vp,this,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:F(lp,this).box,path:{d:F(lp,this).toSVGPath()}},!0));else if(this.parent){const e=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(F(pp,this),{bbox:Mp.call(J,F(up,this).box,(e-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(F(vp,this),{bbox:Mp.call(J,F(lp,this).box,e),path:{d:F(lp,this).toSVGPath()}})}const[s,a,r,o]=t.box;switch(this.rotation){case 0:this.x=s,this.y=a,this.width=r,this.height=o;break;case 90:{const[e,t]=this.parentDimensions;this.x=a,this.y=1-s,this.width=r*t/e,this.height=o*e/t;break}case 180:this.x=1-s,this.y=1-a,this.width=r,this.height=o;break;case 270:{const[e,t]=this.parentDimensions;this.x=1-a,this.y=s,this.width=r*t/e,this.height=o*e/t;break}}const{lastPoint:l}=F(lp,this);W(fp,this,[(l[0]-s)/r,(l[1]-a)/o])}function Ep(e){const t=(e,t)=>{var n,i;this.color=e,W(gp,this,t),null===(n=this.parent)||void 0===n||n.drawLayer.updateProperties(F(pp,this),{root:{fill:e,"fill-opacity":t}}),null===(i=F(op,this))||void 0===i||i.updateColor(e)},n=this.color,i=F(gp,this);this.addCommands({cmd:t.bind(this,e,J._defaultOpacity),undo:t.bind(this,n,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ge.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(e)},!0)}function kp(e){const t=F(bp,this),n=e=>{W(bp,this,e),D(wp,this,Cp).call(this,e)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ge.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}function Cp(e){if(!F(mp,this))return;D(wp,this,Sp).call(this,{highlightOutlines:F(up,this).getNewOutline(e/2)}),this.fixAndSetPosition();const[t,n]=this.parentDimensions;this.setDims(this.width*t,this.height*n)}function Tp(){null!==F(pp,this)&&this.parent&&(this.parent.drawLayer.remove(F(pp,this)),W(pp,this,null),this.parent.drawLayer.remove(F(vp,this)),W(vp,this,null))}function Np(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parent;null===F(pp,this)&&(({id:I(W,[pp,this])._,clipPathId:I(W,[rp,this])._}=e.drawLayer.draw({bbox:F(up,this).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":F(gp,this)},rootClass:{highlight:!0,free:F(mp,this)},path:{d:F(up,this).toSVGPath()}},!1,!0)),W(vp,this,e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:F(mp,this)},bbox:F(lp,this).box,path:{d:F(lp,this).toSVGPath()}},F(mp,this))),F(hp,this)&&(F(hp,this).style.clipPath=F(rp,this)))}function Mp(e,t){let[n,i,s,a]=e;switch(t){case 90:return[1-i-a,n,a,s];case 180:return[1-n-s,1-i-a,s,a];case 270:return[i,1-n-s,a,s]}return[n,i,s,a]}function Rp(e){J._keyboardManager.exec(this,e)}function Ip(e){if(!F(ip,this))return;const t=window.getSelection();e?t.setPosition(F(ip,this),F(sp,this)):t.setPosition(F(cp,this),F(dp,this))}function Pp(){return F(mp,this)?this.rotation:0}function Lp(){if(F(mp,this))return null;const[e,t]=this.pageDimensions,[n,i]=this.pageTranslation,s=F(ap,this),a=new Float32Array(8*s.length);let r=0;for(const{x:o,y:l,width:c,height:d}of s){const s=o*e+n,h=(1-l)*t+i;a[r]=a[r+4]=s,a[r+1]=a[r+3]=h,a[r+2]=a[r+6]=s+c*e,a[r+5]=a[r+7]=h-d*t,r+=8}return a}function jp(e){return F(up,this).serialize(e,D(wp,this,Pp).call(this))}function Dp(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}function Op(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}function Fp(e){const{color:t}=this._initialData;return this.hasEditedComment||e.color.some((e,n)=>e!==t[n])}J=Ap,o(Ap,"_defaultColor",null),o(Ap,"_defaultOpacity",1),o(Ap,"_defaultThickness",12),o(Ap,"_type","highlight"),o(Ap,"_editorType",fe.HIGHLIGHT),o(Ap,"_freeHighlightId",-1),o(Ap,"_freeHighlight",null),o(Ap,"_freeHighlightClipId","");var Wp=new WeakMap;class zp{constructor(){j(this,Wp,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,n)}updateSVGProperty(e,t){F(Wp,this)[e]=t}toSVGProperties(){const e=F(Wp,this);return W(Wp,this,Object.create(null)),{root:e}}reset(){W(Wp,this,Object.create(null))}updateAll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;this.updateProperties(e)}clone(){Be("Not implemented")}}var Bp=new WeakMap,Hp=new WeakMap,Up=new WeakSet;class Gp extends Ks{constructor(e){super(e),L(this,Up),j(this,Bp,null),j(this,Hp,void 0),o(this,"_colorPicker",null),o(this,"_drawId",null),W(Hp,this,e.mustBeCommitted||!1),this._addOutlines(e)}_addOutlines(e){e.drawOutlines&&(D(Up,this,Vp).call(this,e),D(Up,this,Kp).call(this))}static _mergeSVGProperties(e,t){const n=new Set(Object.keys(e));for(const[i,s]of Object.entries(t))n.has(i)?Object.assign(e[i],s):e[i]=s;return e}static getDefaultDrawingOptions(e){Be("Not implemented")}static get typesMap(){Be("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const n=this.typesMap.get(e);n&&this._defaultDrawingOptions.updateProperty(n,t),this._currentParent&&(Zp._.updateProperty(n,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const n=this.constructor.typesMap.get(e);n&&this._updateProperty(e,n,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[n,i]of this.typesMap)e.push([n,t[i]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[n,i]of this.constructor.typesMap)e.push([n,t[i]]);return e}_updateProperty(e,t,n){const i=this._drawingOptions,s=i[t],a=n=>{var s;i.updateProperty(t,n);const a=F(Bp,this).updateProperty(t,n);var r;(a&&D(Up,this,$p).call(this,a),null===(s=this.parent)||void 0===s||s.drawLayer.updateProperties(this._drawId,i.toSVGProperties()),e===this.colorType)&&(null===(r=this._colorPicker)||void 0===r||r.update(n))};this.addCommands({cmd:a.bind(this,n),undo:a.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var e;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(this._drawId,Gp._mergeSVGProperties(F(Bp,this).getPathResizingSVGProperties(D(Up,this,Qp).call(this)),{bbox:D(Up,this,Jp).call(this)}))}_onResized(){var e;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(this._drawId,Gp._mergeSVGProperties(F(Bp,this).getPathResizedSVGProperties(D(Up,this,Qp).call(this)),{bbox:D(Up,this,Jp).call(this)}))}_onTranslating(e,t){var n;null===(n=this.parent)||void 0===n||n.drawLayer.updateProperties(this._drawId,{bbox:D(Up,this,Jp).call(this)})}_onTranslated(){var e;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(this._drawId,Gp._mergeSVGProperties(F(Bp,this).getPathTranslatedSVGProperties(D(Up,this,Qp).call(this),this.parentDimensions),{bbox:D(Up,this,Jp).call(this)}))}_onStartDragging(){var e;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var e;null===(e=this.parent)||void 0===e||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,F(Hp,this)&&(W(Hp,this,!1),this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){D(Up,this,Yp).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(D(Up,this,Kp).call(this),D(Up,this,$p).call(this,F(Bp,this).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;if(this.parent&&!e)this._uiManager.removeShouldRescale(this),D(Up,this,Yp).call(this);else if(e){var n;this._uiManager.addShouldRescale(this),D(Up,this,Kp).call(this,e),t=!this.parent&&(null===(n=this.div)||void 0===n?void 0:n.classList.contains("selectedEditor"))}super.setParent(e),t&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Gp._mergeSVGProperties({bbox:D(Up,this,Jp).call(this)},F(Bp,this).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&D(Up,this,$p).call(this,F(Bp,this).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);const n=super.render();n.classList.add("draw");const i=document.createElement("div");n.append(i),i.setAttribute("aria-hidden","true"),i.className="internal";const[s,a]=this.parentDimensions;return this.setDims(this.width*s,this.height*a),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),n}static createDrawerInstance(e,t,n,i,s){Be("Not implemented")}static startDrawing(e,t,n,i){var s,a;const{target:r,offsetX:o,offsetY:l,pointerId:c,pointerType:d}=i;if(im._&&im._!==d)return;const{viewport:{rotation:h}}=e,{width:u,height:p}=r.getBoundingClientRect(),m=em._=new AbortController,f=e.combinedSignal(m);nm._||(nm._=c),null!==(s=im._)&&void 0!==s||(im._=d),window.addEventListener("pointerup",e=>{var t;nm._===e.pointerId?this._endDraw(e):null===(t=sm._)||void 0===t||t.delete(e.pointerId)},{signal:f}),window.addEventListener("pointercancel",e=>{var t;nm._===e.pointerId?this._currentParent.endDrawingSession():null===(t=sm._)||void 0===t||t.delete(e.pointerId)},{signal:f}),window.addEventListener("pointerdown",e=>{im._===e.pointerType&&((sm._||(sm._=new Set)).add(e.pointerId),Zp._.isCancellable()&&(Zp._.removeLastElement(),Zp._.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",wt,{signal:f}),r.addEventListener("pointermove",this._drawMove.bind(this),{signal:f}),r.addEventListener("touchmove",e=>{e.timeStamp===am._&&At(e)},{signal:f}),e.toggleDrawing(),null===(a=t._editorUndoBar)||void 0===a||a.hide(),Zp._?e.drawLayer.updateProperties(this._currentDrawId,Zp._.startNew(o,l,u,p,h)):(t.updateUIForDefaultProperties(this),Zp._=this.createDrawerInstance(o,l,u,p,h),tm._=this.getDefaultDrawingOptions(),this._currentParent=e,({id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(tm._.toSVGProperties(),Zp._.defaultSVGProperties),!0,!1)))}static _drawMove(e){var t;if(am._=-1,!Zp._)return;const{offsetX:n,offsetY:i,pointerId:s}=e;nm._===s&&((null===(t=sm._)||void 0===t?void 0:t.size)>=1?this._endDraw(e):(this._currentParent.drawLayer.updateProperties(this._currentDrawId,Zp._.add(n,i)),am._=e.timeStamp,At(e)))}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,Zp._=null,tm._=null,im._=null,am._=NaN),em._&&(em._.abort(),em._=null,nm._=NaN,sm._=null)}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),(null===e||void 0===e?void 0:e.target)===t.div&&t.drawLayer.updateProperties(this._currentDrawId,Zp._.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const e=Zp._,n=this._currentDrawId,i=e.getLastElement();return void t.addCommands({cmd:()=>{t.drawLayer.updateProperties(n,e.setLastElement(i))},undo:()=>{t.drawLayer.updateProperties(n,e.removeLastElement())},mustExec:!1,type:ge.DRAW_STEP})}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(ge.DRAW_STEP),!Zp._.isEmpty()){const{pageDimensions:[n,i],scale:s}=t,a=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Zp._.getOutlines(n*s,i*s,s,this._INNER_MARGIN),drawingOptions:tm._,mustBeCommitted:!e});return this._cleanup(!0),a}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,n,i,s,a){Be("Not implemented")}static async deserialize(e,t,n){const{rawDims:{pageWidth:i,pageHeight:s,pageX:a,pageY:r}}=t.viewport,o=this.deserializeDraw(a,r,i,s,this._INNER_MARGIN,e),l=await super.deserialize(e,t,n);return l.createDrawingOptions(e),D(Up,l,Vp).call(l,{drawOutlines:o}),D(Up,l,Kp).call(l),l.onScaleChanging(),l.rotate(),l}serializeDraw(e){const[t,n]=this.pageTranslation,[i,s]=this.pageDimensions;return F(Bp,this).serialize([t,n,i,s],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}function Vp(e){let{drawOutlines:t,drawId:n,drawingOptions:i}=e;W(Bp,this,t),this._drawingOptions||(this._drawingOptions=i),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-".concat(this.editorType,"-added-alert")),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,t.defaultProperties)):this._drawId=D(Up,this,qp).call(this,t,this.parent),D(Up,this,$p).call(this,t.box)}function qp(e,t){const{id:n}=t.drawLayer.draw(Z._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return n}function Yp(){null!==this._drawId&&this.parent&&(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}function Kp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parent;null!==this._drawId&&this.parent===e||(null===this._drawId?(this._drawingOptions.updateAll(),this._drawId=D(Up,this,qp).call(this,F(Bp,this),e)):this.parent.drawLayer.updateParent(this._drawId,e.drawLayer))}function Xp(e){let[t,n,i,s]=e;const{parentDimensions:[a,r],rotation:o}=this;switch(o){case 90:return[n,1-t,i*(r/a),s*(a/r)];case 180:return[1-t,1-n,i,s];case 270:return[1-n,t,i*(r/a),s*(a/r)];default:return[t,n,i,s]}}function Qp(){const{x:e,y:t,width:n,height:i,parentDimensions:[s,a],rotation:r}=this;switch(r){case 90:return[1-t,e,n*(s/a),i*(a/s)];case 180:return[1-e,1-t,n,i];case 270:return[t,1-e,n*(s/a),i*(a/s)];default:return[e,t,n,i]}}function $p(e){if([this.x,this.y,this.width,this.height]=D(Up,this,Xp).call(this,e),this.div){this.fixAndSetPosition();const[e,t]=this.parentDimensions;this.setDims(this.width*e,this.height*t)}this._onResized()}function Jp(){const{x:e,y:t,width:n,height:i,rotation:s,parentRotation:a,parentDimensions:[r,o]}=this;switch((4*s+a)/90){case 1:return[1-t-i,e,i,n];case 2:return[1-e-n,1-t-i,n,i];case 3:return[t,1-e-n,i,n];case 4:return[e,t-n*(r/o),i*(o/r),n*(r/o)];case 5:return[1-t,e,n*(r/o),i*(o/r)];case 6:return[1-e-i*(o/r),1-t,i*(o/r),n*(r/o)];case 7:return[t-n*(r/o),1-e-i*(o/r),n*(r/o),i*(o/r)];case 8:return[e-n,t-i,n,i];case 9:return[1-t,e-n,i,n];case 10:return[1-e,1-t,n,i];case 11:return[t-i,1-e,i,n];case 12:return[e-i*(o/r),t,i*(o/r),n*(r/o)];case 13:return[1-t-n*(r/o),e-i*(o/r),n*(r/o),i*(o/r)];case 14:return[1-e,1-t-n*(r/o),i*(o/r),n*(r/o)];case 15:return[t,1-e,n*(r/o),i*(o/r)];default:return[e,t,n,i]}}Z=Gp,o(Gp,"_currentDrawId",-1),o(Gp,"_currentParent",null);var Zp={_:null},em={_:null},tm={_:null},nm={_:NaN},im={_:null},sm={_:null},am={_:NaN};o(Gp,"_INNER_MARGIN",3);var rm=new WeakMap,om=new WeakMap,lm=new WeakMap,cm=new WeakMap,dm=new WeakMap,hm=new WeakMap,um=new WeakMap,pm=new WeakMap,mm=new WeakMap,fm=new WeakMap,gm=new WeakMap,vm=new WeakSet;class ym{constructor(e,t,n,i,s,a){L(this,vm),j(this,rm,new Float64Array(6)),j(this,om,void 0),j(this,lm,void 0),j(this,cm,void 0),j(this,dm,void 0),j(this,hm,void 0),j(this,um,""),j(this,pm,0),j(this,mm,new Mm),j(this,fm,void 0),j(this,gm,void 0),W(fm,this,n),W(gm,this,i),W(cm,this,s),W(dm,this,a),[e,t]=D(vm,this,bm).call(this,e,t);const r=W(om,this,[NaN,NaN,NaN,NaN,e,t]);W(hm,this,[e,t]),W(lm,this,[{line:r,points:F(hm,this)}]),F(rm,this).set(r,0)}updateProperty(e,t){"stroke-width"===e&&W(dm,this,t)}isEmpty(){return!F(lm,this)||0===F(lm,this).length}isCancellable(){return F(hm,this).length<=10}add(e,t){[e,t]=D(vm,this,bm).call(this,e,t);const[n,i,s,a]=F(rm,this).subarray(2,6),r=e-s,o=t-a;return Math.hypot(F(fm,this)*r,F(gm,this)*o)<=2?null:(F(hm,this).push(e,t),isNaN(n)?(F(rm,this).set([s,a,e,t],2),F(om,this).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(F(rm,this)[0])&&F(om,this).splice(6,6),F(rm,this).set([n,i,s,a,e,t],0),F(om,this).push(...ru.createBezierPoints(n,i,s,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(2===F(hm,this).length?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,i,s){W(fm,this,n),W(gm,this,i),W(cm,this,s),[e,t]=D(vm,this,bm).call(this,e,t);const a=W(om,this,[NaN,NaN,NaN,NaN,e,t]);W(hm,this,[e,t]);const r=F(lm,this).at(-1);return r&&(r.line=new Float32Array(r.line),r.points=new Float32Array(r.points)),F(lm,this).push({line:a,points:F(hm,this)}),F(rm,this).set(a,0),W(pm,this,0),this.toSVGPath(),null}getLastElement(){return F(lm,this).at(-1)}setLastElement(e){return F(lm,this)?(F(lm,this).push(e),W(om,this,e.line),W(hm,this,e.points),W(pm,this,0),{path:{d:this.toSVGPath()}}):F(mm,this).setLastElement(e)}removeLastElement(){if(!F(lm,this))return F(mm,this).removeLastElement();F(lm,this).pop(),W(um,this,"");for(let e=0,t=F(lm,this).length;e<t;e++){const{line:t,points:n}=F(lm,this)[e];W(om,this,t),W(hm,this,n),W(pm,this,0),this.toSVGPath()}return{path:{d:F(um,this)}}}toSVGPath(){const e=ru.svgRound(F(om,this)[4]),t=ru.svgRound(F(om,this)[5]);if(2===F(hm,this).length)return W(um,this,"".concat(F(um,this)," M ").concat(e," ").concat(t," Z")),F(um,this);if(F(hm,this).length<=6){const n=F(um,this).lastIndexOf("M");W(um,this,"".concat(F(um,this).slice(0,n)," M ").concat(e," ").concat(t)),W(pm,this,6)}if(4===F(hm,this).length){const e=ru.svgRound(F(om,this)[10]),t=ru.svgRound(F(om,this)[11]);return W(um,this,"".concat(F(um,this)," L ").concat(e," ").concat(t)),W(pm,this,12),F(um,this)}const n=[];0===F(pm,this)&&(n.push("M ".concat(e," ").concat(t)),W(pm,this,6));for(let i=F(pm,this),s=F(om,this).length;i<s;i+=6){const[e,t,s,a,r,o]=F(om,this).slice(i,i+6).map(ru.svgRound);n.push("C".concat(e," ").concat(t," ").concat(s," ").concat(a," ").concat(r," ").concat(o))}return W(um,this,F(um,this)+n.join(" ")),W(pm,this,F(om,this).length),F(um,this)}getOutlines(e,t,n,i){const s=F(lm,this).at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),F(mm,this).build(F(lm,this),e,t,n,F(cm,this),F(dm,this),i),W(rm,this,null),W(om,this,null),W(lm,this,null),W(um,this,null),F(mm,this)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}function bm(e,t){return ru._normalizePoint(e,t,F(fm,this),F(gm,this),F(cm,this))}var xm=new WeakMap,wm=new WeakMap,Am=new WeakMap,_m=new WeakMap,Sm=new WeakMap,Em=new WeakMap,km=new WeakMap,Cm=new WeakMap,Tm=new WeakMap,Nm=new WeakSet;class Mm extends ru{constructor(){super(...arguments),L(this,Nm),j(this,xm,void 0),j(this,wm,0),j(this,Am,void 0),j(this,_m,void 0),j(this,Sm,void 0),j(this,Em,void 0),j(this,km,void 0),j(this,Cm,void 0),j(this,Tm,void 0)}build(e,t,n,i,s,a,r){W(Sm,this,t),W(Em,this,n),W(km,this,i),W(Cm,this,s),W(Tm,this,a),W(Am,this,null!==r&&void 0!==r?r:0),W(_m,this,e),D(Nm,this,Pm).call(this)}get thickness(){return F(Tm,this)}setLastElement(e){return F(_m,this).push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return F(_m,this).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of F(_m,this))if(e.push("M".concat(ru.svgRound(t[4])," ").concat(ru.svgRound(t[5]))),6!==t.length)if(12===t.length&&isNaN(t[6]))e.push("L".concat(ru.svgRound(t[10])," ").concat(ru.svgRound(t[11])));else for(let n=6,i=t.length;n<i;n+=6){const[i,s,a,r,o,l]=t.subarray(n,n+6).map(ru.svgRound);e.push("C".concat(i," ").concat(s," ").concat(a," ").concat(r," ").concat(o," ").concat(l))}else e.push("Z");return e.join("")}serialize(e,t){let[n,i,s,a]=e;const r=[],o=[],[l,c,d,h]=D(Nm,this,Im).call(this);let u,p,m,f,g,v,y,b,x;switch(F(Cm,this)){case 0:x=ru._rescale,u=n,p=i+a,m=s,f=-a,g=n+l*s,v=i+(1-c-h)*a,y=n+(l+d)*s,b=i+(1-c)*a;break;case 90:x=ru._rescaleAndSwap,u=n,p=i,m=s,f=a,g=n+c*s,v=i+l*a,y=n+(c+h)*s,b=i+(l+d)*a;break;case 180:x=ru._rescale,u=n+s,p=i,m=-s,f=a,g=n+(1-l-d)*s,v=i+c*a,y=n+(1-l)*s,b=i+(c+h)*a;break;case 270:x=ru._rescaleAndSwap,u=n+s,p=i+a,m=-s,f=-a,g=n+(1-c-h)*s,v=i+(1-l-d)*a,y=n+(1-c)*s,b=i+(1-l)*a}for(const{line:w,points:A}of F(_m,this))r.push(x(w,u,p,m,f,t?new Array(w.length):null)),o.push(x(A,u,p,m,f,t?new Array(A.length):null));return{lines:r,points:o,rect:[g,v,y,b]}}static deserialize(e,t,n,i,s,a){let{paths:{lines:r,points:o},rotation:l,thickness:c}=a;const d=[];let h,u,p,m,f;switch(l){case 0:f=ru._rescale,h=-e/n,u=t/i+1,p=1/n,m=-1/i;break;case 90:f=ru._rescaleAndSwap,h=-t/i,u=-e/n,p=1/i,m=1/n;break;case 180:f=ru._rescale,h=e/n+1,u=-t/i,p=-1/n,m=1/i;break;case 270:f=ru._rescaleAndSwap,h=t/i+1,u=e/n+1,p=-1/i,m=-1/n}if(!r){r=[];for(const e of o){const t=e.length;if(2===t){r.push(new Float32Array([NaN,NaN,NaN,NaN,e[0],e[1]]));continue}if(4===t){r.push(new Float32Array([NaN,NaN,NaN,NaN,e[0],e[1],NaN,NaN,NaN,NaN,e[2],e[3]]));continue}const n=new Float32Array(3*(t-2));r.push(n);let[i,s,a,o]=e.subarray(0,4);n.set([NaN,NaN,NaN,NaN,i,s],0);for(let r=4;r<t;r+=2){const t=e[r],l=e[r+1];n.set(ru.createBezierPoints(i,s,a,o,t,l),3*(r-2)),[i,s,a,o]=[a,o,t,l]}}}for(let v=0,y=r.length;v<y;v++)d.push({line:f(r[v].map(e=>null!==e&&void 0!==e?e:NaN),h,u,p,m),points:f(o[v].map(e=>null!==e&&void 0!==e?e:NaN),h,u,p,m)});const g=new this.prototype.constructor;return g.build(d,n,i,1,l,c,s),g}get box(){return F(xm,this)}updateProperty(e,t){return"stroke-width"===e?D(Nm,this,Lm).call(this,t):null}updateParentDimensions(e,t){let[n,i]=e;const[s,a]=D(Nm,this,Rm).call(this);W(Sm,this,n),W(Em,this,i),W(km,this,t);const[r,o]=D(Nm,this,Rm).call(this),l=r-s,c=o-a,d=F(xm,this);return d[0]-=l,d[1]-=c,d[2]+=2*l,d[3]+=2*c,d}updateRotation(e){return W(wm,this,e),{path:{transform:this.rotationTransform}}}get viewBox(){return F(xm,this).map(ru.svgRound).join(" ")}get defaultProperties(){const[e,t]=F(xm,this);return{root:{viewBox:this.viewBox},path:{"transform-origin":"".concat(ru.svgRound(e)," ").concat(ru.svgRound(t))}}}get rotationTransform(){const[,,e,t]=F(xm,this);let n=0,i=0,s=0,a=0,r=0,o=0;switch(F(wm,this)){case 90:i=t/e,s=-e/t,r=e;break;case 180:n=-1,a=-1,r=e,o=t;break;case 270:i=-t/e,s=e/t,o=t;break;default:return""}return"matrix(".concat(n," ").concat(i," ").concat(s," ").concat(a," ").concat(ru.svgRound(r)," ").concat(ru.svgRound(o),")")}getPathResizingSVGProperties(e){let[t,n,i,s]=e;const[a,r]=D(Nm,this,Rm).call(this),[o,l,c,d]=F(xm,this);if(Math.abs(c-a)<=ru.PRECISION||Math.abs(d-r)<=ru.PRECISION){const e=t+i/2-(o+c/2),a=n+s/2-(l+d/2);return{path:{"transform-origin":"".concat(ru.svgRound(t)," ").concat(ru.svgRound(n)),transform:"".concat(this.rotationTransform," translate(").concat(e," ").concat(a,")")}}}const h=(i-2*a)/(c-2*a),u=(s-2*r)/(d-2*r),p=c/i,m=d/s;return{path:{"transform-origin":"".concat(ru.svgRound(o)," ").concat(ru.svgRound(l)),transform:"".concat(this.rotationTransform," scale(").concat(p," ").concat(m,") ")+"translate(".concat(ru.svgRound(a)," ").concat(ru.svgRound(r),") scale(").concat(h," ").concat(u,") ")+"translate(".concat(ru.svgRound(-a)," ").concat(ru.svgRound(-r),")")}}}getPathResizedSVGProperties(e){let[t,n,i,s]=e;const[a,r]=D(Nm,this,Rm).call(this),o=F(xm,this),[l,c,d,h]=o;if(o[0]=t,o[1]=n,o[2]=i,o[3]=s,Math.abs(d-a)<=ru.PRECISION||Math.abs(h-r)<=ru.PRECISION){const e=t+i/2-(l+d/2),a=n+s/2-(c+h/2);for(const{line:t,points:n}of F(_m,this))ru._translate(t,e,a,t),ru._translate(n,e,a,n);return{root:{viewBox:this.viewBox},path:{"transform-origin":"".concat(ru.svgRound(t)," ").concat(ru.svgRound(n)),transform:this.rotationTransform||null,d:this.toSVGPath()}}}const u=(i-2*a)/(d-2*a),p=(s-2*r)/(h-2*r),m=-u*(l+a)+t+a,f=-p*(c+r)+n+r;if(1!==u||1!==p||0!==m||0!==f)for(const{line:g,points:v}of F(_m,this))ru._rescale(g,m,f,u,p,g),ru._rescale(v,m,f,u,p,v);return{root:{viewBox:this.viewBox},path:{"transform-origin":"".concat(ru.svgRound(t)," ").concat(ru.svgRound(n)),transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties(e,t){let[n,i]=e;const[s,a]=t,r=F(xm,this),o=n-r[0],l=i-r[1];if(F(Sm,this)===s&&F(Em,this)===a)for(const{line:c,points:d}of F(_m,this))ru._translate(c,o,l,c),ru._translate(d,o,l,d);else{const e=F(Sm,this)/s,t=F(Em,this)/a;W(Sm,this,s),W(Em,this,a);for(const{line:n,points:i}of F(_m,this))ru._rescale(n,o,l,e,t,n),ru._rescale(i,o,l,e,t,i);r[2]*=e,r[3]*=t}return r[0]=n,r[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":"".concat(ru.svgRound(n)," ").concat(ru.svgRound(i))}}}get defaultSVGProperties(){const e=F(xm,this);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":"".concat(ru.svgRound(e[0])," ").concat(ru.svgRound(e[1])),transform:this.rotationTransform||null},bbox:e}}}function Rm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F(Tm,this);const t=F(Am,this)+e/2*F(km,this);return F(Cm,this)%180===0?[t/F(Sm,this),t/F(Em,this)]:[t/F(Em,this),t/F(Sm,this)]}function Im(){const[e,t,n,i]=F(xm,this),[s,a]=D(Nm,this,Rm).call(this,0);return[e+s,t+a,n-2*s,i-2*a]}function Pm(){const e=W(xm,this,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:i}of F(_m,this)){if(i.length<=12){for(let t=4,n=i.length;t<n;t+=6)it.pointBoundingBox(i[t],i[t+1],e);continue}let t=i[4],n=i[5];for(let s=6,a=i.length;s<a;s+=6){const[a,r,o,l,c,d]=i.subarray(s,s+6);it.bezierBoundingBox(t,n,a,r,o,l,c,d,e),t=c,n=d}}const[t,n]=D(Nm,this,Rm).call(this);e[0]=dt(e[0]-t,0,1),e[1]=dt(e[1]-n,0,1),e[2]=dt(e[2]+t,0,1),e[3]=dt(e[3]+n,0,1),e[2]-=e[0],e[3]-=e[1]}function Lm(e){const[t,n]=D(Nm,this,Rm).call(this);W(Tm,this,e);const[i,s]=D(Nm,this,Rm).call(this),[a,r]=[i-t,s-n],o=F(xm,this);return o[0]-=a,o[1]-=r,o[2]+=2*a,o[3]+=2*r,o}class jm extends zp{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Ks._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){"stroke-width"===e&&(null!==t&&void 0!==t||(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new jm(this._viewParameters);return e.updateAll(this),e}}var Dm=new WeakSet;class Om extends Gp{constructor(e){super(c(c({},e),{},{name:"inkEditor"})),L(this,Dm),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,t){Ks.initialize(e,t),this._defaultDrawingOptions=new jm(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ve(this,"typesMap",new Map([[ge.INK_THICKNESS,"stroke-width"],[ge.INK_COLOR,"stroke"],[ge.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,n,i,s){return new ym(e,t,n,i,s,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,n,i,s,a){return Mm.deserialize(e,t,n,i,s,a)}static async deserialize(e,t,n){let i=null;if(e instanceof Sh){const{data:{inkLists:t,rect:n,rotation:s,id:a,color:r,opacity:o,borderStyle:{rawWidth:l},popupRef:c,contentsObj:d},parent:{page:{pageNumber:h}}}=e;i=e={annotationType:fe.INK,color:Array.from(r),thickness:l,opacity:o,paths:{points:t},boxes:null,pageIndex:h-1,rect:n.slice(0),rotation:s,annotationElementId:a,id:a,deleted:!1,popupRef:c,comment:(null===d||void 0===d?void 0:d.str)||null}}const s=await super.deserialize(e,t,n);return s._initialData=i,e.comment&&s.setCommentData(e.comment),s}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new td(this)),[["colorPicker",this._colorPicker]]}get colorType(){return ge.INK_COLOR}get colorValue(){return this._drawingOptions.stroke}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:n}=this;t.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions(e){let{color:t,thickness:n,opacity:i}=e;this._drawingOptions=Om.getDefaultDrawingOptions({stroke:it.makeHexColor(...t),"stroke-width":n,"stroke-opacity":i})}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:n,rect:i}=this.serializeDraw(e),{_drawingOptions:{stroke:s,"stroke-opacity":a,"stroke-width":r}}=this,o={annotationType:fe.INK,color:Ks._colorManager.convert(s),opacity:a,thickness:r,paths:{lines:t,points:n},pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(o),e?(o.isCopy=!0,o):this.annotationElementId&&!D(Dm,this,Fm).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(e){const{points:t,rect:n}=this.serializeDraw(!1),i={rect:n,thickness:this._drawingOptions["stroke-width"],points:t};return this.hasEditedComment&&(i.popup=this.comment),e.updateEdited(i),null}}function Fm(e){const{color:t,thickness:n,opacity:i,pageIndex:s}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||e.color.some((e,n)=>e!==t[n])||e.thickness!==n||e.opacity!==i||e.pageIndex!==s}o(Om,"_type","ink"),o(Om,"_editorType",fe.INK),o(Om,"_defaultDrawingOptions",null);class Wm extends Mm{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}class zm{static extractContoursFromText(e,t,n,i,s,a){let{fontFamily:r,fontStyle:o,fontWeight:l}=t,c=new OffscreenCanvas(1,1),d=c.getContext("2d",{alpha:!1});const h=d.font="".concat(o," ").concat(l," ").concat(200,"px ").concat(r),{actualBoundingBoxLeft:u,actualBoundingBoxRight:p,actualBoundingBoxAscent:m,actualBoundingBoxDescent:f,fontBoundingBoxAscent:g,fontBoundingBoxDescent:v,width:y}=d.measureText(e),b=1.5,x=Math.ceil(Math.max(Math.abs(u)+Math.abs(p)||0,y)*b),w=Math.ceil(Math.max(Math.abs(m)+Math.abs(f)||200,Math.abs(g)+Math.abs(v)||200)*b);c=new OffscreenCanvas(x,w),d=c.getContext("2d",{alpha:!0,willReadFrequently:!0}),d.font=h,d.filter="grayscale(1)",d.fillStyle="white",d.fillRect(0,0,x,w),d.fillStyle="black",d.fillText(e,.5*x/2,1.5*w/2);const A=D(zm,this,Xm).call(this,d.getImageData(0,0,x,w).data),_=D(zm,this,Km).call(this,A),S=D(zm,this,Qm).call(this,_),E=D(zm,this,Gm).call(this,A,x,w,S);return this.processDrawnLines({lines:{curves:E,width:x,height:w},pageWidth:n,pageHeight:i,rotation:s,innerMargin:a,mustSmooth:!0,areContours:!0})}static process(e,t,n,i,s){const[a,r,o]=D(zm,this,$m).call(this,e),[l,c]=D(zm,this,Ym).call(this,a,r,o,Math.hypot(r,o)*D(zm,this,Jm)._.sigmaSFactor,D(zm,this,Jm)._.sigmaR,D(zm,this,Jm)._.kernelSize),d=D(zm,this,Qm).call(this,c),h=D(zm,this,Gm).call(this,l,r,o,d);return this.processDrawnLines({lines:{curves:h,width:r,height:o},pageWidth:t,pageHeight:n,rotation:i,innerMargin:s,mustSmooth:!0,areContours:!0})}static processDrawnLines(e){var t;let{lines:n,pageWidth:i,pageHeight:s,rotation:a,innerMargin:r,mustSmooth:o,areContours:l}=e;a%180!==0&&([i,s]=[s,i]);const{curves:c,width:d,height:h}=n,u=null!==(t=n.thickness)&&void 0!==t?t:0,p=[],m=Math.min(i/d,s/h),f=m/i,g=m/s,v=[];for(const{points:b}of c){const e=o?D(zm,this,qm).call(this,b):b;if(!e)continue;v.push(e);const t=e.length,n=new Float32Array(t),i=new Float32Array(3*(2===t?2:t-2));if(p.push({line:i,points:n}),2===t){n[0]=e[0]*f,n[1]=e[1]*g,i.set([NaN,NaN,NaN,NaN,n[0],n[1]],0);continue}let[s,a,r,l]=e;s*=f,a*=g,r*=f,l*=g,n.set([s,a,r,l],0),i.set([NaN,NaN,NaN,NaN,s,a],0);for(let o=4;o<t;o+=2){const t=n[o]=e[o]*f,c=n[o+1]=e[o+1]*g;i.set(ru.createBezierPoints(s,a,r,l,t,c),3*(o-2)),[s,a,r,l]=[r,l,t,c]}}if(0===p.length)return null;const y=l?new Wm:new Mm;return y.build(p,i,s,1,a,l?0:u,r),{outline:y,newCurves:v,areContours:l,thickness:u,width:d,height:h}}static async compressSignature(e){let t,{outlines:n,areContours:i,thickness:s,width:a,height:r}=e,o=1/0,l=-1/0,c=0;for(const y of n){c+=y.length;for(let e=2,t=y.length;e<t;e++){const t=y[e]-y[e-2];o=Math.min(o,t),l=Math.max(l,t)}}t=o>=-128&&l<=127?Int8Array:o>=-32768&&l<=32767?Int16Array:Int32Array;const d=n.length,h=8+3*d,u=new Uint32Array(h);let p=0;u[p++]=h*Uint32Array.BYTES_PER_ELEMENT+(c-2*d)*t.BYTES_PER_ELEMENT,u[p++]=0,u[p++]=a,u[p++]=r,u[p++]=i?0:1,u[p++]=Math.max(0,Math.floor(null!==s&&void 0!==s?s:0)),u[p++]=d,u[p++]=t.BYTES_PER_ELEMENT;for(const y of n)u[p++]=y.length-2,u[p++]=y[0],u[p++]=y[1];const m=new CompressionStream("deflate-raw"),f=m.writable.getWriter();await f.ready,f.write(u);const g=t.prototype.constructor;for(const y of n){const e=new g(y.length-2);for(let t=2,n=y.length;t<n;t++)e[t-2]=y[t]-y[t-2];f.write(e)}f.close();const v=await new Response(m.readable).arrayBuffer();return ht(new Uint8Array(v))}static async decompressSignature(e){try{const l=(r=e,Uint8Array.fromBase64?Uint8Array.fromBase64(r):et(atob(r))),{readable:c,writable:d}=new DecompressionStream("deflate-raw"),h=d.getWriter();await h.ready,h.write(l).then(async()=>{await h.ready,await h.close()}).catch(()=>{});let u=null,p=0;var t,n=!1,i=!1;try{for(var s,a=function(e){var t,n,i,s=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,i=Symbol.iterator);s--;){if(n&&null!=(t=e[n]))return t.call(e);if(i&&null!=(t=e[i]))return new z(t.call(e));n="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}(c);n=!(s=await a.next()).done;n=!1){const e=s.value;u||(u=new Uint8Array(new Uint32Array(e.buffer,0,4)[0])),u.set(e,p),p+=e.length}}catch(o){i=!0,t=o}finally{try{n&&null!=a.return&&await a.return()}finally{if(i)throw t}}const m=new Uint32Array(u.buffer,0,u.length>>2),f=m[1];if(0!==f)throw new Error("Invalid version: ".concat(f));const g=m[2],v=m[3],y=0===m[4],b=m[5],x=m[6],w=m[7],A=[],_=(8+3*x)*Uint32Array.BYTES_PER_ELEMENT;let S;switch(w){case Int8Array.BYTES_PER_ELEMENT:S=new Int8Array(u.buffer,_);break;case Int16Array.BYTES_PER_ELEMENT:S=new Int16Array(u.buffer,_);break;case Int32Array.BYTES_PER_ELEMENT:S=new Int32Array(u.buffer,_)}p=0;for(let e=0;e<x;e++){const t=m[3*e+8],n=new Float32Array(t+2);A.push(n);for(let i=0;i<2;i++)n[i]=m[3*e+8+i+1];for(let e=0;e<t;e++)n[e+2]=n[e]+S[p++]}return{areContours:y,thickness:b,outlines:A,width:g,height:v}}catch(l){return ze("decompressSignature: ".concat(l)),null}var r}}function Bm(e,t,n,i){return i-=t,0===(n-=e)?i>0?0:4:1===n?i+6:2-i}function Hm(e,t,n,i,s,a,r){const o=D(ee,this,Bm).call(this,n,i,s,a);for(let l=0;l<8;l++){const s=(-l+o-r+16)%8;if(0!==e[(n+D(ee,this,Zm)._[2*s])*t+(i+D(ee,this,Zm)._[2*s+1])])return s}return-1}function Um(e,t,n,i,s,a,r){const o=D(ee,this,Bm).call(this,n,i,s,a);for(let l=0;l<8;l++){const s=(l+o+r+16)%8;if(0!==e[(n+D(ee,this,Zm)._[2*s])*t+(i+D(ee,this,Zm)._[2*s+1])])return s}return-1}function Gm(e,t,n,i){const s=e.length,a=new Int32Array(s);for(let c=0;c<s;c++)a[c]=e[c]<=i?1:0;for(let c=1;c<n-1;c++)a[c*t]=a[c*t+t-1]=0;for(let c=0;c<t;c++)a[c]=a[t*n-1-c]=0;let r,o=1;const l=[];for(let c=1;c<n-1;c++){r=1;for(let e=1;e<t-1;e++){const n=c*t+e,i=a[n];if(0===i)continue;let s=c,d=e;if(1===i&&0===a[n-1])o+=1,d-=1;else{if(!(i>=1&&0===a[n+1])){1!==i&&(r=Math.abs(i));continue}o+=1,d+=1,i>1&&(r=i)}const h=[e,c],u=d===e+1,p={isHole:u,points:h,id:o,parent:0};let m;l.push(p);for(const e of l)if(e.id===r){m=e;break}m?m.isHole?p.parent=u?m.parent:r:p.parent=u?r:m.parent:p.parent=u?r:0;const f=D(ee,this,Hm).call(this,a,t,c,e,s,d,0);if(-1===f){a[n]=-o,1!==a[n]&&(r=Math.abs(a[n]));continue}let g=D(ee,this,Zm)._[2*f],v=D(ee,this,Zm)._[2*f+1];const y=c+g,b=e+v;s=y,d=b;let x=c,w=e;for(;;){const i=D(ee,this,Um).call(this,a,t,x,w,s,d,1);g=D(ee,this,Zm)._[2*i],v=D(ee,this,Zm)._[2*i+1];const l=x+g,u=w+v;h.push(u,l);const p=x*t+w;if(0===a[p+1]?a[p]=-o:1===a[p]&&(a[p]=o),l===c&&u===e&&x===y&&w===b){1!==a[n]&&(r=Math.abs(a[n]));break}s=x,d=w,x=l,w=u}}}return l}function Vm(e,t,n,i){if(n-t<=4){for(let s=t;s<n-2;s+=2)i.push(e[s],e[s+1]);return}const s=e[t],a=e[t+1],r=e[n-4]-s,o=e[n-3]-a,l=Math.hypot(r,o),c=r/l,d=o/l,h=c*a-d*s,u=o/r,p=1/l,m=Math.atan(u),f=Math.cos(m),g=Math.sin(m),v=p*(Math.abs(f)+Math.abs(g)),y=p*(1-v+v**2),b=Math.max(Math.atan(Math.abs(g+f)*y),Math.atan(Math.abs(g-f)*y));let x=0,w=t;for(let A=t+2;A<n-2;A+=2){const t=Math.abs(h-c*e[A+1]+d*e[A]);t>x&&(w=A,x=t)}x>(l*b)**2?(D(ee,this,Vm).call(this,e,t,w+2,i),D(ee,this,Vm).call(this,e,w,n,i)):i.push(s,a)}function qm(e){const t=[],n=e.length;return D(ee,this,Vm).call(this,e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t}function Ym(e,t,n,i,s,a){const r=new Float32Array(a**2),o=-2*i**2,l=a>>1;for(let m=0;m<a;m++){const e=(m-l)**2;for(let t=0;t<a;t++)r[m*a+t]=Math.exp((e+(t-l)**2)/o)}const c=new Float32Array(256),d=-2*s**2;for(let m=0;m<256;m++)c[m]=Math.exp(m**2/d);const h=e.length,u=new Uint8Array(h),p=new Uint32Array(256);for(let m=0;m<n;m++)for(let i=0;i<t;i++){const s=m*t+i,o=e[s];let d=0,h=0;for(let u=0;u<a;u++){const s=m+u-l;if(!(s<0||s>=n))for(let n=0;n<a;n++){const p=i+n-l;if(p<0||p>=t)continue;const m=e[s*t+p],f=r[u*a+n]*c[Math.abs(m-o)];d+=m*f,h+=f}}p[u[s]=Math.round(d/h)]++}return[u,p]}function Km(e){const t=new Uint32Array(256);for(const n of e)t[n]++;return t}function Xm(e){const t=e.length,n=new Uint8ClampedArray(t>>2);let i=-1/0,s=1/0;for(let r=0,o=n.length;r<o;r++){const t=n[r]=e[r<<2];i=Math.max(i,t),s=Math.min(s,t)}const a=255/(i-s);for(let r=0,o=n.length;r<o;r++)n[r]=(n[r]-s)*a;return n}function Qm(e){let t,n=-1/0,i=-1/0;const s=e.findIndex(e=>0!==e);let a=s,r=s;for(t=s;t<256;t++){const s=e[t];s>n&&(t-a>i&&(i=t-a,r=t-1),n=s,a=t)}for(t=r-1;t>=0&&!(e[t]>e[t+1]);t--);return t}function $m(e){const t=e,{width:n,height:i}=e,{maxDim:s}=D(ee,this,Jm)._;let a=n,r=i;if(n>s||i>s){let o=n,l=i,c=Math.log2(Math.max(n,i)/s);const d=Math.floor(c);c=c===d?d-1:d;for(let n=0;n<c;n++){a=Math.ceil(o/2),r=Math.ceil(l/2);const n=new OffscreenCanvas(a,r);n.getContext("2d").drawImage(e,0,0,o,l,0,0,a,r),o=a,l=r,e!==t&&e.close(),e=n.transferToImageBitmap()}const h=Math.min(s/a,s/r);a=Math.round(a*h),r=Math.round(r*h)}const o=new OffscreenCanvas(a,r).getContext("2d",{willReadFrequently:!0});o.fillStyle="white",o.fillRect(0,0,a,r),o.filter="grayscale(1)",o.drawImage(e,0,0,e.width,e.height,0,0,a,r);const l=o.getImageData(0,0,a,r).data;return[D(ee,this,Xm).call(this,l),a,r]}ee=zm;var Jm={_:{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}},Zm={_:new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1])};class ef extends zp{constructor(){super(),super.updateProperties({fill:Ks._defaultLineColor,"stroke-width":0})}clone(){const e=new ef;return e.updateAll(this),e}}class tf extends jm{constructor(e){super(e),super.updateProperties({stroke:Ks._defaultLineColor,"stroke-width":1})}clone(){const e=new tf(this._viewParameters);return e.updateAll(this),e}}var nf=new WeakMap,sf=new WeakMap,af=new WeakMap,rf=new WeakMap;class of extends Gp{constructor(e){super(c(c({},e),{},{mustBeCommitted:!0,name:"signatureEditor"})),j(this,nf,!1),j(this,sf,null),j(this,af,null),j(this,rf,null),this._willKeepAspectRatio=!0,W(af,this,e.signatureData||null),W(sf,this,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,t){Ks.initialize(e,t),this._defaultDrawingOptions=new ef,this._defaultDrawnSignatureOptions=new tf(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return Ve(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!F(sf,this)}}static computeTelemetryFinalData(e){var t,n;const i=e.get("hasDescription");return{hasAltText:null!==(t=i.get(!0))&&void 0!==t?t:0,hasNoAltText:null!==(n=i.get(!1))&&void 0!==n?n:0}}get isResizable(){return!0}onScaleChanging(){null!==this._drawId&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,t;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,e=this.x,t=this.y),super.render(),null===this._drawId)if(F(af,this)){const{lines:e,mustSmooth:t,areContours:n,description:i,uuid:s,heightInPage:a}=F(af,this),{rawDims:{pageWidth:r,pageHeight:o},rotation:l}=this.parent.viewport,c=zm.processDrawnLines({lines:e,pageWidth:r,pageHeight:o,rotation:l,innerMargin:of._INNER_MARGIN,mustSmooth:t,areContours:n});this.addSignature(c,a,i,s)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:F(sf,this)||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(e,t)),this.div}setUuid(e){W(rf,this,e),this.addEditToolbar()}getUuid(){return F(rf,this)}get description(){return F(sf,this)}set description(e){W(sf,this,e),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:e})),super.addEditToolbar().then(t=>{null===t||void 0===t||t.updateEditSignatureButton(e)}))}getSignaturePreview(){const{newCurves:e,areContours:t,thickness:n,width:i,height:s}=F(af,this),a=Math.max(i,s);return{areContours:t,outline:zm.processDrawnLines({lines:{curves:e.map(e=>({points:e})),thickness:n,width:i,height:s},pageWidth:a,pageHeight:a,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t}).outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,t,n,i){const{x:s,y:a}=this,{outline:r}=W(af,this,e);let o;W(nf,this,r instanceof Wm),this.description=n,F(nf,this)?o=of.getDefaultDrawingOptions():(o=of._defaultDrawnSignatureOptions.clone(),o.updateProperties({"stroke-width":r.thickness})),this._addOutlines({drawOutlines:r,drawingOptions:o});const[l,c]=this.parentDimensions,[,d]=this.pageDimensions;let h=t/d;h=h>=1?.5:h,this.width*=h/this.height,this.width>=1&&(h*=.9/this.width,this.width=.9),this.height=h,this.setDims(l*this.width,c*this.height),this.x=s,this.y=a,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:i}=this.parent.viewport;return zm.process(e,t,n,i,of._INNER_MARGIN)}getFromText(e,t){const{rawDims:{pageWidth:n,pageHeight:i},rotation:s}=this.parent.viewport;return zm.extractContoursFromText(e,t,n,i,s,of._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:i}=this.parent.viewport;return zm.processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:i,innerMargin:of._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions(e){let{areContours:t,thickness:n}=e;t?this._drawingOptions=of.getDefaultDrawingOptions():(this._drawingOptions=of._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":n}))}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty())return null;const{lines:t,points:n,rect:i}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":s}}=this,a={annotationType:fe.SIGNATURE,isSignature:!0,areContours:F(nf,this),color:[0,0,0],thickness:F(nf,this)?0:s,pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(a),e?(a.paths={lines:t,points:n},a.uuid=F(rf,this),a.isCopy=!0):a.lines=t,F(sf,this)&&(a.accessibilityData={type:"Figure",alt:F(sf,this)}),a}static deserializeDraw(e,t,n,i,s,a){return a.areContours?Wm.deserialize(e,t,n,i,s,a):Mm.deserialize(e,t,n,i,s,a)}static async deserialize(e,t,n){var i;const s=await super.deserialize(e,t,n);return W(nf,s,e.areContours),s.description=(null===(i=e.accessibilityData)||void 0===i?void 0:i.alt)||"",W(rf,s,e.uuid),s}}o(of,"_type","signature"),o(of,"_editorType",fe.SIGNATURE),o(of,"_defaultDrawingOptions",null);var lf=new WeakMap,cf=new WeakMap,df=new WeakMap,hf=new WeakMap,uf=new WeakMap,pf=new WeakMap,mf=new WeakMap,ff=new WeakMap,gf=new WeakMap,vf=new WeakMap,yf=new WeakMap,bf=new WeakSet;class xf extends Ks{constructor(e){super(c(c({},e),{},{name:"stampEditor"})),L(this,bf),j(this,lf,null),j(this,cf,null),j(this,df,null),j(this,hf,null),j(this,uf,null),j(this,pf,""),j(this,mf,null),j(this,ff,!1),j(this,gf,null),j(this,vf,!1),j(this,yf,!1),W(hf,this,e.bitmapUrl),W(uf,this,e.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,t){Ks.initialize(e,t)}static isHandlingMimeForPasting(e){return Mt.includes(e)}static paste(e,t){t.pasteEditor({mode:fe.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!(null===(e=this.altTextData)||void 0===e||!e.altText)}}static computeTelemetryFinalData(e){var t,n;const i=e.get("hasAltText");return{hasAltText:null!==(t=i.get(!0))&&void 0!==t?t:0,hasNoAltText:null!==(n=i.get(!1))&&void 0!==n?n:0}}async mlGuessAltText(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:s,height:a}=e||this.copyCanvas(null,null,!0).imageData,r=await n.guess({name:"altText",request:{data:i,width:s,height:a,channels:i.length/(s*a)}});if(!r)throw new Error("No response from the AI service.");if(r.error)throw new Error("Error from the AI service.");if(r.cancel)return null;if(!r.output)throw new Error("No valid response from the AI service.");const o=r.output;return await this.setGuessedAltText(o),t&&!this.hasAltTextData()&&(this.altTextData={alt:o,decorative:!1}),o}remove(){var e;F(cf,this)&&(W(lf,this,null),this._uiManager.imageManager.deleteId(F(cf,this)),null===(e=F(mf,this))||void 0===e||e.remove(),W(mf,this,null),F(gf,this)&&(clearTimeout(F(gf,this)),W(gf,this,null)));super.remove()}rebuild(){this.parent?(super.rebuild(),null!==this.div&&(F(cf,this)&&null===F(mf,this)&&D(bf,this,_f).call(this),this.isAttachedToDOM||this.parent.add(this))):F(cf,this)&&D(bf,this,_f).call(this)}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(F(df,this)||F(lf,this)||F(hf,this)||F(uf,this)||F(cf,this)||F(ff,this))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.createAltText(),F(ff,this)||(F(lf,this)?D(bf,this,Sf).call(this):D(bf,this,_f).call(this)),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){const{id:n,bitmap:i}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(W(cf,this,n),i&&W(lf,this,i),W(ff,this,!1),D(bf,this,Sf).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;null!==F(gf,this)&&clearTimeout(F(gf,this));W(gf,this,setTimeout(()=>{W(gf,this,null),D(bf,this,kf).call(this)},200))}copyCanvas(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e||(e=224);const{width:i,height:s}=F(lf,this),a=new Nt;let r=F(lf,this),o=i,l=s,c=null;if(t){var d,h;if(i>t||s>t){const e=Math.min(t/i,t/s);o=Math.floor(i*e),l=Math.floor(s*e)}c=document.createElement("canvas");const e=c.width=Math.ceil(o*a.sx),n=c.height=Math.ceil(l*a.sy);F(vf,this)||(r=D(bf,this,Ef).call(this,e,n));const u=c.getContext("2d");u.filter=this._uiManager.hcmFilter;let p="white",m="#cfcfd8";"none"!==this._uiManager.hcmFilter?m="black":null!==(d=(h=window).matchMedia)&&void 0!==d&&d.call(h,"(prefers-color-scheme: dark)").matches&&(p="#8f8f9d",m="#42414d");const f=15,g=f*a.sx,v=f*a.sy,y=new OffscreenCanvas(2*g,2*v),b=y.getContext("2d");b.fillStyle=p,b.fillRect(0,0,2*g,2*v),b.fillStyle=m,b.fillRect(0,0,g,v),b.fillRect(g,v,g,v),u.fillStyle=u.createPattern(y,"repeat"),u.fillRect(0,0,e,n),u.drawImage(r,0,0,r.width,r.height,0,0,e,n)}let u=null;if(n){let t,n;if(a.symmetric&&r.width<e&&r.height<e)t=r.width,n=r.height;else if(r=F(lf,this),i>e||s>e){const a=Math.min(e/i,e/s);t=Math.floor(i*a),n=Math.floor(s*a),F(vf,this)||(r=D(bf,this,Ef).call(this,t,n))}const o=new OffscreenCanvas(t,n).getContext("2d",{willReadFrequently:!0});o.drawImage(r,0,0,r.width,r.height,0,0,t,n),u={width:t,height:n,data:o.getImageData(0,0,t,n).data}}return{canvas:c,width:o,height:l,imageData:u}}static async deserialize(e,t,n){let i=null,s=!1;if(e instanceof Mh){var a;const{data:{rect:r,rotation:o,id:l,structParent:c,popupRef:d,contentsObj:h},container:u,parent:{page:{pageNumber:p}},canvas:m}=e;let f,g;m?(delete e.canvas,({id:f,bitmap:g}=n.imageManager.getFromCanvas(u.id,m)),m.remove()):(s=!0,e._hasNoCanvas=!0);const v=(null===(a=await t._structTree.getAriaAttributes("".concat(ct).concat(l)))||void 0===a?void 0:a.get("aria-label"))||"";i=e={annotationType:fe.STAMP,bitmapId:f,bitmap:g,pageIndex:p-1,rect:r.slice(0),rotation:o,annotationElementId:l,id:l,deleted:!1,accessibilityData:{decorative:!1,altText:v},isSvg:!1,structParent:c,popupRef:d,comment:(null===h||void 0===h?void 0:h.str)||null}}const r=await super.deserialize(e,t,n),{rect:o,bitmap:l,bitmapUrl:c,bitmapId:d,isSvg:h,accessibilityData:u}=e;s?(n.addMissingCanvas(e.id,r),W(ff,r,!0)):d&&n.imageManager.isValidId(d)?(W(cf,r,d),l&&W(lf,r,l)):W(hf,r,c),W(vf,r,h);const[p,m]=r.pageDimensions;return r.width=(o[2]-o[0])/p,r.height=(o[3]-o[1])/m,u&&(r.altTextData=u),r._initialData=i,e.comment&&r.setCommentData(e.comment),W(yf,r,!!i),r}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n={annotationType:fe.STAMP,bitmapId:F(cf,this),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:F(vf,this),structTreeParentId:this._structTreeParentId};if(this.addComment(n),e)return n.bitmapUrl=D(bf,this,Cf).call(this,!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:i,altText:s}=this.serializeAltText(!1);if(!i&&s&&(n.accessibilityData={type:"Figure",alt:s}),this.annotationElementId){const e=D(bf,this,Tf).call(this,n);if(e.isSame)return null;var a;if(e.isSameAltText)delete n.accessibilityData;else n.accessibilityData.structParent=null!==(a=this._initialData.structParent)&&void 0!==a?a:-1}if(n.id=this.annotationElementId,null===t)return n;t.stamps||(t.stamps=new Map);const r=F(vf,this)?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(t.stamps.has(F(cf,this))){if(F(vf,this)){const e=t.stamps.get(F(cf,this));r>e.area&&(e.area=r,e.serialized.bitmap.close(),e.serialized.bitmap=D(bf,this,Cf).call(this,!1))}}else t.stamps.set(F(cf,this),{area:r,serialized:n}),n.bitmap=D(bf,this,Cf).call(this,!1);return n}renderAnnotationElement(e){const t={rect:this.getRect(0,0)};return this.hasEditedComment&&(t.popup=this.comment),e.updateEdited(t),null}}function wf(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e?(W(lf,this,e.bitmap),t||(W(cf,this,e.id),W(vf,this,e.isSvg)),e.file&&W(pf,this,e.file.name),D(bf,this,Sf).call(this)):this.remove()}function Af(){if(W(df,this,null),this._uiManager.enableWaiting(!1),F(mf,this))if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&F(lf,this))this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});else{if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&F(lf,this)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch(e){}}this.div.focus()}}function _f(){if(F(cf,this))return this._uiManager.enableWaiting(!0),void this._uiManager.imageManager.getFromId(F(cf,this)).then(e=>D(bf,this,wf).call(this,e,!0)).finally(()=>D(bf,this,Af).call(this));if(F(hf,this)){const e=F(hf,this);return W(hf,this,null),this._uiManager.enableWaiting(!0),void W(df,this,this._uiManager.imageManager.getFromUrl(e).then(e=>D(bf,this,wf).call(this,e)).finally(()=>D(bf,this,Af).call(this)))}if(F(uf,this)){const e=F(uf,this);return W(uf,this,null),this._uiManager.enableWaiting(!0),void W(df,this,this._uiManager.imageManager.getFromFile(e).then(e=>D(bf,this,wf).call(this,e)).finally(()=>D(bf,this,Af).call(this)))}const e=document.createElement("input");e.type="file",e.accept=Mt.join(",");const t=this._uiManager._signal;W(df,this,new Promise(n=>{e.addEventListener("change",async()=>{if(e.files&&0!==e.files.length){this._uiManager.enableWaiting(!0);const t=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),D(bf,this,wf).call(this,t)}else this.remove();n()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:t})}).finally(()=>D(bf,this,Af).call(this))),e.click()}function Sf(){var e;const{div:t}=this;let{width:n,height:i}=F(lf,this);const[s,a]=this.pageDimensions,r=.75;if(this.width)n=this.width*s,i=this.height*a;else if(n>r*s||i>r*a){const e=Math.min(r*s/n,r*a/i);n*=e,i*=e}const[o,l]=this.parentDimensions;this.setDims(n*o/s,i*l/a),this._uiManager.enableWaiting(!1);const c=W(mf,this,document.createElement("canvas"));c.setAttribute("role","img"),this.addContainer(c),this.width=n/s,this.height=i/a,null!==(e=this._initialOptions)&&void 0!==e&&e.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&!this.annotationElementId||(t.hidden=!1),D(bf,this,kf).call(this),F(yf,this)||(this.parent.addUndoableEditor(this),W(yf,this,!0)),this._reportTelemetry({action:"inserted_image"}),F(pf,this)&&this.div.setAttribute("aria-description",F(pf,this)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}function Ef(e,t){const{width:n,height:i}=F(lf,this);let s=n,a=i,r=F(lf,this);for(;s>2*e||a>2*t;){const n=s,i=a;s>2*e&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2)),a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const o=new OffscreenCanvas(s,a);o.getContext("2d").drawImage(r,0,0,n,i,0,0,s,a),r=o.transferToImageBitmap()}return r}function kf(){const[e,t]=this.parentDimensions,{width:n,height:i}=this,s=new Nt,a=Math.ceil(n*e*s.sx),r=Math.ceil(i*t*s.sy),o=F(mf,this);if(!o||o.width===a&&o.height===r)return;o.width=a,o.height=r;const l=F(vf,this)?F(lf,this):D(bf,this,Ef).call(this,a,r),c=o.getContext("2d");c.filter=this._uiManager.hcmFilter,c.drawImage(l,0,0,l.width,l.height,0,0,a,r)}function Cf(e){if(e){if(F(vf,this)){const e=this._uiManager.imageManager.getSvgUrl(F(cf,this));if(e)return e}const e=document.createElement("canvas");({width:e.width,height:e.height}=F(lf,this));return e.getContext("2d").drawImage(F(lf,this),0,0),e.toDataURL()}if(F(vf,this)){const[e,t]=this.pageDimensions,n=Math.round(this.width*e*pt.PDF_TO_CSS_UNITS),i=Math.round(this.height*t*pt.PDF_TO_CSS_UNITS),s=new OffscreenCanvas(n,i);return s.getContext("2d").drawImage(F(lf,this),0,0,F(lf,this).width,F(lf,this).height,0,0,n,i),s.transferToImageBitmap()}return structuredClone(F(lf,this))}function Tf(e){var t;const{pageIndex:n,accessibilityData:{altText:i}}=this._initialData,s=e.pageIndex===n,a=((null===(t=e.accessibilityData)||void 0===t?void 0:t.alt)||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&a,isSameAltText:a}}o(xf,"_type","stamp"),o(xf,"_editorType",fe.STAMP);var Nf=new WeakMap,Mf=new WeakMap,Rf=new WeakMap,If=new WeakMap,Pf=new WeakMap,Lf=new WeakMap,jf=new WeakMap,Df=new WeakMap,Of=new WeakMap,Ff=new WeakMap,Wf=new WeakMap,zf=new WeakMap,Bf=new WeakMap,Hf=new WeakMap,Uf=new WeakMap,Gf=new WeakMap,Vf=new WeakSet;class qf{constructor(e){let{uiManager:t,pageIndex:n,div:i,structTreeLayer:s,accessibilityManager:a,annotationLayer:r,drawLayer:o,textLayer:l,viewport:c,l10n:d}=e;L(this,Vf),j(this,Nf,void 0),j(this,Mf,!1),j(this,Rf,null),j(this,If,null),j(this,Pf,null),j(this,Lf,new Map),j(this,jf,!1),j(this,Df,!1),j(this,Of,!1),j(this,Ff,null),j(this,Wf,null),j(this,zf,null),j(this,Bf,null),j(this,Hf,null),j(this,Uf,-1),j(this,Gf,void 0);const h=[...Jf._.values()];if(!qf._initialized){qf._initialized=!0;for(const e of h)e.initialize(d,t)}t.registerEditorTypes(h),W(Gf,this,t),this.pageIndex=n,this.div=i,W(Nf,this,a),W(Rf,this,r),this.viewport=c,W(zf,this,l),this.drawLayer=o,this._structTree=s,F(Gf,this).addLayer(this)}get isEmpty(){return 0===F(Lf,this).size}get isInvisible(){return this.isEmpty&&F(Gf,this).getMode()===fe.NONE}updateToolbar(e){F(Gf,this).updateToolbar(e)}updateMode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F(Gf,this).getMode();switch(D(Vf,this,$f).call(this),e){case fe.NONE:return this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),void this.disableClick();case fe.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case fe.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const n of Jf._.values())t.toggle("".concat(n._type,"Editing"),e===n._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===(null===(t=F(zf,this))||void 0===t?void 0:t.div)}setEditingState(e){F(Gf,this).setEditingState(e)}addCommands(e){F(Gf,this).addCommands(e)}cleanUndoStack(e){F(Gf,this).cleanUndoStack(e)}toggleDrawing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.div.classList.toggle("drawing",!e)}togglePointerEvents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null===(e=F(Rf,this))||void 0===e||e.div.classList.toggle("disabled",!t)}async enable(){var e;W(Of,this,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),null===(e=F(Hf,this))||void 0===e||e.abort(),W(Hf,this,null);const t=new Set;for(const i of F(Lf,this).values())i.enableEditing(),i.show(!0),i.annotationElementId&&(F(Gf,this).removeChangedExistingAnnotation(i),t.add(i.annotationElementId));if(!F(Rf,this))return void W(Of,this,!1);const n=F(Rf,this).getEditableAnnotations();for(const i of n){if(i.hide(),F(Gf,this).isDeletedAnnotationElement(i.data.id))continue;if(t.has(i.data.id))continue;const e=await this.deserialize(i);e&&(this.addOrRebuild(e),e.enableEditing())}W(Of,this,!1)}disable(){if(W(Df,this,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),F(zf,this)&&!F(Hf,this)){W(Hf,this,new AbortController);const e=F(Gf,this).combinedSignal(F(Hf,this));F(zf,this).div.addEventListener("pointerdown",e=>{const{clientX:t,clientY:n,timeStamp:i}=e;if(i-F(Uf,this)>500)return void W(Uf,this,i);W(Uf,this,-1);const{classList:s}=this.div;s.toggle("getElements",!0);const a=document.elementsFromPoint(t,n);if(s.toggle("getElements",!1),!this.div.contains(a[0]))return;let r;const o=new RegExp("^".concat(me,"[0-9]+$"));for(const c of a)if(o.test(c.id)){r=c.id;break}if(!r)return;const l=F(Lf,this).get(r);null===(null===l||void 0===l?void 0:l.annotationElementId)&&(e.stopPropagation(),e.preventDefault(),l.dblclick())},{signal:e,capture:!0})}const e=new Map,t=new Map;for(const s of F(Lf,this).values()){var n;s.disableEditing(),s.annotationElementId&&(null===s.serialize()?(t.set(s.annotationElementId,s),null===(n=this.getEditableAnnotation(s.annotationElementId))||void 0===n||n.show(),s.remove()):e.set(s.annotationElementId,s))}if(F(Rf,this)){const n=F(Rf,this).getEditableAnnotations();for(const i of n){const{id:n}=i.data;if(F(Gf,this).isDeletedAnnotationElement(n)){i.updateEdited({deleted:!0});continue}let s=t.get(n);s?(s.resetAnnotationElement(i),s.show(!1),i.show()):(s=e.get(n),s&&(F(Gf,this).addChangedExistingAnnotation(s),s.renderAnnotationElement(i)&&s.show(!1)),i.show())}}D(Vf,this,$f).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const s of Jf._.values())i.remove("".concat(s._type,"Editing"));this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),W(Df,this,!1)}getEditableAnnotation(e){var t;return(null===(t=F(Rf,this))||void 0===t?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){F(Gf,this).getActive()!==e&&F(Gf,this).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,null!==(e=F(zf,this))&&void 0!==e&&e.div&&!F(Bf,this)){W(Bf,this,new AbortController);const e=F(Gf,this).combinedSignal(F(Bf,this));F(zf,this).div.addEventListener("pointerdown",D(Vf,this,Yf).bind(this),{signal:e}),F(zf,this).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,null!==(e=F(zf,this))&&void 0!==e&&e.div&&F(Bf,this)&&(F(Bf,this).abort(),W(Bf,this,null),F(zf,this).div.classList.remove("highlighting"))}enableClick(){if(F(If,this))return;W(If,this,new AbortController);const e=F(Gf,this).combinedSignal(F(If,this));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;null===(e=F(If,this))||void 0===e||e.abort(),W(If,this,null)}attach(e){F(Lf,this).set(e.id,e);const{annotationElementId:t}=e;t&&F(Gf,this).isDeletedAnnotationElement(t)&&F(Gf,this).removeDeletedAnnotationElement(e)}detach(e){var t;F(Lf,this).delete(e.id),null===(t=F(Nf,this))||void 0===t||t.removePointerInTextLayer(e.contentDiv),!F(Df,this)&&e.annotationElementId&&F(Gf,this).addDeletedAnnotationElement(e)}remove(e){this.detach(e),F(Gf,this).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(F(Gf,this).addDeletedAnnotationElement(e.annotationElementId),Ks.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),null===(t=e.parent)||void 0===t||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(e.parent!==this||!e.isAttachedToDOM){if(this.changeParent(e),F(Gf,this).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!F(Of,this)),F(Gf,this).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var t;if(!e.isAttachedToDOM)return;const{activeElement:n}=document;e.div.contains(n)&&!F(Pf,this)&&(e._focusEventsAllowed=!1,W(Pf,this,setTimeout(()=>{W(Pf,this,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:F(Gf,this)._signal}),n.focus())},0))),e._structTreeParentId=null===(t=F(Nf,this))||void 0===t?void 0:t.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){this.addCommands({cmd:()=>e._uiManager.rebuild(e),undo:()=>{e.remove()},mustExec:!1})}getNextId(){return F(Gf,this).getId()}combinedSignal(e){return F(Gf,this).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return null===(e=O(Vf,this,Kf))||void 0===e?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await F(Gf,this).updateMode(e.mode);const{offsetX:n,offsetY:i}=D(Vf,this,Qf).call(this),s=this.getNextId(),a=D(Vf,this,Xf).call(this,c({parent:this,id:s,x:n,y:i,uiManager:F(Gf,this),isCentered:!0},t));a&&this.add(a)}async deserialize(e){var t,n;return await(null===(t=Jf._.get(null!==(n=e.annotationType)&&void 0!==n?n:e.annotationEditorType))||void 0===t?void 0:t.deserialize(e,this,F(Gf,this)))||null}createAndAddNewEditor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.getNextId(),s=D(Vf,this,Xf).call(this,c({parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:F(Gf,this),isCentered:t},n));return s&&this.add(s),s}addNewEditor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.createAndAddNewEditor(D(Vf,this,Qf).call(this),!0,e)}setSelected(e){F(Gf,this).setSelected(e)}toggleSelected(e){F(Gf,this).toggleSelected(e)}unselect(e){F(Gf,this).unselect(e)}pointerup(e){var t;const{isMac:n}=tt.platform;if(0!==e.button||e.ctrlKey&&n)return;if(e.target!==this.div)return;if(!F(jf,this))return;if(W(jf,this,!1),null!==(t=O(Vf,this,Kf))&&void 0!==t&&t.isDrawer&&O(Vf,this,Kf).supportMultipleDrawings)return;if(!F(Mf,this))return void W(Mf,this,!0);const i=F(Gf,this).getMode();i!==fe.STAMP&&i!==fe.SIGNATURE?this.createAndAddNewEditor(e,!1):F(Gf,this).unselectAll()}pointerdown(e){var t;if(F(Gf,this).getMode()===fe.HIGHLIGHT&&this.enableTextSelection(),F(jf,this))return void W(jf,this,!1);const{isMac:n}=tt.platform;if(0!==e.button||e.ctrlKey&&n)return;if(e.target!==this.div)return;if(W(jf,this,!0),null!==(t=O(Vf,this,Kf))&&void 0!==t&&t.isDrawer)return void this.startDrawingSession(e);const i=F(Gf,this).getActive();W(Mf,this,!i||i.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),F(Ff,this))return void O(Vf,this,Kf).startDrawing(this,F(Gf,this),!1,e);F(Gf,this).setCurrentDrawingSession(this),W(Ff,this,new AbortController);const t=F(Gf,this).combinedSignal(F(Ff,this));this.div.addEventListener("blur",e=>{let{relatedTarget:t}=e;t&&!this.div.contains(t)&&(W(Wf,this,null),this.commitOrRemove())},{signal:t}),O(Vf,this,Kf).startDrawing(this,F(Gf,this),!1,e)}pause(e){if(e){const{activeElement:e}=document;return void(this.div.contains(e)&&W(Wf,this,e))}F(Wf,this)&&setTimeout(()=>{var e;null===(e=F(Wf,this))||void 0===e||e.focus(),W(Wf,this,null)},0)}endDrawingSession(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return F(Ff,this)?(F(Gf,this).setCurrentDrawingSession(null),F(Ff,this).abort(),W(Ff,this,null),W(Wf,this,null),O(Vf,this,Kf).endDrawing(e)):null}findNewParent(e,t,n){const i=F(Gf,this).findParent(t,n);return null!==i&&i!==this&&(i.changeParent(e),!0)}commitOrRemove(){return!!F(Ff,this)&&(this.endDrawingSession(),!0)}onScaleChanging(){F(Ff,this)&&O(Vf,this,Kf).onScaleChangingWhenDrawing(this)}destroy(){var e;this.commitOrRemove(),(null===(e=F(Gf,this).getActive())||void 0===e?void 0:e.parent)===this&&(F(Gf,this).commitOrRemove(),F(Gf,this).setActiveEditor(null)),F(Pf,this)&&(clearTimeout(F(Pf,this)),W(Pf,this,null));for(const n of F(Lf,this).values()){var t;null===(t=F(Nf,this))||void 0===t||t.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove()}this.div=null,F(Lf,this).clear(),F(Gf,this).removeLayer(this)}render(e){let{viewport:t}=e;this.viewport=t,Tt(this.div,t);for(const n of F(Gf,this).getEditors(this.pageIndex))this.add(n),n.rebuild();this.updateMode()}update(e){let{viewport:t}=e;F(Gf,this).commitOrRemove(),D(Vf,this,$f).call(this);const n=this.viewport.rotation,i=t.rotation;if(this.viewport=t,Tt(this.div,{rotation:i}),n!==i)for(const s of F(Lf,this).values())s.rotate(i)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return F(Gf,this).viewParameters.realScale}}function Yf(e){F(Gf,this).unselectAll();const{target:t}=e;if(t===F(zf,this).div||("img"===t.getAttribute("role")||t.classList.contains("endOfContent"))&&F(zf,this).div.contains(t)){const{isMac:t}=tt.platform;if(0!==e.button||e.ctrlKey&&t)return;F(Gf,this).showAllEditors("highlight",!0,!0),F(zf,this).div.classList.add("free"),this.toggleDrawing(),Ap.startHighlighting(this,"ltr"===F(Gf,this).direction,{target:F(zf,this).div,x:e.x,y:e.y}),F(zf,this).div.addEventListener("pointerup",()=>{F(zf,this).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:F(Gf,this)._signal}),e.preventDefault()}}function Kf(e){return Jf._.get(F(Gf,e).getMode())}function Xf(e){const t=O(Vf,this,Kf);return t?new t.prototype.constructor(e):null}function Qf(){const{x:e,y:t,width:n,height:i}=this.div.getBoundingClientRect(),s=Math.max(0,e),a=Math.max(0,t),r=(s+Math.min(window.innerWidth,e+n))/2-e,o=(a+Math.min(window.innerHeight,t+i))/2-t,[l,c]=this.viewport.rotation%180===0?[r,o]:[o,r];return{offsetX:l,offsetY:c}}function $f(){for(const e of F(Lf,this).values())e.isEmpty()&&e.remove()}o(qf,"_initialized",!1);var Jf={_:new Map([Qh,Om,xf,Ap,of].map(e=>[e._editorType,e]))},Zf=new WeakMap,eg=new WeakMap,tg=new WeakMap,ng=new WeakSet;class ig{constructor(e){let{pageIndex:t}=e;L(this,ng),j(this,Zf,null),j(this,eg,new Map),j(this,tg,new Map),this.pageIndex=t}setParent(e){if(F(Zf,this)){if(F(Zf,this)!==e){if(F(eg,this).size>0)for(const t of F(eg,this).values())t.remove(),e.append(t);W(Zf,this,e)}}else W(Zf,this,e)}static get _svgFactory(){return Ve(this,"_svgFactory",new od)}draw(e){var t,n;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=(lg._=(t=lg._,n=t++,t),n),r=D(ng,this,ag).call(this),o=ig._svgFactory.createElement("defs");r.append(o);const l=ig._svgFactory.createElement("path");o.append(l);const c="path_p".concat(this.pageIndex,"_").concat(a);l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke"),i&&F(tg,this).set(a,l);const d=s?D(ng,this,rg).call(this,o,c):null,h=ig._svgFactory.createElement("use");return r.append(h),h.setAttribute("href","#".concat(c)),this.updateProperties(r,e),F(eg,this).set(a,r),{id:a,clipPathId:"url(#".concat(d,")")}}drawOutline(e,t){var n,i;const s=(lg._=(n=lg._,i=n++,n),i),a=D(ng,this,ag).call(this),r=ig._svgFactory.createElement("defs");a.append(r);const o=ig._svgFactory.createElement("path");r.append(o);const l="path_p".concat(this.pageIndex,"_").concat(s);let c;if(o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),t){const e=ig._svgFactory.createElement("mask");r.append(e),c="mask_p".concat(this.pageIndex,"_").concat(s),e.setAttribute("id",c),e.setAttribute("maskUnits","objectBoundingBox");const t=ig._svgFactory.createElement("rect");e.append(t),t.setAttribute("width","1"),t.setAttribute("height","1"),t.setAttribute("fill","white");const n=ig._svgFactory.createElement("use");e.append(n),n.setAttribute("href","#".concat(l)),n.setAttribute("stroke","none"),n.setAttribute("fill","black"),n.setAttribute("fill-rule","nonzero"),n.classList.add("mask")}const d=ig._svgFactory.createElement("use");a.append(d),d.setAttribute("href","#".concat(l)),c&&d.setAttribute("mask","url(#".concat(c,")"));const h=d.cloneNode();return a.append(h),d.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(a,e),F(eg,this).set(s,a),s}finalizeDraw(e,t){F(tg,this).delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:n,bbox:i,rootClass:s,path:a}=t,r="number"===typeof e?F(eg,this).get(e):e;if(r){if(n&&D(ng,this,og).call(this,r,n),i&&sg.call(ig,r,i),s){const{classList:e}=r;for(const[t,n]of Object.entries(s))e.toggle(t,n)}if(a){const e=r.firstChild.firstChild;D(ng,this,og).call(this,e,a)}}}updateParent(e,t){if(t===this)return;const n=F(eg,this).get(e);n&&(F(Zf,t).append(n),F(eg,this).delete(e),F(eg,t).set(e,n))}remove(e){F(tg,this).delete(e),null!==F(Zf,this)&&(F(eg,this).get(e).remove(),F(eg,this).delete(e))}destroy(){W(Zf,this,null);for(const e of F(eg,this).values())e.remove();F(eg,this).clear(),F(tg,this).clear()}}function sg(e,t){let[n,i,s,a]=t;const{style:r}=e;r.top="".concat(100*i,"%"),r.left="".concat(100*n,"%"),r.width="".concat(100*s,"%"),r.height="".concat(100*a,"%")}function ag(){const e=te._svgFactory.create(1,1,!0);return F(Zf,this).append(e),e.setAttribute("aria-hidden",!0),e}function rg(e,t){const n=te._svgFactory.createElement("clipPath");e.append(n);const i="clip_".concat(t);n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");const s=te._svgFactory.createElement("use");return n.append(s),s.setAttribute("href","#".concat(t)),s.classList.add("clip"),i}function og(e,t){for(const[n,i]of Object.entries(t))null===i?e.removeAttribute(n):e.setAttribute(n,i)}te=ig;var lg={_:0};async function cg(e){return new Promise((t,n)=>{const i=new FileReader;i.onload=async function(e){try{const n=e.target.result,i=await async function(e){try{const t=await ql({data:e}).promise;let n="";for(let e=1;e<=t.numPages;e++){const i=await t.getPage(e),s=(await i.getTextContent()).items.map(e=>e.str).join(" ").trim();s&&(n+=s+"\n\n")}if(!n.trim())throw new Error("No text content found in PDF. Please try copying and pasting your resume text instead.");return n.trim()}catch(t){throw console.error("PDF parsing error:",t),new Error("Failed to extract text from PDF: "+t.message)}}(n);t(i)}catch(i){n(i)}},i.onerror=function(){n(new Error("Failed to read PDF file"))},i.readAsArrayBuffer(e)})}globalThis._pdfjsTestingUtils={HighlightOutliner:qu},globalThis.pdfjsLib={AbortException:Je,AnnotationEditorLayer:qf,AnnotationEditorParamsType:ge,AnnotationEditorType:fe,AnnotationEditorUIManager:ui,AnnotationLayer:zh,AnnotationMode:pe,AnnotationType:Se,build:"295fb3ec4",ColorPicker:Gc,createValidAbsoluteUrl:Ue,DOMSVGFactory:od,DrawLayer:ig,FeatureTest:tt,fetchData:mt,getDocument:ql,getFilenameFromUrl:function(e){return[e]=e.split(/[#?]/,1),e.substring(e.lastIndexOf("/")+1)},getPdfFilenameFromUrl:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"document.pdf";if("string"!==typeof e)return t;if(vt(e))return ze('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const n=(e=>{try{return new URL(e)}catch(t){try{return new URL(decodeURIComponent(e))}catch(n){try{return new URL(e,"https://foo.bar")}catch(i){try{return new URL(decodeURIComponent(e),"https://foo.bar")}catch(s){return null}}}}})(e);if(!n)return t;const i=e=>{try{let t=decodeURIComponent(e);return t.includes("/")?(t=t.split("/").at(-1),t.test(/^\.pdf$/i)?t:e):t}catch(t){return e}},s=/\.pdf$/i,a=n.pathname.split("/").at(-1);if(s.test(a))return i(a);if(n.searchParams.size>0){const e=Array.from(n.searchParams.values()).reverse();for(const n of e)if(s.test(n))return i(n);const t=Array.from(n.searchParams.keys()).reverse();for(const n of t)if(s.test(n))return i(n)}if(n.hash){const e=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(e)return i(e[0])}return t},getRGB:Et,getUuid:lt,getXfaPageViewport:function(e,t){let{scale:n=1,rotation:i=0}=t;const{width:s,height:a}=e.attributes.style,r=[0,0,parseInt(s),parseInt(a)];return new ft({viewBox:r,userUnit:1,scale:n,rotation:i})},GlobalWorkerOptions:wo,ImageKind:_e,InvalidPDFException:Xe,isDataScheme:vt,isPdfFile:yt,isValidExplicitDest:Pa,MathClamp:dt,noContextMenu:wt,normalizeUnicode:function(e){return rt||(rt=/([\xA0\xB5\u037E\u0EB3\u2000-\u200A\u202F\u2126\uFB00-\uFB04\uFB06\uFB20-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBA1\uFBA4-\uFBA9\uFBAE-\uFBB1\uFBD3-\uFBDC\uFBDE-\uFBE7\uFBEA-\uFBF8\uFBFC\uFBFD\uFC00-\uFC5D\uFC64-\uFCF1\uFCF5-\uFD3D\uFD88\uFDF4\uFDFA\uFDFB\uFE71\uFE77\uFE79\uFE7B\uFE7D]+)|(\uFB05+)/g,ot=new Map([["\ufb05","\u017ft"]])),e.replaceAll(rt,(e,t,n)=>t?t.normalize("NFKC"):ot.get(n))},OPS:Re,OutputScale:Nt,PasswordResponses:{NEED_PASSWORD:1,INCORRECT_PASSWORD:2},PDFDataRangeTransport:ec,PDFDateString:_t,PDFWorker:hc,PermissionFlag:{PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},PixelsPerInch:pt,RenderingCancelledException:gt,ResponseException:Qe,setLayerDimensions:Tt,shadow:Ve,SignatureExtractor:zm,stopEvent:At,SupportedImageMimeTypes:Mt,TextLayer:Il,TouchManager:ys,updateUrlHash:Ge,Util:it,VerbosityLevel:Me,version:"5.4.54",XfaLayer:ld},wo.workerSrc="./pdf.worker.min.js";const dg=[{value:"job-description",label:"Job Description",description:"The position you're targeting"},{value:"cover-letter-request",label:"Cover Letter Requirements",description:"Specific points to address in cover letter"},{value:"interview-feedback",label:"Interview Feedback",description:"Past interview experiences or feedback"},{value:"personal-story",label:"Personal Story",description:"Career challenges, achievements, or motivations"},{value:"company-research",label:"Company Insights",description:"What you know about the target company"},{value:"skill-requirements",label:"Skill Requirements",description:"Specific skills or certifications needed"},{value:"career-goals",label:"Career Goals",description:"Your professional aspirations and direction"},{value:"industry-context",label:"Industry Context",description:"Industry trends or specific requirements"},{value:"special-request",label:"Special Instructions",description:"Any other specific requirements or context"}],hg=e=>{var t,n,s;let{state:a,dispatch:r,actions:o}=e;const[l,c]=(0,i.useState)(null),[d,h]=(0,i.useState)(!1),[u,p]=(0,i.useState)(!1),[m,f]=(0,i.useState)(""),[g,v]=(0,i.useState)(""),[y,b]=(0,i.useState)(null),[x,w]=(0,i.useState)(""),[_,S]=(0,i.useState)(""),[E,k]=(0,i.useState)(!1),C=(0,i.useRef)(null),T=dg;i.useEffect(()=>{N()},[]);const N=async()=>{try{const e=await navigator.mediaDevices.getUserMedia({audio:!0});c("granted"),e.getTracks().forEach(e=>e.stop())}catch(e){c("denied"),console.error("Microphone permission denied:",e)}},R=async e=>{if(e)try{!function(e){if(!["application/pdf"].includes(e.type))throw new Error("Please upload a PDF file only.");if(e.size>10485760)throw new Error("File size must be less than 10MB.")}(e),r({type:o.SET_LOADING,payload:!0}),r({type:o.CLEAR_ERROR});const t=await cg(e);r({type:o.SET_PDF_TEXT,payload:t})}catch(t){r({type:o.SET_ERROR,payload:t.message})}finally{r({type:o.SET_LOADING,payload:!1})}},I=()=>{b(null),w(""),S(""),f(""),v(""),p(!1)},P=a.pdfText||a.resumeText,L=P&&[a.pdfText,a.resumeText,...a.additionalContexts.map(e=>e.content)].filter(e=>e.trim()).join("").length>=100;return(0,M.jsxs)("div",{className:"max-w-3xl mx-auto animate-fade-in",children:[(0,M.jsxs)("div",{className:"mb-8 text-center",children:[(0,M.jsx)("h1",{className:"text-h1 font-bold text-midnight-blue mb-4",children:"Share Your Career Story"}),(0,M.jsx)("p",{className:"text-body text-muted leading-body mb-4",children:"Provide your career information through any combination of the methods below. The more context you share, the better we can help you craft your story."}),(0,M.jsx)("div",{className:"bg-amber-gold bg-opacity-10 border border-amber-gold border-opacity-30 rounded-lg p-4 max-w-2xl mx-auto",children:(0,M.jsxs)("p",{className:"text-ui-label text-midnight-blue",children:[(0,M.jsx)("strong",{children:"\ud83d\udca1 Tip:"})," For best results, copy and paste your resume text directly from your document. Add additional context like job descriptions for more targeted results."]})})]}),l&&(0,M.jsx)("div",{className:"mb-6 p-4 rounded-lg ".concat("granted"===l?"bg-green-50 border border-green-200":"bg-yellow-50 border border-yellow-200"),children:(0,M.jsx)("div",{className:"flex items-center",children:"granted"===l?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("svg",{className:"w-5 h-5 text-green-500 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),(0,M.jsx)("span",{className:"text-ui-label text-green-700",children:"Microphone access granted - ready for voice conversation!"})]}):(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("svg",{className:"w-5 h-5 text-yellow-500 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,M.jsx)("span",{className:"text-ui-label text-yellow-700",children:"Microphone access denied - you can still type your responses during the interview"})]})})}),(0,M.jsxs)("div",{className:"space-y-8",children:[(0,M.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-2 border-coral border-opacity-20",children:[(0,M.jsxs)("div",{className:"flex items-center mb-4",children:[(0,M.jsx)("div",{className:"w-8 h-8 bg-coral rounded-full flex items-center justify-center mr-3",children:(0,M.jsx)("span",{className:"text-white font-bold text-ui-label",children:"1"})}),(0,M.jsx)("h2",{className:"text-h2 font-semibold text-midnight-blue",children:"Paste Your Resume Text (Recommended)"})]}),(0,M.jsx)("textarea",{value:a.resumeText,onChange:e=>{r({type:o.SET_RESUME_TEXT,payload:e.target.value})},placeholder:"Paste your complete resume text here... Example:\nJohn Smith\nSoftware Engineer\nEmail: john@email.com | Phone: (555) 123-4567 PROFESSIONAL SUMMARY\nExperienced software engineer with 5+ years developing web applications... EXPERIENCE\nSenior Software Engineer | ABC Company | 2020-Present\n- Led development of customer portal increasing user engagement by 40%\n- Managed team of 3 junior developers\n...",className:"input-field h-64 resize-none"}),(0,M.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,M.jsx)("p",{className:"text-ui-label text-muted",children:"\ud83d\udccb Copy your entire resume text from Word, PDF, or any document and paste it here for the most accurate analysis."}),(0,M.jsxs)("span",{className:"text-ui-label ".concat(a.resumeText.length<100?"text-coral":"text-green-600"),children:[a.resumeText.length," characters ",a.resumeText.length<100?"(minimum 100 recommended)":"\u2713"]})]})]}),(0,M.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border border-gray-200",children:[(0,M.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,M.jsxs)("div",{className:"flex items-center",children:[(0,M.jsx)("div",{className:"w-8 h-8 bg-amber-gold rounded-full flex items-center justify-center mr-3",children:(0,M.jsx)("span",{className:"text-midnight-blue font-bold text-ui-label",children:"2"})}),(0,M.jsx)("h2",{className:"text-h2 font-semibold text-midnight-blue",children:"Upload Resume PDF (Alternative)"})]})}),(0,M.jsxs)("div",{className:"space-y-4",children:[(0,M.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-8 text-center transition-colors ".concat(E?"border-coral bg-coral bg-opacity-10":"border-gray-300 hover:border-amber-gold"),onDragOver:e=>{e.preventDefault(),e.stopPropagation(),k(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),k(!1)},onDrop:async e=>{e.preventDefault(),e.stopPropagation(),k(!1);const t=e.dataTransfer.files;if(0===t.length)return;const n=t[0];await R(n)},children:[(0,M.jsx)("input",{ref:C,type:"file",accept:".pdf",onChange:async e=>{const t=e.target.files[0];await R(t)},className:"hidden",id:"pdf-upload"}),(0,M.jsxs)("label",{htmlFor:"pdf-upload",className:"cursor-pointer",children:[(0,M.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,M.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})}),(0,M.jsx)("p",{className:"text-body text-midnight-blue mb-2",children:E?"Drop your PDF here":"Click to upload your resume PDF"}),(0,M.jsx)("p",{className:"text-ui-label text-muted",children:"Or drag and drop your PDF file here (Max 10MB)"})]})]}),a.pdfText&&(0,M.jsxs)("div",{className:"mt-4 p-4 bg-green-50 rounded-lg border border-green-200",children:[(0,M.jsxs)("p",{className:"text-ui-label text-green-700 mb-2 flex items-center",children:[(0,M.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"PDF content extracted successfully (",a.pdfText.length," characters)"]}),(0,M.jsxs)("div",{className:"text-ui-label text-muted max-h-32 overflow-y-auto bg-white p-2 rounded border",children:[a.pdfText.substring(0,300),"..."]})]})]})]}),(0,M.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border border-gray-200",children:[(0,M.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,M.jsxs)("div",{className:"flex items-center",children:[(0,M.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center mr-3",children:(0,M.jsx)("span",{className:"text-white font-bold text-ui-label",children:"3"})}),(0,M.jsx)("h2",{className:"text-h2 font-semibold text-midnight-blue",children:"Additional Context (Optional)"})]})}),(0,M.jsx)("p",{className:"text-ui-label text-muted mb-4",children:"Add specific context to help tailor your resume and interview. This can include job descriptions, company information, or special requirements."}),a.additionalContexts.length>0&&(0,M.jsx)("div",{className:"space-y-3 mb-4",children:a.additionalContexts.map(e=>(0,M.jsx)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:y===e.id?(0,M.jsxs)("div",{className:"space-y-3",children:[(0,M.jsxs)("select",{value:x,onChange:e=>w(e.target.value),className:"input-field",children:[(0,M.jsx)("option",{value:"",children:"Select context type..."}),T.map(e=>(0,M.jsx)("option",{value:e.value,children:e.label},e.value))]}),(0,M.jsx)("textarea",{value:_,onChange:e=>S(e.target.value),placeholder:"Enter the content...",className:"input-field h-32 resize-none"}),(0,M.jsxs)("div",{className:"flex gap-2",children:[(0,M.jsx)("button",{onClick:()=>{var t,n,i;return n=e.id,i={type:x,title:(null===(t=T.find(e=>e.value===x))||void 0===t?void 0:t.label)||x,content:_.trim()},r({type:o.UPDATE_ADDITIONAL_CONTEXT,payload:{id:n,updates:i}}),b(null),w(""),void S("")},disabled:!x||!_.trim(),className:"btn-primary text-sm px-4 py-2",children:"Update"}),(0,M.jsx)("button",{onClick:I,className:"btn-secondary text-sm px-4 py-2",children:"Cancel"})]})]}):(0,M.jsxs)("div",{children:[(0,M.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,M.jsxs)("div",{className:"flex items-center",children:[(0,M.jsx)("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full mr-2",children:e.title}),(0,M.jsxs)("span",{className:"text-ui-label text-muted",children:[e.content.length," characters"]})]}),(0,M.jsxs)("div",{className:"flex gap-2",children:[(0,M.jsx)("button",{onClick:()=>(e=>{b(e.id),w(e.type),S(e.content)})(e),className:"text-blue-600 hover:text-blue-800 text-sm",title:"Edit",children:"\u270f\ufe0f"}),(0,M.jsx)("button",{onClick:()=>{return t=e.id,void r({type:o.REMOVE_ADDITIONAL_CONTEXT,payload:t});var t},className:"text-red-600 hover:text-red-800 text-sm",title:"Remove",children:"\ud83d\uddd1\ufe0f"})]})]}),(0,M.jsx)("div",{className:"text-ui-label text-gray-700 bg-white p-3 rounded border max-h-32 overflow-y-auto",children:e.content.length>200?"".concat(e.content.substring(0,200),"..."):e.content})]})},e.id))}),u||y?null:(0,M.jsx)("button",{onClick:()=>p(!0),className:"w-full border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-blue-400 transition-colors group",children:(0,M.jsxs)("div",{className:"flex items-center justify-center",children:[(0,M.jsx)("svg",{className:"w-5 h-5 text-gray-400 group-hover:text-blue-500 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),(0,M.jsx)("span",{className:"text-gray-600 group-hover:text-blue-600",children:"Add Additional Context"})]})}),u&&(0,M.jsxs)("div",{className:"border border-gray-300 rounded-lg p-4 bg-gray-50",children:[(0,M.jsx)("h4",{className:"text-body font-medium text-midnight-blue mb-3",children:"Add New Context"}),(0,M.jsxs)("div",{className:"space-y-3",children:[(0,M.jsxs)("div",{children:[(0,M.jsx)("label",{className:"block text-ui-label font-medium text-midnight-blue mb-1",children:"Context Type"}),(0,M.jsxs)("select",{value:m,onChange:e=>f(e.target.value),className:"input-field",children:[(0,M.jsx)("option",{value:"",children:"Choose what you want to add..."}),T.map(e=>(0,M.jsxs)("option",{value:e.value,children:[e.label," - ",e.description]},e.value))]})]}),m&&(0,M.jsxs)("div",{children:[(0,M.jsx)("label",{className:"block text-ui-label font-medium text-midnight-blue mb-1",children:"Content"}),(0,M.jsx)("textarea",{value:g,onChange:e=>v(e.target.value),placeholder:"Enter ".concat((null===(t=T.find(e=>e.value===m))||void 0===t||null===(n=t.label)||void 0===n?void 0:n.toLowerCase())||"content"," here..."),className:"input-field h-32 resize-none"}),(0,M.jsxs)("div",{className:"flex justify-between items-center mt-1",children:[(0,M.jsx)("span",{className:"text-ui-label text-muted text-sm",children:null===(s=T.find(e=>e.value===m))||void 0===s?void 0:s.description}),(0,M.jsxs)("span",{className:"text-ui-label text-sm ".concat(g.length<10?"text-coral":"text-green-600"),children:[g.length," characters"]})]})]}),(0,M.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,M.jsx)("button",{onClick:()=>{if(!m||!g.trim())return;const e=T.find(e=>e.value===m),t={id:Date.now().toString(),type:m,title:(null===e||void 0===e?void 0:e.label)||m,content:g.trim()};r({type:o.ADD_ADDITIONAL_CONTEXT,payload:t}),f(""),v(""),p(!1)},disabled:!m||!g.trim(),className:"btn-primary text-sm px-4 py-2",children:"Add Context"}),(0,M.jsx)("button",{onClick:I,className:"btn-secondary text-sm px-4 py-2",children:"Cancel"})]})]})]})]}),(0,M.jsxs)("div",{className:"text-center",children:[(0,M.jsx)("button",{onClick:async()=>{const e=[a.pdfText,a.resumeText,...a.additionalContexts.map(e=>"\n\n=== ".concat(e.title," ===\n").concat(e.content))].filter(e=>e.trim()).join("\n\n");if(!e.trim())return void r({type:o.SET_ERROR,payload:"Please provide some career information before analyzing."});if(e.replace(/example:|sample:|placeholder/gi,"").trim().length<100)r({type:o.SET_ERROR,payload:"Please provide more detailed career information (at least 100 characters) for a meaningful analysis."});else{h(!0),r({type:o.SET_LOADING,payload:!0}),r({type:o.CLEAR_ERROR});try{const t=await A(e,a.apiKey,a.selectedModel);r({type:o.SET_ANALYSIS_SUMMARY,payload:t.summary||t}),r({type:o.SET_ANALYSIS_DATA,payload:t}),r({type:o.SET_PHASE,payload:"ANALYSIS"})}catch(t){console.error("Analysis error:",t),r({type:o.SET_ERROR,payload:"Failed to analyze your information. Please try again."})}finally{h(!1),r({type:o.SET_LOADING,payload:!1})}}},disabled:!L||d,className:"btn-primary px-12 py-4 text-lg",children:d?(0,M.jsxs)("div",{className:"flex items-center justify-center",children:[(0,M.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,M.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,M.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Analyzing Your Career Story..."]}):"Analyze My Career Information"}),!L&&(0,M.jsx)("p",{className:"text-ui-label text-muted mt-2",children:P?"Please provide more detailed information (at least 100 characters) for meaningful analysis":"Please provide some career information before proceeding"})]}),(0,M.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,M.jsx)("h3",{className:"text-body font-medium text-midnight-blue mb-3",children:"\ud83d\udcdd How to get the best analysis:"}),(0,M.jsxs)("ul",{className:"space-y-2 text-ui-label text-muted",children:[(0,M.jsxs)("li",{className:"flex items-start",children:[(0,M.jsx)("span",{className:"text-coral mr-2",children:"1."}),(0,M.jsxs)("span",{children:[(0,M.jsx)("strong",{children:"Start with resume text:"})," Copy your entire resume from Word/PDF for the most accurate analysis"]})]}),(0,M.jsxs)("li",{className:"flex items-start",children:[(0,M.jsx)("span",{className:"text-coral mr-2",children:"2."}),(0,M.jsxs)("span",{children:[(0,M.jsx)("strong",{children:"Upload PDF as backup:"})," If pasting text doesn't work well, upload your resume PDF file"]})]}),(0,M.jsxs)("li",{className:"flex items-start",children:[(0,M.jsx)("span",{className:"text-coral mr-2",children:"3."}),(0,M.jsxs)("span",{children:[(0,M.jsx)("strong",{children:"Include achievements:"})," Make sure metrics, numbers, and accomplishments are included"]})]})]}),(0,M.jsx)("div",{className:"mt-4 p-3 bg-amber-gold bg-opacity-10 rounded-lg",children:(0,M.jsxs)("p",{className:"text-ui-label text-midnight-blue",children:[(0,M.jsx)("strong",{children:"\ud83d\udca1 Pro tip:"})," Use the text paste method for best results, with PDF upload as a backup option. Make sure to include quantifiable achievements and specific details!"]})})]})]})]})},ug=e=>{let{className:t="",showLabel:n=!0}=e;const[s,a]=(0,i.useState)(()=>{const e=localStorage.getItem("ttsEnabled");return null===e||JSON.parse(e)});(0,i.useEffect)(()=>{localStorage.setItem("ttsEnabled",JSON.stringify(s))},[s]);return(0,M.jsxs)("div",{className:"flex items-center ".concat(t),children:[n&&(0,M.jsx)("span",{className:"text-sm font-medium text-midnight-blue mr-3",children:"Ask Interview Questions in Voice"}),(0,M.jsx)("button",{onClick:()=>{a(!s)},className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-coral focus:ring-offset-2 ".concat(s?"bg-coral":"bg-gray-300"),role:"switch","aria-checked":s,"aria-label":"Toggle Ask Interview Questions in Voice",children:(0,M.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform ".concat(s?"translate-x-6":"translate-x-1")})}),n&&(0,M.jsx)("span",{className:"text-xs text-muted ml-2",children:s?"On":"Off"})]})},pg=e=>{let{onStartInterview:t,onSkipInterview:n,analysisData:i}=e;return(0,M.jsxs)("div",{className:"max-w-4xl mx-auto animate-fade-in",children:[(0,M.jsxs)("div",{className:"text-center mb-8",children:[(0,M.jsx)("div",{className:"w-20 h-20 bg-coral rounded-full flex items-center justify-center mx-auto mb-4",children:(0,M.jsx)("svg",{className:"w-10 h-10 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M7 4a3 3 0 016 0v4a3 3 0 11-6 0V4zm4 10.93A7.001 7.001 0 0017 8a1 1 0 10-2 0A5 5 0 015 8a1 1 0 00-2 0 7.001 7.001 0 006 6.93V17H6a1 1 0 100 2h8a1 1 0 100-2h-3v-2.07z",clipRule:"evenodd"})})}),(0,M.jsx)("h1",{className:"text-h1 font-bold text-midnight-blue mb-4",children:"Let's Talk About Your Career Journey"}),(0,M.jsx)("p",{className:"text-body text-muted leading-body max-w-2xl mx-auto",children:"I'm here to have a friendly conversation about your work experience and accomplishments. Together, we'll create a resume that truly showcases what makes you special."})]}),(0,M.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-8 mb-8",children:[(0,M.jsx)("div",{className:"text-center mb-8 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-100",children:(0,M.jsx)("p",{className:"text-lg text-midnight-blue leading-relaxed",children:"Think of this as a friendly conversation with someone who wants to help you shine. I'll ask you about your work experience, and together we'll highlight all the wonderful things you've accomplished. Take your time, and don't worry about being perfect - just be yourself!"})}),(0,M.jsx)("h2",{className:"text-h2 font-semibold text-midnight-blue mb-6",children:"What to Expect in Our Conversation"}),(0,M.jsxs)("div",{className:"grid md:grid-cols-2 gap-8",children:[(0,M.jsxs)("div",{className:"space-y-6",children:[(0,M.jsxs)("div",{className:"flex items-start",children:[(0,M.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-amber-gold rounded-full flex items-center justify-center mr-4 mt-1",children:(0,M.jsx)("span",{className:"text-midnight-blue font-bold text-sm",children:"1"})}),(0,M.jsxs)("div",{children:[(0,M.jsx)("h3",{className:"font-semibold text-midnight-blue mb-2",children:"About 10 Friendly Questions"}),(0,M.jsx)("p",{className:"text-muted text-sm",children:"I'll ask you about 10 questions covering your work experience, skills, and accomplishments. Each question helps me understand your story better so we can write a great resume together."})]})]}),(0,M.jsxs)("div",{className:"flex items-start",children:[(0,M.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-amber-gold rounded-full flex items-center justify-center mr-4 mt-1",children:(0,M.jsx)("span",{className:"text-midnight-blue font-bold text-sm",children:"2"})}),(0,M.jsxs)("div",{children:[(0,M.jsx)("h3",{className:"font-semibold text-midnight-blue mb-2",children:"If Something Sounds Familiar"}),(0,M.jsx)("p",{className:"text-muted text-sm",children:"Feel like you've already answered something? Just let me know! Say \"I think I covered this already\" and we'll move on to something new. No worries at all."})]})]}),(0,M.jsxs)("div",{className:"flex items-start",children:[(0,M.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-amber-gold rounded-full flex items-center justify-center mr-4 mt-1",children:(0,M.jsx)("span",{className:"text-midnight-blue font-bold text-sm",children:"3"})}),(0,M.jsxs)("div",{children:[(0,M.jsx)("h3",{className:"font-semibold text-midnight-blue mb-2",children:"Want to Wrap Up Early?"}),(0,M.jsx)("p",{className:"text-muted text-sm",children:"After we've talked for a bit, you can choose to finish and create your resume. The more we chat, the more detailed your resume will be, but you're in complete control."})]})]})]}),(0,M.jsxs)("div",{className:"space-y-6",children:[(0,M.jsxs)("div",{className:"flex items-start",children:[(0,M.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-coral rounded-full flex items-center justify-center mr-4 mt-1",children:(0,M.jsx)("span",{className:"text-white font-bold text-sm",children:"4"})}),(0,M.jsxs)("div",{children:[(0,M.jsx)("h3",{className:"font-semibold text-midnight-blue mb-2",children:"How You Can Respond"}),(0,M.jsx)("p",{className:"text-muted text-sm",children:"You can type your answers or speak them out loud - whatever feels more comfortable for you. I can also read my questions aloud if you'd like (just use the toggle below)."})]})]}),(0,M.jsxs)("div",{className:"flex items-start",children:[(0,M.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-coral rounded-full flex items-center justify-center mr-4 mt-1",children:(0,M.jsx)("span",{className:"text-white font-bold text-sm",children:"5"})}),(0,M.jsxs)("div",{children:[(0,M.jsx)("h3",{className:"font-semibold text-midnight-blue mb-2",children:"I Already Know About You"}),(0,M.jsx)("p",{className:"text-muted text-sm",children:"I've already reviewed your background information, so my questions will be personalized to your specific experience and accomplishments. No need to start from scratch!"})]})]})]})]}),(null===i||void 0===i?void 0:i.interview_focus_areas)&&(0,M.jsxs)("div",{className:"mt-8 p-6 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,M.jsx)("h3",{className:"font-semibold text-midnight-blue mb-3",children:"\ud83d\udccb Topics We'll Explore Based on Your Experience:"}),(0,M.jsx)("div",{className:"grid md:grid-cols-2 gap-3",children:i.interview_focus_areas.slice(0,4).map((e,t)=>(0,M.jsxs)("div",{className:"flex items-center text-sm text-blue-700",children:[(0,M.jsx)("svg",{className:"w-4 h-4 mr-2 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e]},t))})]})]}),(0,M.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,M.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,M.jsxs)("div",{children:[(0,M.jsx)("h3",{className:"font-semibold text-midnight-blue mb-2",children:"Audio Preferences"}),(0,M.jsx)("p",{className:"text-sm text-muted",children:"Would you like me to read my questions out loud?"})]}),(0,M.jsx)(ug,{className:"ml-4"})]}),(0,M.jsxs)("div",{className:"text-center",children:[(0,M.jsx)("p",{className:"text-lg text-muted mb-6 font-medium",children:"Ready to get started? Our conversation will take about 10-15 minutes."}),(0,M.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[(0,M.jsx)("button",{onClick:t,className:"btn-primary px-10 py-4 text-xl font-semibold rounded-full shadow-lg hover:shadow-xl transition-all duration-200",children:"\ud83d\udcac Let's Begin Our Chat"}),(0,M.jsx)("button",{onClick:n,className:"text-muted border-2 border-gray-300 hover:border-gray-400 hover:text-midnight-blue px-8 py-4 text-lg font-medium rounded-full transition-all duration-200 opacity-50",children:"\ud83d\udcc4 Skip to Results"})]}),(0,M.jsx)("p",{className:"text-sm text-gray-400 mt-4 max-w-md mx-auto",children:"Want to chat first? The interview creates much better results! \u261d\ufe0f Or create a basic resume now using your uploaded information."})]})]})]})},mg=e=>{let{state:t,dispatch:n,actions:s}=e;const[a,r]=(0,i.useState)("overview"),[o,l]=(0,i.useState)(!1),[c,d]=(0,i.useState)(!1),h=(0,i.useCallback)(async()=>{l(!0),n({type:s.CLEAR_ERROR});try{const e=[t.resumeText,t.pdfText,t.linkedinText].filter(Boolean).join("\n\n");if(!e.trim())throw new Error("No content available for analysis");console.log("Starting analysis with context length:",e.length);const i=await A(e,t.apiKey,t.selectedModel);console.log("Analysis result:",i),n({type:s.SET_ANALYSIS_DATA,payload:i}),n({type:s.SET_ANALYSIS_SUMMARY,payload:i.summary||""})}catch(e){console.error("Analysis failed:",e),e.isRetryable?n({type:s.SET_RETRYABLE_ERROR,payload:{message:e.message,retryAction:h}}):n({type:s.SET_ERROR,payload:"Failed to analyze your information: "+e.message})}finally{l(!1)}},[t.resumeText,t.pdfText,t.linkedinText,t.apiKey,t.selectedModel,n,s.CLEAR_ERROR,s.SET_ANALYSIS_DATA,s.SET_ANALYSIS_SUMMARY,s.SET_RETRYABLE_ERROR,s.SET_ERROR]);(0,i.useEffect)(()=>{t.analysisData||o||h()},[t.analysisData,o,h]);const u=async()=>{if(t.apiKey&&t.apiKey.trim()){d(!1),n({type:s.SET_PHASE,payload:"RESULTS"}),n({type:s.SET_THINKING,payload:!0}),n({type:s.SET_LOADING,payload:!0});try{const e={resumeText:t.resumeText,pdfText:t.pdfText},[i,a]=await Promise.all([k([],e,t.additionalContexts||[],t.apiKey,t.selectedModel),C([],e,t.additionalContexts||[],t.apiKey,t.selectedModel)]);n({type:s.SET_FINAL_RESUME,payload:i}),n({type:s.SET_LINKEDIN_CONTENT,payload:a})}catch(e){console.error("Error in skip interview resume generation:",e),e.message&&(e.message.includes("Invalid API key")||e.message.includes("Incorrect API key"))?n({type:s.SET_ERROR,payload:"Invalid API key detected. Please go back to setup and verify your OpenAI API key is correct."}):e.isRetryable?n({type:s.SET_RETRYABLE_ERROR,payload:{message:e.message,retryAction:u}}):n({type:s.SET_ERROR,payload:e.message||"Failed to generate resume and LinkedIn content. Please try again."})}finally{n({type:s.SET_THINKING,payload:!1}),n({type:s.SET_LOADING,payload:!1})}}else n({type:s.SET_ERROR,payload:"API key is required to generate the resume. Please go back to setup and enter your OpenAI API key."})};return(0,M.jsx)("div",{className:"max-w-4xl mx-auto animate-fade-in",children:c?(0,M.jsx)(pg,{onStartInterview:()=>{d(!1),n({type:s.SET_PHASE,payload:"INTERVIEW"})},onSkipInterview:u,analysisData:t.analysisData}):(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)("div",{className:"mb-8 text-center",children:[(0,M.jsx)("h1",{className:"text-h1 font-bold text-midnight-blue mb-4",children:"Career Analysis"}),(0,M.jsx)("p",{className:"text-body text-muted leading-body",children:"Here's what we've discovered about your professional journey"})]}),(0,M.jsxs)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden mb-8",children:[(0,M.jsx)("div",{className:"border-b border-gray-100",children:(0,M.jsx)("nav",{className:"flex",children:[{id:"overview",label:"Overview",icon:"\ud83d\udc4b"},{id:"strengths",label:"Strengths",icon:"\ud83d\udcaa"},{id:"experience",label:"Experience",icon:"\ud83c\udfe2"},{id:"achievements",label:"Achievements",icon:"\ud83c\udfc6"},{id:"themes",label:"Career Themes",icon:"\ud83c\udfaf"},{id:"focus",label:"Interview Focus",icon:"\ud83c\udfa4"}].map(e=>(0,M.jsx)("button",{onClick:()=>r(e.id),className:"\n                  flex-1 px-4 py-4 text-sm font-medium border-b-2 transition-all duration-200 \n                  flex items-center justify-center min-h-[64px]\n                  ".concat(a===e.id?"border-amber-gold text-amber-gold bg-amber-50":"border-transparent text-gray-500 hover:text-midnight-blue hover:bg-gray-50","\n                "),children:(0,M.jsxs)("div",{className:"flex flex-col items-center space-y-1",children:[(0,M.jsx)("span",{className:"text-lg",children:e.icon}),(0,M.jsx)("span",{className:"text-xs font-medium",children:e.label})]})},e.id))})}),(0,M.jsx)("div",{className:"p-8 min-h-[400px]",children:(()=>{if(o)return(0,M.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,M.jsxs)("div",{className:"text-center",children:[(0,M.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-amber-gold mx-auto mb-4"}),(0,M.jsx)("p",{className:"text-muted",children:"Analyzing your career information..."})]})});var e,n,i;if(!t.analysisData)return(0,M.jsxs)("div",{className:"text-center py-8",children:[(0,M.jsx)("p",{className:"text-muted",children:"No analysis data available"}),(0,M.jsxs)("div",{className:"mt-4 text-left bg-gray-100 p-4 rounded text-sm",children:[(0,M.jsx)("p",{children:(0,M.jsx)("strong",{children:"Debug Info:"})}),(0,M.jsxs)("p",{children:["Resume text length: ",(null===(e=t.resumeText)||void 0===e?void 0:e.length)||0]}),(0,M.jsxs)("p",{children:["PDF text length: ",(null===(n=t.pdfText)||void 0===n?void 0:n.length)||0]}),(0,M.jsxs)("p",{children:["Analysis summary: ",(null===(i=t.analysisSummary)||void 0===i?void 0:i.substring(0,100))||"None"]})]})]});const s=t.analysisData;switch(a){case"overview":return(0,M.jsxs)("div",{className:"space-y-8",children:[s.name&&(0,M.jsxs)("div",{className:"text-center mb-12",children:[(0,M.jsxs)("div",{className:"relative",children:[(0,M.jsxs)("h1",{className:"text-4xl font-bold text-midnight-blue mb-4",children:["Hello, ",s.name,"! \ud83d\udc4b"]}),(0,M.jsx)("div",{className:"absolute -top-2 -right-8 w-8 h-8 bg-amber-200 rounded-full animate-pulse opacity-50"}),(0,M.jsx)("div",{className:"absolute -bottom-2 -left-6 w-6 h-6 bg-coral opacity-30 rounded-full animate-pulse"})]}),(0,M.jsx)("p",{className:"text-lg text-muted max-w-2xl mx-auto",children:"Let's explore your career journey together and uncover the unique story that makes you stand out"})]}),(0,M.jsxs)("div",{className:"grid md:grid-cols-2 gap-6 mb-8",children:[s.current_role&&(0,M.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 p-6 rounded-xl hover:shadow-md transition-shadow",children:[(0,M.jsxs)("div",{className:"flex items-center mb-3",children:[(0,M.jsx)("div",{className:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center mr-3",children:(0,M.jsx)("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M6 6V5a3 3 0 013-3h2a3 3 0 013 3v1h2a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h2zm2-1a1 1 0 011-1h2a1 1 0 011 1v1H8V5zm1 6a1 1 0 011-1h.01a1 1 0 110 2H10a1 1 0 01-1-1z",clipRule:"evenodd"})})}),(0,M.jsx)("h4",{className:"font-semibold text-midnight-blue",children:"Current Role"})]}),(0,M.jsx)("p",{className:"text-muted font-medium",children:s.current_role})]}),s.career_level&&(0,M.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border border-green-200 p-6 rounded-xl hover:shadow-md transition-shadow",children:[(0,M.jsxs)("div",{className:"flex items-center mb-3",children:[(0,M.jsx)("div",{className:"w-10 h-10 bg-green-500 rounded-lg flex items-center justify-center mr-3",children:(0,M.jsx)("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z",clipRule:"evenodd"})})}),(0,M.jsx)("h4",{className:"font-semibold text-midnight-blue",children:"Career Level"})]}),(0,M.jsx)("p",{className:"text-muted font-medium",children:s.career_level}),s.career_level_justification&&(0,M.jsx)("p",{className:"text-sm text-gray-600 mt-3 italic leading-relaxed",children:s.career_level_justification})]}),s.years_experience&&(0,M.jsxs)("div",{className:"bg-gradient-to-br from-purple-50 to-violet-50 border border-purple-200 p-6 rounded-xl hover:shadow-md transition-shadow",children:[(0,M.jsxs)("div",{className:"flex items-center mb-3",children:[(0,M.jsx)("div",{className:"w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center mr-3",children:(0,M.jsx)("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})})}),(0,M.jsx)("h4",{className:"font-semibold text-midnight-blue",children:"Experience"})]}),(0,M.jsxs)("p",{className:"text-muted font-medium",children:[s.years_experience," years"]})]}),s.skills_mentioned&&s.skills_mentioned.length>0&&(0,M.jsxs)("div",{className:"bg-gradient-to-br from-amber-50 to-orange-50 border border-amber-200 p-6 rounded-xl hover:shadow-md transition-shadow",children:[(0,M.jsxs)("div",{className:"flex items-center mb-3",children:[(0,M.jsx)("div",{className:"w-10 h-10 bg-amber-500 rounded-lg flex items-center justify-center mr-3",children:(0,M.jsx)("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})})}),(0,M.jsx)("h4",{className:"font-semibold text-midnight-blue",children:"Key Skills"})]}),(0,M.jsx)("p",{className:"text-muted font-medium",children:s.skills_mentioned.slice(0,3).join(", ")})]})]}),(0,M.jsxs)("div",{className:"bg-gradient-to-r from-gray-50 to-slate-50 border border-gray-200 rounded-xl p-8",children:[(0,M.jsxs)("div",{className:"flex items-center mb-4",children:[(0,M.jsx)("div",{className:"w-8 h-8 bg-midnight-blue rounded-full flex items-center justify-center mr-3",children:(0,M.jsx)("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,M.jsx)("h3",{className:"text-xl font-semibold text-midnight-blue",children:"Professional Summary"})]}),(0,M.jsx)("div",{className:"prose prose-lg max-w-none",children:(0,M.jsx)("div",{className:"text-body leading-relaxed text-midnight-blue",dangerouslySetInnerHTML:{__html:(s.summary||"Welcome! Let's analyze your career background and help you shine.").replace(/\n/g,"<br/>").replace(/\\"/g,'"').replace(/\\'/g,"'")}})})]})]});case"strengths":return(0,M.jsxs)("div",{className:"space-y-6",children:[(0,M.jsxs)("div",{className:"text-center mb-8",children:[(0,M.jsx)("h3",{className:"text-2xl font-bold text-midnight-blue mb-2",children:"Your Key Strengths"}),(0,M.jsx)("p",{className:"text-muted",children:"The unique qualities that set you apart from other candidates"})]}),s.key_strengths&&s.key_strengths.length>0?(0,M.jsxs)("div",{className:"grid gap-4",children:[s.key_strengths.map((e,t)=>(0,M.jsx)("div",{className:"group hover:shadow-md transition-all duration-200",children:(0,M.jsx)("div",{className:"bg-gradient-to-r from-amber-50 to-yellow-50 border border-amber-200 rounded-lg p-6 hover:border-amber-300",children:(0,M.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,M.jsx)("div",{className:"flex-shrink-0",children:(0,M.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-amber-400 to-yellow-500 rounded-full flex items-center justify-center shadow-lg",children:(0,M.jsx)("span",{className:"text-white text-lg",children:"\u2728"})})}),(0,M.jsx)("div",{className:"flex-1",children:(0,M.jsx)("p",{className:"text-midnight-blue text-lg leading-relaxed font-medium",children:e})})]})})},t)),(0,M.jsxs)("div",{className:"mt-8 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6",children:[(0,M.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,M.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:(0,M.jsx)("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})})}),(0,M.jsx)("h4",{className:"text-lg font-semibold text-midnight-blue",children:"How We'll Use These"})]}),(0,M.jsx)("p",{className:"text-muted leading-relaxed",children:"These strengths will be woven throughout your resume and interview responses to create a consistent, compelling narrative about your professional capabilities and the unique value you bring to employers."})]})]}):(0,M.jsxs)("div",{className:"text-center py-12",children:[(0,M.jsx)("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,M.jsx)("span",{className:"text-2xl",children:"\ud83d\udcaa"})}),(0,M.jsx)("h4",{className:"text-lg font-medium text-midnight-blue mb-2",children:"Strengths to Discover"}),(0,M.jsx)("p",{className:"text-muted max-w-md mx-auto",children:"We'll discover your hidden strengths during our conversation! Everyone has unique talents that make them valuable to employers."})]})]});case"experience":return(0,M.jsxs)("div",{className:"space-y-4",children:[(0,M.jsx)("h3",{className:"text-xl font-semibold text-midnight-blue mb-4",children:"Experience Highlights"}),s.experience_highlights&&s.experience_highlights.length>0?(0,M.jsx)("div",{className:"space-y-4",children:s.experience_highlights.map((e,t)=>(0,M.jsxs)("div",{className:"border-l-4 border-coral pl-4 py-3 bg-gray-50 rounded-r-lg",children:[(0,M.jsxs)("div",{className:"font-medium text-midnight-blue text-lg",children:[e.role," ",e.company&&"at ".concat(e.company)]}),e.duration&&(0,M.jsx)("div",{className:"text-sm text-muted mb-2",children:e.duration}),e.key_responsibilities&&(0,M.jsxs)("div",{className:"mb-2",children:[(0,M.jsx)("span",{className:"text-sm font-medium text-midnight-blue",children:"Responsibilities: "}),(0,M.jsx)("span",{className:"text-muted",children:e.key_responsibilities})]}),e.achievements&&(0,M.jsxs)("div",{className:"mb-2",children:[(0,M.jsx)("span",{className:"text-sm font-medium text-midnight-blue",children:"Achievements: "}),(0,M.jsx)("span",{className:"text-muted",children:e.achievements})]}),e.missing_details&&(0,M.jsxs)("div",{className:"mt-2 p-2 bg-yellow-50 border-l-2 border-yellow-400 rounded",children:[(0,M.jsx)("span",{className:"text-sm font-medium text-yellow-800",children:"Interview Focus: "}),(0,M.jsx)("span",{className:"text-sm text-yellow-700",children:e.missing_details})]}),e.impact&&!e.key_responsibilities&&(0,M.jsx)("p",{className:"text-muted mt-1",children:e.impact})]},t))}):(0,M.jsx)("p",{className:"text-muted",children:"We'll explore your professional experience together!"})]});case"achievements":return(0,M.jsxs)("div",{className:"space-y-6",children:[(0,M.jsxs)("div",{className:"text-center mb-8",children:[(0,M.jsx)("h3",{className:"text-2xl font-bold text-midnight-blue mb-2",children:"Notable Achievements"}),(0,M.jsx)("p",{className:"text-muted",children:"The accomplishments that demonstrate your impact and value"})]}),s.achievements&&s.achievements.length>0?(0,M.jsxs)("div",{className:"space-y-4",children:[s.achievements.map((e,t)=>(0,M.jsx)("div",{className:"group hover:shadow-md transition-all duration-200",children:(0,M.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-6 hover:border-green-300",children:(0,M.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,M.jsx)("div",{className:"flex-shrink-0",children:(0,M.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full flex items-center justify-center shadow-lg",children:(0,M.jsx)("svg",{className:"w-6 h-6 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})}),(0,M.jsx)("div",{className:"flex-1",children:(0,M.jsx)("p",{className:"text-midnight-blue text-lg leading-relaxed font-medium",children:e})})]})})},t)),(0,M.jsxs)("div",{className:"mt-8 bg-gradient-to-r from-purple-50 to-violet-50 border border-purple-200 rounded-lg p-6",children:[(0,M.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,M.jsx)("div",{className:"w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center",children:(0,M.jsx)("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z",clipRule:"evenodd"})})}),(0,M.jsx)("h4",{className:"text-lg font-semibold text-midnight-blue",children:"Interview Strategy"})]}),(0,M.jsx)("p",{className:"text-muted leading-relaxed",children:"These achievements will serve as concrete examples during your interview. We'll help you tell the complete story behind each accomplishment, including challenges faced and methods used."})]})]}):(0,M.jsxs)("div",{className:"text-center py-12",children:[(0,M.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,M.jsx)("span",{className:"text-2xl",children:"\ud83c\udfc6"})}),(0,M.jsx)("h4",{className:"text-lg font-medium text-midnight-blue mb-2",children:"Achievements to Highlight"}),(0,M.jsx)("p",{className:"text-muted max-w-md mx-auto",children:"Let's uncover your accomplishments in our interview! Every professional has achievements worth celebrating and sharing."})]})]});case"themes":return(0,M.jsxs)("div",{className:"space-y-6",children:[(0,M.jsxs)("div",{className:"text-center mb-8",children:[(0,M.jsx)("h3",{className:"text-2xl font-bold text-midnight-blue mb-2",children:"Career Themes"}),(0,M.jsx)("p",{className:"text-muted",children:"Consistent patterns that define your professional journey"})]}),s.career_themes&&s.career_themes.length>0?(0,M.jsxs)("div",{className:"space-y-4",children:[s.career_themes.map((e,t)=>(0,M.jsx)("div",{className:"group hover:shadow-md transition-all duration-200",children:(0,M.jsx)("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200 rounded-lg p-6 hover:border-amber-300",children:(0,M.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,M.jsx)("div",{className:"flex-shrink-0",children:(0,M.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-amber-400 to-orange-500 rounded-full flex items-center justify-center shadow-lg",children:(0,M.jsx)("svg",{className:"w-6 h-6 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M3 3a1 1 0 000 2v8a2 2 0 002 2h2.586l-1.293 1.293a1 1 0 101.414 1.414L10 15.414l2.293 2.293a1 1 0 001.414-1.414L12.414 15H15a2 2 0 002-2V5a1 1 0 100-2H3zm11.707 4.707a1 1 0 00-1.414-1.414L10 9.586 8.707 8.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})}),(0,M.jsx)("div",{className:"flex-1",children:(0,M.jsx)("p",{className:"text-midnight-blue text-lg leading-relaxed font-medium",children:e})})]})})},t)),(0,M.jsxs)("div",{className:"mt-8 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6",children:[(0,M.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,M.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:(0,M.jsx)("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,M.jsx)("h4",{className:"text-lg font-semibold text-midnight-blue",children:"Why These Themes Matter"})]}),(0,M.jsx)("p",{className:"text-muted leading-relaxed",children:"These recurring themes demonstrate consistency in your career choices and highlight your core professional values. They'll help us craft a compelling narrative that shows employers the unique value you bring to any organization."})]})]}):(0,M.jsxs)("div",{className:"text-center py-12",children:[(0,M.jsx)("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,M.jsx)("span",{className:"text-2xl",children:"\ud83c\udfa8"})}),(0,M.jsx)("h4",{className:"text-lg font-medium text-midnight-blue mb-2",children:"No Clear Themes Yet"}),(0,M.jsx)("p",{className:"text-muted max-w-md mx-auto",children:"We'll identify patterns in your career journey during our interview! Every professional has unique themes that make their story compelling."})]})]});case"focus":return(0,M.jsxs)("div",{className:"space-y-6",children:[(0,M.jsx)("h3",{className:"text-xl font-semibold text-midnight-blue mb-4",children:"Interview Focus Areas"}),(0,M.jsx)("p",{className:"text-muted mb-6",children:"Based on your background, here are the key areas our AI interviewer will explore to create the most compelling resume:"}),s.interview_focus_areas&&s.interview_focus_areas.length>0&&(0,M.jsxs)("div",{className:"mb-6",children:[(0,M.jsx)("h4",{className:"text-lg font-medium text-midnight-blue mb-3",children:"\ud83c\udfaf Areas to Explore"}),(0,M.jsx)("div",{className:"space-y-3",children:s.interview_focus_areas.map((e,t)=>(0,M.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-blue-50 rounded-lg",children:[(0,M.jsx)("span",{className:"text-blue-600 text-lg flex-shrink-0",children:"\ud83d\udccb"}),(0,M.jsx)("span",{className:"text-midnight-blue",children:e})]},t))})]}),s.gaps_to_explore&&s.gaps_to_explore.length>0&&(0,M.jsxs)("div",{className:"mb-6",children:[(0,M.jsx)("h4",{className:"text-lg font-medium text-midnight-blue mb-3",children:"\ud83d\udd0d Areas Needing More Detail"}),(0,M.jsx)("div",{className:"space-y-3",children:s.gaps_to_explore.map((e,t)=>(0,M.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-amber-50 rounded-lg",children:[(0,M.jsx)("span",{className:"text-amber-600 text-lg flex-shrink-0",children:"\u26a1"}),(0,M.jsx)("span",{className:"text-midnight-blue",children:e})]},t))})]}),s.skills_mentioned&&s.skills_mentioned.length>0&&(0,M.jsxs)("div",{children:[(0,M.jsx)("h4",{className:"text-lg font-medium text-midnight-blue mb-3",children:"\ud83d\udca1 Skills to Elaborate On"}),(0,M.jsx)("div",{className:"flex flex-wrap gap-2",children:s.skills_mentioned.map((e,t)=>(0,M.jsx)("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:e},t))}),(0,M.jsx)("p",{className:"text-sm text-muted mt-2",children:"The interviewer will ask for specific examples of how you've used these skills."})]}),(0,M.jsxs)("div",{className:"mt-6 p-4 bg-gradient-to-r from-coral/10 to-amber-gold/10 rounded-lg border border-coral/20",children:[(0,M.jsx)("p",{className:"text-midnight-blue font-medium mb-2",children:"\ud83d\udcac What to Expect:"}),(0,M.jsx)("p",{className:"text-muted text-sm",children:"The AI interviewer is aware of your background and will ask targeted questions about your specific experiences, achievements, and challenges. Be ready to share stories, emotions, and concrete examples that bring your resume to life!"})]})]});default:return null}})()})]}),(0,M.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6 mb-8",children:[(0,M.jsx)("h3",{className:"text-body font-medium text-midnight-blue mb-4",children:"What to expect in your interview:"}),(0,M.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,M.jsxs)("div",{className:"flex items-start",children:[(0,M.jsx)("div",{className:"w-8 h-8 bg-coral rounded-full flex items-center justify-center mr-3 mt-1",children:(0,M.jsx)("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M7 4a3 3 0 016 0v4a3 3 0 11-6 0V4zm4 10.93A7.001 7.001 0 0017 8a1 1 0 10-2 0A5 5 0 015 8a1 1 0 00-2 0 7.001 7.001 0 006 6.93V17H6a1 1 0 100 2h8a1 1 0 100-2h-3v-2.07z",clipRule:"evenodd"})})}),(0,M.jsxs)("div",{children:[(0,M.jsx)("h4",{className:"text-ui-label font-medium text-midnight-blue",children:"Voice Conversation"}),(0,M.jsx)("p",{className:"text-ui-label text-muted",children:"Speak naturally with our AI coach, or type your responses"})]})]}),(0,M.jsxs)("div",{className:"flex items-start",children:[(0,M.jsx)("div",{className:"w-8 h-8 bg-coral rounded-full flex items-center justify-center mr-3 mt-1",children:(0,M.jsx)("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M18 13V5a2 2 0 00-2-2H4a2 2 0 00-2 2v8a2 2 0 002 2h3l3 3 3-3h3a2 2 0 002-2zM5 7a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1zm1 3a1 1 0 100 2h3a1 1 0 100-2H6z",clipRule:"evenodd"})})}),(0,M.jsxs)("div",{children:[(0,M.jsx)("h4",{className:"text-ui-label font-medium text-midnight-blue",children:"Thoughtful Questions"}),(0,M.jsx)("p",{className:"text-ui-label text-muted",children:"Answer questions that reveal your hidden strengths"})]})]}),(0,M.jsxs)("div",{className:"flex items-start",children:[(0,M.jsx)("div",{className:"w-8 h-8 bg-coral rounded-full flex items-center justify-center mr-3 mt-1",children:(0,M.jsx)("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})})}),(0,M.jsxs)("div",{children:[(0,M.jsx)("h4",{className:"text-ui-label font-medium text-midnight-blue",children:"Editable Transcripts"}),(0,M.jsx)("p",{className:"text-ui-label text-muted",children:"Review and edit your responses before sending"})]})]}),(0,M.jsxs)("div",{className:"flex items-start",children:[(0,M.jsx)("div",{className:"w-8 h-8 bg-coral rounded-full flex items-center justify-center mr-3 mt-1",children:(0,M.jsx)("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0113 13a2.99 2.99 0 01-.879 2.121z",clipRule:"evenodd"})})}),(0,M.jsxs)("div",{children:[(0,M.jsx)("h4",{className:"text-ui-label font-medium text-midnight-blue",children:"Natural Flow"}),(0,M.jsx)("p",{className:"text-ui-label text-muted",children:"Take your time - this is your moment to shine"})]})]})]})]}),(0,M.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,M.jsx)("button",{onClick:()=>{n({type:s.SET_PHASE,payload:"ONBOARDING"})},className:"btn-secondary px-8 py-3",children:"\u2190 Back to Edit Information"}),(0,M.jsx)("button",{onClick:()=>{d(!0)},className:"btn-primary px-8 py-3",disabled:o,children:o?"Analyzing...":"Start Interview \u2192"})]}),(0,M.jsx)("div",{className:"mt-8 text-center",children:(0,M.jsxs)("p",{className:"text-ui-label text-muted",children:[(0,M.jsx)("svg",{className:"w-4 h-4 inline mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})}),"Your conversation is private and processed securely. We only use your information to generate your personalized resume."]})})]})})},fg=e=>{let{onSendMessage:t,isListening:n,onStartListening:s,onStopListening:a,disabled:r,apiKey:o}=e;const[l,c]=(0,i.useState)(""),[d,h]=(0,i.useState)(!1),[u,p]=(0,i.useState)(!1),m=(0,i.useRef)(null),f=(0,i.useRef)([]),g=(0,i.useRef)(null);(0,i.useEffect)(()=>()=>{g.current&&g.current.getTracks().forEach(e=>e.stop())},[]);const v=async e=>{if(o){p(!0);try{const t=await async function(e,t){try{const n=new FormData;n.append("file",e,"audio.webm"),n.append("model","whisper-1"),n.append("language","en");const i=await w("".concat(b,"/audio/transcriptions"),{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:n});return(await i.json()).text}catch(n){throw console.error("Speech transcription failed:",n),n}}(e,o);c(e=>e+(e?" ":"")+t)}catch(t){console.error("Transcription error:",t),alert("Failed to transcribe audio. Please try again or type your message.")}finally{p(!1)}}else alert("API key is required for speech recognition")},y=()=>{l.trim()&&!r&&(t(l.trim()),c(""))};return(0,M.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-t border-gray-200","data-input-box":!0,children:(0,M.jsxs)("div",{className:"flex flex-col space-y-3",children:[(0,M.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,M.jsxs)("div",{className:"flex-1 relative",children:[(0,M.jsx)("textarea",{value:l,onChange:e=>{c(e.target.value)},onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),y())},placeholder:u?"Transcribing your speech...":d?"Recording... Speak now or edit the text below.":"Type your response or click the microphone to speak...",className:"input-field min-h-[120px] resize-none w-full",disabled:r,rows:3}),(0,M.jsxs)("div",{className:"absolute bottom-2 right-2 text-ui-label text-muted text-xs",children:[l.length,"/5000"]})]}),(0,M.jsxs)("div",{className:"flex flex-col items-center space-y-3 min-w-[100px]",children:[(0,M.jsx)("button",{onClick:()=>{r||u||(d?m.current&&"recording"===m.current.state&&(m.current.stop(),h(!1),a()):(async()=>{try{const e=await navigator.mediaDevices.getUserMedia({audio:!0});g.current=e;const t=new MediaRecorder(e);m.current=t,f.current=[],t.ondataavailable=e=>{e.data.size>0&&f.current.push(e.data)},t.onstop=async()=>{const e=new Blob(f.current,{type:"audio/webm"});await v(e),g.current&&(g.current.getTracks().forEach(e=>e.stop()),g.current=null)},t.start(),h(!0),s()}catch(e){console.error("Error starting recording:",e),alert("Could not access microphone. Please check your permissions.")}})())},disabled:r||u,className:"mic-button ".concat(d?"listening":""," ").concat(r||u?"opacity-50 cursor-not-allowed":""),title:u?"Transcribing...":d?"Stop recording":"Start voice input",children:u?(0,M.jsx)("svg",{className:"w-6 h-6 text-amber-gold animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,M.jsx)("circle",{cx:"12",cy:"12",r:"10",strokeWidth:"2",strokeDasharray:"60",strokeDashoffset:"15",strokeLinecap:"round"})}):d?(0,M.jsx)("svg",{className:"w-6 h-6 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z",clipRule:"evenodd"})}):(0,M.jsx)("svg",{className:"w-6 h-6 text-coral",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M7 4a3 3 0 016 0v4a3 3 0 11-6 0V4zm4 10.93A7.001 7.001 0 0017 8a1 1 0 10-2 0A5 5 0 015 8a1 1 0 00-2 0 7.001 7.001 0 006 6.93V17H6a1 1 0 100 2h8a1 1 0 100-2h-3v-2.07z",clipRule:"evenodd"})})}),(0,M.jsxs)("button",{onClick:y,disabled:!l.trim()||r,className:"btn-primary px-4 py-2 text-sm flex items-center justify-center w-full",children:[(0,M.jsx)("span",{children:"Send"}),(0,M.jsx)("svg",{className:"w-3 h-3 ml-1",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]})]}),(0,M.jsxs)("div",{className:"flex items-center justify-between",children:[(0,M.jsxs)("div",{className:"flex items-center space-x-4",children:[u&&(0,M.jsxs)("div",{className:"flex items-center text-amber-gold",children:[(0,M.jsx)("div",{className:"w-2 h-2 bg-amber-gold rounded-full animate-pulse mr-2"}),(0,M.jsx)("span",{className:"text-ui-label text-xs",children:"Transcribing..."})]}),d&&!u&&(0,M.jsxs)("div",{className:"flex items-center text-coral",children:[(0,M.jsx)("div",{className:"w-2 h-2 bg-coral rounded-full animate-pulse mr-2"}),(0,M.jsx)("span",{className:"text-ui-label text-xs",children:"Recording..."})]})]}),(0,M.jsx)("div",{className:"text-ui-label text-muted text-xs",children:"\ud83d\udca1 Enter to send \u2022 Shift+Enter for new line"})]})]})})};class gg{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:28,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16;this.maxMessages=e,this.criticalMessages=t,this.summaryTargetLength=n,this.topicTracker=new Map,this.questionHistory=[]}needsSummarization(e){return e.length>this.maxMessages}async createAISummary(e,t,n){const i=e.map(e=>"".concat("assistant"===e.role?"Interviewer":"Candidate",": ").concat(e.content)).join("\n\n"),s=d.contextManagement.aiSummarization.replace("{conversationText}",i);try{const e=function(e,t){return new y(e,t)}(t,n);return(await e.complete([{role:"system",content:"You are an expert conversation summarizer who creates comprehensive, structured summaries that capture all essential details while preventing repetitive questioning."},{role:"user",content:s}])).content}catch(a){return console.error("AI summarization failed, falling back to basic summary:",a),this.createBasicSummary(e)}}updateTopicTracker(e){const t=e.filter(e=>"assistant"===e.role).map(e=>e.content);this.questionHistory=[...new Set([...this.questionHistory,...t])];const n=e.filter(e=>"user"===e.role).map(e=>e.content.toLowerCase()).join(" ");Object.entries({current_role:["current role","present position","current job","current work"],achievements:["achievement","accomplish","success","result","impact"],technical_skills:["skill","technical","technology","tool","programming"],leadership:["leadership","lead","manage","team","mentor"],challenges:["challenge","difficult","problem","obstacle","struggle"],career_goals:["goal","future","career","aspiration","vision"],projects:["project","initiative","work on","developed","built"],growth:["growth","development","learning","improve","develop"]}).forEach(e=>{let[t,i]=e;const s=i.reduce((e,t)=>{var i;return e+((null===(i=n.match(new RegExp(t,"g")))||void 0===i?void 0:i.length)||0)},0);this.topicTracker.set(t,(this.topicTracker.get(t)||0)+s)})}generateAntiRepetitionContext(e){this.updateTopicTracker(e);const t=e.filter(e=>"assistant"===e.role).slice(-6).map(e=>'"'.concat(e.content.substring(0,100),'..."')).join("\n- "),n=Array.from(this.topicTracker.entries()).filter(e=>{let[t,n]=e;return n>=3}).map(e=>{let[t,n]=e;return t.replace("_"," ")}).join(", ");return"\n\ud83d\udeab ANTI-REPETITION INTELLIGENCE:\n\nRECENT QUESTIONS ASKED (DO NOT REPEAT):\n- ".concat(t,"\n\nTOPICS THOROUGHLY COVERED (MOVE ON):\n").concat(n||"None yet - still exploring","\n\nQUESTION HISTORY COUNT: ").concat(this.questionHistory.length," unique questions asked\n\n\u26a0\ufe0f CRITICAL: Before asking your next question, verify it explores NEW territory not covered above. If similar ground was covered, pivot to a completely different aspect of their career experience.\n")}async summarizeConversationAI(e,t,n){if(!this.needsSummarization(e))return{summarizedConversation:e,summaryCreated:!1,antiRepetitionContext:this.generateAntiRepetitionContext(e)};try{const i=Math.floor(this.criticalMessages/2),s=Math.floor(this.criticalMessages/2),a=e.slice(0,i),r=e.slice(-s),o=e.slice(i,-s),l=await this.createAISummary(o,t,n),c={role:"system",content:"[AI CONVERSATION SUMMARY - ".concat(o.length," messages intelligently condensed]\n\n").concat(l),timestamp:(new Date).toISOString(),isSummary:!0,isAIPowered:!0,messagesCounted:o.length,summaryMethod:"AI_COMPREHENSIVE"},d=[...a,c,...r];if(d.length>this.summaryTargetLength){return{summarizedConversation:[c,...e.slice(-6)],summaryCreated:!0,antiRepetitionContext:this.generateAntiRepetitionContext(e)}}return{summarizedConversation:d,summaryCreated:!0,antiRepetitionContext:this.generateAntiRepetitionContext(e)}}catch(i){return console.error("AI summarization failed, using fallback:",i),this.createFallbackSummary(e)}}createFallbackSummary(e){const t=Math.floor(this.criticalMessages/2),n=Math.floor(this.criticalMessages/2),i=e.slice(0,t),s=e.slice(-n),a=e.slice(t,-n),r=this.createBasicSummary(a);return{summarizedConversation:[...i,{role:"system",content:"[CONVERSATION SUMMARY - ".concat(a.length," messages condensed]\n").concat(r),timestamp:(new Date).toISOString(),isSummary:!0,summaryMethod:"BASIC_FALLBACK"},...s],summaryCreated:!0,antiRepetitionContext:this.generateAntiRepetitionContext(e)}}createBasicSummary(e){const t=[],n=[],i=[],s=[];e.forEach(e=>{if("user"===e.role){const t=e.content.toLowerCase();(t.includes("achieved")||t.includes("accomplished")||t.includes("increased")||t.includes("improved"))&&n.push(this.extractKeyPhrase(e.content)),(t.includes("worked on")||t.includes("responsible for")||t.includes("managed")||t.includes("led"))&&i.push(this.extractKeyPhrase(e.content)),(t.includes("skill")||t.includes("experience with")||t.includes("proficient"))&&s.push(this.extractKeyPhrase(e.content))}else if("assistant"===e.role){const n=this.extractQuestionTopic(e.content);n&&t.push(n)}});let a="Topics discussed: ".concat(t.join(", ")||"General career conversation");return n.length>0&&(a+="\nKey achievements mentioned: ".concat(n.slice(0,3).join("; "))),i.length>0&&(a+="\nExperiences discussed: ".concat(i.slice(0,3).join("; "))),s.length>0&&(a+="\nSkills mentioned: ".concat(s.slice(0,3).join(", "))),a}extractKeyPhrase(e){const t=e.split(/[.!?]+/).find(e=>e.trim().length>20);return t?t.trim().substring(0,100)+"...":e.substring(0,100)+"..."}extractQuestionTopic(e){const t=[{pattern:/current role|recent work|present position/,topic:"current role"},{pattern:/achievement|accomplish|success/,topic:"achievements"},{pattern:/skill|technical|expertise/,topic:"skills"},{pattern:/challenge|difficult|problem/,topic:"challenges"},{pattern:/leadership|team|manage/,topic:"leadership"},{pattern:/goal|future|career/,topic:"career goals"},{pattern:/growth|development|learning/,topic:"professional development"},{pattern:/project|work on|responsible/,topic:"work projects"}];for(const{pattern:n,topic:i}of t)if(n.test(e.toLowerCase()))return i;return"career discussion"}estimateTokenCount(e){const t=e.reduce((e,t)=>e+t.content.length,0);return Math.ceil(t/4)}getStats(e){return this.updateTopicTracker(e),{messageCount:e.length,estimatedTokens:this.estimateTokenCount(e),needsSummarization:this.needsSummarization(e),userMessages:e.filter(e=>"user"===e.role).length,assistantMessages:e.filter(e=>"assistant"===e.role).length,summaryMessages:e.filter(e=>e.isSummary).length,aiSummaryMessages:e.filter(e=>e.isAIPowered).length,topicsCovered:this.topicTracker.size,questionsAsked:this.questionHistory.length,averageTopicDepth:this.topicTracker.size>0?Array.from(this.topicTracker.values()).reduce((e,t)=>e+t,0)/this.topicTracker.size:0}}resetTracking(){this.topicTracker.clear(),this.questionHistory=[]}}const vg=new gg,yg=()=>({manageContext:(e,t)=>{const n=vg.getStats(e),i=async(n,i)=>{try{const{summarizedConversation:s,summaryCreated:a,antiRepetitionContext:r}=await vg.summarizeConversationAI(e,n,i);return a?(t(s),{success:!0,antiRepetitionContext:r}):{success:!1,antiRepetitionContext:r}}catch(s){return console.error("AI summarization failed:",s),{success:!1,error:s.message}}};return{stats:n,triggerAISummarization:i,autoManageContext:async(t,n)=>vg.needsSummarization(e)?await i(t,n):{success:!1,antiRepetitionContext:vg.generateAntiRepetitionContext(e)},getAntiRepetitionContext:()=>vg.generateAntiRepetitionContext(e),resetConversationTracking:()=>{vg.resetTracking()},needsSummarization:vg.needsSummarization(e)}}}),bg=e=>{let{state:t,dispatch:n,actions:s}=e;const a=(0,i.useRef)(null),r=(0,i.useRef)(null),o=(0,i.useRef)(!1),[l,c]=(0,i.useState)({percentage:0,explanation:"Preparing to start..."}),[d,h]=(0,i.useState)(0),[u,p]=(0,i.useState)(!1),[m,f]=(0,i.useState)(!1),g=(0,i.useCallback)((e,t)=>{const n=Math.max(8*t,e);return Math.min(n,t>=10?100:95)},[]),{manageContext:v}=yg(),y=v(t.conversation,e=>{n({type:s.SET_CONVERSATION,payload:e})});(0,i.useEffect)(()=>{const e=e=>{"Escape"===e.key&&m&&f(!1)};if(m)return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[m]);const x=(0,i.useCallback)(async e=>{if((()=>{const e=localStorage.getItem("ttsEnabled");return null===e||JSON.parse(e)})())try{if(r.current){try{r.current.pause(),r.current.currentTime=0,r.current.src&&URL.revokeObjectURL(r.current.src)}catch(i){}r.current=null}n({type:s.SET_TTS_PREPARING,payload:!0});const a=await async function(e,t){try{const n=await w("".concat(b,"/audio/speech"),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({model:"tts-1",voice:"alloy",input:e,response_format:"mp3"})});return await n.blob()}catch(i){throw console.error("TTS request failed:",i),i}}(e,t.apiKey),o=URL.createObjectURL(a),l=new Audio(o);r.current=l,n({type:s.SET_TTS_PREPARING,payload:!1}),n({type:s.SET_SPEAKING,payload:!0}),l.onended=()=>{n({type:s.SET_SPEAKING,payload:!1}),URL.revokeObjectURL(o),r.current=null},l.onerror=e=>{console.warn("Audio error:",e),n({type:s.SET_SPEAKING,payload:!1}),n({type:s.SET_TTS_PREPARING,payload:!1}),URL.revokeObjectURL(o),r.current=null},await l.play()}catch(i){console.error("Audio playback failed:",i),n({type:s.SET_SPEAKING,payload:!1}),n({type:s.SET_TTS_PREPARING,payload:!1}),r.current=null}},[t.apiKey,n,s]),A=(0,i.useCallback)(async()=>{if(t.conversation.length>0||t.isThinking||o.current)console.log("Interview already started or in progress");else try{o.current=!0,console.log("Starting interview process"),n({type:s.SET_THINKING,payload:!0});const e={resumeText:t.resumeText,linkedinText:t.linkedinText,pdfText:t.pdfText},i=await E([],t.apiKey,t.selectedModel,!0,t.analysisData,e,t.additionalContexts||[]);console.log("Received opening response:",i),c(e=>{const t=g(i.progress.percentage,1);return{percentage:Math.max(e.percentage,t),explanation:i.progress.explanation||"Getting to know your current work situation"}}),h(1),n({type:s.ADD_MESSAGE,payload:{role:"assistant",content:i.question}}),i.question&&await x(i.question)}catch(e){console.error("Error starting interview:",e),o.current=!1,e.isRetryable?n({type:s.SET_RETRYABLE_ERROR,payload:{message:e.message,retryAction:A}}):n({type:s.SET_ERROR,payload:e.message||"Failed to start interview. Please try again."})}finally{n({type:s.SET_THINKING,payload:!1})}},[t.conversation.length,t.isThinking,t.apiKey,t.selectedModel,t.analysisData,t.resumeText,t.linkedinText,t.pdfText,t.additionalContexts,n,s,x,g]);(0,i.useEffect)(()=>{const e=0===t.conversation.length&&!o.current&&!t.isThinking;0===t.conversation.length&&(h(0),c({percentage:0,explanation:"Preparing to start..."})),e&&(console.log("Starting interview initialization"),A())},[t.conversation.length,t.isThinking,A]),(0,i.useEffect)(()=>{if(a.current){const e=document.getElementById("conversation-container");e&&(e.scrollTop=e.scrollHeight),setTimeout(()=>{const e=document.querySelector("[data-input-box]");e&&e.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})},100)}},[t.conversation]),(0,i.useEffect)(()=>()=>{if(r.current){try{r.current.pause(),r.current.currentTime=0,r.current.src&&URL.revokeObjectURL(r.current.src)}catch(e){console.warn("Audio cleanup warning:",e)}r.current=null}n({type:s.SET_SPEAKING,payload:!1}),n({type:s.SET_TTS_PREPARING,payload:!1})},[]);const _=async e=>{if(!t.isThinking){if(n({type:s.ADD_MESSAGE,payload:{role:"user",content:e}}),l.percentage>=100)return p(!0),void await S([...t.conversation,{role:"user",content:e}]);n({type:s.SET_THINKING,payload:!0});try{const i=[...t.conversation,{role:"user",content:e}],a=(await y.autoManageContext(t.apiKey,t.selectedModel)).antiRepetitionContext||y.getAntiRepetitionContext(),r={resumeText:t.resumeText,linkedinText:t.linkedinText,pdfText:t.pdfText},o=await E(i,t.apiKey,t.selectedModel,!1,t.analysisData,r,t.additionalContexts||[],a),{question:l,progress:u}=o;c(e=>{const t=g(u.percentage,d+1),n=Math.max(e.percentage,t);return{percentage:n,explanation:u.explanation||"Continuing our conversation (".concat(n,"%)")}}),h(e=>e+1),n({type:s.ADD_MESSAGE,payload:{role:"assistant",content:l}}),u.percentage>=100&&p(!0),await x(l)}catch(i){console.error("Error in generateNextQuestion:",i),i.isRetryable?n({type:s.SET_RETRYABLE_ERROR,payload:{message:i.message,retryAction:()=>_(e)}}):n({type:s.SET_ERROR,payload:i.message||"Failed to get next question. Please try again."})}finally{n({type:s.SET_THINKING,payload:!1})}}},S=async e=>{if(console.log("generateFinalResume - Current state:",{apiKey:t.apiKey?"".concat(t.apiKey.substring(0,10),"..."):"MISSING",isKeyVerified:t.isKeyVerified,selectedModel:t.selectedModel}),t.apiKey&&t.apiKey.trim()){n({type:s.SET_PHASE,payload:"RESULTS"}),n({type:s.SET_THINKING,payload:!0}),n({type:s.SET_LOADING,payload:!0});try{const i={resumeText:t.resumeText,pdfText:t.pdfText},[a,r]=await Promise.all([k(e,i,t.additionalContexts||[],t.apiKey,t.selectedModel),C(e,i,t.additionalContexts||[],t.apiKey,t.selectedModel)]);n({type:s.SET_FINAL_RESUME,payload:a}),n({type:s.SET_LINKEDIN_CONTENT,payload:r})}catch(i){console.error("Error in generateFinalResume:",i),i.message&&(i.message.includes("Invalid API key")||i.message.includes("Incorrect API key"))?n({type:s.SET_ERROR,payload:"Invalid API key detected. Please go back to setup and verify your OpenAI API key is correct."}):i.isRetryable?n({type:s.SET_RETRYABLE_ERROR,payload:{message:i.message,retryAction:()=>S(e)}}):n({type:s.SET_ERROR,payload:i.message||"Failed to generate resume and LinkedIn content. Please try again."})}finally{n({type:s.SET_THINKING,payload:!1}),n({type:s.SET_LOADING,payload:!1})}}else n({type:s.SET_ERROR,payload:"API key is required to generate the final resume. Please go back to setup and enter your OpenAI API key."})},T=()=>{S(t.conversation)},N=()=>{f(!1)},R=t.isThinking||t.isLoading;return(0,M.jsxs)("div",{className:"max-w-4xl mx-auto animate-fade-in",children:[(0,M.jsxs)("div",{className:"mb-2 text-center",children:[(0,M.jsx)("h1",{className:"text-h1 font-bold text-midnight-blue mb-2",children:"Career Discovery Conversation"}),(0,M.jsx)("p",{className:"text-body text-muted mb-4",children:"Share your authentic experiences and let's uncover your unique professional story"}),(0,M.jsx)("div",{className:"flex justify-center mb-4",children:(0,M.jsx)(ug,{})}),(0,M.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm border",children:[(0,M.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,M.jsx)("span",{className:"text-ui-label font-medium text-midnight-blue",children:d>0?"Question ".concat(d):"Interview Progress"}),(0,M.jsxs)("span",{className:"text-ui-label font-bold text-amber-gold",children:[l.percentage,"%"]})]}),(0,M.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-2",children:(0,M.jsx)("div",{className:"bg-gradient-to-r from-amber-gold to-coral h-3 rounded-full transition-all duration-500 ease-out",style:{width:"".concat(l.percentage,"%")}})}),(0,M.jsx)("p",{className:"text-ui-label text-muted text-left",children:l.explanation}),l.percentage>=65&&l.percentage<100&&(0,M.jsx)("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,M.jsxs)("p",{className:"text-sm text-blue-700 text-center",children:["\ud83d\udca1 ",(0,M.jsx)("strong",{children:"Ready to finish?"}),' You can generate your resume now using the "Finish Interview" button below, or continue for even more detailed results.']})}),u&&(0,M.jsxs)("div",{className:"mt-3 flex items-center justify-center text-green-600",children:[(0,M.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),(0,M.jsx)("span",{className:"text-ui-label font-medium",children:"Ready to generate your resume!"})]}),y.stats.messageCount>20&&(0,M.jsx)("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,M.jsxs)("p",{className:"text-sm text-blue-700 text-center",children:["\ud83e\udde0 ",(0,M.jsx)("strong",{children:"AI-Powered Processing:"})," Our context management system is creating comprehensive summaries and preventing repetitive questions to maximize interview efficiency."]})})]})]}),(0,M.jsx)("div",{className:"mb-2 flex items-center justify-center transition-opacity duration-300 ".concat(t.isSpeaking||t.isTTSPreparing?"opacity-100":"opacity-0 pointer-events-none"),children:(0,M.jsxs)("div",{className:"bg-gradient-to-r from-amber-gold/10 to-coral/10 border border-amber-gold/20 rounded-full px-6 py-1 flex items-center shadow-sm backdrop-blur-sm",children:[(0,M.jsxs)("div",{className:"flex items-center mr-4",children:[(0,M.jsxs)("div",{className:"relative",children:[(0,M.jsx)("div",{className:"w-2 h-2 bg-amber-gold rounded-full animate-pulse"}),(0,M.jsx)("div",{className:"absolute inset-0 w-2 h-2 bg-amber-gold rounded-full animate-ping opacity-75"})]}),(0,M.jsx)("svg",{className:"w-4 h-4 text-amber-gold mx-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.82L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.797-3.82a1 1 0 011.617.16zm6.617-.926a1 1 0 011.345-.02A8.969 8.969 0 0120 10a8.969 8.969 0 01-2.655 6.126 1 1 0 11-1.49-1.337A6.97 6.97 0 0018 10c0-1.854-.723-3.534-1.905-4.789a1 1 0 01.905-1.051zm-2.828 2.828a1 1 0 011.414 0A3.984 3.984 0 0116 10a3.984 3.984 0 01-1.414 3.071 1 1 0 01-1.414-1.414A1.992 1.992 0 0014 10a1.992 1.992 0 00-.828-1.657 1 1 0 010-1.415z",clipRule:"evenodd"})}),(0,M.jsx)("span",{className:"text-ui-label text-midnight-blue font-medium",children:t.isTTSPreparing?"Preparing to speak...":"AI is speaking..."})]}),(0,M.jsx)("button",{onClick:()=>{if(r.current){try{r.current.pause(),r.current.currentTime=0,r.current.src&&URL.revokeObjectURL(r.current.src)}catch(e){console.warn("Stop audio warning:",e)}r.current=null,n({type:s.SET_SPEAKING,payload:!1}),n({type:s.SET_TTS_PREPARING,payload:!1})}},className:"text-ui-label text-muted hover:text-coral transition-colors duration-200 px-3 py-1 rounded-full hover:bg-white/50",children:"Stop"})]})}),(0,M.jsx)("div",{className:"bg-white rounded-xl shadow-lg mb-6",children:(0,M.jsxs)("div",{className:"p-6 h-[32rem] md:h-[40rem] lg:h-[44rem] overflow-y-auto",id:"conversation-container",children:[0===t.conversation.length?(0,M.jsxs)("div",{className:"text-center py-8",children:[(0,M.jsx)("div",{className:"w-12 h-12 bg-amber-gold rounded-full flex items-center justify-center mx-auto mb-4",children:(0,M.jsx)("svg",{className:"w-6 h-6 text-midnight-blue",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-6-3a2 2 0 11-4 0 2 2 0 014 0zm-2 4a5 5 0 00-4.546 2.916A5.986 5.986 0 0010 16a5.986 5.986 0 004.546-2.084A5 5 0 0010 11z",clipRule:"evenodd"})})}),(0,M.jsx)("p",{className:"text-muted",children:"Starting your personalized career conversation..."})]}):(0,M.jsxs)("div",{className:"space-y-4",children:[t.conversation.map((e,t)=>(0,M.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"),children:(0,M.jsxs)("div",{className:"max-w-xs lg:max-w-md px-4 py-3 rounded-lg ".concat("user"===e.role?"bg-coral text-white message-user":"bg-gray-100 text-midnight-blue message-ai"),children:[(0,M.jsx)("div",{className:"assistant"===e.role?"text-ai-text font-medium":"text-body",children:e.content}),"assistant"===e.role&&(0,M.jsx)("div",{className:"text-ui-label text-muted mt-1",children:"Career Counselor"})]})},t)),(t.isThinking||t.isTTSPreparing)&&(0,M.jsx)("div",{className:"flex justify-start",children:(0,M.jsx)("div",{className:"bg-gray-100 text-midnight-blue px-4 py-3 rounded-lg message-ai",children:(0,M.jsxs)("div",{className:"flex items-center",children:[(0,M.jsxs)("div",{className:"flex space-x-1 mr-2",children:[(0,M.jsx)("div",{className:"w-2 h-2 bg-muted rounded-full animate-pulse"}),(0,M.jsx)("div",{className:"w-2 h-2 bg-muted rounded-full animate-pulse",style:{animationDelay:"0.2s"}}),(0,M.jsx)("div",{className:"w-2 h-2 bg-muted rounded-full animate-pulse",style:{animationDelay:"0.4s"}})]}),(0,M.jsx)("span",{className:"text-ui-label text-muted",children:t.isTTSPreparing?"Preparing to speak...":"Thinking..."})]})})})]}),(0,M.jsx)("div",{ref:a})]})}),(0,M.jsx)(fg,{onSendMessage:_,isListening:t.isListening,onStartListening:()=>{n({type:s.SET_LISTENING,payload:!0})},onStopListening:()=>{n({type:s.SET_LISTENING,payload:!1})},disabled:R,apiKey:t.apiKey}),(0,M.jsxs)("div",{className:"mt-6 flex justify-between items-center",children:[(0,M.jsx)("button",{onClick:()=>n({type:s.SET_PHASE,payload:"ANALYSIS"}),className:"text-muted hover:text-midnight-blue transition-colors",disabled:R,children:"\u2190 Back to Analysis"}),(0,M.jsxs)("div",{className:"flex gap-3",children:[(!t.apiKey||!t.apiKey.trim())&&(0,M.jsx)("button",{onClick:()=>n({type:s.SET_PHASE,payload:"SETUP"}),className:"btn-primary px-4 py-2",children:"Go to Setup"}),l.percentage<65&&(0,M.jsx)("button",{onClick:()=>{t.conversation.length<4||l.percentage<40?f(!0):T()},disabled:R||!t.apiKey||!t.apiKey.trim(),className:"text-coral border-2 border-coral hover:bg-coral hover:text-white px-4 py-2 rounded-lg transition-all duration-200 font-medium disabled:opacity-50 disabled:cursor-not-allowed",title:t.apiKey&&t.apiKey.trim()?"End the interview and generate resume with current conversation":"API key required to generate resume",children:"End Interview"}),l.percentage>=65&&(0,M.jsx)("button",{onClick:T,disabled:R,className:"btn-primary px-6 py-2",children:u?"Generate Resume Now":"Generate Resume"})]})]}),(0,M.jsxs)("div",{className:"mt-8 bg-gray-50 rounded-lg p-6",children:[(0,M.jsx)("h3",{className:"text-body font-medium text-midnight-blue mb-3",children:"\ud83d\udca1 How to get the most from this conversation:"}),(0,M.jsxs)("ul",{className:"space-y-2 text-ui-label text-muted",children:[(0,M.jsxs)("li",{className:"flex items-start",children:[(0,M.jsx)("span",{className:"text-amber-gold mr-2",children:"\u2022"}),(0,M.jsx)("strong",{children:"Be specific:"})," Share real examples with numbers, outcomes, and emotions"]}),(0,M.jsxs)("li",{className:"flex items-start",children:[(0,M.jsx)("span",{className:"text-amber-gold mr-2",children:"\u2022"}),(0,M.jsx)("strong",{children:"Tell the story:"})," What happened, how you felt, what you learned"]}),(0,M.jsxs)("li",{className:"flex items-start",children:[(0,M.jsx)("span",{className:"text-amber-gold mr-2",children:"\u2022"}),(0,M.jsx)("strong",{children:"Share challenges:"})," Talk about problems you solved and how you overcame obstacles"]}),(0,M.jsxs)("li",{className:"flex items-start",children:[(0,M.jsx)("span",{className:"text-amber-gold mr-2",children:"\u2022"}),(0,M.jsx)("strong",{children:"Be authentic:"})," This isn't a job interview - be genuine and conversational"]}),(0,M.jsxs)("li",{className:"flex items-start",children:[(0,M.jsx)("span",{className:"text-amber-gold mr-2",children:"\u2022"}),(0,M.jsx)("strong",{children:"Question repetition?"}),' Just say "I think I answered this before" - no penalty!']}),(0,M.jsxs)("li",{className:"flex items-start",children:[(0,M.jsx)("span",{className:"text-amber-gold mr-2",children:"\u2022"}),(0,M.jsx)("strong",{children:"Want to finish early?"}),' After 65% progress, use the "Generate Resume" button below']})]}),(0,M.jsx)("div",{className:"mt-4 p-3 bg-amber-gold bg-opacity-10 rounded-lg",children:(0,M.jsxs)("p",{className:"text-ui-label text-midnight-blue",children:[(0,M.jsx)("strong",{children:"\ud83c\udfaf Remember:"})," The more detailed and emotional your stories are, the more compelling your resume will be!"]})})]}),m&&(0,M.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:N,children:(0,M.jsx)("div",{className:"bg-white rounded-xl p-6 max-w-md mx-4 shadow-2xl",onClick:e=>e.stopPropagation(),children:(0,M.jsxs)("div",{className:"text-center",children:[(0,M.jsx)("div",{className:"w-16 h-16 bg-red-100 border-2 border-red-300 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,M.jsx)("span",{className:"text-2xl",children:"\u26a0\ufe0f"})}),(0,M.jsx)("h3",{className:"text-h2 font-semibold text-midnight-blue mb-3",children:"End Interview Early?"}),(0,M.jsx)("p",{className:"text-body text-muted mb-6",children:l.percentage<20?"You've just started the conversation. Continuing will help create a much more comprehensive and personalized resume with deeper insights into your experience.":"You're making good progress, but continuing the conversation will help create a more comprehensive and personalized resume with additional details about your experience."}),(0,M.jsxs)("div",{className:"space-y-3",children:[(0,M.jsx)("button",{onClick:N,className:"w-full btn-primary",children:"Continue Interview"}),(0,M.jsx)("button",{onClick:()=>{f(!1),T()},className:"w-full text-coral border-2 border-coral hover:bg-coral hover:text-white py-3 px-6 rounded-lg transition-all duration-200 font-medium",children:"End Now & Generate Resume"})]}),(0,M.jsx)("p",{className:"text-ui-label text-muted mt-4",children:"\ud83d\udca1 You can always come back to refine your resume later"})]})})})]})},xg=async(e,t)=>{try{return await navigator.clipboard.writeText(e),t(!0),setTimeout(()=>t(!1),2e3),!0}catch(n){return console.error("Failed to copy text:",n),!1}},wg=async function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Failed to generate content. Please try again.";n(!0);try{t(await e())}catch(s){console.error("Content generation error:",s),t(i)}finally{n(!1)}},Ag=e=>{var t,n,s,a,r,o,l,c,h;let{state:u,dispatch:p,actions:m}=e;const[g,v]=(0,i.useState)(!1),[y,x]=(0,i.useState)(!1),[A,S]=(0,i.useState)(!1),[E,k]=(0,i.useState)("resume"),[C,T]=(0,i.useState)(""),[N,R]=(0,i.useState)(!1),[I,P]=(0,i.useState)(""),[L,j]=(0,i.useState)(!1),[D,O]=(0,i.useState)(""),[F,W]=(0,i.useState)(!1),[z,B]=(0,i.useState)(!1),H=null===(t=u.additionalContexts)||void 0===t?void 0:t.some(e=>"job-description"===e.type),U=e=>{switch(e){case"resume":return!!u.finalResume;case"narrative":return!!C&&!N;case"cover-letter":return!!I&&!L;case"career-improvement":return!!D&&!F;default:return!1}};(0,i.useEffect)(()=>{const e=(t=u.resumeText,n=u.pdfText,{resumeText:t,pdfText:n});var t,n;(async()=>{"narrative"!==E||C||N||await wg(()=>async function(e,t,n,i,s){try{const a=new f(s),r=[{role:"user",content:d.narrative.generate(e,t,n)}],o={systemMessage:a.supportsSystemMessages()?d.narrative.system:null,maxTokens:4e3,temperature:.9},l=a.buildRequestParams(r,o),c=await w("".concat(b,"/chat/completions"),{method:"POST",headers:a.buildHeaders(i),body:JSON.stringify(l)});return _((await c.json()).choices[0].message.content)}catch(a){throw console.error("Narrative generation failed:",a),a}}(u.conversation,e,u.additionalContexts||[],u.apiKey,u.selectedModel),T,R,"Failed to generate narrative story. Please try again."),"cover-letter"!==E||I||L||await wg(()=>async function(e,t,n,i,s){try{const a=new f(s),r=[{role:"user",content:d.coverLetter.generate(e,t,n)}],o={systemMessage:a.supportsSystemMessages()?d.coverLetter.system:null,maxTokens:1500,temperature:.7},l=a.buildRequestParams(r,o),c=await w("".concat(b,"/chat/completions"),{method:"POST",headers:a.buildHeaders(i),body:JSON.stringify(l)});return _((await c.json()).choices[0].message.content)}catch(a){throw console.error("Cover letter generation failed:",a),a}}(u.conversation,e,u.additionalContexts||[],u.apiKey,u.selectedModel),P,j,"Failed to generate cover letter. Please try again."),"career-improvement"!==E||D||F||await wg(()=>async function(e,t,n,i,s){try{var a;const r=new f(s);if(!(null===(a=n.find(e=>"job-description"===e.type))||void 0===a?void 0:a.content))return"Career improvement suggestions require a job description to be added in the Additional Context section during the onboarding process.";const o=[{role:"user",content:d.careerImprovement.generate(e,t,n)}],l={systemMessage:r.supportsSystemMessages()?d.careerImprovement.system:null,maxTokens:2e3,temperature:.7},c=r.buildRequestParams(o,l),h=await w("".concat(b,"/chat/completions"),{method:"POST",headers:r.buildHeaders(i),body:JSON.stringify(c)});return _((await h.json()).choices[0].message.content)}catch(r){throw console.error("Career improvement generation failed:",r),r}}(u.conversation,e,u.additionalContexts||[],u.apiKey,u.selectedModel),O,W,"Failed to generate career improvement suggestions. Please try again.")})()},[E,C,N,I,L,D,F,u.conversation,u.resumeText,u.pdfText,u.additionalContexts,u.apiKey,u.selectedModel]);const G=()=>{var e,t;const n=(new Date).toISOString().split("T")[0],i="# Complete Career Package - ".concat(n,"\n\n## Resume\n").concat(u.finalResume,"\n\n## Personal Career Story\n").concat(C||"Personal story not yet generated.","\n\n## Cover Letter\n").concat(I||"Cover letter not yet generated.","\n\n").concat(H?"## Career Improvement Plan\n".concat(D||"Career improvement plan not yet generated.","\n\n"):"","## LinkedIn Headline\n").concat((null===(e=u.linkedinContent)||void 0===e?void 0:e.headline)||"LinkedIn headline not yet generated.","\n\n## LinkedIn About Section\n").concat((null===(t=u.linkedinContent)||void 0===t?void 0:t.about)||"LinkedIn about section not yet generated.","\n\n---\nGenerated by AI Career & Resume Polisher\n"),s=document.createElement("a"),a=new Blob([i],{type:"text/plain"});s.href=URL.createObjectURL(a),s.download="career_package_".concat(n,".md"),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(s.href)},V=e=>{if(!e)return"";let t=e;t=t.replace(/^```markdown\s*/gim,""),t=t.replace(/^```\s*/gim,""),t=t.replace(/\s*```\s*$/gim,""),t=t.replace(/^### (.*$)/gim,'<h3 class="text-lg font-medium text-midnight-blue mb-2 mt-4">$1</h3>'),t=t.replace(/^## (.*$)/gim,'<h2 class="text-xl font-semibold text-midnight-blue mb-3 mt-6">$1</h2>'),t=t.replace(/^# (.*$)/gim,'<h1 class="text-2xl font-bold text-midnight-blue mb-4 mt-0">$1</h1>'),t=t.replace(/\*\*(.*?)\*\*/gim,'<strong class="font-semibold text-midnight-blue">$1</strong>'),t=t.replace(/\*(.*?)\*/gim,'<em class="italic">$1</em>'),t=t.replace(/_(.*?)_/gim,'<em class="italic">$1</em>'),t=t.replace(/\[(.*?)\]\((.*?)\)/gim,'<a href="$2" target="_blank" class="text-coral hover:text-coral underline">$1</a>'),t=t.replace(/^---+\s*$/gim,'<hr class="border-t border-gray-300 my-6">');const n=t.split("\n");let i=[],s=!1;for(let d=0;d<n.length;d++){const e=n[d].trim(),t=e.includes("|")&&!e.match(/^\s*\|[\s\-|]*\|\s*$/),a=e.match(/^\s*\|[\s\-|]*\|\s*$/);if(t&&!s){s=!0;const t=e.split("|").map(e=>e.trim()).filter(e=>e);i.push('<table class="min-w-full mt-4 mb-6 border-collapse border border-gray-300">'),i.push('<thead class="bg-gray-50">'),i.push("<tr>"),t.forEach(e=>{i.push('<th class="border border-gray-300 px-4 py-2 text-left font-semibold text-midnight-blue">'.concat(e,"</th>"))}),i.push("</tr>"),i.push("</thead>"),i.push("<tbody>")}else{if(a&&s)continue;if(t&&s){const t=e.split("|").map(e=>e.trim()).filter(e=>e);i.push('<tr class="hover:bg-gray-50">'),t.forEach(e=>{i.push('<td class="border border-gray-300 px-4 py-2 text-midnight-blue">'.concat(e,"</td>"))}),i.push("</tr>")}else s&&(i.push("</tbody>"),i.push("</table>"),s=!1),i.push(e)}}s&&(i.push("</tbody>"),i.push("</table>")),t=i.join("\n");const a=t.split("\n");let r=!1,o=!1,l=[];for(let d=0;d<a.length;d++){const e=a[d],t=e.match(/^[-*+]\s+(.+)$/),n=e.match(/^\d+\.\s+(.+)$/);t?(o&&(l.push("</ol>"),o=!1),r||(l.push('<ul class="list-disc ml-6 mb-4 space-y-1">'),r=!0),l.push('<li class="text-midnight-blue">'.concat(t[1],"</li>"))):n?(r&&(l.push("</ul>"),r=!1),o||(l.push('<ol class="list-decimal ml-6 mb-4 space-y-1">'),o=!0),l.push('<li class="text-midnight-blue">'.concat(n[1],"</li>"))):(r&&(l.push("</ul>"),r=!1),o&&(l.push("</ol>"),o=!1),l.push(e))}r&&l.push("</ul>"),o&&l.push("</ol>"),t=l.join("\n");const c=t.split("\n\n");return t=c.map(e=>e.trim()?e.includes("<table")||e.includes("<ul")||e.includes("<ol")||e.includes("<h1")||e.includes("<h2")||e.includes("<h3")?e:'<p class="mb-4 text-midnight-blue">'.concat(e.replace(/\n/g,"<br>"),"</p>"):"").filter(e=>e.trim()).join("\n"),t},q=(0,i.useMemo)(()=>V(u.finalResume),[u.finalResume]),Y=(0,i.useMemo)(()=>V(D),[D]),K=(0,i.useMemo)(()=>V(C),[C]),X=(0,i.useMemo)(()=>V(I),[I]);return(0,M.jsx)("div",{className:"max-w-7xl mx-auto animate-fade-in px-4 sm:px-6",children:u.isThinking&&!u.finalResume?(0,M.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,M.jsxs)("div",{className:"text-center max-w-md mx-auto",children:[(0,M.jsx)("div",{className:"w-20 h-20 bg-amber-gold rounded-full flex items-center justify-center mx-auto mb-6",children:(0,M.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-midnight-blue"})}),(0,M.jsx)("h2",{className:"text-h2 font-semibold text-midnight-blue mb-4",children:"Creating Your Resume..."}),(0,M.jsx)("p",{className:"text-body text-muted leading-body mb-6",children:"Our AI is crafting your personalized resume and LinkedIn content. This usually takes 10-30 seconds."}),(0,M.jsxs)("div",{className:"space-y-2 text-sm text-muted",children:[(0,M.jsxs)("div",{className:"flex items-center justify-center",children:[(0,M.jsx)("div",{className:"w-2 h-2 bg-amber-gold rounded-full mr-2"}),"Analyzing your career journey..."]}),(0,M.jsxs)("div",{className:"flex items-center justify-center",children:[(0,M.jsx)("div",{className:"w-2 h-2 bg-amber-gold rounded-full mr-2"}),"Crafting compelling narratives..."]}),(0,M.jsxs)("div",{className:"flex items-center justify-center",children:[(0,M.jsx)("div",{className:"w-2 h-2 bg-amber-gold rounded-full mr-2"}),"Optimizing for impact..."]})]})]})}):u.finalResume?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)("div",{className:"mb-6 sm:mb-8 text-center",children:[(0,M.jsx)("div",{className:"mb-4",children:(0,M.jsx)("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-amber-gold rounded-full flex items-center justify-center mx-auto mb-4",children:(0,M.jsx)("svg",{className:"w-8 h-8 sm:w-10 sm:h-10 text-midnight-blue",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})}),(0,M.jsx)("h1",{className:"text-2xl sm:text-h1 font-bold text-midnight-blue mb-4",children:"\ud83c\udf89 Your Polished Resume is Ready!"}),(0,M.jsx)("p",{className:"text-sm sm:text-body text-muted leading-body",children:"Congratulations! Your career conversation has been transformed into a compelling professional narrative. Review, customize, and use your new resume to make a powerful impression."})]}),(0,M.jsx)("div",{className:"max-w-5xl mx-auto space-y-6",children:(0,M.jsxs)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[(0,M.jsxs)("div",{className:"border-b border-gray-200",children:[(0,M.jsx)("div",{className:"flex items-center justify-between p-4 sm:p-6 pb-0",children:(0,M.jsx)("h2",{className:"text-h2 font-semibold text-midnight-blue",children:"linkedin"===E?"LinkedIn Content":"cover-letter"===E?"Cover Letter":"career-improvement"===E?"Career Development Plan":"narrative"===E?"Personal Career Story":"Your Resume"})}),(0,M.jsx)("div",{className:"px-4 sm:px-6 pt-4",children:(0,M.jsxs)("div",{className:"flex flex-wrap gap-1",children:[(0,M.jsx)("button",{onClick:()=>k("resume"),className:"px-3 py-2 text-sm font-medium rounded-t-lg transition-colors flex-shrink-0 ".concat("resume"===E?"bg-white text-midnight-blue border-t border-l border-r border-gray-200":"text-muted hover:text-midnight-blue"),children:"\ud83d\udcc4 Resume"}),(0,M.jsx)("button",{onClick:()=>k("linkedin"),className:"px-3 py-2 text-sm font-medium rounded-t-lg transition-colors flex-shrink-0 ".concat("linkedin"===E?"bg-white text-midnight-blue border-t border-l border-r border-gray-200":"text-muted hover:text-midnight-blue"),children:"\ud83d\udcbc LinkedIn"}),(0,M.jsx)("button",{onClick:()=>k("narrative"),className:"px-3 py-2 text-sm font-medium rounded-t-lg transition-colors flex-shrink-0 ".concat("narrative"===E?"bg-white text-midnight-blue border-t border-l border-r border-gray-200":"text-muted hover:text-midnight-blue"),children:"\ud83d\udcac Personal Story"}),(0,M.jsx)("button",{onClick:()=>k("cover-letter"),className:"px-3 py-2 text-sm font-medium rounded-t-lg transition-colors flex-shrink-0 ".concat("cover-letter"===E?"bg-white text-midnight-blue border-t border-l border-r border-gray-200":"text-muted hover:text-midnight-blue"),children:"\u2709\ufe0f Cover Letter"}),H&&(0,M.jsx)("button",{onClick:()=>k("career-improvement"),className:"px-3 py-2 text-sm font-medium rounded-t-lg transition-colors flex-shrink-0 ".concat("career-improvement"===E?"bg-white text-midnight-blue border-t border-l border-r border-gray-200":"text-muted hover:text-midnight-blue"),children:"\u2197\ufe0f Improvement Plan"})]})})]}),"          ",(0,M.jsxs)("div",{className:"p-4 sm:p-8",children:["resume"===E&&(0,M.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 sm:p-12 min-h-[600px] max-h-[800px] overflow-y-auto",children:(0,M.jsx)("div",{className:"text-base sm:text-lg leading-relaxed max-w-none",dangerouslySetInnerHTML:{__html:q},style:{fontFamily:"system-ui, -apple-system, sans-serif",lineHeight:"1.7"}})}),"linkedin"===E&&(0,M.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-8 sm:p-12 min-h-[600px] max-h-[800px] overflow-y-auto space-y-8",children:[(0,M.jsxs)("div",{children:[(0,M.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,M.jsx)("h3",{className:"text-xl font-semibold text-midnight-blue",children:"LinkedIn Headline"}),(0,M.jsx)("button",{onClick:async()=>{var e;await xg((null===(e=u.linkedinContent)||void 0===e?void 0:e.headline)||"",x)},className:"btn-secondary px-4 py-2 text-sm",children:y?"Copied!":"Copy Headline"})]}),(0,M.jsxs)("p",{className:"text-muted text-sm mb-4",children:["\ud83d\udccf ",(null===(n=u.linkedinContent)||void 0===n||null===(s=n.headline)||void 0===s?void 0:s.length)||0,"/120 characters (LinkedIn limit)"]}),(0,M.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:(0,M.jsx)("div",{className:"text-lg leading-relaxed text-midnight-blue font-medium",children:(null===(a=u.linkedinContent)||void 0===a?void 0:a.headline)||"LinkedIn headline not generated yet."})}),(null===(r=u.linkedinContent)||void 0===r?void 0:r.headline)&&(0,M.jsx)("div",{className:"mt-4 text-sm text-muted",children:"\ud83d\udca1 This headline appears right under your name on LinkedIn and in search results. It should be keyword-rich and capture your value proposition."})]}),(0,M.jsxs)("div",{children:[(0,M.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,M.jsx)("h3",{className:"text-xl font-semibold text-midnight-blue",children:"LinkedIn About Section"}),(0,M.jsx)("button",{onClick:async()=>{var e;await xg((null===(e=u.linkedinContent)||void 0===e?void 0:e.about)||"",S)},className:"btn-secondary px-4 py-2 text-sm",children:A?"Copied!":"Copy About"})]}),(0,M.jsxs)("p",{className:"text-muted text-sm mb-4",children:["\ud83d\udccf ",(null===(o=u.linkedinContent)||void 0===o||null===(l=o.about)||void 0===l?void 0:l.length)||0,"/2,600 characters (LinkedIn limit)"]}),(0,M.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-8",children:(0,M.jsx)("div",{className:"text-base leading-relaxed text-midnight-blue whitespace-pre-wrap",children:(null===(c=u.linkedinContent)||void 0===c?void 0:c.about)||"LinkedIn about section not generated yet."})}),(null===(h=u.linkedinContent)||void 0===h?void 0:h.about)&&(0,M.jsx)("div",{className:"mt-4 text-sm text-muted",children:'\ud83d\udca1 This appears in your LinkedIn "About" section. It should tell your professional story in first person and include relevant keywords for discoverability.'})]})]}),"narrative"===E&&(0,M.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 sm:p-12 min-h-[600px] max-h-[800px] overflow-y-auto",children:N?(0,M.jsxs)("div",{className:"flex flex-col items-center justify-center h-64",children:[(0,M.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-coral mb-4"}),(0,M.jsx)("p",{className:"text-muted text-lg",children:"Creating your career story..."}),(0,M.jsx)("p",{className:"text-muted text-sm mt-2",children:"This may take a moment as we craft a personalized narrative"})]}):(0,M.jsx)("div",{className:"text-base sm:text-lg leading-relaxed max-w-none",dangerouslySetInnerHTML:{__html:K||'<p class="mb-4 text-midnight-blue">Your career story will appear here...</p>'},style:{fontFamily:"system-ui, -apple-system, sans-serif",lineHeight:"1.7"}})}),"cover-letter"===E&&(0,M.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 sm:p-12 min-h-[600px] max-h-[800px] overflow-y-auto",children:L?(0,M.jsxs)("div",{className:"flex flex-col items-center justify-center h-64",children:[(0,M.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-coral mb-4"}),(0,M.jsx)("p",{className:"text-muted text-lg",children:"Crafting your cover letter..."}),(0,M.jsx)("p",{className:"text-muted text-sm mt-2",children:"Tailoring your experience to the role requirements"})]}):(0,M.jsx)("div",{className:"text-base sm:text-lg leading-relaxed max-w-none",dangerouslySetInnerHTML:{__html:X||'<p class="mb-4 text-midnight-blue">Your cover letter will appear here...</p>'},style:{fontFamily:"system-ui, -apple-system, sans-serif",lineHeight:"1.7"}})}),"career-improvement"===E&&(0,M.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 sm:p-12 min-h-[600px] max-h-[800px] overflow-y-auto",children:F?(0,M.jsxs)("div",{className:"flex flex-col items-center justify-center h-64",children:[(0,M.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-coral mb-4"}),(0,M.jsx)("p",{className:"text-muted text-lg",children:"Analyzing career development opportunities..."}),(0,M.jsx)("p",{className:"text-muted text-sm mt-2",children:"Comparing your profile to job requirements"})]}):(0,M.jsx)("div",{className:"text-base sm:text-lg leading-relaxed max-w-none",dangerouslySetInnerHTML:{__html:Y||'<p class="mb-4 text-midnight-blue">Your career development plan will appear here...</p>'},style:{fontFamily:"system-ui, -apple-system, sans-serif",lineHeight:"1.7"}})})]}),(0,M.jsxs)("div",{className:"border-t border-gray-200 p-4 sm:p-8",children:[(0,M.jsxs)("div",{className:"flex flex-wrap gap-3 sm:gap-4 justify-center",children:["linkedin"!==E&&(0,M.jsx)("button",{onClick:U(E)?()=>async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t="";if(e)t=e;else{if("linkedin"===E)return;t="narrative"===E?C:"cover-letter"===E?I:"career-improvement"===E?D:u.finalResume}await xg(t,v)}():void 0,disabled:!U(E),className:"px-6 sm:px-8 py-3 text-base sm:text-lg font-medium rounded-lg transition-colors ".concat(U(E)?"btn-primary hover:bg-coral/90":"bg-gray-200 text-gray-400 cursor-not-allowed"),children:g?(0,M.jsxs)("div",{className:"flex items-center justify-center",children:[(0,M.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Copied!"]}):(0,M.jsxs)("div",{className:"flex items-center justify-center",children:[(0,M.jsxs)("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:[(0,M.jsx)("path",{d:"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"}),(0,M.jsx)("path",{d:"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"})]}),U(E)?"Copy":"Not Ready"]})}),["resume","narrative","cover-letter","career-improvement"].includes(E)&&(0,M.jsx)("button",{onClick:U(E)?()=>{const e=document.createElement("a");let t="",n="";switch(E){case"resume":t=u.finalResume,n="resume.md";break;case"narrative":t=C,n="career_story.md";break;case"cover-letter":t=I,n="cover_letter.md";break;case"career-improvement":t=D,n="career_improvement_plan.md";break;default:return}const i=new Blob([t],{type:"text/plain"});e.href=URL.createObjectURL(i),e.download=n,document.body.appendChild(e),e.click(),document.body.removeChild(e),URL.revokeObjectURL(e.href)}:void 0,disabled:!U(E),className:"px-6 sm:px-8 py-3 text-base sm:text-lg font-medium rounded-lg transition-colors ".concat(U(E)?"btn-secondary hover:bg-gray-100":"bg-gray-200 text-gray-400 cursor-not-allowed"),children:(0,M.jsxs)("div",{className:"flex items-center justify-center",children:[(0,M.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})}),(0,M.jsxs)("span",{className:"hidden sm:inline",children:[U(E)?"Download":"Generating"," ","resume"===E?"Resume":"narrative"===E?"Story":"cover-letter"===E?"Letter":"career-improvement"===E?"Plan":"File"]})]})}),(0,M.jsx)("button",{onClick:()=>{var e,t;const n=[];C||n.push("Personal Story"),I||n.push("Cover Letter"),!D&&H&&n.push("Career Improvement Plan"),null!==(e=u.linkedinContent)&&void 0!==e&&e.headline||n.push("LinkedIn Headline"),null!==(t=u.linkedinContent)&&void 0!==t&&t.about||n.push("LinkedIn About Section"),n.length>0?B(!0):G()},className:"bg-amber-gold hover:bg-amber-gold/90 text-midnight-blue px-6 sm:px-8 py-3 text-base sm:text-lg font-medium rounded-lg transition-colors",children:(0,M.jsxs)("div",{className:"flex items-center justify-center",children:[(0,M.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v3.586l-1.293-1.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V8z",clipRule:"evenodd"})}),(0,M.jsx)("span",{className:"hidden sm:inline",children:"Download All"})]})})]}),"linkedin"===E&&(0,M.jsx)("div",{className:"mt-4 text-center",children:(0,M.jsx)("p",{className:"text-sm text-muted",children:'\ud83d\udca1 Use the individual "Copy" buttons above to copy content to your LinkedIn profile'})}),"cover-letter"===E&&(0,M.jsx)("div",{className:"mt-4 text-center",children:(0,M.jsx)("p",{className:"text-sm text-muted",children:"\ud83d\udca1 Customize the salutation and company details before sending"})}),"career-improvement"===E&&!H&&(0,M.jsx)("div",{className:"mt-4 text-center",children:(0,M.jsx)("p",{className:"text-sm text-muted text-orange-600",children:"\u26a0\ufe0f Career improvement suggestions require a job description in Additional Context"})})]})]})}),(0,M.jsxs)("div",{className:"mt-12 flex flex-col sm:flex-row gap-4 justify-center",children:[(0,M.jsx)("button",{onClick:()=>{p({type:m.SET_PHASE,payload:"INTERVIEW"})},className:"btn-secondary px-8 py-3",children:"\u2190 Continue Interview"}),(0,M.jsx)("button",{onClick:()=>{p({type:m.RESET_STATE})},className:"text-muted hover:text-midnight-blue transition-colors px-8 py-3",children:"Start New Session"})]}),(0,M.jsx)("div",{className:"mt-8 text-center",children:(0,M.jsx)("p",{className:"text-ui-label text-muted",children:"Thank you for using AI Career & Resume Polisher! We hope this helps you land your dream job. \ud83c\udfaf"})}),z&&(0,M.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,M.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[(0,M.jsx)("h3",{className:"text-lg font-semibold text-midnight-blue mb-4",children:"Incomplete Content Detected"}),(0,M.jsx)("p",{className:"text-muted mb-4",children:"Some content hasn't been generated yet. You can:"}),(0,M.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,M.jsx)("button",{onClick:()=>{G(),B(!1)},className:"w-full btn-primary py-2",children:"Download Now (with placeholders)"}),(0,M.jsx)("button",{onClick:()=>B(!1),className:"w-full btn-secondary py-2",children:"Cancel (generate content first)"})]})]})})]}):(0,M.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,M.jsxs)("div",{className:"text-center max-w-md mx-auto",children:[(0,M.jsx)("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,M.jsx)("svg",{className:"w-10 h-10 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),(0,M.jsx)("h2",{className:"text-h2 font-semibold text-midnight-blue mb-4",children:"Resume Generation Failed"}),(0,M.jsx)("p",{className:"text-body text-muted leading-body mb-6",children:"We encountered an issue while creating your resume. Please try again or go back to make changes."}),(0,M.jsxs)("div",{className:"space-y-3",children:[(0,M.jsx)("button",{onClick:()=>{u.conversation.length>0?p({type:m.SET_PHASE,payload:"INTERVIEW"}):p({type:m.SET_PHASE,payload:"ANALYSIS"})},className:"btn-primary w-full",children:"\ud83d\udd04 Try Again"}),(0,M.jsx)("button",{onClick:()=>p({type:m.SET_PHASE,payload:"ANALYSIS"}),className:"w-full text-muted border-2 border-gray-300 hover:border-gray-400 hover:text-midnight-blue px-6 py-3 text-lg font-medium rounded-lg transition-all duration-200",children:"\u2190 Go Back to Analysis"})]})]})})})},_g=e=>{let{message:t,onClose:n}=e;return(0,M.jsx)("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-50 animate-fade-in",children:(0,M.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 max-w-md shadow-lg",children:(0,M.jsxs)("div",{className:"flex items-start",children:[(0,M.jsx)("div",{className:"flex-shrink-0",children:(0,M.jsx)("svg",{className:"w-5 h-5 text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,M.jsx)("div",{className:"ml-3 flex-1",children:(0,M.jsx)("p",{className:"text-ui-label text-red-700",children:t})}),(0,M.jsx)("div",{className:"ml-auto pl-3",children:(0,M.jsx)("button",{onClick:n,className:"inline-flex text-red-400 hover:text-red-500 transition-colors",children:(0,M.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})})]})})})},Sg=()=>(0,M.jsx)("div",{className:"fixed top-0 left-0 right-0 z-50",children:(0,M.jsx)("div",{className:"progress-bar",children:(0,M.jsx)("div",{className:"progress-shimmer"})})}),Eg=e=>{let{currentPhase:t,dispatch:n,actions:i,isDebugMode:s,debugModeClickCount:a}=e;const r=[{key:"SETUP",label:"Setup",icon:"\u2699\ufe0f"},{key:"ONBOARDING",label:"Information",icon:"\ud83d\udcc4"},{key:"ANALYSIS",label:"Analysis",icon:"\ud83d\udd0d"},{key:"INTERVIEW",label:"Interview",icon:"\ud83d\udcac"},{key:"RESULTS",label:"Results",icon:"\u2728"}],o=(l=t,r.findIndex(e=>e.key===l));var l;const c=e=>{const t={SETUP:{apiKey:"mock-api-key",isKeyVerified:!0,selectedModel:"gpt-4o-mini"},ONBOARDING:{resumeText:"John Smith\nSoftware Engineer\nEmail: john@email.com\n\nEXPERIENCE\nSenior Software Engineer | ABC Company | 2020-Present\n- Led development of customer portal increasing user engagement by 40%\n- Managed team of 3 junior developers\n- Implemented microservices architecture reducing system downtime by 60%",additionalContexts:[{id:"context1",type:"job-description",title:"Target Job Description",content:"Senior Full Stack Developer position requiring React, Node.js, and cloud experience."}]},ANALYSIS:{analysisSummary:"Mock analysis: Senior Software Engineer with 5+ years experience in full-stack development.",analysisData:{careerLevel:"Senior Professional",track:"Technical",keyStrengths:["Full-stack development","Team leadership","System architecture"],experienceYears:5}},INTERVIEW:{conversation:[{role:"assistant",content:"What project are you most proud of in your current role?"},{role:"user",content:"I led the development of our customer portal which increased engagement by 40%."}]},RESULTS:{finalResume:"# John Smith\n## Senior Software Engineer\n\n**Contact:** john@email.com\n\n## Professional Summary\nExperienced software engineer with 5+ years developing scalable web applications...",linkedinContent:{headline:"Senior Software Engineer | Full-Stack Developer | Team Lead",about:"Passionate software engineer with 5+ years of experience building scalable web applications..."}}}[e];t&&(Object.entries(t).forEach(e=>{let[t,s]=e;const a={apiKey:i.SET_API_KEY,isKeyVerified:i.SET_KEY_VERIFIED,selectedModel:i.SET_MODEL,resumeText:i.SET_RESUME_TEXT,additionalContexts:null,analysisSummary:i.SET_ANALYSIS_SUMMARY,analysisData:i.SET_ANALYSIS_DATA,conversation:i.SET_CONVERSATION,finalResume:i.SET_FINAL_RESUME,linkedinContent:i.SET_LINKEDIN_CONTENT};"additionalContexts"===t?s.forEach(e=>{n({type:i.ADD_ADDITIONAL_CONTEXT,payload:e})}):a[t]&&n({type:a[t],payload:s})}),n({type:i.SET_PHASE,payload:e}))};return(0,M.jsx)("div",{className:"w-full bg-white shadow-sm border-b border-gray-100 mb-8",children:(0,M.jsxs)("div",{className:"container mx-auto px-4 max-w-4xl",children:[(0,M.jsx)("div",{className:"flex justify-between items-center py-4 px-6 overflow-x-auto",children:r.map((e,l)=>{const d=e.key===t,h=l<o;return(0,M.jsxs)("div",{className:"flex items-center flex-shrink-0",children:[(0,M.jsxs)("div",{className:"flex flex-col items-center",children:[(0,M.jsx)("div",{className:"\n                      w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium\n                      transition-all duration-300 ease-in-out\n                      ".concat(d?"bg-amber-gold text-midnight-blue shadow-lg scale-110":h?"bg-midnight-blue text-white":"bg-gray-200 text-gray-500","\n                    "),onClick:t=>((e,t)=>{t.shiftKey&&(n({type:i.INCREMENT_DEBUG_CLICK}),setTimeout(()=>{n({type:i.RESET_DEBUG_CLICK})},1e3),a>=2&&(n({type:i.SET_DEBUG_MODE,payload:!0}),c(e)))})(e.key,t),title:s?"Debug: Jump to ".concat(e.label):"",children:h?(0,M.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,M.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):(0,M.jsx)("span",{children:e.icon})}),(0,M.jsx)("span",{className:"\n                      mt-2 text-xs font-medium whitespace-nowrap\n                      ".concat(d||h?"text-midnight-blue":"text-gray-500","\n                    "),children:e.label})]}),l<r.length-1&&(0,M.jsx)("div",{className:"\n                      h-0.5 w-12 sm:w-16 mx-1 sm:mx-2 mt-[-16px] transition-all duration-300\n                      ".concat(l<o?"bg-midnight-blue":"bg-gray-200","\n                    ")})]},e.key)})}),s&&(0,M.jsx)("div",{className:"pb-2",children:(0,M.jsx)("div",{className:"text-center",children:(0,M.jsx)("span",{className:"inline-block bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full",children:"\ud83d\udc1b Debug Mode Active"})})})]})})};const kg=function(e){let{error:t,onRetry:n,onCancel:i}=e;return(0,M.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,M.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[(0,M.jsxs)("div",{className:"flex items-center mb-4",children:[(0,M.jsx)("div",{className:"bg-red-100 rounded-full p-2 mr-3",children:(0,M.jsx)("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,M.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,M.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Connection Error"})]}),(0,M.jsx)("p",{className:"text-gray-600 mb-6",children:t}),(0,M.jsxs)("div",{className:"flex space-x-3",children:[(0,M.jsx)("button",{onClick:n,className:"flex-1 bg-coral text-white px-4 py-2 rounded-lg font-medium hover:bg-coral-dark transition-colors focus:outline-none focus:ring-2 focus:ring-coral focus:ring-offset-2",children:"Try Again"}),(0,M.jsx)("button",{onClick:i,className:"flex-1 bg-gray-100 text-gray-700 px-4 py-2 rounded-lg font-medium hover:bg-gray-200 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:"Cancel"})]})]})})},Cg={appPhase:"SETUP",apiKey:"",isKeyVerified:!1,selectedModel:N,analysisSummary:"",analysisData:null,conversation:[],currentDraft:"",isThinking:!1,isSpeaking:!1,isTTSPreparing:!1,isListening:!1,error:null,retryableError:null,isLoading:!1,resumeText:"",pdfText:"",additionalContexts:[],finalResume:"",linkedinContent:null,selectedFormat:"markdown",isDebugMode:!1,debugModeClickCount:0},Tg={SET_API_KEY:"SET_API_KEY",SET_KEY_VERIFIED:"SET_KEY_VERIFIED",SET_MODEL:"SET_MODEL",SET_PHASE:"SET_PHASE",SET_ANALYSIS_SUMMARY:"SET_ANALYSIS_SUMMARY",SET_ANALYSIS_DATA:"SET_ANALYSIS_DATA",ADD_MESSAGE:"ADD_MESSAGE",SET_CONVERSATION:"SET_CONVERSATION",SET_CURRENT_DRAFT:"SET_CURRENT_DRAFT",SET_THINKING:"SET_THINKING",SET_SPEAKING:"SET_SPEAKING",SET_TTS_PREPARING:"SET_TTS_PREPARING",SET_LISTENING:"SET_LISTENING",SET_ERROR:"SET_ERROR",SET_RETRYABLE_ERROR:"SET_RETRYABLE_ERROR",SET_LOADING:"SET_LOADING",SET_RESUME_TEXT:"SET_RESUME_TEXT",SET_PDF_TEXT:"SET_PDF_TEXT",ADD_ADDITIONAL_CONTEXT:"ADD_ADDITIONAL_CONTEXT",UPDATE_ADDITIONAL_CONTEXT:"UPDATE_ADDITIONAL_CONTEXT",REMOVE_ADDITIONAL_CONTEXT:"REMOVE_ADDITIONAL_CONTEXT",SET_FINAL_RESUME:"SET_FINAL_RESUME",SET_LINKEDIN_CONTENT:"SET_LINKEDIN_CONTENT",SET_FORMAT:"SET_FORMAT",CLEAR_ERROR:"CLEAR_ERROR",RESET_STATE:"RESET_STATE",SET_DEBUG_MODE:"SET_DEBUG_MODE",INCREMENT_DEBUG_CLICK:"INCREMENT_DEBUG_CLICK",RESET_DEBUG_CLICK:"RESET_DEBUG_CLICK"};function Ng(e,t){switch(t.type){case Tg.SET_API_KEY:return t.payload?localStorage.setItem("openai_api_key",t.payload):localStorage.removeItem("openai_api_key"),c(c({},e),{},{apiKey:t.payload});case Tg.SET_KEY_VERIFIED:return c(c({},e),{},{isKeyVerified:t.payload});case Tg.SET_MODEL:return t.payload&&localStorage.setItem("selected_model",t.payload),c(c({},e),{},{selectedModel:t.payload});case Tg.SET_PHASE:return c(c({},e),{},{appPhase:t.payload});case Tg.SET_ANALYSIS_SUMMARY:return c(c({},e),{},{analysisSummary:t.payload});case Tg.SET_ANALYSIS_DATA:return c(c({},e),{},{analysisData:t.payload});case Tg.ADD_MESSAGE:return c(c({},e),{},{conversation:[...e.conversation,t.payload]});case Tg.SET_CONVERSATION:return c(c({},e),{},{conversation:t.payload});case Tg.SET_CURRENT_DRAFT:return c(c({},e),{},{currentDraft:t.payload});case Tg.SET_THINKING:return c(c({},e),{},{isThinking:t.payload});case Tg.SET_SPEAKING:return c(c({},e),{},{isSpeaking:t.payload});case Tg.SET_TTS_PREPARING:return c(c({},e),{},{isTTSPreparing:t.payload});case Tg.SET_LISTENING:return c(c({},e),{},{isListening:t.payload});case Tg.SET_ERROR:return c(c({},e),{},{error:t.payload,retryableError:null});case Tg.SET_RETRYABLE_ERROR:return c(c({},e),{},{retryableError:t.payload,error:null});case Tg.SET_LOADING:return c(c({},e),{},{isLoading:t.payload});case Tg.SET_RESUME_TEXT:return c(c({},e),{},{resumeText:t.payload});case Tg.SET_PDF_TEXT:return c(c({},e),{},{pdfText:t.payload});case Tg.ADD_ADDITIONAL_CONTEXT:return c(c({},e),{},{additionalContexts:[...e.additionalContexts,t.payload]});case Tg.UPDATE_ADDITIONAL_CONTEXT:return c(c({},e),{},{additionalContexts:e.additionalContexts.map(e=>e.id===t.payload.id?c(c({},e),t.payload.updates):e)});case Tg.REMOVE_ADDITIONAL_CONTEXT:return c(c({},e),{},{additionalContexts:e.additionalContexts.filter(e=>e.id!==t.payload)});case Tg.SET_FINAL_RESUME:return c(c({},e),{},{finalResume:t.payload});case Tg.SET_LINKEDIN_CONTENT:return c(c({},e),{},{linkedinContent:t.payload});case Tg.SET_FORMAT:return c(c({},e),{},{selectedFormat:t.payload});case Tg.CLEAR_ERROR:return c(c({},e),{},{error:null,retryableError:null});case Tg.RESET_STATE:const n=e.apiKey,i=e.selectedModel,s=e.isKeyVerified;return c(c({},Cg),{},{apiKey:n,selectedModel:i,isKeyVerified:s});case Tg.SET_DEBUG_MODE:return c(c({},e),{},{isDebugMode:t.payload});case Tg.INCREMENT_DEBUG_CLICK:return c(c({},e),{},{debugModeClickCount:e.debugModeClickCount+1});case Tg.RESET_DEBUG_CLICK:return c(c({},e),{},{debugModeClickCount:0});default:return e}}const Mg=function(){const[e,t]=(0,i.useReducer)(Ng,Cg);return(0,i.useEffect)(()=>{const e=localStorage.getItem("openai_api_key"),n=localStorage.getItem("selected_model");e&&(t({type:Tg.SET_API_KEY,payload:e}),t({type:Tg.SET_KEY_VERIFIED,payload:!0})),n&&t({type:Tg.SET_MODEL,payload:n})},[]),(0,M.jsxs)("div",{className:"min-h-screen bg-cloud-white font-inter",children:[e.isLoading&&(0,M.jsx)(Sg,{}),"SETUP"!==e.appPhase&&(0,M.jsx)(Eg,{currentPhase:e.appPhase,dispatch:t,actions:Tg,isDebugMode:e.isDebugMode,debugModeClickCount:e.debugModeClickCount}),e.error&&(0,M.jsx)(_g,{message:e.error,onClose:()=>t({type:Tg.CLEAR_ERROR})}),e.retryableError&&(0,M.jsx)(kg,{error:e.retryableError.message,onRetry:()=>{t({type:Tg.CLEAR_ERROR}),e.retryableError.retryAction()},onCancel:()=>t({type:Tg.CLEAR_ERROR})}),(0,M.jsx)("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:(()=>{switch(e.appPhase){case"SETUP":default:return(0,M.jsx)(R,{state:e,dispatch:t,actions:Tg});case"ONBOARDING":return(0,M.jsx)(hg,{state:e,dispatch:t,actions:Tg});case"ANALYSIS":return(0,M.jsx)(mg,{state:e,dispatch:t,actions:Tg});case"INTERVIEW":return(0,M.jsx)(bg,{state:e,dispatch:t,actions:Tg});case"RESULTS":return(0,M.jsx)(Ag,{state:e,dispatch:t,actions:Tg})}})()}),(0,M.jsx)("footer",{className:"mt-16 py-8 border-t border-gray-100",children:(0,M.jsx)("div",{className:"container mx-auto px-4 text-center",children:(0,M.jsxs)("p",{className:"text-xs text-blue-200 font-light",children:["Crafted with passion by"," ",(0,M.jsx)("a",{href:"https://www.linkedin.com/in/wenyuzhang1",target:"_blank",rel:"noopener noreferrer",children:(0,M.jsx)("span",{className:"text-blue-300 font-light",children:"Wenyu Zhang"})})," ","\u2014 empowering professionals to showcase their brilliance and unlock their career potential"]})})})]})};s.createRoot(document.getElementById("root")).render((0,M.jsx)(i.StrictMode,{children:(0,M.jsx)(Mg,{})}))})();